ace.define("ace/ext/beautify",["require","exports","module","ace/token_iterator"],function(e,t){"use strict";var o=e("../token_iterator").TokenIterator;function s(e,t){return e.type.lastIndexOf(t+".xml")>-1}t.singletonTags=["area","base","br","col","command","embed","hr","html","img","input","keygen","link","meta","param","source","track","wbr"],t.blockTags=["article","aside","blockquote","body","div","dl","fieldset","footer","form","head","header","html","nav","ol","p","script","section","style","table","tbody","tfoot","thead","ul"],t.beautify=function(e){for(var l,h,A,E=new o(e,0,0),i=E.getCurrentToken(),L=e.getTabString(),T=t.singletonTags,D=t.blockTags,f=!1,d=!1,p=!1,a="",n="",x="",r=0,C=0,z=0,m=0,j=0,y=0,M=0,k=0,c=0,N=[],R=!1,_=!1,S=!1,O=!1,g=!1,F={0:0},b=[],v=function(){l&&l.value&&l.type!=="string.regexp"&&(l.value=l.value.replace(/^\s*/,""))},w=function(){a=a.replace(/ +$/,"")},u=function(){a=a.trimRight(),f=!1};i!==null;){if(k=E.getCurrentTokenRow(),N=E.$rowTokens,l=E.stepForward(),typeof i!="undefined"){if(n=i.value,j=0,O=x==="style"||e.$modeId==="ace/mode/css",s(i,"tag-open")?(S=!0,l&&(g=D.indexOf(l.value)!==-1),n==="</"&&(g&&!f&&c<1&&c++,O&&(c=1),j=1,g=!1)):s(i,"tag-close")?S=!1:s(i,"comment.start")?g=!0:s(i,"comment.end")&&(g=!1),!S&&!c&&i.type==="paren.rparen"&&i.value.substr(0,1)==="}"&&c++,k!==A&&(c=k,A&&(c-=A)),c){for(u();c>0;c--)a+=`
`;f=!0,!s(i,"comment")&&!i.type.match(/^(comment|string)$/)&&(n=n.trimLeft())}if(n){if(i.type==="keyword"&&n.match(/^(if|else|elseif|for|foreach|while|switch)$/)?(b[r]=n,v(),p=!0,n.match(/^(else|elseif)$/)&&a.match(/\}[\s]*$/)&&(u(),d=!0)):i.type==="paren.lparen"?(v(),n.substr(-1)==="{"&&(p=!0,_=!1,S||(c=1)),n.substr(0,1)==="{"&&(d=!0,a.substr(-1)!=="["&&a.trimRight().substr(-1)==="["?(u(),d=!1):a.trimRight().substr(-1)===")"?u():w())):i.type==="paren.rparen"?(j=1,n.substr(0,1)==="}"&&(b[r-1]==="case"&&j++,a.trimRight().substr(-1)==="{"?u():(d=!0,O&&(c+=2))),n.substr(0,1)==="]"&&a.substr(-1)!=="}"&&a.trimRight().substr(-1)==="}"&&(d=!1,m++,u()),n.substr(0,1)===")"&&a.substr(-1)!=="("&&a.trimRight().substr(-1)==="("&&(d=!1,m++,u()),w()):(i.type==="keyword.operator"||i.type==="keyword")&&n.match(/^(=|==|===|!=|!==|&&|\|\||and|or|xor|\+=|.=|>|>=|<|<=|=>)$/)?(u(),v(),d=!0,p=!0):i.type==="punctuation.operator"&&n===";"?(u(),v(),p=!0,O&&c++):i.type==="punctuation.operator"&&n.match(/^(:|,)$/)?(u(),v(),n.match(/^(,)$/)&&M>0&&y===0?c++:(p=!0,f=!1)):i.type==="support.php_tag"&&n==="?>"&&!f?(u(),d=!0):s(i,"attribute-name")&&a.substr(-1).match(/^\s$/)?d=!0:s(i,"attribute-equals")?(w(),v()):s(i,"tag-close")&&(w(),n==="/>"&&(d=!0)),f&&!(i.type.match(/^(comment)$/)&&!n.substr(0,1).match(/^[/#]$/))&&!(i.type.match(/^(string)$/)&&!n.substr(0,1).match(/^['"]$/))){if(m=z,r>C){m++;for(h=r;h>C;h--)F[h]=m}else r<C&&(m=F[r]);C=r,z=m,j&&(m-=j),_&&!y&&(m++,_=!1);for(h=0;h<m;h++)a+=L}if(i.type==="keyword"&&n.match(/^(case|default)$/)&&(b[r]=n,r++),i.type==="keyword"&&n.match(/^(break)$/)&&b[r-1]&&b[r-1].match(/^(case|default)$/)&&r--,i.type==="paren.lparen"&&(y+=(n.match(/\(/g)||[]).length,M+=(n.match(/\{/g)||[]).length,r+=n.length),i.type==="keyword"&&n.match(/^(if|else|elseif|for|while)$/)?(_=!0,y=0):!y&&n.trim()&&i.type!=="comment"&&(_=!1),i.type==="paren.rparen"){y-=(n.match(/\)/g)||[]).length,M-=(n.match(/\}/g)||[]).length;for(h=0;h<n.length;h++)r--,n.substr(h,1)==="}"&&b[r]==="case"&&r--}i.type=="text"&&(n=n.replace(/\s+$/," ")),d&&!f&&(w(),a.substr(-1)!==`
`&&(a+=" ")),a+=n,p&&(a+=" "),f=!1,d=!1,p=!1,(s(i,"tag-close")&&(g||D.indexOf(x)!==-1)||s(i,"doctype")&&n===">")&&(g&&l&&l.value==="</"?c=-1:c=1),s(i,"tag-open")&&n==="</"?r--:s(i,"tag-open")&&n==="<"&&T.indexOf(l.value)===-1?r++:s(i,"tag-name")?x=n:s(i,"tag-close")&&n==="/>"&&T.indexOf(x)===-1&&r--,A=k}}i=l}a=a.trim(),e.doc.setValue(a)},t.commands=[{name:"beautify",description:"Format selection (Beautify)",exec:function(e){t.beautify(e.session)},bindKey:"Ctrl-Shift-B"}]}),function(){ace.require(["ace/ext/beautify"],function(e){typeof module=="object"&&typeof exports=="object"&&module&&(module.exports=e)})}()