ace.define("ace/ext/beautify",["require","exports","module","ace/token_iterator"],function(e,t){"use strict";var s=e("../token_iterator").TokenIterator;function n(e,t){return e.type.lastIndexOf(t+".xml")>-1}t.singletonTags=["area","base","br","col","command","embed","hr","html","img","input","keygen","link","meta","param","source","track","wbr"],t.blockTags=["article","aside","blockquote","body","div","dl","fieldset","footer","form","head","header","html","nav","ol","p","script","section","style","table","tbody","tfoot","thead","ul"],t.beautify=function(e){for(var d,h,A,E=new s(e,0,0),i=E.getCurrentToken(),L=e.getTabString(),D=t.singletonTags,z=t.blockTags,f=!1,l=!1,p=!1,a="",o="",x="",r=0,k=0,F=0,m=0,v=0,b=0,M=0,C=0,c=0,N=[],R=!1,w=!1,S=!1,O=!1,g=!1,T={0:0},j=[],y=function(){d&&d.value&&d.type!=="string.regexp"&&(d.value=d.value.replace(/^\s*/,""))},_=function(){a=a.replace(/ +$/,"")},u=function(){a=a.trimRight(),f=!1};i!==null;){if(C=E.getCurrentTokenRow(),N=E.$rowTokens,d=E.stepForward(),typeof i!="undefined"){if(o=i.value,v=0,O=x==="style"||e.$modeId==="ace/mode/css",n(i,"tag-open")?(S=!0,d&&(g=z.indexOf(d.value)!==-1),o==="</"&&(g&&!f&&c<1&&c++,O&&(c=1),v=1,g=!1)):n(i,"tag-close")?S=!1:n(i,"comment.start")?g=!0:n(i,"comment.end")&&(g=!1),!S&&!c&&i.type==="paren.rparen"&&i.value.substr(0,1)==="}"&&c++,C!==A&&(c=C,A&&(c-=A)),c){for(u();c>0;c--)a+=`
`;f=!0,!n(i,"comment")&&!i.type.match(/^(comment|string)$/)&&(o=o.trimLeft())}if(o){if(i.type==="keyword"&&o.match(/^(if|else|elseif|for|foreach|while|switch)$/)?(j[r]=o,y(),p=!0,o.match(/^(else|elseif)$/)&&a.match(/\}[\s]*$/)&&(u(),l=!0)):i.type==="paren.lparen"?(y(),o.substr(-1)==="{"&&(p=!0,w=!1,S||(c=1)),o.substr(0,1)==="{"&&(l=!0,a.substr(-1)!=="["&&a.trimRight().substr(-1)==="["?(u(),l=!1):a.trimRight().substr(-1)===")"?u():_())):i.type==="paren.rparen"?(v=1,o.substr(0,1)==="}"&&(j[r-1]==="case"&&v++,a.trimRight().substr(-1)==="{"?u():(l=!0,O&&(c+=2))),o.substr(0,1)==="]"&&a.substr(-1)!=="}"&&a.trimRight().substr(-1)==="}"&&(l=!1,m++,u()),o.substr(0,1)===")"&&a.substr(-1)!=="("&&a.trimRight().substr(-1)==="("&&(l=!1,m++,u()),_()):(i.type==="keyword.operator"||i.type==="keyword")&&o.match(/^(=|==|===|!=|!==|&&|\|\||and|or|xor|\+=|.=|>|>=|<|<=|=>)$/)?(u(),y(),l=!0,p=!0):i.type==="punctuation.operator"&&o===";"?(u(),y(),p=!0,O&&c++):i.type==="punctuation.operator"&&o.match(/^(:|,)$/)?(u(),y(),o.match(/^(,)$/)&&M>0&&b===0?c++:(p=!0,f=!1)):i.type==="support.php_tag"&&o==="?>"&&!f?(u(),l=!0):n(i,"attribute-name")&&a.substr(-1).match(/^\s$/)?l=!0:n(i,"attribute-equals")?(_(),y()):n(i,"tag-close")&&(_(),o==="/>"&&(l=!0)),f&&!(i.type.match(/^(comment)$/)&&!o.substr(0,1).match(/^[/#]$/))&&!(i.type.match(/^(string)$/)&&!o.substr(0,1).match(/^['"]$/))){if(m=F,r>k){m++;for(h=r;h>k;h--)T[h]=m}else r<k&&(m=T[r]);k=r,F=m,v&&(m-=v),w&&!b&&(m++,w=!1);for(h=0;h<m;h++)a+=L}if(i.type==="keyword"&&o.match(/^(case|default)$/)&&(j[r]=o,r++),i.type==="keyword"&&o.match(/^(break)$/)&&j[r-1]&&j[r-1].match(/^(case|default)$/)&&r--,i.type==="paren.lparen"&&(b+=(o.match(/\(/g)||[]).length,M+=(o.match(/\{/g)||[]).length,r+=o.length),i.type==="keyword"&&o.match(/^(if|else|elseif|for|while)$/)?(w=!0,b=0):!b&&o.trim()&&i.type!=="comment"&&(w=!1),i.type==="paren.rparen"){b-=(o.match(/\)/g)||[]).length,M-=(o.match(/\}/g)||[]).length;for(h=0;h<o.length;h++)r--,o.substr(h,1)==="}"&&j[r]==="case"&&r--}i.type=="text"&&(o=o.replace(/\s+$/," ")),l&&!f&&(_(),a.substr(-1)!==`
`&&(a+=" ")),a+=o,p&&(a+=" "),f=!1,l=!1,p=!1,(n(i,"tag-close")&&(g||z.indexOf(x)!==-1)||n(i,"doctype")&&o===">")&&(g&&d&&d.value==="</"?c=-1:c=1),n(i,"tag-open")&&o==="</"?r--:n(i,"tag-open")&&o==="<"&&D.indexOf(d.value)===-1?r++:n(i,"tag-name")?x=o:n(i,"tag-close")&&o==="/>"&&D.indexOf(x)===-1&&r--,A=C}}i=d}a=a.trim(),e.doc.setValue(a)},t.commands=[{name:"beautify",description:"Format selection (Beautify)",exec:function(e){t.beautify(e.session)},bindKey:"Ctrl-Shift-B"}]}),function(){ace.require(["ace/ext/beautify"],function(e){typeof module=="object"&&typeof exports=="object"&&module&&(module.exports=e)})}()