ace.define("ace/ext/elastic_tabstops_lite",["require","exports","module","ace/editor","ace/config"],function(e,t){"use strict";var o,s=function(e){this.$editor=e;var s=this,t=[],n=!1;this.onAfterExec=function(){n=!1,s.processRows(t),t=[]},this.onExec=function(){n=!0},this.onChange=function(e){n&&(t.indexOf(e.start.row)==-1&&t.push(e.start.row),e.end.row!=e.start.row&&t.push(e.end.row))}};(function(){this.processRows=function(e){this.$inChange=!0,s=[];for(var t,n,s,i,a,r,c,l,o=0,d=e.length;o<d;o++){if(i=e[o],s.indexOf(i)>-1)continue;a=this.$findCellWidthsForBlock(i),r=this.$setBlockCellWidthsToMax(a.cellWidths),t=a.firstRow;for(n=0,c=r.length;n<c;n++)l=r[n],s.push(t),this.$adjustRow(t,l),t++}this.$inChange=!1},this.$findCellWidthsForBlock=function(e){for(var n,o,i,s=[],t=e;t>=0;){if(n=this.$cellWidthsForRow(t),n.length==0)break;s.unshift(n),t--}for(o=t+1,t=e,i=this.$editor.session.getLength();t<i-1;){if(t++,n=this.$cellWidthsForRow(t),n.length==0)break;s.push(n)}return{cellWidths:s,firstRow:o}},this.$cellWidthsForRow=function(e){a=this.$selectionColumnsForRow(e),t=[-1].concat(this.$tabsForRow(e)),s=t.map(function(){return 0}).slice(1),r=this.$editor.session.getLine(e);for(var t,s,o,i,a,r,c,l,n=0,d=t.length-1;n<d;n++)o=t[n]+1,i=t[n+1],c=this.$rightmostSelectionInCell(a,i),l=r.substring(o,i),s[n]=Math.max(l.replace(/\s+$/g,"").length,c-o);return s},this.$selectionColumnsForRow=function(e){var t=[],n=this.$editor.getCursorPosition();return this.$editor.session.getSelection().isEmpty()&&e==n.row&&t.push(n.column),t},this.$setBlockCellWidthsToMax=function(e){s=!0,r=this.$izip_longest(e);for(var t,n,s,o,a,r,c,l,d,u,i=0,h=r.length;i<h;i++){if(t=r[i],!t.push){console.error(t);continue}t.push(NaN);for(n=0,u=t.length;n<u;n++){if(c=t[n],s&&(l=n,o=0,s=!1),isNaN(c)){d=n;for(a=l;a<d;a++)e[a][i]=o;s=!0}o=Math.max(o,c)}}return e},this.$rightmostSelectionInCell=function(e,t){if(o=0,e.length){n=[];for(var n,o,s=0,i=e.length;s<i;s++)e[s]<=t?n.push(s):n.push(0);o=Math.max.apply(Math,n)}return o},this.$tabsForRow=function(e){for(var n,t=[],s=this.$editor.session.getLine(e),o=/\t/g;(n=o.exec(s))!=null;)t.push(n.index);return t},this.$adjustRow=function(e,t){if(i=this.$tabsForRow(e),i.length==0)return;for(var n,s,i,c,d,u,h,a=0,l=-1,r=this.$izip(t,i),o=0,m=r.length;o<m;o++){if(d=r[o][0],n=r[o][1],l+=1+d,n+=a,s=l-n,s==0)continue;c=this.$editor.session.getLine(e).substr(0,n),u=c.replace(/\s*$/g,""),h=c.length-u.length,s>0&&(this.$editor.session.getDocument().insertInLine({row:e,column:n+1},Array(s+1).join(" ")+"	"),this.$editor.session.getDocument().removeInLine(e,n,n+1),a+=s),s<0&&h>=-s&&(this.$editor.session.getDocument().removeInLine(e,n+s,n),a+=s)}},this.$izip_longest=function(e){if(!e[0])return[];for(var n,s,i,a,o=e[0].length,r=e.length,t=1;t<r;t++)i=e[t].length,i>o&&(o=i);a=[];for(n=0;n<o;n++){s=[];for(t=0;t<r;t++)e[t][n]===""?s.push(NaN):s.push(e[t][n]);a.push(s)}return a},this.$izip=function(e,t){for(var o,i=e.length>=t.length?t.length:e.length,s=[],n=0;n<i;n++)o=[e[n],t[n]],s.push(o);return s}}).call(s.prototype),t.ElasticTabstopsLite=s,o=e("../editor").Editor,e("../config").defineOptions(o.prototype,"editor",{useElasticTabstops:{set:function(e){e?(this.elasticTabstops||(this.elasticTabstops=new s(this)),this.commands.on("afterExec",this.elasticTabstops.onAfterExec),this.commands.on("exec",this.elasticTabstops.onExec),this.on("change",this.elasticTabstops.onChange)):this.elasticTabstops&&(this.commands.removeListener("afterExec",this.elasticTabstops.onAfterExec),this.commands.removeListener("exec",this.elasticTabstops.onExec),this.removeListener("change",this.elasticTabstops.onChange))}}})}),function(){ace.require(["ace/ext/elastic_tabstops_lite"],function(e){typeof module=="object"&&typeof exports=="object"&&module&&(module.exports=e)})}()