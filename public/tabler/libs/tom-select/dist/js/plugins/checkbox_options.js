(function(e,t){typeof exports=="object"&&typeof module!="undefined"?module.exports=t():typeof define=="function"&&define.amd?define(t):(e=typeof globalThis!="undefined"?globalThis:e||self,e.checkbox_options=t())})(this,function(){"use strict";const s=e=>typeof e=="undefined"||e===null?null:o(e),o=e=>typeof e=="boolean"?e?"1":"0":e+"",e=(e,t=!1)=>{e&&(e.preventDefault(),t&&e.stopPropagation())},i="[̀-ͯ·ʾʼ]",t={},n={"/":"⁄∕",0:"߀",a:"ⱥɐɑ",aa:"ꜳ",ae:"æǽǣ",ao:"ꜵ",au:"ꜷ",av:"ꜹꜻ",ay:"ꜽ",b:"ƀɓƃ",c:"ꜿƈȼↄ",d:"đɗɖᴅƌꮷԁɦ",e:"ɛǝᴇɇ",f:"ꝼƒ",g:"ǥɠꞡᵹꝿɢ",h:"ħⱨⱶɥ",i:"ɨı",j:"ɉȷ",k:"ƙⱪꝁꝃꝅꞣ",l:"łƚɫⱡꝉꝇꞁɭ",m:"ɱɯϻ",n:"ꞥƞɲꞑᴎлԉ",o:"øǿɔɵꝋꝍᴑ",oe:"œ",oi:"ƣ",oo:"ꝏ",ou:"ȣ",p:"ƥᵽꝑꝓꝕρ",q:"ꝗꝙɋ",r:"ɍɽꝛꞧꞃ",s:"ßȿꞩꞅʂ",t:"ŧƭʈⱦꞇ",th:"þ",tz:"ꜩ",u:"ʉ",v:"ʋꝟʌ",vy:"ꝡ",w:"ⱳ",y:"ƴɏỿ",z:"ƶȥɀⱬꝣ",hv:"ƕ"};for(let e in n){let s=n[e]||"";for(let n=0;n<s.length;n++){let o=s.substring(n,n+1);t[o]=e}}new RegExp(Object.keys(t).join("|")+"|"+i,"gu");const a=e=>{if(e.jquery)return e[0];if(e instanceof HTMLElement)return e;if(r(e)){var t=document.createElement("template");return t.innerHTML=e.trim(),t.content.firstChild}return document.querySelector(e)},r=e=>typeof e=="string"&&e.indexOf("<")>-1;function c(){var n,t=this,o=t.onOptionSelect;t.settings.hideSelected=!1,n=function(t){setTimeout(()=>{var e=t.querySelector("input");e instanceof HTMLInputElement&&(t.classList.contains("selected")?e.checked=!0:e.checked=!1)},1)},t.hook("after","setupTemplates",()=>{var n=t.settings.render.option;t.settings.render.option=(o,i)=>{var c=a(n.call(t,o,i)),r=document.createElement("input");r.addEventListener("click",function(t){e(t)}),r.type="checkbox";const l=s(o[t.settings.valueField]);return l&&t.items.indexOf(l)>-1&&(r.checked=!0),c.prepend(r),c}}),t.on("item_remove",e=>{var s=t.getOption(e);s&&(s.classList.remove("selected"),n(s))}),t.on("item_add",e=>{var s=t.getOption(e);s&&n(s)}),t.hook("instead","onOptionSelect",(s,i)=>{if(i.classList.contains("selected")){i.classList.remove("selected"),t.removeItem(i.dataset.value),t.refreshOptions(),e(s,!0);return}o.call(t,s,i),n(i)})}return c})