(function(){"use strict";var s,u,m,f,w=tinymce.util.Tools.resolve("tinymce.PluginManager");const U=(e,t,n)=>{var s;return!!n(e,t.prototype)||((s=e.constructor)===null||s===void 0?void 0:s.name)===t.name},P=e=>{const t=typeof e;return e===null?"null":t==="object"&&Array.isArray(e)?"array":t==="object"&&U(e,String,(e,t)=>t.isPrototypeOf(e))?"string":t},R=e=>t=>P(t)===e,r=e=>t=>typeof t===e,L=R("string"),o=r("boolean"),D=e=>e==null,g=e=>!D(e),l=r("function"),n=e=>t=>t.options.get(e),E=e=>{const t=e.options.register,n=e=>t=>{const n=o(t)||L(t);return n?o(t)?{value:t?e:"",valid:n}:{value:t.trim(),valid:n}:{valid:!1,message:"Must be a boolean or string."}},s="bold italic | quicklink h2 h3 blockquote";t("quickbars_selection_toolbar",{processor:n(s),default:s});const i="quickimage quicktable";t("quickbars_insert_toolbar",{processor:n(i),default:i});const a="alignleft aligncenter alignright";t("quickbars_image_toolbar",{processor:n(a),default:a})},C=n("quickbars_selection_toolbar"),_=n("quickbars_insert_toolbar"),y=n("quickbars_image_toolbar");let a=0;const M=e=>{const t=new Date,n=t.getTime(),s=Math.floor(Math.random()*1e9);return a++,e+"_"+s+a+String(n)},v=(e,t,n)=>{e.execCommand("mceInsertTable",!1,{rows:n,columns:t})},b=(e,t,n)=>{const s=e.editorUpload.blobCache,o=s.create(M("mceu"),n,t);s.add(o),e.insertContent(e.dom.createHTML("img",{src:o.blobUri()}))},j=e=>new Promise(t=>{const n=new FileReader;n.onloadend=()=>{t(n.result.split(",")[1])},n.readAsDataURL(e)});f=tinymce.util.Tools.resolve("tinymce.Env"),m=tinymce.util.Tools.resolve("tinymce.util.Delay");const p=e=>new Promise(t=>{const n=document.createElement("input");n.type="file",n.accept="image/*",n.style.position="fixed",n.style.left="0",n.style.top="0",n.style.opacity="0.001",document.body.appendChild(n);const o=e=>{t(Array.prototype.slice.call(e.target.files))};n.addEventListener("change",o);const s=o=>{const i=()=>{var e;t([]),(e=n.parentNode)===null||e===void 0?void 0:e.removeChild(n)};f.os.isAndroid()&&o.type!=="remove"?m.setEditorTimeout(e,i,0):i(),e.off("focusin remove",s)};e.on("focusin remove",s),n.click()}),O=e=>{e.ui.registry.addButton("quickimage",{icon:"image",tooltip:"Insert image",onAction:()=>{p(e).then(t=>{if(t.length>0){const n=t[0];j(n).then(t=>{b(e,t,n)})}})}}),e.ui.registry.addButton("quicktable",{icon:"table",tooltip:"Insert table",onAction:()=>{v(e,2,2)}})},x=e=>()=>e,h=x(!1);class e{constructor(e,t){this.tag=e,this.value=t}static some(t){return new e(!0,t)}static none(){return e.singletonNone}fold(e,t){return this.tag?t(this.value):e()}isSome(){return this.tag}isNone(){return!this.tag}map(t){return this.tag?e.some(t(this.value)):e.none()}bind(t){return this.tag?t(this.value):e.none()}exists(e){return this.tag&&e(this.value)}forall(e){return!this.tag||e(this.value)}filter(t){return!this.tag||t(this.value)?this:e.none()}getOr(e){return this.tag?this.value:e}or(e){return this.tag?this:e}getOrThunk(e){return this.tag?this.value:e()}orThunk(e){return this.tag?this:e()}getOrDie(e){if(this.tag)return this.value;throw new Error(e??"Called getOrDie on None")}static from(t){return g(t)?e.some(t):e.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(e){this.tag&&e(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}e.singletonNone=new e(!1),typeof window!="undefined"?window:Function("return this;")();const k=1,A=e=>{const t=e.dom.nodeName;return t.toLowerCase()},S=(e,t)=>{const n=e.dom;return!!(n&&n.hasAttribute)&&n.hasAttribute(t)};s=(t,n,s,o,i)=>t(s,o)?e.some(s):l(i)&&i(s)?e.none():n(s,o,i);const F=(e,n)=>{const o=n||document,s=o.createElement("div");if(s.innerHTML=e,!s.hasChildNodes()||s.childNodes.length>1){const t="HTML does not have a single root node";throw console.error(t,e),new Error(t)}return t(s.childNodes[0])},T=(e,n)=>{const s=n||document,o=s.createElement(e);return t(o)},z=(e,n)=>{const s=n||document,o=s.createTextNode(e);return t(o)},t=e=>{if(e==null)throw new Error("Node cannot be null or undefined");return{dom:e}},N=(n,s,o)=>e.from(n.dom.elementFromPoint(s,o)).map(t),i={fromHtml:F,fromTag:T,fromText:z,fromDom:t,fromPoint:N},c=(e,t)=>{const s=e.dom;if(s.nodeType!==k)return!1;const n=s;if(n.matches!==void 0)return n.matches(t);if(n.msMatchesSelector!==void 0)return n.msMatchesSelector(t);if(n.webkitMatchesSelector!==void 0)return n.webkitMatchesSelector(t);if(n.mozMatchesSelector!==void 0)return n.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")},d=(t,n,s)=>{let o=t.dom;const a=l(s)?s:h;for(;o.parentNode;){o=o.parentNode;const t=i.fromDom(o);if(n(t))return e.some(t);if(a(t))break}return e.none()},H=(e,t,n)=>{const o=(e,t)=>t(e);return s(o,d,e,t,n)},I=(e,t,n)=>H(e,t,n).isSome(),B=(e,t,n)=>d(e,e=>c(e,t),n),V=(e,t,n)=>{const o=(e,t)=>c(e,t);return s(o,B,e,t,n)},$=e=>{const t=_(e);t.length>0&&e.ui.registry.addContextToolbar("quickblock",{predicate:t=>{const n=i.fromDom(t),o=e.schema.getTextBlockElements(),s=t=>t.dom===e.getBody();return!S(n,"data-mce-bogus")&&V(n,'table,[data-mce-bogus="all"]',s).fold(()=>I(n,t=>A(t)in o&&e.dom.isEmpty(t.dom),s),h)},items:t,position:"line",scope:"editor"})},W=e=>{const o=t=>e.dom.getContentEditableParent(t)!=="false",t=e=>e.nodeName==="IMG"||e.nodeName==="FIGURE"&&/image/i.test(e.className),n=y(e);n.length>0&&e.ui.registry.addContextToolbar("imageselection",{predicate:t,items:n,position:"node"});const s=C(e);s.length>0&&e.ui.registry.addContextToolbar("textselection",{predicate:n=>!t(n)&&!e.selection.isCollapsed()&&o(n),items:s,position:"selection",scope:"editor"})};u=()=>{w.add("quickbars",e=>{E(e),O(e),$(e),W(e)})},u()})()