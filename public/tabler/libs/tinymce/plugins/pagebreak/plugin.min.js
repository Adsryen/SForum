!function(){"use strict";var o=tinymce.util.Tools.resolve("tinymce.PluginManager"),i=tinymce.util.Tools.resolve("tinymce.Env");const e=e=>t=>t.options.get(e),a=e("pagebreak_separator"),t=e("pagebreak_split_block"),n="mce-pagebreak",s=e=>{const t=`<img src="${i.transparentSrc}" class="mce-pagebreak" data-mce-resize="false" data-mce-placeholder />`;return e?`<p>${t}</p>`:t};o.add("pagebreak",e=>{(e=>{const t=e.options.register;t("pagebreak_separator",{processor:"string",default:"<!-- pagebreak -->"}),t("pagebreak_split_block",{processor:"boolean",default:!1})})(e),(e=>{e.addCommand("mcePageBreak",()=>{e.insertContent(s(t(e)))})})(e),(e=>{const t=()=>e.execCommand("mcePageBreak");e.ui.registry.addButton("pagebreak",{icon:"page-break",tooltip:"Page break",onAction:t}),e.ui.registry.addMenuItem("pagebreak",{text:"Page break",icon:"page-break",onAction:t})})(e),(e=>{const o=a(e),i=()=>t(e),r=new RegExp(o.replace(/[?.*[\](){}+^$:]/g,e=>"\\"+e),"gi");e.on("BeforeSetContent",e=>{e.content=e.content.replace(r,s(i()))}),e.on("PreInit",()=>{e.serializer.addNodeFilter("img",t=>{let s,a,r=t.length;for(;r--;)if(s=t[r],a=s.attr("class"),a&&-1!==a.indexOf(n)){const t=s.parent;if(t&&e.schema.getBlockElements()[t.name]&&i()){t.type=3,t.value=o,t.raw=!0,s.remove();continue}s.type=3,s.value=o,s.raw=!0}})})})(e),(e=>{e.on("ResolveName",t=>{"IMG"===t.target.nodeName&&e.dom.hasClass(t.target,n)&&(t.name="pagebreak")})})(e)})}()