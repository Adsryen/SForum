(function(){"use strict";var p,C=tinymce.util.Tools.resolve("tinymce.PluginManager");const ue=(e,t,n)=>{var s;return!!n(e,t.prototype)||((s=e.constructor)===null||s===void 0?void 0:s.name)===t.name},le=e=>{const t=typeof e;return e===null?"null":t==="object"&&Array.isArray(e)?"array":t==="object"&&ue(e,String,(e,t)=>t.isPrototypeOf(e))?"string":t},re=e=>t=>le(t)===e,i=e=>t=>typeof t===e,te=re("string"),G=i("boolean"),$=e=>e==null,r=e=>!$(e),s=i("function"),T=i("number"),F=(e,t)=>n=>e(t(n)),A=e=>()=>e,k=A(!1);class e{constructor(e,t){this.tag=e,this.value=t}static some(t){return new e(!0,t)}static none(){return e.singletonNone}fold(e,t){return this.tag?t(this.value):e()}isSome(){return this.tag}isNone(){return!this.tag}map(t){return this.tag?e.some(t(this.value)):e.none()}bind(t){return this.tag?t(this.value):e.none()}exists(e){return this.tag&&e(this.value)}forall(e){return!this.tag||e(this.value)}filter(t){return!this.tag||t(this.value)?this:e.none()}getOr(e){return this.tag?this.value:e}or(e){return this.tag?this:e}getOrThunk(e){return this.tag?this.value:e()}orThunk(e){return this.tag?this:e()}getOrDie(e){if(this.tag)return this.value;throw new Error(e??"Called getOrDie on None")}static from(t){return r(t)?e.some(t):e.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(e){this.tag&&e(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}e.singletonNone=new e(!1);const v=(e,t)=>{const n=e.length,s=new Array(n);for(let o=0;o<n;o++){const i=e[o];s[o]=t(i,o)}return s},g=(e,t)=>{for(let n=0,s=e.length;n<s;n++){const o=e[n];t(o,n)}},y=(e,t)=>{const n=[];for(let s=0,i=e.length;s<i;s++){const o=e[s];t(o,s)&&n.push(o)}return n},V=9,j=11,c=1,_=3,w=(e,t)=>{const o=t||document,s=o.createElement("div");if(s.innerHTML=e,!s.hasChildNodes()||s.childNodes.length>1){const t="HTML does not have a single root node";throw console.error(t,e),new Error(t)}return n(s.childNodes[0])},O=(e,t)=>{const s=t||document,o=s.createElement(e);return n(o)},x=(e,t)=>{const s=t||document,o=s.createTextNode(e);return n(o)},n=e=>{if(e==null)throw new Error("Node cannot be null or undefined");return{dom:e}},E=(t,s,o)=>e.from(t.dom.elementFromPoint(s,o)).map(n),t={fromHtml:w,fromTag:O,fromText:x,fromDom:n,fromPoint:E},h=(e,t)=>{const s=e.dom;if(s.nodeType!==c)return!1;const n=s;if(n.matches!==void 0)return n.matches(t);if(n.msMatchesSelector!==void 0)return n.msMatchesSelector(t);if(n.webkitMatchesSelector!==void 0)return n.webkitMatchesSelector(t);if(n.mozMatchesSelector!==void 0)return n.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")};typeof window!="undefined"?window:Function("return this;")();const S=e=>{const t=e.dom.nodeName;return t.toLowerCase()},M=e=>e.dom.nodeType,o=e=>t=>M(t)===e,d=o(c),z=o(_),D=o(V),N=o(j),L=e=>t=>d(t)&&S(t)===e,R=e=>t.fromDom(e.dom.ownerDocument),P=e=>D(e)?e:R(e),H=n=>e.from(n.dom.parentNode).map(t.fromDom),I=e=>v(e.dom.childNodes,t.fromDom),B=(e,t,n)=>{if(te(n)||G(n)||T(n))e.setAttribute(t,n+"");else throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",n,":: Element ",e),new Error("Attribute value was not simple")},b=(e,t,n)=>{B(e.dom,t,n)},l=(e,t)=>{e.dom.removeAttribute(t)},W=e=>N(e)&&r(e.dom.host),U=s(Element.prototype.attachShadow)&&s(Node.prototype.getRootNode),K=U?e=>t.fromDom(e.dom.getRootNode()):P,q=t=>{const n=K(t);return W(n)?e.some(n):e.none()},Y=e=>t.fromDom(e.dom.host),u=e=>{const n=z(e)?e.dom.parentNode:e.dom;if(n==null||n.ownerDocument===null)return!1;const s=n.ownerDocument;return q(t.fromDom(n)).fold(()=>s.body.contains(n),F(u,Y))},X=(n,o,i)=>{let a=n.dom;const r=s(i)?i:k;for(;a.parentNode;){a=a.parentNode;const n=t.fromDom(a);if(o(n))return e.some(n);if(r(n))break}return e.none()},Q=(e,t,n)=>X(e,e=>h(e,t),n),Z=e=>e.style!==void 0&&s(e.style.getPropertyValue),J=(e,t)=>{const n=e.dom,o=window.getComputedStyle(n),s=o.getPropertyValue(t);return s===""&&!u(e)?ee(n,t):s},ee=(e,t)=>Z(e)?e.style.getPropertyValue(t):"",a=e=>J(e,"direction")==="rtl"?"rtl":"ltr",ne=(e,t)=>y(I(e),t),se=(e,t)=>ne(e,e=>h(e,t)),oe=e=>H(e).filter(d),ie=(t,n)=>{const s=n?Q(t,"ol,ul"):e.some(t);return s.getOr(t)},ae=L("li"),m=(e,n)=>{const s=e.selection.getSelectedBlocks();s.length>0&&(g(s,e=>{const o=t.fromDom(e),i=ae(o),s=ie(o,i),r=oe(s);r.each(e=>{const t=a(e);if(t!==n?b(s,"dir",n):a(s)!==n&&l(s,"dir"),i){const e=se(s,"li[dir]");g(e,e=>l(e,"dir"))}})}),e.nodeChanged())},ce=e=>{e.addCommand("mceDirectionLTR",()=>{m(e,"ltr")}),e.addCommand("mceDirectionRTL",()=>{m(e,"rtl")})},f=(e,n)=>s=>{const o=e=>{const o=t.fromDom(e.element);s.setActive(a(o)===n)};return e.on("NodeChange",o),()=>e.off("NodeChange",o)},de=e=>{e.ui.registry.addToggleButton("ltr",{tooltip:"Left to right",icon:"ltr",onAction:()=>e.execCommand("mceDirectionLTR"),onSetup:f(e,"ltr")}),e.ui.registry.addToggleButton("rtl",{tooltip:"Right to left",icon:"rtl",onAction:()=>e.execCommand("mceDirectionRTL"),onSetup:f(e,"rtl")})};p=()=>{C.add("directionality",e=>{ce(e),de(e)})},p()})()