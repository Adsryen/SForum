(function(){"use strict";var qs=tinymce.util.Tools.resolve("tinymce.PluginManager"),Xe,ee,Kt,Ke,We,ft,tn;const aa=(e,t,n)=>{var s;return!!n(e,t.prototype)||((s=e.constructor)===null||s===void 0?void 0:s.name)===t.name},ta=e=>{const t=typeof e;return e===null?"null":t==="object"&&Array.isArray(e)?"array":t==="object"&&aa(e,String,(e,t)=>t.isPrototypeOf(e))?"string":t},Jt=e=>t=>ta(t)===e,ne=e=>t=>typeof t===e,ea=e=>t=>e===t,ae=Jt("string"),re=Jt("array"),Ji=ne("boolean"),ge=ea(void 0),Xi=e=>e==null,we=e=>!Xi(e),u=ne("function"),Gi=ne("number"),Ii=()=>{},Ri=(e,t)=>n=>e(t(n)),n=e=>()=>e,Se=e=>e,Ai=(e,t)=>e===t;function l(e,...t){return(...n)=>{const s=t.concat(n);return e.apply(null,s)}}const vi=e=>{e()},z=n(!1),T=n(!0);class e{constructor(e,t){this.tag=e,this.value=t}static some(t){return new e(!0,t)}static none(){return e.singletonNone}fold(e,t){return this.tag?t(this.value):e()}isSome(){return this.tag}isNone(){return!this.tag}map(t){return this.tag?e.some(t(this.value)):e.none()}bind(t){return this.tag?t(this.value):e.none()}exists(e){return this.tag&&e(this.value)}forall(e){return!this.tag||e(this.value)}filter(t){return!this.tag||t(this.value)?this:e.none()}getOr(e){return this.tag?this.value:e}or(e){return this.tag?this:e}getOrThunk(e){return this.tag?this.value:e()}orThunk(e){return this.tag?this:e()}getOrDie(e){if(this.tag)return this.value;throw new Error(e??"Called getOrDie on None")}static from(t){return we(t)?e.some(t):e.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(e){this.tag&&e(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}e.singletonNone=new e(!1);const x=Object.keys,di=Object.hasOwnProperty,P=(e,t)=>{const n=x(e);for(let s=0,i=n.length;s<i;s++){const o=n[s],a=e[o];t(a,o)}},li=e=>(t,n)=>{e[n]=t},ci=(e,t,n,s)=>{P(e,(e,o)=>{(t(e,o)?n:s)(e,o)})},q=(e,t)=>{const n={};return ci(e,t,li(n),Ii),n},ri=(e,t)=>{const n=[];return P(e,(e,s)=>{n.push(t(e,s))}),n},Et=e=>ri(e,Se),y=e=>x(e).length,v=(t,n)=>p(t,n)?e.from(t[n]):e.none(),p=(e,t)=>di.call(e,t),Ft=(e,t)=>p(e,t)&&e[t]!==void 0&&e[t]!==null,ai=Array.prototype.indexOf,Zo=Array.prototype.push,Xo=(e,t)=>ai.call(e,t),r=(e,t)=>Xo(e,t)>-1,X=(e,t)=>{for(let n=0,s=e.length;n<s;n++){const o=e[n];if(t(o,n))return!0}return!1},$t=(e,t)=>{const n=[];for(let s=0;s<e;s++)n.push(t(s));return n},s=(e,t)=>{const n=e.length,s=new Array(n);for(let o=0;o<n;o++){const i=e[o];s[o]=t(i,o)}return s},i=(e,t)=>{for(let n=0,s=e.length;n<s;n++){const o=e[n];t(o,n)}},Ko=(e,t)=>{for(let n=e.length-1;n>=0;n--){const s=e[n];t(s,n)}},Ho=(e,t)=>{const n=[],s=[];for(let o=0,a=e.length;o<a;o++){const i=e[o],r=t(i,o)?n:s;r.push(i)}return{pass:n,fail:s}},E=(e,t)=>{const n=[];for(let s=0,i=e.length;s<i;s++){const o=e[s];t(o,s)&&n.push(o)}return n},Ro=(e,t,n)=>(Ko(e,(e,s)=>{n=t(n,e,s)}),n),Gt=(e,t,n)=>(i(e,(e,s)=>{n=t(n,e,s)}),n),Lo=(t,n,s)=>{for(let o=0,a=t.length;o<a;o++){const i=t[o];if(n(i,o))return e.some(i);if(s(i,o))break}return e.none()},Z=(e,t)=>Lo(e,t,z),zo=e=>{const t=[];for(let n=0,s=e.length;n<s;++n){if(!re(e[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+e);Zo.apply(t,e[n])}return t},M=(e,t)=>zo(s(e,t)),G=(e,t)=>{for(let n=0,s=e.length;n<s;++n){const o=e[n];if(t(o,n)!==!0)return!1}return!0},To=(e,t)=>{const n={};for(let s=0,i=e.length;s<i;s++){const o=e[s];n[String(o)]=t(o,s)}return n},Zt=(t,n)=>n>=0&&n<t.length?e.some(t[n]):e.none(),Fo=e=>Zt(e,0),Mo=e=>Zt(e,e.length-1),Yt=(t,n)=>{for(let e=0;e<t.length;e++){const s=n(t[e],e);if(s.isSome())return s}return e.none()},So=(e,t)=>{const s=t||document,n=s.createElement("div");if(n.innerHTML=e,!n.hasChildNodes()||n.childNodes.length>1){const t="HTML does not have a single root node";throw console.error(t,e),new Error(t)}return R(n.childNodes[0])},Ao=(e,t)=>{const n=t||document,s=n.createElement(e);return R(s)},ko=(e,t)=>{const n=t||document,s=n.createTextNode(e);return R(s)},R=e=>{if(e==null)throw new Error("Node cannot be null or undefined");return{dom:e}},Eo=(t,n,s)=>e.from(t.dom.elementFromPoint(n,s)).map(R),t={fromHtml:So,fromTag:Ao,fromText:ko,fromDom:R,fromPoint:Eo};typeof window!="undefined"?window:Function("return this;")();const Co=8,Lt=9,zt=11,fe=1,_o=3,c=e=>{const t=e.dom.nodeName;return t.toLowerCase()},kt=e=>e.dom.nodeType,U=e=>t=>kt(t)===e,bo=e=>kt(e)===Co||c(e)==="#comment",C=U(fe),_e=U(_o),vo=U(Lt),go=U(zt),mt=e=>t=>C(t)&&c(t)===e,g=(e,t)=>{const s=e.dom;if(s.nodeType!==fe)return!1;const n=s;if(n.matches!==void 0)return n.matches(t);if(n.msMatchesSelector!==void 0)return n.msMatchesSelector(t);if(n.webkitMatchesSelector!==void 0)return n.webkitMatchesSelector(t);if(n.mozMatchesSelector!==void 0)return n.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")},at=e=>e.nodeType!==fe&&e.nodeType!==Lt&&e.nodeType!==zt||e.childElementCount===0,mo=(e,n)=>{const o=n===void 0?document:n.dom;return at(o)?[]:s(o.querySelectorAll(e),t.fromDom)},ho=(n,s)=>{const o=s===void 0?document:s.dom;return at(o)?e.none():e.from(o.querySelector(n)).map(t.fromDom)},h=(e,t)=>e.dom===t.dom,oo=g,no=e=>t.fromDom(e.dom.ownerDocument),nt=e=>vo(e)?e:no(e),K=n=>e.from(n.dom.parentNode).map(t.fromDom),to=(e,n)=>{const i=u(n)?n:z;let s=e.dom;const o=[];for(;s.parentNode!==null&&s.parentNode!==void 0;){const e=s.parentNode,n=t.fromDom(e);if(o.push(n),i(n)===!0)break;s=e}return o},eo=n=>e.from(n.dom.previousSibling).map(t.fromDom),Ve=n=>e.from(n.dom.nextSibling).map(t.fromDom),D=e=>s(e.dom.childNodes,t.fromDom),Js=(n,s)=>{const o=n.dom.childNodes;return e.from(o[s]).map(t.fromDom)},Qs=e=>Js(e,0),Gs=e=>go(e)&&we(e.dom.host),on=u(Element.prototype.attachShadow)&&u(Node.prototype.getRootNode),Us=on?e=>t.fromDom(e.dom.getRootNode()):nt,Ws=t=>{const n=Us(t);return Gs(n)?e.some(n):e.none()},Fs=e=>t.fromDom(e.dom.host),Ue=e=>{const n=_e(e)?e.dom.parentNode:e.dom;if(n==null||n.ownerDocument===null)return!1;const s=n.ownerDocument;return Ws(t.fromDom(n)).fold(()=>s.body.contains(n),Ri(Ue,Fs))},Ms=(e,t)=>E(D(e),t),qe=(e,t)=>{let n=[];return i(D(e),e=>{t(e)&&(n=n.concat([e])),n=n.concat(qe(e,t))}),n},De=(e,t)=>Ms(e,e=>g(e,t)),Ge=(e,t)=>mo(t,e);Xe=(t,n,s,o,i)=>t(s,o)?e.some(s):u(i)&&i(s)?e.none():n(s,o,i);const Qe=(n,s,o)=>{let i=n.dom;const a=u(o)?o:z;for(;i.parentNode;){i=i.parentNode;const n=t.fromDom(i);if(s(n))return e.some(n);if(a(n))break}return e.none()},ks=(e,n)=>{const s=e=>n(t.fromDom(e)),o=Z(e.dom.childNodes,s);return o.map(t.fromDom)},w=(e,t,n)=>Qe(e,e=>g(e,t),n),xs=(e,t)=>ks(e,e=>g(e,t)),tt=(e,t)=>ho(t,e),Te=(e,t,n)=>{const s=(e,t)=>g(e,t);return Xe(s,w,e,t,n)},st=(e,t,n)=>{if(ae(n)||Ji(n)||Gi(n))e.setAttribute(t,n+"");else throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",n,":: Element ",e),new Error("Attribute value was not simple")},ws=(e,t,n)=>{st(e.dom,t,n)},ys=(e,t)=>{const n=e.dom;P(t,(e,t)=>{st(n,t,e)})},$=(e,t)=>{const n=e.dom.getAttribute(t);return n===null?void 0:n},N=(t,n)=>e.from($(t,n)),ct=(e,t)=>{e.dom.removeAttribute(t)},bs=e=>Gt(e.dom.attributes,(e,t)=>(e[t.name]=t.value,e),{}),dt=(e,t,n=Ai)=>e.exists(e=>n(e,t)),vs=e=>{const t=[],n=e=>{t.push(e)};for(let t=0;t<e.length;t++)e[t].each(n);return t},ht=(t,n,s)=>t.isSome()&&n.isSome()?e.some(s(t.getOrDie(),n.getOrDie())):e.none(),cs=e=>e.bind(Se),rs=(t,n)=>t?e.some(n):e.none(),os=(e,t)=>e.substring(t),ts=(e,t,n)=>t===""||e.length>=t.length&&e.substr(n,n+t.length)===t,es=(e,t)=>bt(e,t)?os(e,t.length):e,bt=(e,t)=>ts(e,t,0),Jn=e=>t=>t.replace(e,""),Zn=Jn(/^\s+|\s+$/g),_t=e=>e.length>0,Qn=e=>!_t(e),Ot=(t,n=10)=>{const s=parseInt(t,n);return isNaN(s)?e.none():e.some(s)},Xn=t=>{const n=parseFloat(t);return isNaN(n)?e.none():e.some(n)},je=e=>e.style!==void 0&&u(e.style.getPropertyValue),Yn=(e,t,n)=>{if(!ae(n))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",n,":: Element ",e),new Error("CSS value must be a string: "+n);je(e)&&e.style.setProperty(t,n)},Kn=(e,t)=>{je(e)&&e.style.removeProperty(t)},Un=(e,t,n)=>{const s=e.dom;Yn(s,t,n)},St=(e,t)=>{const n=e.dom,o=window.getComputedStyle(n),s=o.getPropertyValue(t);return s===""&&!Ue(e)?Mt(n,t):s},Mt=(e,t)=>je(e)?e.style.getPropertyValue(t):"",_=(t,n)=>{const s=t.dom,o=Mt(s,n);return e.from(o).filter(e=>e.length>0)},Vn=(e,t)=>{const n=e.dom;Kn(n,t),dt(N(e,"style").map(Zn),"")&&ct(e,"style")},me=(e,t,n=0)=>N(e,t).map(e=>parseInt(e,10)).getOr(n),Dt=(e,t)=>Nt(e,t,T),Nt=(e,t,n)=>M(D(e),e=>g(e,t)?n(e)?[e]:[]:Nt(e,t,n)),Bn=["tfoot","thead","tbody","colgroup"],In=e=>r(Bn,e),Hn=(e,t)=>({rows:e,columns:t}),Ht=(e,t,n)=>({element:e,rowspan:t,colspan:n}),Pn=(e,t,n,s,o,i)=>({element:e,rowspan:t,colspan:n,row:s,column:o,isLocked:i}),ce=(e,t,n)=>({element:e,cells:t,section:n}),Rn=(e,t,n,s)=>({startRow:e,startCol:t,finishRow:n,finishCol:s}),Nn=(e,t,n)=>({element:e,colspan:t,column:n}),Tn=(e,t)=>({element:e,columns:t}),Fn=(t,n,s=z)=>{if(s(n))return e.none();if(r(t,c(n)))return e.some(n);const o=e=>g(e,"table")||s(e);return w(n,t.join(","),o)},kn=(e,t)=>Fn(["td","th"],e,t),wn=e=>Dt(e,"th,td"),yn=e=>g(e,"colgroup")?De(e,"col"):M(Qt(e),e=>De(e,"col")),a=(e,t)=>Te(e,"table",t),Xt=e=>Dt(e,"tr"),Qt=e=>a(e).fold(n([]),e=>De(e,"colgroup")),bn=(e,t)=>s(e,e=>{if(c(e)==="colgroup"){const t=s(yn(e),e=>{const t=me(e,"span",1);return Ht(e,1,t)});return ce(e,t,"colgroup")}const n=s(wn(e),e=>{const t=me(e,"rowspan",1),n=me(e,"colspan",1);return Ht(e,t,n)});return ce(e,n,t(e))}),vn=e=>K(e).map(e=>{const t=c(e);return In(t)?t:"tbody"}).getOr("tbody"),gn=e=>{const t=Xt(e),n=Qt(e),s=[...n,...t];return bn(s,vn)},pn="data-snooker-locked-cols",ln=t=>N(t,pn).bind(t=>e.from(t.match(/\d+/g))).map(e=>To(e,T)),J=(e,t)=>e+","+t,rn=(t,n,s)=>e.from(t.access[J(n,s)]),io=(t,n,s)=>{const o=Bt(t,e=>s(n,e.element));return o.length>0?e.some(o[0]):e.none()},Bt=(e,t)=>{const n=M(e.all,e=>e.cells);return E(n,t)},cn=e=>{const t={};let n=0;return i(e.cells,e=>{const s=e.colspan;$t(s,o=>{const i=n+o;t[i]=Nn(e.element,s,i)}),n+=s}),t},nn=e=>{const n={},o=[],c=Fo(e).map(e=>e.element).bind(a),l=c.bind(ln).getOr({});let r=0,s=0,t=0;const{pass:d,fail:u}=Ho(e,e=>e.section==="colgroup");i(u,e=>{const a=[];i(e.cells,e=>{let o=0;for(;n[J(t,o)]!==void 0;)o++;const r=Ft(l,o.toString()),i=Pn(e.element,e.rowspan,e.colspan,t,o,r);for(let a=0;a<e.colspan;a++)for(let r=0;r<e.rowspan;r++){const l=t+r,c=o+a,d=J(l,c);n[d]=i,s=Math.max(s,c+1)}a.push(i)}),r++,o.push(ce(e.element,a,e.section)),t++});const{columns:h,colgroups:m}=Mo(d).map(e=>{const t=cn(e),n=Tn(e.element,Et(t));return{colgroups:[n],columns:t}}).getOrThunk(()=>({colgroups:[],columns:{}})),f=Hn(r,s);return{grid:f,access:n,all:o,columns:h,colgroups:m}},dn=e=>{const t=gn(e);return nn(t)},un=e=>M(e.all,e=>e.cells),hn=e=>Et(e.columns),mn=e=>x(e.columns).length>0,fn=(t,n)=>e.from(t.columns[n]),m={fromTable:dn,generate:nn,getAt:rn,findItem:io,filterItems:Bt,justCells:un,justColumns:hn,hasColumns:mn,getColumnAt:fn};ee=tinymce.util.Tools.resolve("tinymce.util.Tools");const H=(e,t,n)=>{const o=e.select("td,th",t);let s;for(let t=0;t<o.length;t++){const i=e.getStyle(o[t],n);if(ge(s)&&(s=i),s!==i)return""}return s},te=(e,t,n)=>{ee.each("left center right".split(" "),s=>{s!==n&&e.formatter.remove("align"+s,{},t)}),n&&e.formatter.apply("align"+n,{},t)},jn=(e,t,n)=>{ee.each("top middle bottom".split(" "),s=>{s!==n&&e.formatter.remove("valign"+s,{},t)}),n&&e.formatter.apply("valign"+n,{},t)},oe=(e,t,n)=>{e.dispatch("TableModified",{...n,table:t})},_n=(e,t)=>Xn(e).getOr(t),W=(e,t,n)=>_n(St(e,t),n),On=(e,t,n,s)=>{const o=W(e,`padding-${n}`,0),i=W(e,`padding-${s}`,0),a=W(e,`border-${n}-width`,0),r=W(e,`border-${s}-width`,0);return t-o-i-a-r},xn=(e,t)=>{const n=e.dom,s=n.getBoundingClientRect().width||n.offsetWidth;return t==="border-box"?s:On(e,s,"left","right")},Cn=e=>xn(e,"content-box"),En=Cn;Kt=tinymce.util.Tools.resolve("tinymce.Env");const An="tableprops tabledelete | tableinsertrowbefore tableinsertrowafter tabledeleterow | tableinsertcolbefore tableinsertcolafter tabledeletecol",Sn=$t(5,e=>{const t=`${e+1}px`;return{title:t,value:t}}),Mn=s(["Solid","Dotted","Dashed","Double","Groove","Ridge","Inset","Outset","None","Hidden"],e=>({title:e,value:e.toLowerCase()})),Ut="100%",Wt=e=>{var n;const s=e.dom,o=(n=s.getParent(e.selection.getStart(),s.isBlock))!==null&&n!==void 0?n:e.getBody();return En(t.fromDom(o))+"px"},zn=(e,t)=>jt(e)||!f(e)?t:yt(e)?{...t,width:Wt(e)}:{...t,width:Ut},Dn=(e,t)=>jt(e)||f(e)?t:yt(e)?{...t,width:Wt(e)}:{...t,width:Ut},o=e=>t=>t.options.get(e),Ln=e=>{const t=e.options.register;t("table_border_widths",{processor:"object[]",default:Sn}),t("table_border_styles",{processor:"object[]",default:Mn}),t("table_cell_advtab",{processor:"boolean",default:!0}),t("table_row_advtab",{processor:"boolean",default:!0}),t("table_advtab",{processor:"boolean",default:!0}),t("table_appearance_options",{processor:"boolean",default:!0}),t("table_grid",{processor:"boolean",default:!Kt.deviceType.isTouch()}),t("table_cell_class_list",{processor:"object[]",default:[]}),t("table_row_class_list",{processor:"object[]",default:[]}),t("table_class_list",{processor:"object[]",default:[]}),t("table_toolbar",{processor:"string",default:An}),t("table_background_color_map",{processor:"object[]",default:[]}),t("table_border_color_map",{processor:"object[]",default:[]})},Vt=o("table_sizing_mode"),It=o("table_border_widths"),le=o("table_border_styles"),de=o("table_cell_advtab"),he=o("table_row_advtab"),b=o("table_advtab"),$n=o("table_appearance_options"),Wn=o("table_grid"),f=o("table_style_by_css"),ve=o("table_cell_class_list"),qn=o("table_row_class_list"),be=o("table_class_list"),Gn=o("table_toolbar"),xt=o("table_background_color_map"),Ie=o("table_border_color_map"),yt=e=>Vt(e)==="fixed",jt=e=>Vt(e)==="responsive",vt=e=>{const t=e.options,n=t.get("table_default_styles");return t.isSet("table_default_styles")?n:zn(e,n)},gt=e=>{const t=e.options,n=t.get("table_default_attributes");return t.isSet("table_default_attributes")?n:Dn(e,n)},ns=e=>e.nodeName.toLowerCase(),ss=e=>t.fromDom(e.getBody()),A=e=>t=>h(t,ss(e)),is=e=>e?e.replace(/px$/,""):"",d=e=>/^\d+(\.\d+)?$/.test(e)?e+"px":e,xe=e=>t.fromDom(e.selection.getStart()),ls=e=>t.fromDom(e.selection.getEnd()),ds=(e,t)=>t.column>=e.startCol&&t.column+t.colspan-1<=e.finishCol&&t.row>=e.startRow&&t.row+t.rowspan-1<=e.finishRow,us=(t,n)=>{let s=!0;const o=l(ds,n);for(let e=n.startRow;e<=n.finishRow;e++)for(let i=n.startCol;i<=n.finishCol;i++)s=s&&m.getAt(t,e,i).exists(o);return s?e.some(n):e.none()},hs=(e,t)=>Rn(Math.min(e.row,t.row),Math.min(e.column,t.column),Math.max(e.row+e.rowspan-1,t.row+t.rowspan-1),Math.max(e.column+e.colspan-1,t.column+t.colspan-1)),ms=(e,t,n)=>{const s=m.findItem(e,t,h),o=m.findItem(e,n,h);return s.bind(e=>o.map(t=>hs(e,t)))},fs=(e,t,n)=>ms(e,t,n).bind(t=>us(e,t)),ps=(e,t,n)=>{const s=gs(e);return fs(s,t,n)},gs=m.fromTable,Ce=(e,t)=>{const n=K(e);n.each(n=>{n.dom.insertBefore(t.dom,e.dom)})},lt=(e,t)=>{const n=Ve(e);n.fold(()=>{const n=K(e);n.each(e=>{L(e,t)})},e=>{Ce(e,t)})},js=(e,t)=>{const n=Qs(e);n.fold(()=>{L(e,t)},n=>{e.dom.insertBefore(t.dom,n.dom)})},L=(e,t)=>{e.dom.appendChild(t.dom)},_s=(e,t)=>{Ce(e,t),L(t,e)},ot=(e,t)=>{i(t,(n,s)=>{const o=s===0?e:t[s-1];lt(o,n)})},Os=(e,t)=>{i(t,t=>{L(e,t)})},et=e=>{const t=e.dom;t.parentNode!==null&&t.parentNode.removeChild(t)},Cs=e=>{const t=D(e);t.length>0&&ot(e,t),et(e)},Es=(t,n)=>{const o=e=>{if(!t(e))throw new Error("Can only get "+n+" value of a "+n+" node");return s(e).getOr("")},s=n=>t(n)?e.from(n.dom.nodeValue):e.none(),i=(e,s)=>{if(!t(e))throw new Error("Can only set raw "+n+" value of a "+n+" node");e.dom.nodeValue=s};return{get:o,getOption:s,set:i}},Ze=Es(_e,"text"),As=e=>Ze.get(e),Ss=(e,t)=>Ze.set(e,t);Ke=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],We=()=>{const s=e=>t.fromDom(e.dom.cloneNode(!1)),o=e=>nt(e).dom,i=e=>!!C(e)&&(c(e)==="body"||r(Ke,c(e))),a=e=>!!C(e)&&r(["br","img","hr","input"],c(e)),l=e=>C(e)&&$(e,"contenteditable")==="false",d=(e,t)=>e.dom.compareDocumentPosition(t.dom),u=(e,t)=>{const n=bs(e);ys(t,n)},m=e=>{const t=c(e);return r(["script","noscript","iframe","noframes","noembed","title","style","textarea","xmp"],t)},f=t=>C(t)?N(t,"lang"):e.none();return{up:n({selector:w,closest:Te,predicate:Qe,all:to}),down:n({selector:Ge,predicate:qe}),styles:n({get:St,getRaw:_,set:Un,remove:Vn}),attrs:n({get:$,set:ws,remove:ct,copyTo:u}),insert:n({before:Ce,after:lt,afterAll:ot,append:L,appendAll:Os,prepend:js,wrap:_s}),remove:n({unwrap:Cs,remove:et}),create:n({nu:t.fromTag,clone:s,text:t.fromText}),query:n({comparePosition:d,prevSibling:eo,nextSibling:Ve}),property:n({children:D,name:c,parent:K,document:o,isText:_e,isComment:bo,isElement:C,isSpecial:m,getLanguage:f,getText:As,setText:Ss,isBoundary:i,isEmptyTag:a,isNonEditable:l}),eq:h,is:oo}};const Ts=(e,t,n,s)=>{const o=n[0],i=n.slice(1);return s(e,t,o,i)},zs=(t,n,s)=>s.length>0?Ts(t,n,s,Ds):e.none(),Ds=(e,t,n,s)=>{const o=t(e,n);return Ro(s,(n,s)=>{const o=t(e,s);return Ns(e,n,o)},o)},Ns=(e,t,n)=>t.bind(t=>n.filter(l(e.eq,t))),Ls=zs,Rs=We(),Ps=(e,t)=>Ls(Rs,(t,n)=>e(n),t),Hs=e=>w(e,"table"),Is=(t,n)=>{const s=Ge(t,n);return s.length>0?e.some(s):e.none()},Bs=(e,t,n)=>tt(e,t).bind(t=>tt(e,n).bind(e=>Ps(Hs,[t,e]).map(n=>({first:t,last:e,table:n})))),Vs=(e,t)=>Is(e,t),$s=(t,n,s)=>Bs(t,n,s).bind(n=>{const s=e=>h(t,e),o="thead,tfoot,tbody,table",i=w(n.first,o,s),a=w(n.last,o,s);return i.bind(t=>a.bind(s=>h(t,s)?ps(n.table,n.first,n.last):e.none()))}),Ne=e=>s(e,t.fromDom),Le="data-mce-selected",Ks="td["+Le+"],th["+Le+"]",Re="data-mce-first-selected",Ys="td["+Re+"],th["+Re+"]",Pe="data-mce-last-selected",Xs="td["+Pe+"],th["+Pe+"]",Q={selected:Le,selectedSelector:Ks,firstSelected:Re,firstSelectedSelector:Ys,lastSelected:Pe,lastSelectedSelector:Xs},Zs=e=>a(e).bind(e=>Vs(e,Q.firstSelectedSelector)).fold(n(e),e=>e[0]),wt=e=>(t,n)=>{const s=c(t),o=s==="col"||s==="colgroup"?Zs(t):t;return Te(o,e,n)},$e=wt("th,td,caption"),Ye=wt("th,td"),Fe=e=>Ne(e.model.table.getSelectedCells()),so=(e,t)=>{const n=Ye(e),s=n.bind(e=>a(e)).map(e=>Xt(e));return ht(n,s,(e,n)=>E(n,n=>X(Ne(n.dom.cells),n=>$(n,t)==="1"||h(n,e)))).getOr([])},Me=[{text:"None",value:""},{text:"Top",value:"top"},{text:"Middle",value:"middle"},{text:"Bottom",value:"bottom"}],an=e=>({value:e}),ao=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,ro=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,co=e=>ao.test(e)||ro.test(e),lo=e=>es(e,"#").toUpperCase(),uo=t=>co(t)?e.some({value:lo(t)}):e.none(),Ae=e=>{const t=e.toString(16);return(t.length===1?"0"+t:t).toUpperCase()},ke=e=>{const t=Ae(e.red)+Ae(e.green)+Ae(e.blue);return an(t)},fo=/^\s*rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)\s*$/i,po=/^\s*rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d?(?:\.\d+)?)\s*\)\s*$/i,Oe=(e,t,n,s)=>({red:e,green:t,blue:n,alpha:s}),pt=(e,t,n,s)=>{const o=parseInt(e,10),i=parseInt(t,10),a=parseInt(n,10),r=parseFloat(s);return Oe(o,i,a,r)},Ct=t=>{if(t==="transparent")return e.some(Oe(0,0,0,0));const s=fo.exec(t);if(s!==null)return e.some(pt(s[1],s[2],s[3],"1"));const n=po.exec(t);return n!==null?e.some(pt(n[1],n[2],n[3],n[4])):e.none()},jo=e=>uo(e).orThunk(()=>Ct(e).map(ke)).getOrThunk(()=>{const t=document.createElement("canvas");t.height=1,t.width=1;const n=t.getContext("2d");n.clearRect(0,0,t.width,t.height),n.fillStyle="#FFFFFF",n.fillStyle=e,n.fillRect(0,0,1,1);const s=n.getImageData(0,0,1,1).data,o=s[0],i=s[1],a=s[2],r=s[3];return ke(Oe(o,i,a,r))}),yo=e=>Ct(e).map(ke).map(e=>"#"+e.value).getOr(e),pe=e=>{let t=e;const n=()=>t,s=e=>{t=e};return{get:n,set:s}},wo=t=>{const n=pe(e.none()),s=()=>n.get().each(t),o=()=>{s(),n.set(e.none())},i=()=>n.get().isSome(),a=()=>n.get(),r=t=>{s(),n.set(e.some(t))};return{clear:o,isSet:i,get:a,set:r}},Oo=()=>wo(e=>e.unbind()),xo=(e,t,n)=>s=>{const o=Oo(),i=Qn(n),a=()=>{const a=Fe(e),r=s=>e.formatter.match(t,{value:n},s.dom,i);i?(s.setActive(!X(a,r)),o.set(e.formatter.formatChanged(t,e=>s.setActive(!e),!0))):(s.setActive(G(a,r)),o.set(e.formatter.formatChanged(t,s.setActive,!1,{value:n})))};return e.initialized?a():e.on("init",a),o.clear},ue=e=>Ft(e,"menu"),k=e=>s(e,e=>{const t=e.text||e.title||"";return ue(e)?{text:t,items:k(e.menu)}:{text:t,value:e.value}}),j=(e,t,n,o)=>s(t,t=>{const s=t.text||t.title;return ue(t)?{type:"nestedmenuitem",text:s,getSubmenuItems:()=>j(e,t.menu,n,o)}:{text:s,type:"togglemenuitem",onAction:()=>o(t.value),onSetup:xo(e,n,t.value)}}),O=(e,t)=>n=>{e.execCommand("mceTableApplyCellStyle",!1,{[t]:n})},F=e=>M(e,e=>ue(e)?[{...e,menu:F(e.menu)}]:_t(e.value)?[e]:[]),S=(e,t,n,s)=>o=>o(j(e,t,n,s)),Y=(e,t,n)=>{const o=s(t,e=>({text:e.title,value:"#"+jo(e.value).value,type:"choiceitem"}));return[{type:"fancymenuitem",fancytype:"colorswatch",initData:{colors:o.length>0?o:void 0,allowCustomColors:!1},onAction:t=>{const s=t.value==="remove"?"":t.value;e.execCommand("mceTableApplyCellStyle",!1,{[n]:s})}}]},en=e=>()=>{const t=e.queryCommandValue("mceTableRowType"),n=t==="header"?"body":"header";e.execCommand("mceTableRowType",!1,{type:n})},ut=e=>()=>{const t=e.queryCommandValue("mceTableColType"),n=t==="th"?"td":"th";e.execCommand("mceTableColType",!1,{type:n})},Do=t=>{const n=k(ve(t));return n.length>0?e.some({name:"class",type:"listbox",label:"Class",items:n}):e.none()},No=[{name:"width",type:"input",label:"Width"},{name:"height",type:"input",label:"Height"},{name:"celltype",type:"listbox",label:"Cell type",items:[{text:"Cell",value:"td"},{text:"Header cell",value:"th"}]},{name:"scope",type:"listbox",label:"Scope",items:[{text:"None",value:""},{text:"Row",value:"row"},{text:"Column",value:"col"},{text:"Row group",value:"rowgroup"},{text:"Column group",value:"colgroup"}]},{name:"halign",type:"listbox",label:"Horizontal align",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{name:"valign",type:"listbox",label:"Vertical align",items:Me}],sn=e=>No.concat(Do(e).toArray()),se=(e,t)=>{const s=[{text:"Select...",value:""}],n=[{name:"borderstyle",type:"listbox",label:"Border style",items:s.concat(k(le(e)))},{name:"bordercolor",type:"colorinput",label:"Border color"},{name:"backgroundcolor",type:"colorinput",label:"Background color"}],o={name:"borderwidth",type:"input",label:"Border width"},i=t==="cell"?[o].concat(n):n;return{title:"Advanced",name:"advanced",items:i}},Po=(e,t)=>{const n=e.dom,s=(e,s)=>{n.setAttrib(t,e,s)},o=(e,s)=>{n.setStyle(t,e,s)},i=(n,s)=>{s===""?e.formatter.remove(n,{value:null},t,!0):e.formatter.apply(n,{value:s},t)};return{setAttrib:s,setStyle:o,setFormat:i}},ie={normal:Po},Io=mt("th"),Bo=(e,t)=>e&&t?"sectionCells":e?"section":"cells",Vo=e=>{const t=e.section==="thead",n=dt($o(e.cells),"th");return e.section==="tfoot"?{type:"footer"}:t||n?{type:"header",subType:Bo(t,n)}:{type:"body"}},$o=t=>{const n=E(t,e=>Io(e.element));return n.length===0?e.some("td"):n.length===t.length?e.some("th"):e.none()},Wo=t=>{const n=s(t,e=>Vo(e).type),o=r(n,"header"),i=r(n,"footer");if(!o&&!i)return e.some("body");const a=r(n,"body");return o&&!a&&!i?e.some("header"):!o&&!a&&i?e.some("footer"):e.none()},Uo=e=>{let t=!1,n;return(...s)=>(t||(t=!0,n=e.apply(null,s)),n)},qt=(e,t)=>Yt(e.all,e=>Z(e.cells,e=>h(t,e.element))),qo=(e,t,n)=>{const i=s(t.selection,t=>kn(t).bind(t=>qt(e,t)).filter(n)),o=vs(i);return rs(o.length>0,o)},Yo=(e,t)=>t.mergable,Go=(e,t)=>t.unmergable,Pt=(e,t)=>qo(e,t,T),Qo=(e,t)=>qt(e,t).exists(e=>!e.isLocked),Rt=(e,t)=>G(t,t=>Qo(e,t)),Jo=(e,t)=>Yo(e,t).filter(t=>Rt(e,t.cells)),ei=(e,t)=>Go(e,t).filter(t=>Rt(e,t)),ti=e=>{if(!re(e))throw new Error("cases must be an array");if(e.length===0)throw new Error("there must be at least one case");const t=[],n={};return i(e,(s,o)=>{const c=x(s);if(c.length!==1)throw new Error("one and only one name per case");const i=c[0],a=s[i];if(n[i]!==void 0)throw new Error("duplicate key detected:"+i);if(i==="cata")throw new Error("cannot have a case named cata (sorry)");if(!re(a))throw new Error("case arguments must be an array");t.push(i),n[i]=(...n)=>{const s=n.length;if(s!==a.length)throw new Error("Wrong number of arguments to case "+i+". Expected "+a.length+" ("+a+"), got "+s);const c=e=>{const s=x(e);if(t.length!==s.length)throw new Error("Wrong number of arguments to match. Expected: "+t.join(",")+`
Actual: `+s.join(","));const o=G(t,e=>r(s,e));if(!o)throw new Error("Not all branches were specified when using match. Specified: "+s.join(", ")+`
Required: `+t.join(", "));return e[i].apply(null,n)};return{fold:(...t)=>{if(t.length!==e.length)throw new Error("Wrong number of arguments to fold. Expected "+e.length+", got "+t.length);const s=t[o];return s.apply(null,n)},match:c,log:e=>{console.log(e,{constructors:t,constructor:i,params:n})}}}}),n},ni={generate:ti},si=ni.generate([{none:[]},{only:["index"]},{left:["index","next"]},{middle:["prev","index","next"]},{right:["prev","index"]}]);({...si});const oi=(e,t)=>{const n=m.fromTable(e),s=Pt(n,t);return s.bind(e=>{const t=e[e.length-1],s=e[0].row,o=t.row+t.rowspan,i=n.all.slice(s,o);return Wo(i)}).getOr("")},ii=oi,B=e=>bt(e,"rgb")?yo(e):e,ye=e=>{const n=t.fromDom(e);return{borderwidth:_(n,"border-width").getOr(""),borderstyle:_(n,"border-style").getOr(""),bordercolor:_(n,"border-color").map(B).getOr(""),backgroundcolor:_(n,"background-color").map(B).getOr("")}},He=e=>{const t=e[0],n=e.slice(1);return i(n,e=>{i(x(t),n=>{P(e,(e,s)=>{const o=t[n];o!==""&&n===s&&o!==e&&(t[n]="")})})}),t},it=(e,t,n,s)=>Z(e,e=>!ge(n.formatter.matchNode(s,t+e))).getOr(""),ze=l(it,["left","center","right"],"align"),ui=l(it,["top","middle","bottom"],"valign"),hi=(e,t)=>{const n=vt(e),s=gt(e),o=()=>({borderstyle:v(n,"border-style").getOr(""),bordercolor:B(v(n,"border-color").getOr("")),backgroundcolor:B(v(n,"background-color").getOr(""))}),i={height:"",width:"100%",cellspacing:"",cellpadding:"",caption:!1,class:"",align:"",border:""},a=()=>{const t=n["border-width"];return f(e)&&t?{border:t}:v(s,"border").fold(()=>({}),e=>({border:e}))},r=t?o():{},c=()=>{const e=v(n,"border-spacing").or(v(s,"cellspacing")).fold(()=>({}),e=>({cellspacing:e})),t=v(n,"border-padding").or(v(s,"cellpadding")).fold(()=>({}),e=>({cellpadding:e}));return{...e,...t}},l={...i,...n,...s,...r,...a(),...c()};return l},mi=e=>a(t.fromDom(e)).map(t=>{const n={selection:Ne(e.cells)};return ii(t,n)}).getOr(""),fi=(e,n,s)=>{const r=(n,s)=>{const o=_(t.fromDom(s),"border-width");return f(e)&&o.isSome()?o.getOr(""):n.getAttrib(s,"border")||H(e.dom,s,"border-width")||H(e.dom,s,"border")||""},o=e.dom,i=f(e)?o.getStyle(n,"border-spacing")||o.getAttrib(n,"cellspacing"):o.getAttrib(n,"cellspacing")||o.getStyle(n,"border-spacing"),a=f(e)?H(o,n,"padding")||o.getAttrib(n,"cellpadding"):o.getAttrib(n,"cellpadding")||H(o,n,"padding");return{width:o.getStyle(n,"width")||o.getAttrib(n,"width"),height:o.getStyle(n,"height")||o.getAttrib(n,"height"),cellspacing:i??"",cellpadding:a??"",border:r(o,n),caption:!!o.select("caption",n)[0],class:o.getAttrib(n,"class",""),align:ze(e,n),...s?ye(n):{}}},pi=(e,t,n)=>{const s=e.dom;return{height:s.getStyle(t,"height")||s.getAttrib(t,"height"),class:s.getAttrib(t,"class",""),type:mi(t),align:ze(e,t),...n?ye(t):{}}},gi=(e,t,n,s)=>{const o=e.dom,a=s.getOr(t),i=(e,t)=>o.getStyle(e,t)||o.getAttrib(e,t);return{width:i(a,"width"),height:i(t,"height"),scope:o.getAttrib(t,"scope"),celltype:ns(t),class:o.getAttrib(t,"class",""),halign:ze(e,t),valign:ui(e,t),...n?ye(t):{}}},Be=(e,t)=>{const n=m.fromTable(e),o=m.justCells(n),i=E(o,e=>X(t,t=>h(e.element,t)));return s(i,e=>({element:e.element.dom,column:m.getColumnAt(n,e.column).map(e=>e.element.dom)}))},bi=(e,t,n,s)=>{s("scope")&&e.setAttrib("scope",n.scope),s("class")&&e.setAttrib("class",n.class),s("height")&&e.setStyle("height",d(n.height)),s("width")&&t.setStyle("width",d(n.width))},ji=(e,t,n)=>{n("backgroundcolor")&&e.setFormat("tablecellbackgroundcolor",t.backgroundcolor),n("bordercolor")&&e.setFormat("tablecellbordercolor",t.bordercolor),n("borderstyle")&&e.setFormat("tablecellborderstyle",t.borderstyle),n("borderwidth")&&e.setFormat("tablecellborderwidth",d(t.borderwidth))},yi=(e,t,n,s)=>{const o=t.length===1;i(t,t=>{const i=t.element,r=o?T:s,a=ie.normal(e,i),c=t.column.map(t=>ie.normal(e,t)).getOr(a);bi(a,c,n,r),de(e)&&ji(a,n,r),s("halign")&&te(e,i,n.halign),s("valign")&&jn(e,i,n.valign)})},_i=(e,t)=>{e.execCommand("mceTableCellType",!1,{type:t.celltype,no_events:!0})},wi=(e,t,n,s)=>{const o=q(s,(e,t)=>n[t]!==e);y(o)>0&&t.length>=1&&a(t[0]).each(n=>{const r=Be(n,t),i=y(q(o,(e,t)=>t!=="scope"&&t!=="celltype"))>0,a=p(o,"celltype");(i||p(o,"scope"))&&yi(e,r,s,l(p,o)),a&&_i(e,s),oe(e,n.dom,{structure:a,style:i})})},Oi=(e,t,n,s)=>{const o=s.getData();s.close(),e.undoManager.transact(()=>{wi(e,t,n,o),e.focus()})},xi=(e,t)=>{const n=a(t[0]).map(n=>s(Be(n,t),t=>gi(e,t.element,de(e),t.column)));return He(n.getOrDie())},Ci=e=>{const t=Fe(e);if(t.length===0)return;const n=xi(e,t),s={type:"tabpanel",tabs:[{title:"General",name:"general",items:sn(e)},se(e,"cell")]},o={type:"panel",items:[{type:"grid",columns:2,items:sn(e)}]};e.windowManager.open({title:"Cell Properties",size:"normal",body:de(e)?s:o,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:n,onSubmit:l(Oi,e,t,n)})},Ei=t=>{const n=k(qn(t));return n.length>0?e.some({name:"class",type:"listbox",label:"Class",items:n}):e.none()},ki=[{type:"listbox",name:"type",label:"Row type",items:[{text:"Header",value:"header"},{text:"Body",value:"body"},{text:"Footer",value:"footer"}]},{type:"listbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"Height",name:"height",type:"input"}],Je=e=>ki.concat(Ei(e).toArray()),Si=(e,t,n)=>{n("class")&&e.setAttrib("class",t.class),n("height")&&e.setStyle("height",d(t.height))},Mi=(e,t,n)=>{n("backgroundcolor")&&e.setStyle("background-color",t.backgroundcolor),n("bordercolor")&&e.setStyle("border-color",t.bordercolor),n("borderstyle")&&e.setStyle("border-style",t.borderstyle)},Fi=(e,t,n,s)=>{const a=t.length===1,o=a?T:s;i(t,t=>{const i=ie.normal(e,t);Si(i,n,o),he(e)&&Mi(i,n,o),s("align")&&te(e,t,n.align)})},Ti=(e,t)=>{e.execCommand("mceTableRowType",!1,{type:t.type,no_events:!0})},zi=(e,n,s,o)=>{const i=q(o,(e,t)=>s[t]!==e);if(y(i)>0){const s=p(i,"type"),r=!s||y(i)>1;r&&Fi(e,n,o,l(p,i)),s&&Ti(e,o),a(t.fromDom(n[0])).each(t=>oe(e,t.dom,{structure:s,style:r}))}},Di=(e,t,n,s)=>{const o=s.getData();s.close(),e.undoManager.transact(()=>{zi(e,t,n,o),e.focus()})},Ni=e=>{const t=so(xe(e),Q.selected);if(t.length===0)return;const o=s(t,t=>pi(e,t.dom,he(e))),n=He(o),i={type:"tabpanel",tabs:[{title:"General",name:"general",items:Je(e)},se(e,"row")]},a={type:"panel",items:[{type:"grid",columns:2,items:Je(e)}]};e.windowManager.open({title:"Row Properties",size:"normal",body:he(e)?i:a,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:n,onSubmit:l(Di,e,s(t,e=>e.dom),n)})},Li=(e,t,n)=>{const s=n?[{type:"input",name:"cols",label:"Cols",inputMode:"numeric"},{type:"input",name:"rows",label:"Rows",inputMode:"numeric"}]:[],o=[{type:"input",name:"width",label:"Width"},{type:"input",name:"height",label:"Height"}],i=$n(e)?[{type:"input",name:"cellspacing",label:"Cell spacing",inputMode:"numeric"},{type:"input",name:"cellpadding",label:"Cell padding",inputMode:"numeric"},{type:"input",name:"border",label:"Border width"},{type:"label",label:"Caption",items:[{type:"checkbox",name:"caption",label:"Show caption"}]}]:[],a=[{type:"listbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]}],r=t.length>0?[{type:"listbox",name:"class",label:"Class",items:t}]:[];return s.concat(o).concat(i).concat(a).concat(r)},Ee=(e,t,n,s)=>{if(t.tagName==="TD"||t.tagName==="TH")ae(n)&&we(s)?e.setStyle(t,n,s):e.setStyles(t,n);else if(t.children)for(let o=0;o<t.children.length;o++)Ee(e,t.children[o],n,s)},Pi=(e,t,n)=>{const i=e.dom,o={},s={};if(ge(n.class)||(o.class=n.class),s.height=d(n.height),f(e)?s.width=d(n.width):i.getAttrib(t,"width")&&(o.width=is(n.width)),f(e)?(s["border-width"]=d(n.border),s["border-spacing"]=d(n.cellspacing)):(o.border=n.border,o.cellpadding=n.cellpadding,o.cellspacing=n.cellspacing),f(e)&&t.children)for(let s=0;s<t.children.length;s++)Ee(i,t.children[s],{"border-width":d(n.border),padding:d(n.cellpadding)}),b(e)&&Ee(i,t.children[s],{"border-color":n.bordercolor});if(b(e)){const e=n;s["background-color"]=e.backgroundcolor,s["border-color"]=e.bordercolor,s["border-style"]=e.borderstyle}o.style=i.serializeStyle({...vt(e),...s}),i.setAttribs(t,{...gt(e),...o})},Hi=(e,t,n,s)=>{const r=e.dom,o=s.getData(),i=q(o,(e,t)=>n[t]!==e);s.close(),o.class===""&&delete o.class,e.undoManager.transact(()=>{if(!t){const n=Ot(o.cols).getOr(1),s=Ot(o.rows).getOr(1);e.execCommand("mceInsertTable",!1,{rows:s,columns:n}),t=Ye(xe(e),A(e)).bind(t=>a(t,A(e))).map(e=>e.dom).getOrDie()}if(y(i)>0){Pi(e,t,o);const n=r.select("caption",t)[0];(n&&!o.caption||!n&&o.caption)&&e.execCommand("mceTableToggleCaption"),te(e,t,o.align)}if(e.focus(),e.addVisual(),y(i)>0){const n=p(i,"caption"),s=!n||y(i)>1;oe(e,t,{structure:n,style:s})}})},rt=(e,t)=>{const a=e.dom;let s,n=hi(e,b(e));t?(n.cols="1",n.rows="1",b(e)&&(n.borderstyle="",n.bordercolor="",n.backgroundcolor="")):(s=a.getParent(e.selection.getStart(),"table",e.getBody()),s?n=fi(e,s,b(e)):b(e)&&(n.borderstyle="",n.bordercolor="",n.backgroundcolor=""));const o=k(be(e));o.length>0&&n.class&&(n.class=n.class.replace(/\s*mce-item-table\s*/g,""));const i={type:"grid",columns:2,items:Li(e,o,t)},r=()=>({type:"panel",items:[i]}),c=()=>({type:"tabpanel",tabs:[{title:"General",name:"general",items:[i]},se(e,"table")]}),d=b(e)?c():r();e.windowManager.open({title:"Table Properties",size:"normal",body:d,onSubmit:l(Hi,e,s,n),buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:n})},Bi=e=>{P({mceTableProps:l(rt,e,!1),mceTableRowProps:l(Ni,e),mceTableCellProps:l(Ci,e)},(t,n)=>e.addCommand(n,()=>t())),e.addCommand("mceInsertTableDialog",t=>{rt(e,!0)})},Vi=(e,t)=>xs(e,t).isSome(),$i=Se,Wi=t=>{const n=(e,t)=>N(e,t).exists(e=>parseInt(e,10)>1),s=e=>n(e,"rowspan")||n(e,"colspan");return t.length>0&&G(t,s)?e.some(t):e.none()},Ui=(t,n,s)=>n.length<=1?e.none():$s(t,s.firstSelectedSelector,s.lastSelectedSelector).map(e=>({bounds:e,cells:n})),Ki=t=>({element:t,mergable:e.none(),unmergable:e.none(),selection:[t]}),qi=(e,t,n)=>({element:n,mergable:Ui(t,e,Q),unmergable:Wi(e),selection:$i(e)}),Yi=t=>{const r=pe(e.none()),o=pe([]);let c=e.none();const s=mt("caption"),l=e=>c.forall(t=>!t[e]),M=()=>$e(xe(t),A(t)),v=()=>$e(ls(t),A(t)),j=()=>M().bind(n=>cs(ht(a(n),v().bind(a),(o,i)=>h(o,i)?s(n)?e.some(Ki(n)):e.some(qi(Fe(t),o,n)):e.none()))),x=e=>{const t=a(e.element);return t.map(t=>{const n=m.fromTable(t),s=Pt(n,e).getOr([]),o=Gt(s,(e,t)=>(t.isLocked&&(e.onAny=!0,t.column===0?e.onFirst=!0:t.column+t.colspan>=n.grid.columns&&(e.onLast=!0)),e),{onAny:!1,onFirst:!1,onLast:!1});return{mergeable:Jo(n,e).isSome(),unmergeable:ei(n,e).isSome(),locked:o}})},p=()=>{r.set(Uo(j)()),c=r.get().bind(x),i(o.get(),vi)},g=e=>(e(),o.set(o.get().concat([e])),()=>{o.set(E(o.get(),t=>t!==e))}),n=(e,t)=>g(()=>r.get().fold(()=>{e.setEnabled(!1)},n=>{e.setEnabled(!t(n))})),f=(e,t,n)=>g(()=>r.get().fold(()=>{e.setEnabled(!1),e.setActive(!1)},s=>{e.setEnabled(!t(s)),e.setActive(n(s))})),u=e=>c.exists(t=>t.locked[e]),y=e=>n(e,e=>!1),_=e=>n(e,e=>s(e.element)),w=e=>t=>n(t,t=>s(t.element)||u(e)),O=e=>t=>n(t,t=>s(t.element)||e().isNone()),b=(e,t)=>o=>n(o,n=>s(n.element)||e().isNone()||u(t)),C=e=>n(e,e=>l("mergeable")),k=e=>n(e,e=>l("unmergeable")),S=e=>f(e,z,e=>{const n=a(e.element,A(t));return n.exists(e=>Vi(e,"caption"))}),d=(e,n)=>o=>f(o,e=>s(e.element),()=>t.queryCommandValue(e)===n),F=d("mceTableRowType","header"),T=d("mceTableColType","th");return t.on("NodeChange ExecCommand TableSelectorChange",p),{onSetupTable:y,onSetupCellOrRow:_,onSetupColumn:w,onSetupPasteable:O,onSetupPasteableColumn:b,onSetupMergeable:C,onSetupUnmergeable:k,resetTargets:p,onSetupTableWithCaption:S,onSetupTableRowHeaders:F,onSetupTableColumnHeaders:T,targets:r.get}};ft=tinymce.util.Tools.resolve("tinymce.FakeClipboard");const At="x-tinymce/dom-table-",Qi=At+"rows",Zi=At+"columns",Tt=t=>{var n;const s=(n=ft.read())!==null&&n!==void 0?n:[];return Yt(s,n=>e.from(n.getType(t)))},I=()=>Tt(Qi),V=()=>Tt(Zi),na=(e,t)=>{e.ui.registry.addMenuButton("table",{tooltip:"Table",icon:"table",fetch:e=>e("inserttable | cell row column | advtablesort | tableprops deletetable")});const o=t=>()=>e.execCommand(t),n=(t,n)=>{e.queryCommandSupported(n.command)&&e.ui.registry.addButton(t,{...n,onAction:u(n.onAction)?n.onAction:o(n.command)})},s=(t,n)=>{e.queryCommandSupported(n.command)&&e.ui.registry.addToggleButton(t,{...n,onAction:u(n.onAction)?n.onAction:o(n.command)})};n("tableprops",{tooltip:"Table properties",command:"mceTableProps",icon:"table",onSetup:t.onSetupTable}),n("tabledelete",{tooltip:"Delete table",command:"mceTableDelete",icon:"table-delete-table",onSetup:t.onSetupTable}),n("tablecellprops",{tooltip:"Cell properties",command:"mceTableCellProps",icon:"table-cell-properties",onSetup:t.onSetupCellOrRow}),n("tablemergecells",{tooltip:"Merge cells",command:"mceTableMergeCells",icon:"table-merge-cells",onSetup:t.onSetupMergeable}),n("tablesplitcells",{tooltip:"Split cell",command:"mceTableSplitCells",icon:"table-split-cells",onSetup:t.onSetupUnmergeable}),n("tableinsertrowbefore",{tooltip:"Insert row before",command:"mceTableInsertRowBefore",icon:"table-insert-row-above",onSetup:t.onSetupCellOrRow}),n("tableinsertrowafter",{tooltip:"Insert row after",command:"mceTableInsertRowAfter",icon:"table-insert-row-after",onSetup:t.onSetupCellOrRow}),n("tabledeleterow",{tooltip:"Delete row",command:"mceTableDeleteRow",icon:"table-delete-row",onSetup:t.onSetupCellOrRow}),n("tablerowprops",{tooltip:"Row properties",command:"mceTableRowProps",icon:"table-row-properties",onSetup:t.onSetupCellOrRow}),n("tableinsertcolbefore",{tooltip:"Insert column before",command:"mceTableInsertColBefore",icon:"table-insert-column-before",onSetup:t.onSetupColumn("onFirst")}),n("tableinsertcolafter",{tooltip:"Insert column after",command:"mceTableInsertColAfter",icon:"table-insert-column-after",onSetup:t.onSetupColumn("onLast")}),n("tabledeletecol",{tooltip:"Delete column",command:"mceTableDeleteCol",icon:"table-delete-column",onSetup:t.onSetupColumn("onAny")}),n("tablecutrow",{tooltip:"Cut row",command:"mceTableCutRow",icon:"cut-row",onSetup:t.onSetupCellOrRow}),n("tablecopyrow",{tooltip:"Copy row",command:"mceTableCopyRow",icon:"duplicate-row",onSetup:t.onSetupCellOrRow}),n("tablepasterowbefore",{tooltip:"Paste row before",command:"mceTablePasteRowBefore",icon:"paste-row-before",onSetup:t.onSetupPasteable(I)}),n("tablepasterowafter",{tooltip:"Paste row after",command:"mceTablePasteRowAfter",icon:"paste-row-after",onSetup:t.onSetupPasteable(I)}),n("tablecutcol",{tooltip:"Cut column",command:"mceTableCutCol",icon:"cut-column",onSetup:t.onSetupColumn("onAny")}),n("tablecopycol",{tooltip:"Copy column",command:"mceTableCopyCol",icon:"duplicate-column",onSetup:t.onSetupColumn("onAny")}),n("tablepastecolbefore",{tooltip:"Paste column before",command:"mceTablePasteColBefore",icon:"paste-column-before",onSetup:t.onSetupPasteableColumn(V,"onFirst")}),n("tablepastecolafter",{tooltip:"Paste column after",command:"mceTablePasteColAfter",icon:"paste-column-after",onSetup:t.onSetupPasteableColumn(V,"onLast")}),n("tableinsertdialog",{tooltip:"Insert table",command:"mceInsertTableDialog",icon:"table"});const i=F(be(e));i.length!==0&&e.queryCommandSupported("mceTableToggleClass")&&e.ui.registry.addMenuButton("tableclass",{icon:"table-classes",tooltip:"Table styles",fetch:S(e,i,"tableclass",t=>e.execCommand("mceTableToggleClass",!1,t)),onSetup:t.onSetupTable});const a=F(ve(e));a.length!==0&&e.queryCommandSupported("mceTableCellToggleClass")&&e.ui.registry.addMenuButton("tablecellclass",{icon:"table-cell-classes",tooltip:"Cell styles",fetch:S(e,a,"tablecellclass",t=>e.execCommand("mceTableCellToggleClass",!1,t)),onSetup:t.onSetupCellOrRow}),e.queryCommandSupported("mceTableApplyCellStyle")&&(e.ui.registry.addMenuButton("tablecellvalign",{icon:"vertical-align",tooltip:"Vertical align",fetch:S(e,Me,"tablecellverticalalign",O(e,"vertical-align")),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuButton("tablecellborderwidth",{icon:"border-width",tooltip:"Border width",fetch:S(e,It(e),"tablecellborderwidth",O(e,"border-width")),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuButton("tablecellborderstyle",{icon:"border-style",tooltip:"Border style",fetch:S(e,le(e),"tablecellborderstyle",O(e,"border-style")),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuButton("tablecellbackgroundcolor",{icon:"cell-background-color",tooltip:"Background color",fetch:t=>t(Y(e,xt(e),"background-color")),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuButton("tablecellbordercolor",{icon:"cell-border-color",tooltip:"Border color",fetch:t=>t(Y(e,Ie(e),"border-color")),onSetup:t.onSetupCellOrRow})),s("tablecaption",{tooltip:"Table caption",icon:"table-caption",command:"mceTableToggleCaption",onSetup:t.onSetupTableWithCaption}),s("tablerowheader",{tooltip:"Row header",icon:"table-top-header",command:"mceTableRowType",onAction:en(e),onSetup:t.onSetupTableRowHeaders}),s("tablecolheader",{tooltip:"Column header",icon:"table-left-header",command:"mceTableColType",onAction:ut(e),onSetup:t.onSetupTableColumnHeaders})},sa=e=>{const n=t=>e.dom.is(t,"table")&&e.getBody().contains(t),t=Gn(e);t.length>0&&e.ui.registry.addContextToolbar("table",{predicate:n,items:t,scope:"node",position:"node"})},oa=(e,t)=>{const o=t=>()=>e.execCommand(t),s=(t,n)=>!!e.queryCommandSupported(n.command)&&(e.ui.registry.addMenuItem(t,{...n,onAction:u(n.onAction)?n.onAction:o(n.command)}),!0),i=(t,n)=>{e.queryCommandSupported(n.command)&&e.ui.registry.addToggleMenuItem(t,{...n,onAction:u(n.onAction)?n.onAction:o(n.command)})},d=t=>{e.execCommand("mceInsertTable",!1,{rows:t.numRows,columns:t.numColumns})},h=[s("tableinsertrowbefore",{text:"Insert row before",icon:"table-insert-row-above",command:"mceTableInsertRowBefore",onSetup:t.onSetupCellOrRow}),s("tableinsertrowafter",{text:"Insert row after",icon:"table-insert-row-after",command:"mceTableInsertRowAfter",onSetup:t.onSetupCellOrRow}),s("tabledeleterow",{text:"Delete row",icon:"table-delete-row",command:"mceTableDeleteRow",onSetup:t.onSetupCellOrRow}),s("tablerowprops",{text:"Row properties",icon:"table-row-properties",command:"mceTableRowProps",onSetup:t.onSetupCellOrRow}),s("tablecutrow",{text:"Cut row",icon:"cut-row",command:"mceTableCutRow",onSetup:t.onSetupCellOrRow}),s("tablecopyrow",{text:"Copy row",icon:"duplicate-row",command:"mceTableCopyRow",onSetup:t.onSetupCellOrRow}),s("tablepasterowbefore",{text:"Paste row before",icon:"paste-row-before",command:"mceTablePasteRowBefore",onSetup:t.onSetupPasteable(I)}),s("tablepasterowafter",{text:"Paste row after",icon:"paste-row-after",command:"mceTablePasteRowAfter",onSetup:t.onSetupPasteable(I)})],m=[s("tableinsertcolumnbefore",{text:"Insert column before",icon:"table-insert-column-before",command:"mceTableInsertColBefore",onSetup:t.onSetupColumn("onFirst")}),s("tableinsertcolumnafter",{text:"Insert column after",icon:"table-insert-column-after",command:"mceTableInsertColAfter",onSetup:t.onSetupColumn("onLast")}),s("tabledeletecolumn",{text:"Delete column",icon:"table-delete-column",command:"mceTableDeleteCol",onSetup:t.onSetupColumn("onAny")}),s("tablecutcolumn",{text:"Cut column",icon:"cut-column",command:"mceTableCutCol",onSetup:t.onSetupColumn("onAny")}),s("tablecopycolumn",{text:"Copy column",icon:"duplicate-column",command:"mceTableCopyCol",onSetup:t.onSetupColumn("onAny")}),s("tablepastecolumnbefore",{text:"Paste column before",icon:"paste-column-before",command:"mceTablePasteColBefore",onSetup:t.onSetupPasteableColumn(V,"onFirst")}),s("tablepastecolumnafter",{text:"Paste column after",icon:"paste-column-after",command:"mceTablePasteColAfter",onSetup:t.onSetupPasteableColumn(V,"onLast")})],f=[s("tablecellprops",{text:"Cell properties",icon:"table-cell-properties",command:"mceTableCellProps",onSetup:t.onSetupCellOrRow}),s("tablemergecells",{text:"Merge cells",icon:"table-merge-cells",command:"mceTableMergeCells",onSetup:t.onSetupMergeable}),s("tablesplitcells",{text:"Split cell",icon:"table-split-cells",command:"mceTableSplitCells",onSetup:t.onSetupUnmergeable})];Wn(e)?e.ui.registry.addNestedMenuItem("inserttable",{text:"Table",icon:"table",getSubmenuItems:()=>[{type:"fancymenuitem",fancytype:"inserttable",onAction:d}]}):e.ui.registry.addMenuItem("inserttable",{text:"Table",icon:"table",onAction:o("mceInsertTableDialog")}),e.ui.registry.addMenuItem("inserttabledialog",{text:"Insert table",icon:"table",onAction:o("mceInsertTableDialog")}),s("tableprops",{text:"Table properties",onSetup:t.onSetupTable,command:"mceTableProps"}),s("deletetable",{text:"Delete table",icon:"table-delete-table",onSetup:t.onSetupTable,command:"mceTableDelete"}),r(h,!0)&&e.ui.registry.addNestedMenuItem("row",{type:"nestedmenuitem",text:"Row",getSubmenuItems:n("tableinsertrowbefore tableinsertrowafter tabledeleterow tablerowprops | tablecutrow tablecopyrow tablepasterowbefore tablepasterowafter")}),r(m,!0)&&e.ui.registry.addNestedMenuItem("column",{type:"nestedmenuitem",text:"Column",getSubmenuItems:n("tableinsertcolumnbefore tableinsertcolumnafter tabledeletecolumn | tablecutcolumn tablecopycolumn tablepastecolumnbefore tablepastecolumnafter")}),r(f,!0)&&e.ui.registry.addNestedMenuItem("cell",{type:"nestedmenuitem",text:"Cell",getSubmenuItems:n("tablecellprops tablemergecells tablesplitcells")}),e.ui.registry.addContextMenu("table",{update:()=>(t.resetTargets(),t.targets().fold(n(""),e=>c(e.element)==="caption"?"tableprops deletetable":"cell row column | advtablesort | tableprops deletetable"))});const a=F(be(e));a.length!==0&&e.queryCommandSupported("mceTableToggleClass")&&e.ui.registry.addNestedMenuItem("tableclass",{icon:"table-classes",text:"Table styles",getSubmenuItems:()=>j(e,a,"tableclass",t=>e.execCommand("mceTableToggleClass",!1,t)),onSetup:t.onSetupTable});const l=F(ve(e));l.length!==0&&e.queryCommandSupported("mceTableCellToggleClass")&&e.ui.registry.addNestedMenuItem("tablecellclass",{icon:"table-cell-classes",text:"Cell styles",getSubmenuItems:()=>j(e,l,"tablecellclass",t=>e.execCommand("mceTableCellToggleClass",!1,t)),onSetup:t.onSetupCellOrRow}),e.queryCommandSupported("mceTableApplyCellStyle")&&(e.ui.registry.addNestedMenuItem("tablecellvalign",{icon:"vertical-align",text:"Vertical align",getSubmenuItems:()=>j(e,Me,"tablecellverticalalign",O(e,"vertical-align")),onSetup:t.onSetupCellOrRow}),e.ui.registry.addNestedMenuItem("tablecellborderwidth",{icon:"border-width",text:"Border width",getSubmenuItems:()=>j(e,It(e),"tablecellborderwidth",O(e,"border-width")),onSetup:t.onSetupCellOrRow}),e.ui.registry.addNestedMenuItem("tablecellborderstyle",{icon:"border-style",text:"Border style",getSubmenuItems:()=>j(e,le(e),"tablecellborderstyle",O(e,"border-style")),onSetup:t.onSetupCellOrRow}),e.ui.registry.addNestedMenuItem("tablecellbackgroundcolor",{icon:"cell-background-color",text:"Background color",getSubmenuItems:()=>Y(e,xt(e),"background-color"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addNestedMenuItem("tablecellbordercolor",{icon:"cell-border-color",text:"Border color",getSubmenuItems:()=>Y(e,Ie(e),"border-color"),onSetup:t.onSetupCellOrRow})),i("tablecaption",{icon:"table-caption",text:"Table caption",command:"mceTableToggleCaption",onSetup:t.onSetupTableWithCaption}),i("tablerowheader",{text:"Row header",icon:"table-top-header",command:"mceTableRowType",onAction:en(e),onSetup:t.onSetupTableRowHeaders}),i("tablecolheader",{text:"Column header",icon:"table-left-header",command:"mceTableColType",onAction:ut(e),onSetup:t.onSetupTableRowHeaders})},ia=e=>{const t=Yi(e);Ln(e),Bi(e),oa(e,t),na(e,t),sa(e)};tn=()=>{qs.add("table",ia)},tn()})()