(function(){"use strict";const L=e=>{let t=e;const n=()=>t,s=e=>{t=e};return{get:n,set:s}};var _,je=tinymce.util.Tools.resolve("tinymce.PluginManager");const ve=e=>{const t=()=>e.get();return{isEnabled:t}},ce=(e,t)=>e.dispatch("VisualChars",{state:t}),re=(e,t,n)=>{var s;return!!n(e,t.prototype)||((s=e.constructor)===null||s===void 0?void 0:s.name)===t.name},ae=e=>{const t=typeof e;return e===null?"null":t==="object"&&Array.isArray(e)?"array":t==="object"&&re(e,String,(e,t)=>t.isPrototypeOf(e))?"string":t},ie=e=>t=>ae(t)===e,f=e=>t=>typeof t===e,oe=e=>t=>e===t,l=ie("string"),d=oe(null),te=f("boolean"),Z=e=>e==null,q=e=>!Z(e),K=f("number");class e{constructor(e,t){this.tag=e,this.value=t}static some(t){return new e(!0,t)}static none(){return e.singletonNone}fold(e,t){return this.tag?t(this.value):e()}isSome(){return this.tag}isNone(){return!this.tag}map(t){return this.tag?e.some(t(this.value)):e.none()}bind(t){return this.tag?t(this.value):e.none()}exists(e){return this.tag&&e(this.value)}forall(e){return!this.tag||e(this.value)}filter(t){return!this.tag||t(this.value)?this:e.none()}getOr(e){return this.tag?this.value:e}or(e){return this.tag?this:e}getOrThunk(e){return this.tag?this.value:e()}orThunk(e){return this.tag?this:e()}getOrDie(e){if(this.tag)return this.value;throw new Error(e??"Called getOrDie on None")}static from(t){return q(t)?e.some(t):e.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(e){this.tag&&e(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}e.singletonNone=new e(!1);const U=(e,t)=>{const n=e.length,s=new Array(n);for(let o=0;o<n;o++){const i=e[o];s[o]=t(i,o)}return s},a=(e,t)=>{for(let n=0,s=e.length;n<s;n++){const o=e[n];t(o,n)}},$=(e,t)=>{const n=[];for(let s=0,i=e.length;s<i;s++){const o=e[s];t(o,s)&&n.push(o)}return n},z=Object.keys,y=(e,t)=>{const n=z(e);for(let s=0,i=n.length;s<i;s++){const o=n[s],a=e[o];t(a,o)}};typeof window!="undefined"?window:Function("return this;")();const M=3,S=e=>e.dom.nodeType,O=e=>e.dom.nodeValue,k=e=>t=>S(t)===e,G=k(M),E=(e,t,n)=>{if(l(n)||te(n)||K(n))e.setAttribute(t,n+"");else throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",n,":: Element ",e),new Error("Attribute value was not simple")},p=(e,t,n)=>{E(e.dom,t,n)},A=(e,t)=>{const n=e.dom.getAttribute(t);return n===null?void 0:n},w=(e,t)=>{e.dom.removeAttribute(t)},o=(e,t)=>{const n=A(e,t);return n===void 0||n===""?[]:n.split(" ")},F=(e,t,n)=>{const s=o(e,t),i=s.concat([n]);return p(e,t,i.join(" ")),!0},T=(e,t,n)=>{const s=$(o(e,t),e=>e!==n);return s.length>0?p(e,t,s.join(" ")):w(e,t),!1},i=e=>e.dom.classList!==void 0,D=e=>o(e,"class"),N=(e,t)=>F(e,"class",t),x=(e,t)=>T(e,"class",t),R=(e,t)=>{i(e)?e.dom.classList.add(t):N(e,t)},P=e=>{const t=i(e)?e.dom.classList:D(e);t.length===0&&w(e,"class")},H=(e,t)=>{if(i(e)){const n=e.dom.classList;n.remove(t)}else x(e,t);P(e)},I=(e,n)=>{const o=n||document,s=o.createElement("div");if(s.innerHTML=e,!s.hasChildNodes()||s.childNodes.length>1){const t="HTML does not have a single root node";throw console.error(t,e),new Error(t)}return t(s.childNodes[0])},B=(e,n)=>{const s=n||document,o=s.createElement(e);return t(o)},V=(e,n)=>{const s=n||document,o=s.createTextNode(e);return t(o)},t=e=>{if(e==null)throw new Error("Node cannot be null or undefined");return{dom:e}},W=(n,s,o)=>e.from(n.dom.elementFromPoint(s,o)).map(t),s={fromHtml:I,fromTag:B,fromText:V,fromDom:t,fromPoint:W},n={"\xA0":"nbsp","\xAD":"shy"},m=(e,t)=>{let n="";return y(e,(e,t)=>{n+=t}),new RegExp("["+n+"]",t?"g":"")},Y=e=>{let t="";return y(e,e=>{t&&(t+=","),t+="span.mce-"+e}),t},C=m(n),X=m(n,!0),Q=Y(n),h="mce-nbsp",J=e=>'<span data-mce-bogus="1" class="mce-'+n[e]+'">'+e+"</span>",ee=e=>{const t=O(e);return G(e)&&l(t)&&C.test(t)},u=(e,t)=>{let n=[];const o=e.dom,i=U(o.childNodes,s.fromDom);return a(i,e=>{t(e)&&(n=n.concat([e])),n=n.concat(u(e,t))}),n},ne=(e,t)=>{for(;e.parentNode;){if(e.parentNode===t)return t;e=e.parentNode}},se=e=>e.replace(X,J),g=e=>e.nodeName.toLowerCase()==="span"&&e.classList.contains("mce-nbsp-wrap"),r=(e,t)=>{const n=e.dom,o=u(s.fromDom(t),ee);a(o,t=>{const i=t.dom.parentNode;if(g(i))R(s.fromDom(i),h);else{const i=se(n.encode((o=O(t))!==null&&o!==void 0?o:"")),a=n.create("div",{},i);let s;for(var o;s=a.lastChild;)n.insertAfter(s,t.dom);e.dom.remove(t.dom)}})},c=(e,t)=>{const n=e.dom.select(Q,t);a(n,t=>{g(t)?H(s.fromDom(t),h):e.dom.remove(t,!0)})},v=e=>{const n=e.getBody(),s=e.selection.getBookmark();let t=ne(e.selection.getNode(),n);t=t!==void 0?t:n,c(e,t),r(e,t),e.selection.moveToBookmark(s)},b=(e,t)=>{ce(e,t.get());const n=e.getBody();t.get()===!0?r(e,n):c(e,n)},le=(e,t)=>{t.set(!t.get());const n=e.selection.getBookmark();b(e,t),e.selection.moveToBookmark(n)},de=(e,t)=>{e.addCommand("mceVisualChars",()=>{le(e,t)})},ue=e=>t=>t.options.get(e),he=e=>{const t=e.options.register;t("visualchars_default_state",{processor:"boolean",default:!1})},me=ue("visualchars_default_state"),fe=(e,t)=>{e.on("init",()=>{b(e,t)})},pe=(e,t)=>{let n=null;const s=()=>{d(n)||(clearTimeout(n),n=null)},o=(...s)=>{d(n)&&(n=setTimeout(()=>{n=null,e.apply(null,s)},t))};return{cancel:s,throttle:o}},ge=(e,t)=>{const n=pe(()=>{v(e)},300);e.on("keydown",s=>{t.get()===!0&&(s.keyCode===13?v(e):n.throttle())}),e.on("remove",n.cancel)},j=(e,t)=>n=>{n.setActive(t.get());const s=e=>n.setActive(e.state);return e.on("VisualChars",s),()=>e.off("VisualChars",s)},be=(e,t)=>{const n=()=>e.execCommand("mceVisualChars");e.ui.registry.addToggleButton("visualchars",{tooltip:"Show invisible characters",icon:"visualchars",onAction:n,onSetup:j(e,t)}),e.ui.registry.addToggleMenuItem("visualchars",{text:"Show invisible characters",icon:"visualchars",onAction:n,onSetup:j(e,t)})};_=()=>{je.add("visualchars",e=>{he(e);const t=L(me(e));return de(e,t),be(e,t),ge(e,t),fe(e,t),ve(t)})},_()})()