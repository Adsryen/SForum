!function(){"use strict";const A=e=>{let t=e;return{get:()=>t,set:e=>{t=e}}};v=tinymce.util.Tools.resolve("tinymce.PluginManager");const w=e=>t=>(e=>{const t=typeof e;return null===e?"null":"object"===t&&Array.isArray(e)?"array":"object"===t&&(s=o=e,(i=String).prototype.isPrototypeOf(s)||(null===(n=o.constructor)||void 0===n?void 0:n.name)===i.name)?"string":t;var n,s,o,i})(t)===e,x=e=>t=>typeof t===e,Z=w("string"),W=w("array"),Y=x("boolean"),q=x("number"),G=()=>{},F=e=>()=>e,E=F(!0),ne=F("[!-#%-*,-\\/:;?@\\[-\\]_{}\xa1\xab\xb7\xbb\xbf;\xb7՚-՟։֊־׀׃׆׳״؉؊،؍؛؞؟٪-٭۔܀-܍߷-߹࠰-࠾࡞।॥॰෴๏๚๛༄-༒༺-༽྅࿐-࿔࿙࿚၊-၏჻፡-፨᐀᙭᙮᚛᚜᛫-᛭᜵᜶។-៖៘-៚᠀-᠊᥄᥅᨞᨟᪠-᪦᪨-᪭᭚-᭠᯼-᯿᰻-᰿᱾᱿᳓‐-‧‰-⁃⁅-⁑⁓-⁞⁽⁾₍₎〈〉❨-❵⟅⟆⟦-⟯⦃-⦘⧘-⧛⧼⧽⳹-⳼⳾⳿⵰⸀-⸮⸰⸱、-〃〈-】〔-〟〰〽゠・꓾꓿꘍-꘏꙳꙾꛲-꛷꡴-꡷꣎꣏꣸-꣺꤮꤯꥟꧁-꧍꧞꧟꩜-꩟꫞꫟꯫﴾﴿︐-︙︰-﹒﹔-﹡﹣﹨﹪﹫！-＃％-＊，-／：；？＠［-］＿｛｝｟-･]");class e{constructor(e,t){this.tag=e,this.value=t}static some(t){return new e(!0,t)}static none(){return e.singletonNone}fold(e,t){return this.tag?t(this.value):e()}isSome(){return this.tag}isNone(){return!this.tag}map(t){return this.tag?e.some(t(this.value)):e.none()}bind(t){return this.tag?t(this.value):e.none()}exists(e){return this.tag&&e(this.value)}forall(e){return!this.tag||e(this.value)}filter(t){return!this.tag||t(this.value)?this:e.none()}getOr(e){return this.tag?this.value:e}or(e){return this.tag?this:e}getOrThunk(e){return this.tag?this.value:e()}orThunk(e){return this.tag?this:e()}getOrDie(e){if(this.tag)return this.value;throw new Error(e??"Called getOrDie on None")}static from(t){return t==null?e.none():e.some(t)}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(e){this.tag&&e(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}e.singletonNone=new e(!1);const b=ne;var l,v,f=tinymce.util.Tools.resolve("tinymce.Env"),s=tinymce.util.Tools.resolve("tinymce.util.Tools");const K=Array.prototype.slice,se=Array.prototype.push,o=(e,t)=>{const n=e.length,s=new Array(n);for(let o=0;o<n;o++){const i=e[o];s[o]=t(i,o)}return s},j=(e,t)=>{for(let n=0,s=e.length;n<s;n++)t(e[n],n)},y=(e,t)=>{for(let n=e.length-1;n>=0;n--)t(e[n],n)},a=(e,t)=>(e=>{const t=[];for(let n=0,s=e.length;n<s;++n){if(!W(e[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+e);se.apply(t,e[n])}return t})(o(e,t)),te=Object.hasOwnProperty,O=(e,t)=>te.call(e,t);"undefined"!=typeof window?window:Function("return this;")();const ee=(3,e=>3===(e=>e.dom.nodeType)(e)),X=e=>{if(e==null)throw new Error("Node cannot be null or undefined");return{dom:e}},t=X,k=(e,t)=>({element:e,offset:t}),p=(n,s)=>{((n,s)=>{const o=(n=>e.from(n.dom.parentNode).map(t))(n);o.each(e=>{e.dom.insertBefore(s.dom,n.dom)})})(n,s),((e,t)=>{e.dom.appendChild(t.dom)})(s,n)},$=((t)=>{const s=n=>t(n)?e.from(n.dom.nodeValue):e.none();return{get:e=>{if(!t(e))throw new Error("Can only get text value of a text node");return s(e).getOr("")},getOption:s,set:(e,n)=>{if(!t(e))throw new Error("Can only set raw text value of a text node");e.dom.nodeValue=n}}})(ee),M=e=>$.get(e);l=tinymce.util.Tools.resolve("tinymce.dom.TreeWalker");const T=(e,t)=>e.isBlock(t)||O(e.schema.getVoidElements(),t.nodeName),z=(e,t)=>"false"===e.getContentEditable(t),D=(e,t)=>!e.isBlock(t)&&O(e.schema.getWhitespaceElements(),t.nodeName),N=(e,n)=>((e,n)=>{const s=(e=>o(e.dom.childNodes,t))(e);return s.length>0&&n<s.length?k(s[n],0):k(e,n)})(t(e),n),g=(e,t,n,s,o,i=!0)=>{let a=i?t(!1):n;for(;a;){const n=z(e,a);if(n||D(e,a)){if(n?s.cef(a):s.boundary(a))break;a=t(!0)}else{if(T(e,a)){if(s.boundary(a))break}else 3===a.nodeType&&s.text(a);if(a===o)break;a=t(!1)}}},R=(e,n,s,o,i)=>{var r;if(((e,t)=>T(e,t)||z(e,t)||D(e,t)||((e,t)=>"true"===e.getContentEditable(t)&&t.parentNode&&"false"===e.getContentEditableParent(t.parentNode))(e,t))(e,s))return;const c=null!==(r=e.getParent(o,e.isBlock))&&void 0!==r?r:e.getRoot(),a=new l(s,c),d=i?a.next.bind(a):a.prev.bind(a);g(e,d,s,{boundary:E,cef:E,text:e=>{i?n.fOffset+=e.length:n.sOffset+=e.length,n.elements.push(t(e))}})},P=(e,n,s,o,i,a=!0)=>{const u=new l(s,n),c=[];let r={sOffset:0,fOffset:0,elements:[]};R(e,r,s,n,!1);const d=()=>(r.elements.length>0&&(c.push(r),r={sOffset:0,fOffset:0,elements:[]}),!1);return g(e,u.next.bind(u),s,{boundary:d,cef:e=>(d(),i&&c.push(...i.cef(e)),!1),text:e=>{r.elements.push(t(e)),i&&i.text(e,r)}},o,a),o&&R(e,r,o,n,!0),d(),c},Q=(e,n)=>{const s=N(n.startContainer,n.startOffset),i=s.element.dom,r=N(n.endContainer,n.endOffset),c=r.element.dom;return P(e,n.commonAncestorContainer,i,c,{text:(e,t)=>{e===c?t.fOffset+=e.length-r.offset:e===i&&(t.sOffset+=s.offset)},cef:n=>{return((e)=>{const n=K.call(e,0);return n.sort((e,t)=>((e,t)=>((e,t,n)=>0!=(e.compareDocumentPosition(t)&n))(e,t,Node.DOCUMENT_POSITION_PRECEDING))(e.elements[0].dom,t.elements[0].dom)?1:-1),n})(a((s=t(n),((e,n)=>{const i=void 0===n?document:n.dom;return 1!==(s=i).nodeType&&9!==s.nodeType&&11!==s.nodeType||0===s.childElementCount?[]:o(i.querySelectorAll(e),t);var s})("*[contenteditable=true]",s)),t=>{const n=t.dom;return P(e,n,n)}));var s}},!1)},I=(e,t)=>t.collapsed?[]:Q(e,t),B=(e,t)=>{const n=e.createRng();return n.selectNode(t),I(e,n)},V=(e,t)=>a(t,t=>{const n=t.elements,s=o(n,M).join(""),i=((e,t,n=0,s=e.length)=>{const i=t.regex;i.lastIndex=n;const a=[];let o;for(;o=i.exec(e);){const r=o[t.matchIndex],c=o.index+o[0].indexOf(r),n=c+r.length;if(n>s)break;a.push({start:c,finish:n}),i.lastIndex=n}return a})(s,e,t.sOffset,s.length-t.fOffset);return((e,t)=>{const i=(s=e,o=(e,n)=>{const i=M(n),s=e.last,o=s+i.length,r=a(t,(e,t)=>e.start<o&&e.finish>s?[{element:n,start:Math.max(s,e.start)-s,finish:Math.min(o,e.finish)-s,matchId:t}]:[]);return{results:e.results.concat(r),last:o}},n={results:[],last:0},j(s,(e)=>{n=o(n,e)}),n).results;var n,s,o;return((e,t)=>{if(0===e.length)return[];{let o=t(e[0]);const s=[];let n=[];for(let i=0,c=e.length;i<c;i++){const a=e[i],r=t(a);r!==o&&(s.push(n),n=[]),o=r,n.push(a)}return 0!==n.length&&s.push(n),s}})(i,e=>e.matchId)})(n,i)}),H=(e,n)=>{y(e,(e,s)=>{y(e,e=>{const i=t(n.cloneNode(!1));((e,t,n)=>{((e,t,n)=>{if(!(Z(n)||Y(n)||q(n)))throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",n,":: Element ",e),new Error("Attribute value was not simple");e.setAttribute(t,n+"")})(e.dom,t,n)})(i,"data-mce-index",s);const o=e.element.dom;if(o.length===e.finish&&0===e.start)p(e.element,i);else{o.length!==e.finish&&o.splitText(e.finish);const n=o.splitText(e.start);p(t(n),i)}})})},n=e=>e.getAttribute("data-mce-index"),U=(e,t,n,s)=>{const o=e.dom.create("span",{"data-mce-bogus":1});o.className="mce-match-marker";const r=e.getBody();return i(e,t,!1),s?((e,t,n,s)=>{const r=n.getBookmark(),o=e.select("td[data-mce-selected],th[data-mce-selected]"),c=o.length>0?((e,t)=>a(t,t=>B(e,t)))(e,o):I(e,n.getRng()),i=V(t,c);return H(i,s),n.moveToBookmark(r),i.length})(e.dom,n,e.selection,o):((e,t,n,s)=>{const i=B(e,n),o=V(t,i);return H(o,s),o.length})(e.dom,n,r,o)},L=e=>{var t;const n=e.parentNode;e.firstChild&&n.insertBefore(e.firstChild,e),null===(t=e.parentNode)||void 0===t||t.removeChild(e)},d=(e,t)=>{const i=[],o=s.toArray(e.getBody().getElementsByTagName("span"));if(o.length)for(let e=0;e<o.length;e++){const s=n(o[e]);null!==s&&s.length&&s===t.toString()&&i.push(o[e])}return i},c=(e,t,n)=>{const o=t.get();let s=o.index;const i=e.dom;n?s+1===o.count?s=0:s++:s-1==-1?s=o.count-1:s--,i.removeClass(d(e,o.index),"mce-match-marker-selected");const a=d(e,s);return a.length?(i.addClass(d(e,s),"mce-match-marker-selected"),e.selection.scrollIntoView(a[0]),s):-1},S=(e,t)=>{const n=t.parentNode;e.remove(t),n&&e.isEmpty(n)&&e.remove(n)},C=(e,t,n,s,o,i)=>{const a=e.selection,l=((e,t)=>{const n="("+e.replace(/[-[\]/{}()*+?.\\^$|]/g,"\\$&").replace(/\s/g,`[^\\S\\r\\n\\uFEFF]`)+")";return t?`(?:^|\\s|${b()})`+n+`(?=$|\\s|${b()})`:n})(n,o),d=a.isForward(),u={regex:new RegExp(l,s?"g":"gi"),matchIndex:1},r=U(e,t,u,i);if(f.browser.isSafari()&&a.setRng(a.getRng(),d),r){const a=c(e,t,!0);t.set({index:a,count:r,text:n,matchCase:s,wholeWord:o,inSelection:i})}return r},r=(e,t)=>{const n=c(e,t,!0);t.set({...t.get(),index:n})},u=(e,t)=>{const n=c(e,t,!1);t.set({...t.get(),index:n})},J=e=>{const t=n(e);return null!==t&&t.length>0},h=(e,t,o,i,a)=>{const l=t.get(),h=l.index;let d,m=h;i=!1!==i;const f=e.getBody(),c=s.grep(s.toArray(f.getElementsByTagName("span")),J);for(let t=0;t<c.length;t++){const r=n(c[t]);let s=d=parseInt(r,10);if(a||s===l.index){for(o.length?(c[t].innerText=o,L(c[t])):S(e.dom,c[t]);c[++t];){if(s=parseInt(n(c[t]),10),s!==d){t--;break}S(e.dom,c[t])}i&&m--}else d>h&&c[t].setAttribute("data-mce-index",String(d-1))}return t.set({...l,count:a?0:l.count-1,index:m}),i?r(e,t):u(e,t),!a&&t.get().count>0},i=(e,t,o)=>{let a,r;const c=t.get(),i=s.toArray(e.getBody().getElementsByTagName("span"));for(let e=0;e<i.length;e++){const t=n(i[e]);null!==t&&t.length&&(t===c.index.toString()&&(a||(a=i[e].firstChild),r=i[e].firstChild),L(i[e]))}if(t.set({...c,index:-1,count:0,text:""}),a&&r){const t=e.dom.createRng();return t.setStart(a,0),t.setEnd(r,r.data.length),!1!==o&&e.selection.setRng(t),t}},_=(t,n)=>{const p=(()=>{const t=(t=>{const n=A(e.none()),s=()=>n.get().each(t);return{clear:()=>{s(),n.set(e.none())},isSet:()=>n.get().isSome(),get:()=>n.get(),set:t=>{s(),n.set(e.some(t))}}})(G);return{...t,on:e=>t.get().each(e)}})();t.undoManager.add();const g=s.trim(t.selection.getContent({format:"text"})),o=e=>{e.setEnabled("next",((e,t)=>t.get().count>1)(0,n)),e.setEnabled("prev",((e,t)=>t.get().count>1)(0,n))},l=(e,t)=>{j(["replace","replaceall","prev","next"],n=>e.setEnabled(n,!t))},d=(e,t)=>{f.browser.isSafari()&&f.deviceType.isTouch()&&("find"===t||"replace"===t||"replaceall"===t)&&e.focus(t)},a=e=>{i(t,n,!1),l(e,!0),o(e)},m=e=>{const s=e.getData(),i=n.get();if(s.findtext.length){if(i.text===s.findtext&&i.matchCase===s.matchcase&&i.wholeWord===s.wholewords)r(t,n);else{const o=C(t,n,s.findtext,s.matchcase,s.wholewords,s.inselection);o<=0&&(e=>{t.windowManager.alert("Could not find the specified string.",()=>{e.focus("findtext")})})(e),l(e,0===o)}o(e)}else a(e)},c=n.get(),v={title:"Find and Replace",size:"normal",body:{type:"panel",items:[{type:"bar",items:[{type:"input",name:"findtext",placeholder:"Find",maximized:!0,inputMode:"search"},{type:"button",name:"prev",text:"Previous",icon:"action-prev",enabled:!1,borderless:!0},{type:"button",name:"next",text:"Next",icon:"action-next",enabled:!1,borderless:!0}]},{type:"input",name:"replacetext",placeholder:"Replace with",inputMode:"search"}]},buttons:[{type:"menu",name:"options",icon:"preferences",tooltip:"Preferences",align:"start",items:[{type:"togglemenuitem",name:"matchcase",text:"Match case"},{type:"togglemenuitem",name:"wholewords",text:"Find whole words only"},{type:"togglemenuitem",name:"inselection",text:"Find in selection"}]},{type:"custom",name:"find",text:"Find",primary:!0},{type:"custom",name:"replace",text:"Replace",enabled:!1},{type:"custom",name:"replaceall",text:"Replace all",enabled:!1}],initialData:{findtext:g,replacetext:"",wholewords:c.wholeWord,matchcase:c.matchCase,inselection:c.inSelection},onChange:(e,t)=>{"findtext"===t.name&&n.get().count>0&&a(e)},onAction:(e,s)=>{const i=e.getData();switch(s.name){case"find":m(e);break;case"replace":h(t,n,i.replacetext)?o(e):a(e);break;case"replaceall":h(t,n,i.replacetext,!0,!0),a(e);break;case"prev":u(t,n),o(e);break;case"next":r(t,n),o(e);break;case"matchcase":case"wholewords":case"inselection":(e=>{const t=e.getData(),s=n.get();n.set({...s,matchCase:t.matchcase,wholeWord:t.wholewords,inSelection:t.inselection})})(e),a(e)}d(e,s.name)},onSubmit:e=>{m(e),d(e,"find")},onClose:()=>{t.focus(),i(t,n),t.undoManager.add()}};p.set(t.windowManager.open(v,{inline:"toolbar"}))},m=(e,t)=>()=>{_(e,t)};v.add("searchreplace",e=>{const t=A({index:-1,count:0,text:"",matchCase:!1,wholeWord:!1,inSelection:!1});return((e,t)=>{e.addCommand("SearchReplace",()=>{_(e,t)})})(e,t),((e,t)=>{e.ui.registry.addMenuItem("searchreplace",{text:"Find and replace...",shortcut:"Meta+F",onAction:m(e,t),icon:"search"}),e.ui.registry.addButton("searchreplace",{tooltip:"Find and replace",onAction:m(e,t),icon:"search"}),e.shortcuts.add("Meta+F","",m(e,t))})(e,t),((e,t)=>({done:n=>i(e,t,n),find:(n,s,o,i=!1)=>C(e,t,n,s,o,i),next:()=>r(e,t),prev:()=>u(e,t),replace:(n,s,o)=>h(e,t,n,s,o)}))(e,t)})}()