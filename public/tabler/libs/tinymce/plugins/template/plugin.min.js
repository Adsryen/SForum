!function(){"use strict";var n,r,x=tinymce.util.Tools.resolve("tinymce.PluginManager");const a=e=>t=>(e=>{const t=typeof e;return null===e?"null":"object"===t&&Array.isArray(e)?"array":"object"===t&&(s=o=e,(i=String).prototype.isPrototypeOf(s)||(null===(n=o.constructor)||void 0===n?void 0:n.name)===i.name)?"string":t;var n,s,o,i})(t)===e,u=a("string"),E=a("object"),w=a("array"),i=("function",e=>"function"==typeof e),_=(!1,()=>!1);n=tinymce.util.Tools.resolve("tinymce.util.Tools");const t=e=>t=>t.options.get(e),p=t("template_cdate_classes"),d=t("template_mdate_classes"),M=t("template_selected_content_classes"),A=t("template_preview_replace_values"),m=t("template_replace_values"),k=t("templates"),y=t("template_cdate_format"),l=t("template_mdate_format"),v=t("content_style"),b=t("content_css_cors"),j=t("body_class"),s=(e,t)=>{if((e=""+e).length<t)for(let n=0;n<t-e.length;n++)e="0"+e;return e},c=(e,t,n=new Date)=>{const o="Sun Mon Tue Wed Thu Fri Sat Sun".split(" "),i="Sunday Monday Tuesday Wednesday Thursday Friday Saturday Sunday".split(" "),a="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),r="January February March April May June July August September October November December".split(" ");return(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=t.replace("%D","%m/%d/%Y")).replace("%r","%I:%M:%S %p")).replace("%Y",""+n.getFullYear())).replace("%y",""+n.getYear())).replace("%m",s(n.getMonth()+1,2))).replace("%d",s(n.getDate(),2))).replace("%H",""+s(n.getHours(),2))).replace("%M",""+s(n.getMinutes(),2))).replace("%S",""+s(n.getSeconds(),2))).replace("%I",""+((n.getHours()+11)%12+1))).replace("%p",n.getHours()<12?"AM":"PM")).replace("%B",""+e.translate(r[n.getMonth()]))).replace("%b",""+e.translate(a[n.getMonth()]))).replace("%A",""+e.translate(i[n.getDay()]))).replace("%a",""+e.translate(o[n.getDay()]))).replace("%%","%")};class e{constructor(e,t){this.tag=e,this.value=t}static some(t){return new e(!0,t)}static none(){return e.singletonNone}fold(e,t){return this.tag?t(this.value):e()}isSome(){return this.tag}isNone(){return!this.tag}map(t){return this.tag?e.some(t(this.value)):e.none()}bind(t){return this.tag?t(this.value):e.none()}exists(e){return this.tag&&e(this.value)}forall(e){return!this.tag||e(this.value)}filter(t){return!this.tag||t(this.value)?this:e.none()}getOr(e){return this.tag?this.value:e}or(e){return this.tag?this:e}getOrThunk(e){return this.tag?this.value:e()}orThunk(e){return this.tag?this:e()}getOrDie(e){if(this.tag)return this.value;throw new Error(e??"Called getOrDie on None")}static from(t){return t==null?e.none():e.some(t)}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(e){this.tag&&e(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}e.singletonNone=new e(!1);const O=Object.hasOwnProperty,g={'"':"&quot;","<":"&lt;",">":"&gt;","&":"&amp;","'":"&#039;"},C=t=>t.replace(/["'<>&]/g,t=>{return(n=g,s=t,((e,t)=>O.call(e,t))(n,s)?e.from(n[s]):e.none()).getOr(t);var n,s}),o=(e,t,n)=>((n)=>{for(let s=0,i=n.length;s<i;s++)if(o=n[s],e.hasClass(t,o))return!0;var o;return!1})(n.split(/\s+/)),f=(e,t)=>(n.each(t,(t,n)=>{i(t)&&(t=t(n)),e=e.replace(new RegExp("\\{\\$"+n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")+"\\}","g"),t)}),e),h=(e,t)=>{const s=e.dom,o=m(e);n.each(s.select("*",t),e=>{n.each(o,(t,n)=>{s.hasClass(e,n)&&i(t)&&t(e)})})},S=(e,t,s)=>{const i=e.dom,u=e.selection.getContent();s=f(s,m(e));let a=i.create("div",{},s);const r=i.select(".mceTmpl",a);r&&r.length>0&&(a=i.create("div"),a.appendChild(r[0].cloneNode(!0))),n.each(i.select("*",a),t=>{o(i,t,p(e))&&(t.innerHTML=c(e,y(e))),o(i,t,d(e))&&(t.innerHTML=c(e,l(e))),o(i,t,M(e))&&(t.innerHTML=u)}),h(e,a),e.execCommand("mceInsertContent",!1,a.innerHTML),e.addVisual()};r=tinymce.util.Tools.resolve("tinymce.Env");const F=(t,s)=>{const a=(t,n)=>((t,n,s)=>{for(let o=0,a=t.length;o<a;o++){const i=t[o];if(n(i,o))return e.some(i);if(s(i,o))break}return e.none()})(t,e=>e.text===n,_),o=e=>{t.windowManager.alert("Could not load the specified template.",()=>e.focus("template"))},i=e=>e.value.url.fold(()=>Promise.resolve(e.value.content.getOr("")),e=>fetch(e).then(e=>e.ok?e.text():Promise.reject())),c=(e,t)=>(n,s)=>{if("template"===s.name){const s=n.getData().template;a(e,s).each(e=>{n.block("Loading..."),i(e).then(s=>{t(n,e,s)}).catch(()=>{t(n,e,""),n.setEnabled("save",!1),o(n)})})}},l=e=>n=>{const s=n.getData();a(e,s.template).each(e=>{i(e).then(e=>{t.execCommand("mceInsertTemplate",!1,e),n.close()}).catch(()=>{n.setEnabled("save",!1),o(n)})})};(()=>{if(!s||0===s.length){const n=t.translate("No templates defined.");return t.notificationManager.open({text:n,type:"info"}),e.none()}return e.from(n.map(s,(t,n)=>{const s=e=>void 0!==e.url;return{selected:0===n,text:t.title,value:{url:s(t)?e.from(t.url):e.none(),content:s(t)?e.none():e.from(t.content),description:t.description}}}))})().each(e=>{const u=(e=>((e)=>{const n=e.length,s=new Array(n);for(let t=0;t<n;t++){const i=e[t];s[t]={text:(o=i).text,value:o.text}}var o;return s})(e))(e),d=(t,n)=>({title:"Insert Template",size:"large",body:{type:"panel",items:t},initialData:n,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],onSubmit:l(e),onChange:c(e,a)}),a=(e,s,o)=>{const i=((e,t)=>{var s;if(-1===t.indexOf("<html>")){let o="";const a=null!==(s=v(e))&&void 0!==s?s:"",l=b(e)?' crossorigin="anonymous"':"";n.each(e.contentCSS,t=>{o+='<link type="text/css" rel="stylesheet" href="'+e.documentBaseURI.toAbsolute(t)+'"'+l+">"}),a&&(o+='<style type="text/css">'+a+"</style>");const d=j(e),i=e.dom.encode,u='<script>document.addEventListener && document.addEventListener("click", function(e) {for (var elm = e.target; elm; elm = elm.parentNode) {if (elm.nodeName === "A" && !('+(r.os.isMacOS()||r.os.isiOS()?"e.metaKey":"e.ctrlKey && !e.altKey")+")) {e.preventDefault();}}}, false);<\/script> ",c=e.getBody().dir,h=c?' dir="'+i(c)+'"':"";t='<!DOCTYPE html><html><head><base href="'+i(e.documentBaseURI.getURI())+'">'+o+u+'</head><body class="'+i(d)+'"'+h+">"+t+"</body></html>"}return f(t,A(e))})(t,o),a=[{type:"selectbox",name:"template",label:"Templates",items:u},{type:"htmlpanel",html:`<p aria-live="polite">${C(s.value.description)}</p>`},{label:"Preview",type:"iframe",name:"preview",sandboxed:!1,transparent:!1}],c={template:s.text,preview:i};e.unblock(),e.redial(d(a,c)),e.focus("template")},s=t.windowManager.open(d([],{template:"",preview:""}));s.block("Loading..."),i(e[0]).then(t=>{a(s,e[0],t)}).catch(()=>{a(s,e[0],""),s.setEnabled("save",!1),o(s)})})};x.add("template",e=>{(e=>{const t=e.options.register;t("template_cdate_classes",{processor:"string",default:"cdate"}),t("template_mdate_classes",{processor:"string",default:"mdate"}),t("template_selected_content_classes",{processor:"string",default:"selcontent"}),t("template_preview_replace_values",{processor:"object"}),t("template_replace_values",{processor:"object"}),t("templates",{processor:e=>u(e)||((e,t)=>{if(w(e)){for(let n=0,s=e.length;n<s;++n)if(!t(e[n]))return!1;return!0}return!1})(e,E)||i(e),default:[]}),t("template_cdate_format",{processor:"string",default:e.translate("%Y-%m-%d")}),t("template_mdate_format",{processor:"string",default:e.translate("%Y-%m-%d")})})(e),(e=>{const t=()=>e.execCommand("mceTemplate");e.ui.registry.addButton("template",{icon:"template",tooltip:"Insert template",onAction:t}),e.ui.registry.addMenuItem("template",{icon:"template",text:"Insert template...",onAction:t})})(e),(e=>{e.addCommand("mceInsertTemplate",function(e,...t){return(...n)=>{const s=t.concat(n);return e.apply(null,s)}}(S,e)),e.addCommand("mceTemplate",((e,t)=>()=>{const n=k(e);i(n)?n(t):u(n)?fetch(n).then(e=>{e.ok&&e.json().then(t)}):t(n)})(e,(e=>t=>{F(e,t)})(e)))})(e),(e=>{e.on("PreProcess",t=>{const s=e.dom,i=l(e);n.each(s.select("div",t.node),t=>{s.hasClass(t,"mceTmpl")&&(n.each(s.select("*",t),t=>{o(s,t,d(e))&&(t.innerHTML=c(e,i))}),h(e,t))})})})(e)})}()