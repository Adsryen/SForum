!function(){"use strict";we=tinymce.util.Tools.resolve("tinymce.PluginManager");const G=e=>t=>(e=>{const t=typeof e;return null===e?"null":"object"===t&&Array.isArray(e)?"array":"object"===t&&(s=o=e,(i=String).prototype.isPrototypeOf(s)||(null===(n=o.constructor)||void 0===n?void 0:n.name)===i.name)?"string":t;var n,s,o,i})(t)===e,Q=e=>t=>typeof t===e,rt=G("string"),M=G("object"),ft=G("array"),mt=Q("boolean"),a=e=>!(e=>e==null)(e),C=Q("function"),vt=Q("number"),At=()=>{},st=(e,t)=>e===t,Qe=e=>t=>!e(t),Ge=(!1,()=>!1);class e{constructor(e,t){this.tag=e,this.value=t}static some(t){return new e(!0,t)}static none(){return e.singletonNone}fold(e,t){return this.tag?t(this.value):e()}isSome(){return this.tag}isNone(){return!this.tag}map(t){return this.tag?e.some(t(this.value)):e.none()}bind(t){return this.tag?t(this.value):e.none()}exists(e){return this.tag&&e(this.value)}forall(e){return!this.tag||e(this.value)}filter(t){return!this.tag||t(this.value)?this:e.none()}getOr(e){return this.tag?this.value:e}or(e){return this.tag?this:e}getOrThunk(e){return this.tag?this.value:e()}orThunk(e){return this.tag?this:e()}getOrDie(e){if(this.tag)return this.value;throw new Error(e??"Called getOrDie on None")}static from(t){return a(t)?e.some(t):e.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(e){this.tag&&e(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}e.singletonNone=new e(!1);const Ft=Array.prototype.slice,St=Array.prototype.indexOf,Ot=Array.prototype.push,et=(e,t)=>{return n=e,s=t,St.call(n,s)>-1;var n,s},xe=(e,t)=>{for(let n=0,s=e.length;n<s;n++)if(t(e[n],n))return!0;return!1},i=(e,t)=>{const n=e.length,s=new Array(n);for(let o=0;o<n;o++){const i=e[o];s[o]=t(i,o)}return s},o=(e,t)=>{for(let n=0,s=e.length;n<s;n++)t(e[n],n)},f=(e,t)=>{const n=[];for(let s=0,i=e.length;s<i;s++){const o=e[s];t(o,s)&&n.push(o)}return n},ie=(e,t,n)=>(o(e,(e,s)=>{n=t(n,e,s)}),n),O=(t,n,s)=>{for(let o=0,a=t.length;o<a;o++){const i=t[o];if(n(i,o))return e.some(i);if(s(i,o))break}return e.none()},le=(e,t)=>O(e,t,Ge),fe=(e,t)=>(e=>{const t=[];for(let n=0,s=e.length;n<s;++n){if(!ft(e[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+e);Ot.apply(t,e[n])}return t})(i(e,t)),ue=e=>{const t=Ft.call(e,0);return t.reverse(),t},Ze=(t,n)=>n>=0&&n<t.length?e.some(t[n]):e.none(),de=e=>Ze(e,0),x=e=>Ze(e,e.length-1),pe=(e,t)=>{const n=[],s=C(t)?e=>xe(n,n=>t(n,e)):e=>et(n,e);for(let t=0,i=e.length;t<i;t++){const o=e[t];s(o)||n.push(o)}return n},_e=(e,t,n=st)=>e.exists(e=>n(e,t)),te=(t,n,s)=>t.isSome()&&n.isSome()?e.some(s(t.getOrDie(),n.getOrDie())):e.none(),he=e=>{if(e==null)throw new Error("Node cannot be null or undefined");return{dom:e}},N=(e,t)=>{const n=(t||document).createElement(e);return he(n)},t=he,V=(e,t)=>e.dom===t.dom;"undefined"!=typeof window?window:Function("return this;")();const k=e=>e.dom.nodeName.toLowerCase(),dt=(1,e=>1===(e=>e.dom.nodeType)(e)),be=e=>t=>dt(t)&&k(t)===e,B=n=>e.from(n.dom.parentNode).map(t),R=e=>i(e.dom.childNodes,t),je=(n,s)=>{const o=n.dom.childNodes;return e.from(o[s]).map(t)},Ee=e=>je(e,0),Ae=e=>je(e,e.dom.childNodes.length-1),_t=(n,s,o)=>{let i=n.dom;const a=C(o)?o:Ge;for(;i.parentNode;){i=i.parentNode;const n=t(i);if(s(n))return e.some(n);if(a(n))break}return e.none()},Ie=(t,n,s)=>((t,n,s,o,i)=>o(s)?e.some(s):C(i)&&i(s)?e.none():n(s,o,i))(0,_t,t,n,s),$e=(e,t)=>{B(e).each(n=>{n.dom.insertBefore(t.dom,e.dom)})},v=(e,t)=>{e.dom.appendChild(t.dom)},X=(e,t)=>{o(t,t=>{v(e,t)})},me=e=>{e.dom.textContent="",o(R(e),e=>{Z(e)})},Z=e=>{const t=e.dom;null!==t.parentNode&&t.parentNode.removeChild(t)};var s,F,we,ht=tinymce.util.Tools.resolve("tinymce.dom.RangeUtils"),kt=tinymce.util.Tools.resolve("tinymce.dom.TreeWalker"),z=tinymce.util.Tools.resolve("tinymce.util.VK"),Je,lt;const Be=e=>i(e,t),Pt=Object.keys,oe=(e,t)=>{const n=Pt(e);for(let s=0,i=n.length;s<i;s++){const o=n[s];t(e[o],o)}},b=(e,t)=>{const n=e.dom;oe(t,(e,t)=>{((e,t,n)=>{if(!(rt(n)||mt(n)||vt(n)))throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",n,":: Element ",e),new Error("Attribute value was not simple");e.setAttribute(t,n+"")})(n,t,e)})},ae=e=>ie(e.dom.attributes,(e,t)=>(e[t.name]=t.value,e),{}),Vt=e=>((e)=>t(e.dom.cloneNode(!0)))(e),ce=(n,s)=>{const o=((e,t)=>{const n=N(t),s=ae(e);return b(n,s),n})(n,s);((n,s)=>{const o=(n=>e.from(n.dom.nextSibling).map(t))(n);o.fold(()=>{B(n).each(e=>{v(e,s)})},e=>{$e(e,s)})})(n,o);const i=R(n);return X(o,i),Z(n),o};F=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),s=tinymce.util.Tools.resolve("tinymce.util.Tools");const at=e=>t=>a(t)&&t.nodeName.toLowerCase()===e,j=e=>t=>a(t)&&e.test(t.nodeName),u=e=>a(e)&&3===e.nodeType,y=e=>a(e)&&1===e.nodeType,n=j(/^(OL|UL|DL)$/),$t=j(/^(OL|UL)$/),ve=at("ol"),re=j(/^(LI|DT|DD)$/),It=j(/^(DT|DD)$/),Ht=j(/^(TH|TD)$/),c=at("br"),P=(e,t)=>a(t)&&t.nodeName in e.schema.getTextBlockElements(),Oe=(e,t)=>a(e)&&e.nodeName in t,l=(e,t,n)=>{const s=e.isEmpty(t);return!(n&&e.select("span[data-mce-type=bookmark]",t).length>0)&&s},Ce=(e,t)=>e.isChildOf(t,e.getRoot()),se=e=>t=>t.options.get(e),Rt=se("lists_indent_on_tab"),Nt=se("forced_root_block"),Dt=se("forced_root_block_attrs"),Me=(e,t)=>{const o=e.dom,r=e.schema.getBlockElements(),i=o.createFragment(),c=Nt(e),l=Dt(e);let s,n,a=!1;for(n=o.create(c,l),Oe(t.firstChild,r)||i.appendChild(n);s=t.firstChild;){const e=s.nodeName;a||"SPAN"===e&&"bookmark"===s.getAttribute("data-mce-type")||(a=!0),Oe(s,r)?(i.appendChild(s),n=null):(n||(n=o.create(c,l),i.appendChild(n)),n.appendChild(s))}return!a&&n&&n.appendChild(o.create("br",{"data-mce-bogus":"1"})),i},r=F.DOM,Tt=be("dd"),ze=be("dt"),Et=(n,o)=>{var i;Tt(o)?ce(o,"dt"):ze(o)&&(i=o,e.from(i.dom.parentElement).map(t)).each(e=>((e,t,n)=>{const c=r.select('span[data-mce-type="bookmark"]',t),d=Me(e,n),o=r.createRng();o.setStartAfter(n),o.setEndAfter(t);const i=o.extractContents();for(let t=i.firstChild;t;t=t.firstChild)if("LI"===t.nodeName&&e.dom.isEmpty(t)){r.remove(t);break}e.dom.isEmpty(i)||r.insertAfter(i,t),r.insertAfter(d,t);const a=n.parentElement;a&&l(e.dom,a)&&(e=>{const t=e.parentNode;t&&s.each(c,e=>{t.insertBefore(e,n.parentNode)}),r.remove(e)})(a),r.remove(n),l(e.dom,t)&&r.remove(t)})(n,e.dom,o.dom))},jt=e=>{ze(e)&&ce(e,"dd")},Le=(e,t)=>{if(u(e))return{container:e,offset:t};const n=ht.getNode(e,t);return u(n)?{container:n,offset:t>=e.childNodes.length?n.data.length:0}:n.previousSibling&&u(n.previousSibling)?{container:n.previousSibling,offset:n.previousSibling.data.length}:n.nextSibling&&u(n.nextSibling)?{container:n.nextSibling,offset:0}:{container:e,offset:t}},A=e=>{const t=e.cloneRange(),n=Le(e.startContainer,e.startOffset);t.setStart(n.container,n.offset);const s=Le(e.endContainer,e.endOffset);return t.setEnd(s.container,s.offset),t},Pe=["OL","UL","DL"],He=Pe.join(","),d=(e,t)=>{const n=t||e.selection.getStart(!0);return e.dom.getParent(n,He,D(e,n))},ne=e=>{const t=e.selection.getSelectedBlocks();return f(((e,t)=>{const n=s.map(t,t=>e.dom.getParent(t,"li,dd,dt",D(e,t))||t);return pe(n)})(e,t),re)},ee=(e,t)=>{const n=e.dom.getParents(t,"TD,TH");return n.length>0?n[0]:e.getBody()},D=(e,t)=>{const s=e.dom.getParents(t,e.dom.isBlock),o=le(s,t=>{return o=e.schema,!n(s=t)&&!re(s)&&xe(Pe,e=>o.isValidChild(s.nodeName,e));var s,o});return o.getOr(e.getBody())},We=(e,t)=>{const n=e.dom.getParents(t,"ol,ul",D(e,t));return x(n)},Ct=(e,t)=>{const n=i(t,t=>We(e,t).getOr(t));return pe(n)},Ke=e=>/\btox-/.test(e.className),qe=(e,t)=>O(e,n,Ht).exists(e=>e.nodeName===t&&!Ke(e)),Ye=(e,t)=>null!==t&&"false"===e.dom.getContentEditableParent(t),h=(e,t)=>{const n=e.dom.getParent(t,"ol,ul,dl");return Ye(e,n)},Xe=(e,t)=>{const n=e.selection.getNode();return t({parents:e.dom.getParents(n),element:n}),e.on("NodeChange",t),()=>e.off("NodeChange",t)},p=(e,t,n)=>e.dispatch("ListMutation",{action:t,element:n}),xt=(Je=/^\s+|\s+$/g,e=>e.replace(Je,"")),zt=(e,t,n)=>{((e,t,n)=>{if(!rt(n))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",n,":: Element ",e),new Error("CSS value must be a string: "+n);(e=>void 0!==e.style&&C(e.style.getPropertyValue))(e)&&e.style.setProperty(t,n)})(e.dom,t,n)},Re=(e,t)=>{v(e.item,t.list)},Wt=(e,t)=>{const n={list:N(t,e),item:N("li",e)};return v(n.list,n.item),n},g=e=>((e,t)=>{const n=e.dom;if(1!==n.nodeType)return!1;{const e=n;if(void 0!==e.matches)return e.matches(t);if(void 0!==e.msMatchesSelector)return e.msMatchesSelector(t);if(void 0!==e.webkitMatchesSelector)return e.webkitMatchesSelector(t);if(void 0!==e.mozMatchesSelector)return e.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")}})(e,"OL,UL"),ot=e=>Ee(e).exists(g),it=e=>e.depth>0,wt=e=>e.isSelected,yt=e=>{const t=R(e),n=Ae(e).exists(g)?t.slice(0,-1):t;return i(n,Vt)},ct=e=>(o(e,(t,n)=>{((e,t)=>{const n=e[t].depth,s=e=>e.depth===n&&!e.dirty,o=e=>e.depth<n;return O(ue(e.slice(0,t)),s,o).orThunk(()=>O(e.slice(t+1),s,o))})(e,n).fold(()=>{t.dirty&&(e=>{e.listAttributes=((e,t)=>{const n={};var s;return((e,t,n,s)=>{oe(e,(e,o)=>{(t(e,o)?n:s)(e,o)})})(e,t,(s=n,(e,t)=>{s[t]=e}),At),n})(e.listAttributes,(e,t)=>"start"!==t)})(t)},e=>{return n=e,(s=t).listType=n.listType,void(s.listAttributes={...n.listAttributes});var n,s})}),e),bt=(e,t,n,s)=>Ee(s).filter(g).fold(()=>{t.each(e=>{V(e.start,s)&&n.set(!0)});const o=((e,t,n)=>B(e).filter(dt).map(s=>({depth:t,dirty:!1,isSelected:n,content:yt(e),itemAttributes:ae(e),listAttributes:ae(s),listType:k(s)})))(s,e,n.get());t.each(e=>{V(e.end,s)&&n.set(!1)});const i=Ae(s).filter(g).map(s=>T(e,t,n,s)).getOr([]);return o.toArray().concat(i)},s=>T(e,t,n,s)),T=(e,t,n,s)=>fe(R(s),s=>(g(s)?T:bt)(e+1,t,n,s)),pt=(e,t)=>{const n=ct(t);return((e,t)=>{const n=ie(t,(t,n)=>n.depth>t.length?((e,t,n)=>{const s=((e,t,n)=>{const s=[];for(let o=0;o<n;o++)s.push(Wt(e,t.listType));return s})(e,n,n.depth-t.length);var o;return(e=>{for(let t=1;t<e.length;t++)Re(e[t-1],e[t])})(s),((e,t)=>{for(let t=0;t<e.length-1;t++)zt(e[t].item,"list-style-type","none");x(e).each(e=>{b(e.list,t.listAttributes),b(e.item,t.itemAttributes),X(e.item,t.content)})})(s,n),o=s,te(x(t),de(o),Re),t.concat(s)})(e,t,n):((e,t,n)=>{const s=t.slice(0,n.depth);return x(s).each(t=>{const s=((e,t,n)=>{const s=N("li",e);return b(s,t),X(s,n),s})(e,n.itemAttributes,n.content);((e,t)=>{v(e.list,t),e.item=t})(t,s),((e,t)=>{k(e.list)!==t.listType&&(e.list=ce(e.list,t.listType)),b(e.list,t.listAttributes)})(t,n)}),s})(e,t,n),[]);return de(n).map(e=>e.list)})(e.contentDocument,n).toArray()},Mt=(e,n,s)=>{const a=((e,t)=>{const n=(e=>{let t=!1;return{get:()=>t,set:e=>{t=e}}})();return i(e,e=>({sourceList:e,entries:T(0,t,n,e)}))})(n,(e=>{const n=i(ne(e),t);return te(le(n,Qe(ot)),le(ue(n),Qe(ot)),(e,t)=>({start:e,end:t}))})(e));o(a,n=>{((e,t)=>{o(f(e,wt),e=>((e,t)=>{switch(e){case"Indent":t.depth++;break;case"Outdent":t.depth--;break;case"Flatten":t.depth=0}t.dirty=!0})(t,e))})(n.entries,s);const a=((e,n)=>fe(((e,t)=>{if(0===e.length)return[];{let o=t(e[0]);const s=[];let n=[];for(let i=0,c=e.length;i<c;i++){const a=e[i],r=t(a);r!==o&&(s.push(n),n=[]),o=r,n.push(a)}return 0!==n.length&&s.push(n),s}})(n,it),n=>de(n).exists(it)?pt(e,n):((e,n)=>{const s=ct(n);return i(s,n=>{const s=((e)=>{const s=document.createDocumentFragment();return o(e,e=>{s.appendChild(e.dom)}),t(s)})(n.content);return t(Me(e,s.dom))})})(e,n)))(e,n.entries);var r;o(a,t=>{p(e,"Indent"===s?"IndentList":"OutdentList",t.dom)}),r=n.sourceList,o(a,e=>{$e(r,e)}),Z(n.sourceList)})},gt=(e,t)=>{const n=Be((e=>{const t=(e=>{const t=We(e,e.selection.getStart()),n=f(e.selection.getSelectedBlocks(),$t);return t.toArray().concat(n)})(e);return Ct(e,t)})(e)),s=Be((e=>f(ne(e),It))(e));let i=!1;if(n.length||s.length){const a=e.selection.getBookmark();Mt(e,n,t),((e,t,n)=>{o(n,"Indent"===t?jt:t=>Et(e,t))})(e,t,s),e.selection.moveToBookmark(a),e.selection.setRng(A(e.selection.getRng())),e.nodeChanged(),i=!0}return i},J=(e,t)=>!(e=>{const t=d(e);return Ye(e,t)})(e)&&gt(e,t),ut=e=>J(e,"Indent"),H=e=>J(e,"Outdent"),E=e=>J(e,"Flatten");lt=tinymce.util.Tools.resolve("tinymce.dom.BookmarkManager");const m=F.DOM,w=e=>{const t={},n=n=>{let s=e[n?"startContainer":"endContainer"],o=e[n?"startOffset":"endOffset"];if(y(s)){const e=m.create("span",{"data-mce-type":"bookmark"});s.hasChildNodes()?(o=Math.min(o,s.childNodes.length-1),n?s.insertBefore(e,s.childNodes[o]):m.insertAfter(e,s.childNodes[o])):s.appendChild(e),s=e,o=0}t[n?"startContainer":"endContainer"]=s,t[n?"startOffset":"endOffset"]=o};return n(!0),e.collapsed||n(),t},_=e=>{const n=t=>{let n=e[t?"startContainer":"endContainer"],s=e[t?"startOffset":"endOffset"];if(n){if(y(n)&&n.parentNode){const e=n;s=(e=>{let t=null===(n=e.parentNode)||void 0===n?void 0:n.firstChild,s=0;for(var n;t;){if(t===e)return s;y(t)&&"bookmark"===t.getAttribute("data-mce-type")||s++,t=t.nextSibling}return-1})(n),n=n.parentNode,m.remove(e),!n.hasChildNodes()&&m.isBlock(n)&&n.appendChild(m.create("br"))}e[t?"startContainer":"endContainer"]=n,e[t?"startOffset":"endOffset"]=s}};n(!0),n();const t=m.createRng();return t.setStart(e.startContainer,e.startOffset),e.endContainer&&t.setEnd(e.endContainer,e.endOffset),A(t)},S=e=>{switch(e){case"UL":return"ToggleUlList";case"OL":return"ToggleOlList";case"DL":return"ToggleDLList"}},tt=(e,t)=>{s.each(t,(t,n)=>{e.setAttribute(n,t)})},L=(e,t,n)=>{((e,t,n)=>{const s=n["list-style-type"]?n["list-style-type"]:null;e.setStyle(t,"list-style-type",s)})(e,t,n),((e,t,n)=>{tt(t,n["list-attributes"]),s.each(e.select("li",t),e=>{tt(e,n["list-item-attributes"])})})(e,t,n)},Ue=(e,t,n,s)=>{let o=t[n?"startContainer":"endContainer"];const i=t[n?"startOffset":"endOffset"];for(y(o)&&(o=o.childNodes[Math.min(i,o.childNodes.length-1)]||o),!n&&c(o.nextSibling)&&(o=o.nextSibling);o.parentNode!==s;){const t=o.parentNode;if(P(e,o))return o;if(/^(TD|TH)$/.test(t.nodeName))return o;o=t}return o},Y=(e,t,o)=>{const r=e.selection.getRng();let a="LI";const l=D(e,e.selection.getStart(!0)),i=e.dom;if("false"===i.getContentEditable(e.selection.getNode()))return;"DL"===(t=t.toUpperCase())&&(a="DT");const d=w(r),u=((e,t,o)=>{const a=[],r=e.dom,d=Ue(e,t,!0,o),u=Ue(e,t,!1,o);let i;const l=[];for(let e=d;e&&(l.push(e),e!==u);e=e.nextSibling);return s.each(l,t=>{var s;if(P(e,t))return a.push(t),void(i=null);if(r.isBlock(t)||c(t))return c(t)&&r.remove(t),void(i=null);const l=t.nextSibling;lt.isBookmarkNode(t)&&(n(l)||P(e,l)||!l&&t.parentNode===o)?i=null:(i||(i=r.create("p"),null===(s=t.parentNode)||void 0===s||s.insertBefore(i,t),a.push(i)),i.appendChild(t))}),a})(e,r,l);s.each(u,r=>{let c;const l=r.previousSibling,d=r.parentNode;re(d)||(l&&n(l)&&l.nodeName===t&&((e,t,n)=>{const o=e.getStyle(t,"list-style-type");let s=n?n["list-style-type"]:"";return s=null===s?"":s,o===s})(i,l,o)?(c=l,r=i.rename(r,a),l.appendChild(r)):(c=i.create(t),d.insertBefore(c,r),c.appendChild(r),r=i.rename(r,a)),((e,t)=>{s.each(["margin","margin-right","margin-bottom","margin-left","margin-top","padding","padding-right","padding-bottom","padding-left","padding-top"],n=>e.setStyle(t,n,""))})(i,r),L(i,c,o),q(e.dom,c))}),e.selection.setRng(_(d))},Ve=(e,t,s)=>{return((e,t)=>n(e)&&e.nodeName===t?.nodeName)(t,s)&&((e,t,n)=>e.getStyle(t,"list-style-type",!0)===e.getStyle(n,"list-style-type",!0))(e,t,s)&&(o=s,t.className===o.className);var o},q=(e,t)=>{let s,n=t.nextSibling;if(Ve(e,t,n)){const o=n;for(;s=o.firstChild;)t.appendChild(s);e.remove(o)}if(n=t.previousSibling,Ve(e,t,n)){const o=n;for(;s=o.lastChild;)t.insertBefore(s,t.firstChild);e.remove(o)}},Ne=e=>"list-style-type"in e,K=(e,t,o)=>{const i=d(e);if(h(e,i))return;const r=(e=>{const t=d(e),s=e.selection.getSelectedBlocks();return((e,t)=>a(e)&&1===t.length&&t[0]===e)(t,s)?(e=>f(e.querySelectorAll(He),n))(t):f(s,e=>n(e)&&t!==e)})(e),c=M(o)?o:{};r.length>0?((e,t,o,i,a)=>{const r=n(t);if(r&&t.nodeName===i&&!Ne(a))E(e);else{Y(e,i,a);const n=w(e.selection.getRng()),c=r?[t,...o]:o;s.each(c,t=>{((e,t,n,s)=>{if(t.nodeName!==n){const o=e.dom.rename(t,n);L(e.dom,o,s),p(e,S(n),o)}else L(e.dom,t,s),p(e,S(n),t)})(e,t,i,a)}),e.selection.setRng(_(n))}})(e,i,r,t,c):((e,t,n,s)=>{if(t!==e.getBody())if(t)if(t.nodeName!==n||Ne(s)||Ke(t)){const i=w(e.selection.getRng());L(e.dom,t,s);const o=e.dom.rename(t,n);q(e.dom,o),e.selection.setRng(_(i)),Y(e,n,s),p(e,S(n),o)}else E(e);else Y(e,n,s),p(e,S(n),t)})(e,i,t,c)},De=F.DOM,Te=(e,t)=>{const o=s.grep(e.select("ol,ul",t));s.each(o,t=>{((e,t)=>{const s=t.parentElement;if(s&&"LI"===s.nodeName&&s.firstChild===t){const n=s.previousSibling;n&&"LI"===n.nodeName?(n.appendChild(t),l(e,s)&&De.remove(s)):De.setStyle(s,"listStyleType","none")}if(n(s)){const e=s.previousSibling;e&&"LI"===e.nodeName&&e.appendChild(t)}})(e,t)})},Fe=(e,t,n,s)=>{let o=t.startContainer;const a=t.startOffset;if(u(o)&&(n?a<o.data.length:a>0))return o;const r=e.schema.getNonEmptyElements();y(o)&&(o=ht.getNode(o,a));const i=new kt(o,s);n&&((e,t)=>!!c(t)&&e.isBlock(t.nextSibling)&&!c(t.previousSibling))(e.dom,o)&&i.next();const l=n?i.next.bind(i):i.prev2.bind(i);for(;o=l();){if("LI"===o.nodeName&&!o.hasChildNodes())return o;if(r[o.nodeName])return o;if(u(o)&&o.data.length>0)return o}return null},Se=(e,t)=>{const s=t.childNodes;return 1===s.length&&!n(s[0])&&e.isBlock(s[0])},U=(e,s,i)=>{let a;const r=s.parentNode;if(!Ce(e,s)||!Ce(e,i))return;n(i.lastChild)&&(a=i.lastChild),r===i.lastChild&&c(r.previousSibling)&&e.remove(r.previousSibling);const d=i.lastChild;d&&c(d)&&s.hasChildNodes()&&e.remove(d),l(e,i,!0)&&me(t(i)),((e,t,n)=>{let s;const o=Se(e,n)?n.firstChild:n;if(((e,t)=>{Se(e,t)&&e.remove(t.firstChild,!0)})(e,t),!l(e,t,!0))for(;s=t.firstChild;)o.appendChild(s)})(e,s,i),a&&i.appendChild(a);const u=((e,t)=>{const n=e.dom,s=t.dom;return n!==s&&n.contains(s)})(t(i),t(s))?e.getParents(s,n,i):[];e.remove(s),o(u,t=>{l(e,t)&&t!==e.getRoot()&&e.remove(t)})},Lt=(e,n)=>{const o=e.dom,i=e.selection,r=i.getStart(),a=ee(e,r),s=o.getParent(i.getStart(),"LI",a);if(s){const d=s.parentElement;if(d===e.getBody()&&l(o,d))return!0;const r=A(i.getRng()),c=o.getParent(Fe(e,r,n,a),"LI",a);if(c&&c!==s)return e.undoManager.transact(()=>{var o,i;n?((e,n,s,o)=>{const i=e.dom;if(i.isEmpty(o))((e,n,s)=>{me(t(s)),U(e.dom,n,s),e.selection.setCursorLocation(s,0)})(e,s,o);else{const t=w(n);U(i,s,o),e.selection.setRng(_(t))}})(e,r,c,s):(null===(o=(i=s).parentNode)||void 0===o?void 0:o.firstChild)===i?H(e):((e,t,n,s)=>{const o=w(t);U(e.dom,n,s);const i=_(o);e.selection.setRng(i)})(e,r,s,c)}),!0;if(!c&&!n&&0===r.startOffset&&0===r.endOffset)return e.undoManager.transact(()=>{E(e)}),!0}return!1},ke=e=>{const t=e.selection.getStart(),n=ee(e,t);return e.dom.getParent(t,"LI,DT,DD",n)||ne(e).length>0},W=(e,n)=>{const s=e.selection;return!h(e,s.getNode())&&(s.isCollapsed()?((e,n)=>Lt(e,n)||((e,n)=>{const s=e.dom,a=e.selection.getStart(),o=ee(e,a),i=s.getParent(a,s.isBlock,o);if(i&&s.isEmpty(i)){const r=A(e.selection.getRng()),a=s.getParent(Fe(e,r,n,o),"LI",o);if(a){const c=e=>et(["td","th","caption"],k(e)),l=e=>e.dom===o;return!!((e,t,n=st)=>te(e,t,n).getOr(e.isNone()&&t.isNone()))(Ie(t(a),c,l),Ie(t(r.startContainer),c,l),V)&&(e.undoManager.transact(()=>{((e,t,n)=>{const s=e.getParent(t.parentNode,e.isBlock,n);e.remove(t),s&&e.isEmpty(s)&&e.remove(s)})(s,i,o),q(s,a.parentNode),e.selection.select(a,!0),e.selection.collapse(n)}),!0)}}return!1})(e,n))(e,n):(e=>!!ke(e)&&(e.undoManager.transact(()=>{e.execCommand("Delete"),Te(e.dom,e.getBody())}),!0))(e))},ye=e=>{const t=ue(xt(e).split("")),n=i(t,(e,t)=>{const n=e.toUpperCase().charCodeAt(0)-"A".charCodeAt(0)+1;return Math.pow(26,t)*n});return ie(n,(e,t)=>e+t,0)},$=e=>{if(--e<0)return"";{const t=e%26,n=Math.floor(e/26);return $(n)+String.fromCharCode("A".charCodeAt(0)+t)}},Bt=e=>{const t=parseInt(e.start,10);return _e(e.listStyleType,"upper-alpha")?$(t):_e(e.listStyleType,"lower-alpha")?$(t).toLowerCase():e.start},I=(e,t)=>()=>{const n=d(e);return a(n)&&n.nodeName===t},ge=t=>{t.addCommand("mceListProps",()=>{(t=>{const n=d(t);ve(n)&&!h(t,n)&&t.windowManager.open({title:"List Properties",body:{type:"panel",items:[{type:"input",name:"start",label:"Start list at number",inputMode:"numeric"}]},initialData:{start:Bt({start:t.dom.getAttrib(n,"start","1"),listStyleType:e.from(t.dom.getStyle(n,"list-style-type"))})},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],onSubmit:n=>{(t=>{switch((e=>/^[0-9]+$/.test(e)?2:/^[A-Z]+$/.test(e)?0:/^[a-z]+$/.test(e)?1:e.length>0?4:3)(t)){case 2:return e.some({listStyleType:e.none(),start:t});case 0:return e.some({listStyleType:e.some("upper-alpha"),start:ye(t).toString()});case 1:return e.some({listStyleType:e.some("lower-alpha"),start:ye(t).toString()});case 3:return e.some({listStyleType:e.none(),start:""});case 4:return e.none()}})(n.getData().start).each(e=>{t.execCommand("mceListUpdate",!1,{attrs:{start:"1"===e.start?"":e.start},styles:{"list-style-type":e.listStyleType.getOr("")}})}),n.close()}})})(t)})},nt=(e,t)=>n=>Xe(e,s=>{n.setActive(qe(s.parents,t)),n.setEnabled(!h(e,s.element))}),Ut=(e,t)=>n=>Xe(e,s=>n.setEnabled(qe(s.parents,t)&&!h(e,s.element)));we.add("lists",e=>((e=>{(0,e.options.register)("lists_indent_on_tab",{processor:"boolean",default:!0})})(e),e.hasPlugin("rtc",!0)?ge(e):((e=>{Rt(e)&&(e=>{e.on("keydown",t=>{t.keyCode!==z.TAB||z.metaKeyPressed(t)||e.undoManager.transact(()=>{(t.shiftKey?H(e):ut(e))&&t.preventDefault()})})})(e),(e=>{e.on("ExecCommand",t=>{const n=t.command.toLowerCase();"delete"!==n&&"forwarddelete"!==n||!ke(e)||Te(e.dom,e.getBody())}),e.on("keydown",t=>{t.keyCode===z.BACKSPACE?W(e,!1)&&t.preventDefault():t.keyCode===z.DELETE&&W(e,!0)&&t.preventDefault()})})(e)})(e),(e=>{e.on("BeforeExecCommand",t=>{const n=t.command.toLowerCase();"indent"===n?ut(e):"outdent"===n&&H(e)}),e.addCommand("InsertUnorderedList",(t,n)=>{K(e,"UL",n)}),e.addCommand("InsertOrderedList",(t,n)=>{K(e,"OL",n)}),e.addCommand("InsertDefinitionList",(t,n)=>{K(e,"DL",n)}),e.addCommand("RemoveList",()=>{E(e)}),ge(e),e.addCommand("mceListUpdate",(t,n)=>{M(n)&&((e,t)=>{const n=d(e);null===n||h(e,n)||e.undoManager.transact(()=>{M(t.styles)&&e.dom.setStyles(n,t.styles),M(t.attrs)&&oe(t.attrs,(t,s)=>e.dom.setAttrib(n,s,t))})})(e,n)}),e.addQueryStateHandler("InsertUnorderedList",I(e,"UL")),e.addQueryStateHandler("InsertOrderedList",I(e,"OL")),e.addQueryStateHandler("InsertDefinitionList",I(e,"DL"))})(e)),(e=>{const t=t=>()=>e.execCommand(t);e.hasPlugin("advlist")||(e.ui.registry.addToggleButton("numlist",{icon:"ordered-list",active:!1,tooltip:"Numbered list",onAction:t("InsertOrderedList"),onSetup:nt(e,"OL")}),e.ui.registry.addToggleButton("bullist",{icon:"unordered-list",active:!1,tooltip:"Bullet list",onAction:t("InsertUnorderedList"),onSetup:nt(e,"UL")}))})(e),(e=>{const t={text:"List properties...",icon:"ordered-list",onAction:()=>e.execCommand("mceListProps"),onSetup:Ut(e,"OL")};e.ui.registry.addMenuItem("listprops",t),e.ui.registry.addContextMenu("lists",{update:t=>{const n=d(e,t);return ve(n)?["listprops"]:[]}})})(e),(e=>({backspaceDelete:t=>{W(e,t)}}))(e)))}()