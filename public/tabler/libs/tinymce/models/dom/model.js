(function(){"use strict";var Y4=tinymce.util.Tools.resolve("tinymce.ModelManager"),zn,ar,Ze,Be,Ui,ic;const Dm=(e,t,n)=>{var s;return!!n(e,t.prototype)||((s=e.constructor)===null||s===void 0?void 0:s.name)===t.name},Am=e=>{const t=typeof e;return e===null?"null":t==="object"&&Array.isArray(e)?"array":t==="object"&&Dm(e,String,(e,t)=>t.isPrototypeOf(e))?"string":t},bs=e=>t=>Am(t)===e,ps=e=>t=>typeof t===e,qr=e=>t=>e===t,rt=bs("string"),km=bs("object"),Xt=bs("array"),Om=qr(null),um=ps("boolean"),dm=qr(void 0),am=e=>e==null,Qe=e=>!am(e),ve=ps("function"),Sn=ps("number"),o=()=>{},im=(e,t)=>(...n)=>e(t.apply(null,n)),nm=(e,t)=>n=>e(t(n)),n=e=>()=>e,h=e=>e,tm=(e,t)=>e===t;function O(e,...t){return(...n)=>{const s=t.concat(n);return e.apply(null,s)}}const Dn=e=>t=>!e(t),em=e=>()=>{throw new Error(e)},ja=e=>e(),B=n(!1),r=n(!0);class e{constructor(e,t){this.tag=e,this.value=t}static some(t){return new e(!0,t)}static none(){return e.singletonNone}fold(e,t){return this.tag?t(this.value):e()}isSome(){return this.tag}isNone(){return!this.tag}map(t){return this.tag?e.some(t(this.value)):e.none()}bind(t){return this.tag?t(this.value):e.none()}exists(e){return this.tag&&e(this.value)}forall(e){return!this.tag||e(this.value)}filter(t){return!this.tag||t(this.value)?this:e.none()}getOr(e){return this.tag?this.value:e}or(e){return this.tag?this:e}getOrThunk(e){return this.tag?this.value:e()}orThunk(e){return this.tag?this:e()}getOrDie(e){if(this.tag)return this.value;throw new Error(e??"Called getOrDie on None")}static from(t){return Qe(t)?e.some(t):e.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(e){this.tag&&e(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}e.singletonNone=new e(!1);const va=Array.prototype.slice,Jh=Array.prototype.indexOf,Yh=Array.prototype.push,Uh=(e,t)=>Jh.call(e,t),f=(e,t)=>Uh(e,t)>-1,D=(e,t)=>{for(let n=0,s=e.length;n<s;n++){const o=e[n];if(t(o,n))return!0}return!1},N=(e,t)=>{const n=[];for(let s=0;s<e;s++)n.push(t(s));return n},s=(e,t)=>{const n=e.length,s=new Array(n);for(let o=0;o<n;o++){const i=e[o];s[o]=t(i,o)}return s},i=(e,t)=>{for(let n=0,s=e.length;n<s;n++){const o=e[n];t(o,n)}},Hh=(e,t)=>{for(let n=e.length-1;n>=0;n--){const s=e[n];t(s,n)}},Si=(e,t)=>{const n=[],s=[];for(let o=0,a=e.length;o<a;o++){const i=e[o],r=t(i,o)?n:s;r.push(i)}return{pass:n,fail:s}},p=(e,t)=>{const n=[];for(let s=0,i=e.length;s<i;s++){const o=e[s];t(o,s)&&n.push(o)}return n},V=(e,t,n)=>(Hh(e,(e,s)=>{n=t(n,e,s)}),n),$=(e,t,n)=>(i(e,(e,s)=>{n=t(n,e,s)}),n),Rh=(t,n,s)=>{for(let o=0,a=t.length;o<a;o++){const i=t[o];if(n(i,o))return e.some(i);if(s(i,o))break}return e.none()},W=(e,t)=>Rh(e,t,B),xs=(t,n)=>{for(let s=0,o=t.length;s<o;s++){const i=t[s];if(n(i,s))return e.some(s)}return e.none()},ji=e=>{const t=[];for(let n=0,s=e.length;n<s;++n){if(!Xt(e[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+e);Yh.apply(t,e[n])}return t},_=(e,t)=>ji(s(e,t)),H=(e,t)=>{for(let n=0,s=e.length;n<s;++n){const o=e[n];if(t(o,n)!==!0)return!1}return!0},Sh=e=>{const t=va.call(e,0);return t.reverse(),t},zs=(e,t)=>{const n={};for(let s=0,i=e.length;s<i;s++){const o=e[s];n[String(o)]=t(o,s)}return n},yh=(e,t)=>{const n=va.call(e,0);return n.sort(t),n},$o=(t,n)=>n>=0&&n<t.length?e.some(t[n]):e.none(),Ct=e=>$o(e,0),Po=e=>$o(e,e.length-1),te=(t,n)=>{for(let e=0;e<t.length;e++){const s=n(t[e],e);if(s.isSome())return s}return e.none()},at=Object.keys,Ao=Object.hasOwnProperty,T=(e,t)=>{const n=at(e);for(let s=0,i=n.length;s<i;s++){const o=n[s],a=e[o];t(a,o)}},go=(e,t)=>bh(e,(e,n)=>({k:n,v:t(e,n)})),bh=(e,t)=>{const n={};return T(e,(e,s)=>{const o=t(e,s);n[o.k]=o.v}),n},vh=e=>(t,n)=>{e[n]=t},ph=(e,t,n,s)=>{T(e,(e,o)=>{(t(e,o)?n:s)(e,o)})},fh=(e,t)=>{const n={};return ph(e,t,vh(n),o),n},uo=(e,t)=>{const n=[];return T(e,(e,s)=>{n.push(t(e,s))}),n},lo=e=>uo(e,h),mh=(t,n)=>Js(t,n)?e.from(t[n]):e.none(),Js=(e,t)=>Ao.call(e,t),rh=(e,t)=>Js(e,t)&&e[t]!==void 0&&e[t]!==null,U3=e=>{for(const t in e)if(Ao.call(e,t))return!1;return!0};typeof window!="undefined"?window:Function("return this;")();const V3=8,co=9,fo=11,Ys=1,P3=3,l=e=>{const t=e.dom.nodeName;return t.toLowerCase()},To=e=>e.dom.nodeType,Pt=e=>t=>To(t)===e,N3=e=>To(e)===V3||l(e)==="#comment",Y=Pt(Ys),_e=Pt(P3),Gi=Pt(co),F3=Pt(fo),I=e=>t=>Y(t)&&l(t)===e,ls=(e,t,n)=>{if(rt(n)||um(n)||Sn(n))e.setAttribute(t,n+"");else throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",n,":: Element ",e),new Error("Attribute value was not simple")},g=(e,t,n)=>{ls(e.dom,t,n)},We=(e,t)=>{const n=e.dom;T(t,(e,t)=>{ls(n,t,e)})},M3=(e,t)=>{T(t,(t,n)=>{t.fold(()=>{d(e,n)},t=>{ls(e.dom,n,t)})})},De=(e,t)=>{const n=e.dom.getAttribute(t);return n===null?void 0:n},re=(t,n)=>e.from(De(t,n)),d=(e,t)=>{e.dom.removeAttribute(t)},Oa=e=>$(e.dom.attributes,(e,t)=>(e[t.name]=t.value,e),{}),E3=(e,t)=>{const s=t||document,n=s.createElement("div");if(n.innerHTML=e,!n.hasChildNodes()||n.childNodes.length>1){const t="HTML does not have a single root node";throw console.error(t,e),new Error(t)}return gt(n.childNodes[0])},x3=(e,t)=>{const n=t||document,s=n.createElement(e);return gt(s)},w3=(e,t)=>{const n=t||document,s=n.createTextNode(e);return gt(s)},gt=e=>{if(e==null)throw new Error("Node cannot be null or undefined");return{dom:e}},_3=(t,n,s)=>e.from(t.dom.elementFromPoint(n,s)).map(gt),t={fromHtml:E3,fromTag:x3,fromText:w3,fromDom:gt,fromPoint:_3},F=(e,t)=>{const s=e.dom;if(s.nodeType!==Ys)return!1;const n=s;if(n.matches!==void 0)return n.matches(t);if(n.msMatchesSelector!==void 0)return n.msMatchesSelector(t);if(n.webkitMatchesSelector!==void 0)return n.webkitMatchesSelector(t);if(n.mozMatchesSelector!==void 0)return n.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")},Ga=e=>e.nodeType!==Ys&&e.nodeType!==co&&e.nodeType!==fo||e.childElementCount===0,y3=(e,n)=>{const o=n===void 0?document:n.dom;return Ga(o)?[]:s(o.querySelectorAll(e),t.fromDom)},sr=(n,s)=>{const o=s===void 0?document:s.dom;return Ga(o)?e.none():e.from(o.querySelector(n)).map(t.fromDom)},c=(e,t)=>e.dom===t.dom,Cn=(e,t)=>{const n=e.dom,s=t.dom;return n!==s&&n.contains(s)},j3=F,mn=e=>t.fromDom(e.dom.ownerDocument),hn=e=>Gi(e)?e:mn(e),v3=e=>t.fromDom(hn(e).dom.documentElement),g3=e=>t.fromDom(hn(e).dom.defaultView),pe=n=>e.from(n.dom.parentNode).map(t.fromDom),p3=n=>e.from(n.dom.parentElement).map(t.fromDom),kr=(e,n)=>{const i=ve(n)?n:B;let s=e.dom;const o=[];for(;s.parentNode!==null&&s.parentNode!==void 0;){const e=s.parentNode,n=t.fromDom(e);if(o.push(n),i(n)===!0)break;s=e}return o},Fr=n=>e.from(n.dom.previousSibling).map(t.fromDom),Gt=n=>e.from(n.dom.nextSibling).map(t.fromDom),z=e=>s(e.dom.childNodes,t.fromDom),Yt=(n,s)=>{const o=n.dom.childNodes;return e.from(o[s]).map(t.fromDom)},d3=e=>Yt(e,0),Lt=(e,t)=>{const n=pe(e);n.each(n=>{n.dom.insertBefore(t.dom,e.dom)})},dt=(e,t)=>{const n=Gt(e);n.fold(()=>{const n=pe(e);n.each(e=>{u(e,t)})},e=>{Lt(e,t)})},Os=(e,t)=>{const n=d3(e);n.fold(()=>{u(e,t)},n=>{e.dom.insertBefore(t.dom,n.dom)})},u=(e,t)=>{e.dom.appendChild(t.dom)},i3=(e,t,n)=>{Yt(e,n).fold(()=>{u(e,t)},e=>{Lt(e,t)})},Q2=(e,t)=>{Lt(e,t),u(t,e)},gc=(e,t)=>{i(t,(n,s)=>{const o=s===0?e:t[s-1];dt(o,n)})},se=(e,t)=>{i(t,t=>{u(e,t)})},Rs=e=>{e.dom.textContent="",i(z(e),e=>{C(e)})},C=e=>{const t=e.dom;t.parentNode!==null&&t.parentNode.removeChild(t)},K2=e=>{const t=z(e);t.length>0&&gc(e,t),C(e)},yc=(e,n)=>t.fromDom(e.dom.cloneNode(n)),jc=e=>yc(e,!1),xe=e=>yc(e,!0),pc=(e,n)=>{const s=t.fromTag(n),o=Oa(e);return We(s,o),s},U2=(e,t)=>{const n=pc(e,t),s=z(xe(e));return se(n,s),n},W2=(e,t)=>{const n=pc(e,t);dt(e,n);const s=z(e);return se(n,s),C(e),n},$2=["tfoot","thead","tbody","colgroup"],V2=e=>f($2,e),B2=(e,t)=>({rows:e,columns:t}),H2=(e,t)=>({row:e,column:t}),rc=(e,t,n)=>({element:e,rowspan:t,colspan:n}),P2=(e,t,n,s)=>({element:e,rowspan:t,colspan:n,isNew:s}),L2=(e,t,n,s,o,i)=>({element:e,rowspan:t,colspan:n,row:s,column:o,isLocked:i}),As=(e,t,n)=>({element:e,cells:t,section:n}),N2=(e,t,n,s)=>({element:e,cells:t,section:n,isNew:s}),k=(e,t,n)=>({element:e,isNew:t,isLocked:n}),he=(e,t,n,s)=>({element:e,cells:t,section:n,isNew:s}),T2=(e,t,n,s)=>({startRow:e,startCol:t,finishRow:n,finishCol:s}),F2=(e,t,n)=>({element:e,colspan:t,column:n}),k2=(e,t)=>({element:e,columns:t}),E2=e=>F3(e)&&Qe(e.dom.host),$r=ve(Element.prototype.attachShadow)&&ve(Node.prototype.getRootNode),C2=n($r),w2=$r?e=>t.fromDom(e.dom.getRootNode()):hn,_2=t=>{const n=w2(t);return E2(n)?e.some(n):e.none()},j2=e=>t.fromDom(e.dom.host),h2=n=>{if(C2()&&Qe(n.target)){const e=t.fromDom(n.target);if(Y(e)&&d2(e)&&n.composed&&n.composedPath){const e=n.composedPath();if(e)return Ct(e)}}return e.from(n.target)},d2=e=>Qe(e.dom.shadowRoot),X=e=>{const n=_e(e)?e.dom.parentNode:e.dom;if(n==null||n.ownerDocument===null)return!1;const s=n.ownerDocument;return _2(t.fromDom(n)).fold(()=>s.body.contains(n),nm(X,j2))},c2=()=>Hr(t.fromDom(document)),Hr=e=>{const n=e.dom.body;if(n==null)throw new Error("Body is not available yet");return t.fromDom(n)},r2=(e,t,n)=>p(kr(e,n),t),a2=(e,t)=>p(z(e),t),Dr=(e,t)=>{let n=[];return i(z(e),e=>{t(e)&&(n=n.concat([e])),n=n.concat(Dr(e,t))}),n},ot=(e,t,n)=>r2(e,e=>F(e,t),n),tn=(e,t)=>a2(e,e=>F(e,t)),U=(e,t)=>y3(t,e);zn=(t,n,s,o,i)=>t(s,o)?e.some(s):ve(i)&&i(s)?e.none():n(s,o,i);const $e=(n,s,o)=>{let i=n.dom;const a=ve(o)?o:B;for(;i.parentNode;){i=i.parentNode;const n=t.fromDom(i);if(s(n))return e.some(n);if(a(n))break}return e.none()},i2=(e,t,n)=>{const s=(e,t)=>t(e);return zn(s,$e,e,t,n)},o2=(e,n)=>{const s=e=>n(t.fromDom(e)),o=W(e.dom.childNodes,s);return o.map(t.fromDom)},e2=(n,s)=>{const o=n=>{for(let i=0;i<n.childNodes.length;i++){const a=t.fromDom(n.childNodes[i]);if(s(a))return e.some(a);const r=o(n.childNodes[i]);if(r.isSome())return r}return e.none()};return o(n.dom)},ge=(e,t,n)=>$e(e,e=>F(e,t),n),_n=(e,t)=>o2(e,e=>F(e,t)),Je=(e,t)=>sr(t,e),y=(e,t,n)=>{const s=(e,t)=>F(e,t);return zn(s,ge,e,t,n)},bn=(e,t,n=tm)=>e.exists(e=>n(e,t)),jr=e=>{const t=[],n=e=>{t.push(e)};for(let t=0;t<e.length;t++)e[t].each(n);return t},J0=(t,n)=>t!=null?n(t):e.none(),gn=(t,n)=>t?e.some(n):e.none(),br=(e,t,n)=>t===""||e.length>=t.length&&e.substr(n,n+t.length)===t,S=(e,t,n=0,s)=>{const o=e.indexOf(t,n);return o!==-1&&(!!dm(s)||o+t.length<=s)},vr=(e,t)=>br(e,t,0),un=(e,t)=>br(e,t,e.length-t.length),Z0=e=>t=>t.replace(e,""),K0=Z0(/^\s+|\s+$/g),U0=e=>e.length>0,B0=t=>{const n=parseFloat(t);return isNaN(n)?e.none():e.some(n)},Fe=e=>e.style!==void 0&&ve(e.style.getPropertyValue),or=(e,t,n)=>{if(!rt(n))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",n,":: Element ",e),new Error("CSS value must be a string: "+n);Fe(e)&&e.style.setProperty(t,n)},L0=(e,t)=>{Fe(e)&&e.style.removeProperty(t)},j=(e,t,n)=>{const s=e.dom;or(s,t,n)},Ke=(e,t)=>{const n=e.dom;T(t,(e,t)=>{or(n,t,e)})},je=(e,t)=>{const n=e.dom,o=window.getComputedStyle(n),s=o.getPropertyValue(t);return s===""&&!X(e)?qa(n,t):s},qa=(e,t)=>Fe(e)?e.style.getPropertyValue(t):"",Tn=(t,n)=>{const s=t.dom,o=qa(s,n);return e.from(o).filter(e=>e.length>0)},ae=(e,t)=>{const n=e.dom;L0(n,t),bn(re(e,"style").map(K0),"")&&d(e,"style")},T0=(e,t)=>{const n=e.dom,s=t.dom;Fe(n)&&Fe(s)&&(s.style.cssText=n.style.cssText)},oe=(e,t,n=0)=>re(e,t).map(e=>parseInt(e,10)).getOr(n),Ln=(e,t)=>oe(e,t,1),fn=e=>I("col")(e)?oe(e,"span",1)>1:Ln(e,"colspan")>1,za=e=>Ln(e,"rowspan")>1,Zt=(e,t)=>parseInt(je(e,t),10),nt=n(10),Bn=n(10),Qt=(e,t)=>$n(e,t,r),$n=(e,t,n)=>_(z(e),e=>F(e,t)?n(e)?[e]:[]:$n(e,t,n)),F0=(t,n,s=B)=>{if(s(n))return e.none();if(f(t,l(n)))return e.some(n);const o=e=>F(e,"table")||s(e);return ge(n,t.join(","),o)},Ea=(e,t)=>F0(["td","th"],e,t),Pe=e=>Qt(e,"th,td"),qn=e=>F(e,"colgroup")?tn(e,"col"):_(ga(e),e=>tn(e,"col")),A=(e,t)=>y(e,"table",t),ba=e=>Qt(e,"tr"),ga=e=>A(e).fold(n([]),e=>tn(e,"colgroup")),fa=(e,t)=>s(e,e=>{if(l(e)==="colgroup"){const t=s(qn(e),e=>{const t=oe(e,"span",1);return rc(e,1,t)});return As(e,t,"colgroup")}const n=s(Pe(e),e=>{const t=oe(e,"rowspan",1),n=oe(e,"colspan",1);return rc(e,t,n)});return As(e,n,t(e))}),M0=e=>pe(e).map(e=>{const t=l(e);return V2(t)?t:"tbody"}).getOr("tbody"),ma=e=>{const t=ba(e),n=ga(e),s=[...n,...t];return fa(s,M0)},S0=(e,t)=>fa(e,()=>t),Ve=e=>{let t=!1,n;return(...s)=>(t||(t=!0,n=e.apply(null,s)),n)},A0=(e,t,s,o)=>{const i=e.isiOS()&&/ipad/i.test(s)===!0,a=e.isiOS()&&!i,r=e.isiOS()||e.isAndroid(),u=r||o("(pointer:coarse)"),c=i||!a&&r&&o("(min-device-width:768px)"),l=a||r&&!c,d=t.isSafari()&&e.isiOS()&&/safari/i.test(s)===!1,h=!l&&!c&&!d;return{isiPad:n(i),isiPhone:n(a),isTablet:n(c),isPhone:n(l),isTouch:n(u),isAndroid:e.isAndroid,isiOS:e.isiOS,isWebView:n(d),isDesktop:n(h)}},C0=(e,t)=>{for(let n=0;n<e.length;n++){const s=e[n];if(s.test(t))return s}},w0=(e,t)=>{const n=C0(e,t);if(!n)return{major:0,minor:0};const s=e=>Number(t.replace(n,"$"+e));return cs(s(1),s(2))},_0=(e,t)=>{const n=String(t).toLowerCase();return e.length===0?sa():w0(e,n)},sa=()=>cs(0,0),cs=(e,t)=>({major:e,minor:t}),Xe={nu:cs,detect:_0,unknown:sa},b0=(e,t)=>te(t.brands,t=>{const n=t.brand.toLowerCase();return W(e,e=>{var t;return n===((t=e.brand)===null||t===void 0?void 0:t.toLowerCase())}).map(e=>({current:e.name,version:Xe.nu(parseInt(t.version,10),0)}))}),Qi=(e,t)=>{const n=String(t).toLowerCase();return W(e,e=>e.search(n))},g0=(e,t)=>Qi(e,t).map(e=>{const n=Xe.detect(e.versionRegexes,t);return{current:e.name,version:n}}),p0=(e,t)=>Qi(e,t).map(e=>{const n=Xe.detect(e.versionRegexes,t);return{current:e.name,version:n}}),fs=/.*?version\/ ?([0-9]+)\.([0-9]+).*/,ee=e=>t=>S(t,e),f0=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:e=>S(e,"edge/")&&S(e,"chrome")&&S(e,"safari")&&S(e,"applewebkit")},{name:"Chromium",brand:"Chromium",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,fs],search:e=>S(e,"chrome")&&!S(e,"chromeframe")},{name:"IE",versionRegexes:[/.*?msie ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:e=>S(e,"msie")||S(e,"trident")},{name:"Opera",versionRegexes:[fs,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:ee("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/ ?([0-9]+)\.([0-9]+).*/],search:ee("firefox")},{name:"Safari",versionRegexes:[fs,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:e=>(S(e,"safari")||S(e,"mobile/"))&&S(e,"applewebkit")}],m0=[{name:"Windows",search:ee("win"),versionRegexes:[/.*?windows nt ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:e=>S(e,"iphone")||S(e,"ipad"),versionRegexes:[/.*?version\/ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:ee("android"),versionRegexes:[/.*?android ?([0-9]+)\.([0-9]+).*/]},{name:"macOS",search:ee("mac os x"),versionRegexes:[/.*?mac os x ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:ee("linux"),versionRegexes:[]},{name:"Solaris",search:ee("sunos"),versionRegexes:[]},{name:"FreeBSD",search:ee("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:ee("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],Ki={browsers:n(f0),oses:n(m0)},$i="Edge",Vi="Chromium",Li="IE",zi="Opera",Fi="Firefox",xi="Safari",u0=()=>mi({current:void 0,version:Xe.unknown()}),mi=e=>{const n=e.current,s=e.version,t=e=>()=>n===e;return{current:n,version:s,isEdge:t($i),isChromium:t(Vi),isIE:t(Li),isOpera:t(zi),isFirefox:t(Fi),isSafari:t(xi)}},di={unknown:u0,nu:mi,edge:n($i),chromium:n(Vi),ie:n(Li),opera:n(zi),firefox:n(Fi),safari:n(xi)},ai="Windows",ii="iOS",ni="Android",ti="Linux",ei="macOS",Jo="Solaris",Zo="FreeBSD",Qo="ChromeOS",l0=()=>qo({current:void 0,version:Xe.unknown()}),qo=e=>{const n=e.current,s=e.version,t=e=>()=>n===e;return{current:n,version:s,isWindows:t(ai),isiOS:t(ii),isAndroid:t(ni),isMacOS:t(ei),isLinux:t(ti),isSolaris:t(Jo),isFreeBSD:t(Zo),isChromeOS:t(Qo)}},Vo={unknown:l0,nu:qo,windows:n(ai),ios:n(ii),android:n(ni),linux:n(ti),macos:n(ei),solaris:n(Jo),freebsd:n(Zo),chromeos:n(Qo)},c0=(e,t,n)=>{const s=Ki.browsers(),a=Ki.oses(),o=t.bind(e=>b0(s,e)).orThunk(()=>g0(s,e)).fold(di.unknown,di.nu),i=p0(a,e).fold(Vo.unknown,Vo.nu),r=A0(i,o,e,n);return{browser:o,os:i,deviceType:r}},r0={detect:c0},i0=e=>window.matchMedia(e).matches;let s0=Ve(()=>r0.detect(navigator.userAgent,e.from(navigator.userAgentData),i0));const So=()=>s0(),ko=(e,t)=>{const o=(t,n)=>{if(!Sn(n)&&!n.match(/^[0-9]+$/))throw new Error(e+".set accepts only positive integer values. Value was "+n);const s=t.dom;Fe(s)&&(s.style[e]=n+"px")},n=n=>{const s=t(n);if(s<=0||s===null){const t=je(n,e);return parseFloat(t)||0}return s},i=n,s=(e,t)=>$(t,(t,n)=>{const s=je(e,n),o=s===void 0?0:parseInt(s,10);return isNaN(o)?t:t+o},0),a=(e,t,n)=>{const o=s(e,n),i=t>o?t-o:0;return i};return{set:o,get:n,getOuter:i,aggregate:s,max:a}},n0=(e,t)=>B0(e).getOr(t),He=(e,t,n)=>n0(je(e,t),n),J4=(e,t,n,s)=>{const o=He(e,`padding-${n}`,0),i=He(e,`padding-${s}`,0),a=He(e,`border-${n}-width`,0),r=He(e,`border-${s}-width`,0);return t-o-i-a-r},Z4=(e,t)=>{const n=e.dom,s=n.getBoundingClientRect().width||n.offsetWidth;return t==="border-box"?s:J4(e,s,"left","right")},G4=e=>He(e,"height",e.dom.offsetHeight),_c=e=>He(e,"width",e.dom.offsetWidth),V4=e=>Z4(e,"content-box"),ho=ko("width",e=>e.dom.offsetWidth),Q=e=>ho.get(e),eo=e=>ho.getOuter(e),to=V4,I4=_c,so=(e,t,n)=>{const s=e.cells,o=s.slice(0,t),i=s.slice(t),a=o.concat(n).concat(i);return ao(e,a)},ro=(e,t,n)=>so(e,t,[n]),it=(e,t,n)=>{const s=e.cells;s[t]=n},ao=(e,t)=>he(e.element,t,e.section,e.isNew),D4=(e,t)=>{const n=e.cells,o=s(n,t);return he(e.element,o,e.section,e.isNew)},P=(e,t)=>e.cells[t],M=(e,t)=>P(e,t).element,R=e=>e.cells.length,b=e=>{const t=Si(e,e=>e.section==="colgroup");return{rows:t.fail,cols:t.pass}},mo=(e,t,n)=>{const o=s(e.cells,n);return he(t(e.element),o,e.section,!0)},yt="data-snooker-locked-cols",M4=t=>re(t,yt).bind(t=>e.from(t.match(/\d+/g))).map(e=>zs(e,r)),ue=e=>{const t=$(b(e).rows,(e,t)=>(i(t.cells,(t,n)=>{t.isLocked&&(e[n]=!0)}),e),{}),n=uo(t,(e,t)=>parseInt(t,10));return yh(n)},qs=(e,t)=>e+","+t,wc=(t,n,s)=>e.from(t.access[qs(n,s)]),k4=(t,n,s)=>{const o=yo(t,e=>s(n,e.element));return o.length>0?e.some(o[0]):e.none()},yo=(e,t)=>{const n=_(e.all,e=>e.cells);return p(n,t)},C4=e=>{const t={};let n=0;return i(e.cells,e=>{const s=e.colspan;N(s,o=>{const i=n+o;t[i]=F2(e.element,s,i)}),n+=s}),t},wo=e=>{const n={},o=[],r=Ct(e).map(e=>e.element).bind(A),c=r.bind(M4).getOr({});let a=0,s=0,t=0;const{pass:l,fail:d}=Si(e,e=>e.section==="colgroup");i(d,e=>{const r=[];i(e.cells,e=>{let o=0;for(;n[qs(t,o)]!==void 0;)o++;const a=rh(c,o.toString()),i=L2(e.element,e.rowspan,e.colspan,t,o,a);for(let a=0;a<e.colspan;a++)for(let r=0;r<e.rowspan;r++){const l=t+r,c=o+a,d=qs(l,c);n[d]=i,s=Math.max(s,c+1)}r.push(i)}),a++,o.push(As(e.element,r,e.section)),t++});const{columns:u,colgroups:h}=Po(l).map(e=>{const t=C4(e),n=k2(e.element,lo(t));return{colgroups:[n],columns:t}}).getOrThunk(()=>({colgroups:[],columns:{}})),m=B2(a,s);return{grid:m,access:n,all:o,columns:u,colgroups:h}},x4=e=>{const t=ma(e);return wo(t)},O4=e=>_(e.all,e=>e.cells),w4=e=>lo(e.columns),_4=e=>at(e.columns).length>0,y4=(t,n)=>e.from(t.columns[n]),a={fromTable:x4,generate:wo,getAt:wc,findItem:k4,filterItems:yo,justCells:O4,justColumns:w4,hasColumns:_4,getColumnAt:y4},$s=(e,t=r)=>{const n=e.grid,o=N(n.columns,h),i=N(n.rows,h);return s(o,n=>{const s=()=>_(i,t=>a.getAt(e,t,n).filter(e=>e.column===n).toArray()),o=e=>e.colspan===1&&t(e.element),r=()=>a.getAt(e,0,n);return Mo(s,o,r)})},Mo=(t,n,s)=>{const o=t(),i=W(o,n),a=i.orThunk(()=>e.from(o[0]).orThunk(s));return a.map(e=>e.element)},Fo=e=>{const t=e.grid,o=N(t.rows,h),i=N(t.columns,h);return s(o,t=>{const s=()=>_(i,s=>a.getAt(e,t,s).filter(e=>e.row===t).fold(n([]),e=>[e])),o=e=>e.rowspan===1,r=()=>a.getAt(e,t,0);return Mo(s,o,r)})},j4=(t,n)=>{if(n<0||n>=t.length-1)return e.none();const s=t[n].fold(()=>{const e=Sh(t.slice(0,n));return te(e,(e,t)=>e.map(e=>({value:e,delta:t+1})))},t=>e.some({value:t,delta:0})),o=t[n+1].fold(()=>{const e=t.slice(n+1);return te(e,(e,t)=>e.map(e=>({value:e,delta:t+1})))},t=>e.some({value:t,delta:1}));return s.bind(e=>o.map(t=>{const n=t.delta+e.delta;return Math.abs(t.value-e.value)/n}))},zo=(e,t)=>n=>b4(n)==="rtl"?t:e,b4=e=>je(e,"direction")==="rtl"?"rtl":"ltr",No=ko("height",e=>{const t=e.dom;return X(e)?t.getBoundingClientRect().height:t.offsetHeight}),Is=e=>No.get(e),Ro=e=>No.getOuter(e),v4=G4,Ho=(e,t)=>{const n=(n,s)=>Ho(e+n,t+s);return{left:e,top:t,translate:n}},J=Ho,r4=e=>{const t=e.getBoundingClientRect();return J(t.left,t.top)},kt=(e,t)=>e!==void 0?e:t!==void 0?t:0,et=e=>{const o=e.dom.ownerDocument,n=o.body,t=o.defaultView,s=o.documentElement;if(n===e.dom)return J(n.offsetLeft,n.offsetTop);const i=kt(t?.pageYOffset,s.scrollTop),a=kt(t?.pageXOffset,s.scrollLeft),r=kt(s.clientTop,n.clientTop),c=kt(s.clientLeft,n.clientLeft);return e4(e).translate(a-c,i-r)},e4=e=>{const t=e.dom,s=t.ownerDocument,n=s.body;return n===t?J(n.offsetLeft,n.offsetTop):X(e)?r4(t):J(0,0)},Uo=(e,t)=>({row:e,y:t}),Ko=(e,t)=>({col:e,x:t}),oo=e=>{const t=et(e);return t.left+eo(e)},Yo=e=>et(e).left,Go=(e,t)=>Ko(e,Yo(t)),Xo=(e,t)=>Ko(e,oo(t)),Ns=e=>et(e).top,J1=(e,t)=>Uo(e,Ns(t)),Z1=(e,t)=>Uo(e,Ns(t)+Ro(t)),Ts=(e,t,n)=>{if(n.length===0)return[];const o=s(n.slice(1),(t,n)=>t.map(t=>e(n,t))),i=n[n.length-1].map(e=>t(n.length-1,e));return o.concat([i])},Q1=e=>-e,Ms={delta:h,positions:e=>Ts(J1,Z1,e),edge:Ns},X1={delta:h,edge:Yo,positions:e=>Ts(Go,Xo,e)},G1={delta:Q1,edge:oo,positions:e=>Ts(Xo,Go,e)},Ss=zo(X1,G1),zt={delta:(e,t)=>Ss(t).delta(e,t),positions:(e,t)=>Ss(t).positions(e,t),edge:e=>Ss(e).edge(e)},Y1={unsupportedLength:["em","ex","cap","ch","ic","rem","lh","rlh","vw","vh","vi","vb","vmin","vmax","cm","mm","Q","in","pc","pt","px"],fixed:["px","pt"],relative:["%"],empty:[""]},q1=(()=>{const e="[0-9]+",o="[+-]?"+e,n="[eE]"+o,s="\\.",t=e=>`(?:${e})?`,i=["Infinity",e+s+t(e)+t(n),s+e+t(n),e+t(n)].join("|"),a=`[+-]?(?:${i})`;return new RegExp(`^(${a})(.*)$`)})(),K1=(e,t)=>D(t,t=>D(Y1[t],t=>e===t)),P1=(t,n)=>{const s=e.from(q1.exec(t));return s.bind(t=>{const o=Number(t[1]),s=t[2];return K1(s,n)?e.some({value:o,unit:s}):e.none()})},ui=/(\d+(\.\d+)?)%/,R1=/(\d+(\.\d+)?)px|em/,T1=I("col"),fi=(e,t,n)=>{const s=p3(e).getOrThunk(()=>Hr(mn(e)));return t(e)/n(s)*100},pi=(e,t)=>{j(e,"width",t+"px")},gi=(e,t)=>{j(e,"width",t+"%")},Dt=(e,t)=>{j(e,"height",t+"px")},M1=e=>v4(e)+"px",S1=(e,t,n,s)=>{const o=A(e).map(e=>{const s=n(e);return Math.floor(t/100*s)}).getOr(t);return s(e,o),o},x1=(e,t,n,s)=>{const o=parseFloat(e);return un(e,"%")&&l(t)!=="table"?S1(t,o,n,s):o},O1=e=>{const t=M1(e);return t?x1(t,e,Is,Dt):Is(e)},_1=(e,t,n)=>{const s=n(e),o=Ln(e,t);return s/o},Oi=(e,t)=>Tn(e,t).orThunk(()=>re(e,t).map(e=>e+"px")),Se=e=>Oi(e,"width"),v1=e=>Oi(e,"height"),p1=e=>fi(e,Q,to),ki=e=>T1(e)?Q(e):I4(e),Ai=e=>_1(e,"rowspan",O1),f1=e=>{const t=Se(e);return t.bind(e=>P1(e,["fixed","relative","empty"]))},Mi=(e,t,n)=>{j(e,"width",t+n)},m1=e=>Q(e)+"px",Ti=e=>fi(e,Q,to)+"%",h1=e=>Se(e).exists(e=>ui.test(e)),u1=e=>Se(e).exists(e=>R1.test(e)),d1=e=>Se(e).isNone(),l1=n(ui),c1=I("col"),a1=e=>Se(e).getOrThunk(()=>ki(e)+"px"),n1=e=>v1(e).getOrThunk(()=>Ai(e)+"px"),t1=t=>s(a.justColumns(t),t=>e.from(t.element)),e1=e=>{const t=So().browser,n=t.isChromium()||t.isFirefox();return!c1(e)||n},ys=(e,t,n,s,o,i)=>e.filter(s).fold(()=>i(j4(n,t)),e=>o(e)),js=(t,n,o,i)=>{const r=$s(t),d=a.hasColumns(t)?t1(t):r,c=[e.some(zt.edge(n))].concat(s(zt.positions(r,n),e=>e.map(e=>e.x))),l=Dn(fn);return s(d,(t,n)=>ys(t,n,c,l,t=>{if(e1(t))return o(t);const s=J0(r[n],h);return ys(s,n,c,l,t=>i(e.some(Q(t))),i)},i))},Wi=e=>e.map(e=>e+"px").getOr(""),Zu=(e,t)=>js(e,t,a1,Wi),Qu=(e,t,n)=>js(e,t,p1,e=>e.fold(()=>n.minCellWidth(),e=>e/n.pixelWidth()*100)),gs=(e,t,n)=>js(e,t,ki,e=>e.getOrThunk(n.minCellWidth)),Yi=(t,n,o,i,a)=>{const r=Fo(t),c=[e.some(o.edge(n))].concat(s(o.positions(r,n),e=>e.map(e=>e.y)));return s(r,(e,t)=>ys(e,t,c,Dn(za),i,a))},Ku=(e,t,n)=>Yi(e,t,n,Ai,e=>e.getOrThunk(Bn)),Uu=(e,t,n)=>Yi(e,t,n,n1,Wi),Bt=(e,t)=>()=>X(e)?t(e):parseFloat(Tn(e,"width").getOr("0")),Zi=e=>{const t=Bt(e,Q),s=n(0),i=(t,n)=>gs(t,e,n);return{width:t,pixelWidth:t,getWidths:i,getCellDelta:s,singleColumnWidth:n([0]),minCellWidth:s,setElementWidth:o,adjustTableWidth:o,isRelative:!0,label:"none"}},Ji=e=>{const n=Bt(e,e=>parseFloat(Ti(e))),t=Bt(e,Q),s=e=>e/t()*100,o=(e)=>[100-e],i=()=>nt()/t()*100,a=t=>{const s=n(),o=t/100*s,i=s+o;gi(e,i)},r=(t,n)=>Qu(t,e,n);return{width:n,pixelWidth:t,getWidths:r,getCellDelta:s,singleColumnWidth:o,minCellWidth:i,setElementWidth:gi,adjustTableWidth:a,isRelative:!0,label:"percent"}},ea=e=>{const t=Bt(e,Q),n=h,s=(e,t)=>{const n=Math.max(nt(),e+t);return[n-e]},o=n=>{const s=t()+n;pi(e,s)},i=(t,n)=>gs(t,e,n);return{width:t,pixelWidth:t,getWidths:i,getCellDelta:n,singleColumnWidth:s,minCellWidth:nt,setElementWidth:pi,adjustTableWidth:o,isRelative:!1,label:"pixel"}},Wu=(e,t)=>{const n=l1().exec(t);return n!==null?Ji(e):ea(e)},yu=e=>{const t=Se(e);return t.fold(()=>Zi(e),t=>Wu(e,t))},Re={getTableSize:yu,pixelSize:ea,percentageSize:Ji,noneSize:Zi},ju=(e,t,n,s,o,i)=>({minRow:e,minCol:t,maxRow:n,maxCol:s,allCells:o,selectedCells:i}),bu=(e,t)=>{const c=e.grid.columns,l=e.grid.rows;let n=l,s=c,o=0,i=0;const a=[],r=[];return T(e.access,e=>{if(a.push(e),t(e)){r.push(e);const t=e.row,c=t+e.rowspan-1,a=e.column,l=a+e.colspan-1;t<n?n=t:c>o&&(o=c),a<s?s=a:l>i&&(i=l)}}),ju(n,s,o,i,a,r)},gu=(e,n,s)=>{const i=e[s].element,o=t.fromTag("td");u(o,t.fromTag("br"));const a=n?u:Os;a(i,o)},pu=(e,t,n,s)=>{const o=p(e,e=>e.section!=="colgroup"),i=t.grid.columns,r=t.grid.rows;for(let e=0;e<r;e++){let c=!1;for(let r=0;r<i;r++)if(!(e<n.minRow||e>n.maxRow||r<n.minCol||r>n.maxCol)){const n=a.getAt(t,e,r).filter(s).isNone();n?gu(o,c,e):c=!0}}},fu=(e,t,n,s)=>{T(n.columns,e=>{(e.column<t.minCol||e.column>t.maxCol)&&C(e.element)});const o=p(Qt(e,"tr"),e=>e.dom.childElementCount===0);i(o,C),(t.minCol===t.maxCol||t.minRow===t.maxRow)&&i(Qt(e,"th,td"),e=>{d(e,"rowspan"),d(e,"colspan")}),d(e,yt),d(e,"data-snooker-col-series");const a=Re.getTableSize(e);a.adjustTableWidth(s)},mu=(e,t,n,s)=>{if(s.minCol===0&&t.grid.columns===s.maxCol+1)return 0;const o=gs(t,e,n),i=$(o,(e,t)=>e+t,0),a=$(o.slice(s.minCol,s.maxCol+1),(e,t)=>e+t,0),r=a/i*n.pixelWidth(),c=r-n.pixelWidth();return n.getCellDelta(c)},hu=(e,t)=>{const r=e=>F(e.element,t),n=xe(e),c=ma(n),l=Re.getTableSize(e),s=a.generate(c),o=bu(s,r),d="th:not("+t+"),td:not("+t+")",u=$n(n,"th,td",e=>F(e,d));i(u,C),pu(c,s,o,r);const h=a.fromTable(e),m=mu(e,h,l,o);return fu(n,o,s,m),n},uu="\xA0",su=(t,n)=>{const o=e=>{if(!t(e))throw new Error("Can only get "+n+" value of a "+n+" node");return s(e).getOr("")},s=n=>t(n)?e.from(n.dom.nodeValue):e.none(),i=(e,s)=>{if(!t(e))throw new Error("Can only set raw "+n+" value of a "+n+" node");e.dom.nodeValue=s};return{get:o,getOption:s,set:i}},Jn=su(_e,"text"),Qn=e=>Jn.get(e),pa=e=>Jn.getOption(e),Yd=(e,t)=>Jn.set(e,t),ie=e=>l(e)==="img"?1:pa(e).fold(()=>z(e).length,e=>e.length),Hd=e=>pa(e).filter(e=>e.trim().length!==0||e.indexOf(uu)>-1).isSome(),Pd=["img","br"],ya=e=>{const t=Hd(e);return t||f(Pd,l(e))},_a=e=>e2(e,ya),wa=e=>Nd(e,ya),Nd=(t,n)=>{const s=t=>{const o=z(t);for(let t=o.length-1;t>=0;t--){const i=o[t];if(n(i))return e.some(i);const a=s(i);if(a.isSome())return a}return e.none()};return s(t)},Dd={scope:["row","col"]},Kn=e=>()=>{const n=t.fromTag("td",e.dom);return u(n,t.fromTag("br",e.dom)),n},Un=e=>()=>t.fromTag("col",e.dom),ka=e=>()=>t.fromTag("colgroup",e.dom),Aa=e=>()=>t.fromTag("tr",e.dom),zd=(e,t,n)=>{const s=U2(e,t);return T(n,(e,t)=>{e===null?d(s,t):g(s,t,e)}),s},Sd=e=>e,Ad=(e,t,n)=>{const s=_a(e);return s.map(s=>{const o=n.join(","),i=ot(s,o,t=>c(t,e));return V(i,(e,t)=>{const n=jc(t);return d(n,"contenteditable"),u(e,n),n},t)}).getOr(t)},Od=(e,t)=>{T(Dd,(n,s)=>re(e,s).filter(e=>f(n,e)).each(e=>g(t,s,e)))},Pn=(e,n,s)=>{const o=(e,t)=>{T0(e.element,t),ae(t,"height"),e.colspan!==1&&ae(t,"width")},i=i=>{const a=t.fromTag(l(i.element),n.dom),r=s.getOr(["strong","em","b","i","span","font","h1","h2","h3","h4","h5","h6","p","div"]),c=r.length>0?Ad(i.element,a,r):a;return u(c,t.fromTag("br")),o(i,a),Od(i.element,a),e(i.element,a),a},a=s=>{const i=t.fromTag(l(s.element),n.dom);return o(s,i),e(s.element,i),i};return{col:a,colgroup:ka(n),row:Aa(n),cell:i,replace:zd,colGap:Un(n),gap:Kn(n)}},Da=e=>({col:Un(e),colgroup:ka(e),row:Aa(e),cell:Kn(e),replace:Sd,colGap:Un(e),gap:Kn(e)}),_d=(e,n)=>{const o=n||document,s=o.createElement("div");return s.innerHTML=e,z(t.fromDom(s))},vd=e=>s(e,t.fromDom),Jt=e=>t.fromDom(e.getBody()),Ie=e=>t=>c(t,Jt(e)),ye=e=>{d(e,"data-mce-style");const t=e=>d(e,"data-mce-style");i(Pe(e),t),i(qn(e),t),i(ba(e),t)},sn=e=>t.fromDom(e.selection.getStart()),Ba=e=>e.getBoundingClientRect().width,Va=e=>e.getBoundingClientRect().height,gd=(t,n)=>{const s=t.dom.getStyle(n,"width")||t.dom.getAttrib(n,"width");return e.from(s).filter(U0)},pd=e=>/^(\d+(\.\d+)?)%$/.test(e),fd=e=>/^(\d+(\.\d+)?)px$/.test(e),dd=(e,t)=>{const n=t.column,s=t.column+t.colspan-1,o=t.row,i=t.row+t.rowspan-1;return n<=e.finishCol&&s>=e.startCol&&o<=e.finishRow&&i>=e.startRow},ld=(e,t)=>t.column>=e.startCol&&t.column+t.colspan-1<=e.finishCol&&t.row>=e.startRow&&t.row+t.rowspan-1<=e.finishRow,nd=(t,n)=>{let s=!0;const o=O(ld,n);for(let e=n.startRow;e<=n.finishRow;e++)for(let i=n.startCol;i<=n.finishCol;i++)s=s&&a.getAt(t,e,i).exists(o);return s?e.some(n):e.none()},Jl=(e,t)=>T2(Math.min(e.row,t.row),Math.min(e.column,t.column),Math.max(e.row+e.rowspan-1,t.row+t.rowspan-1),Math.max(e.column+e.colspan-1,t.column+t.colspan-1)),Xa=(e,t,n)=>{const s=a.findItem(e,t,c),o=a.findItem(e,n,c);return s.bind(e=>o.map(t=>Jl(e,t)))},Ql=(e,t,n)=>Xa(e,t,n).bind(t=>nd(e,t)),Gl=(e,t,n,s)=>a.findItem(e,t,c).bind(t=>{const o=n>0?t.row+t.rowspan-1:t.row,i=s>0?t.column+t.colspan-1:t.column,r=a.getAt(e,o+n,i+s);return r.map(e=>e.element)}),Ja=(e,t,n)=>Xa(e,t,n).map(t=>{const n=a.filterItems(e,O(dd,t));return s(n,e=>e.element)}),er=(e,t)=>{const n=(e,t)=>Cn(t,e);return a.findItem(e,t,n).map(e=>e.element)},ql=(e,t,n)=>A(e).bind(s=>{const o=cn(s);return Gl(o,e,t,n)}),Ul=(e,t,n)=>{const s=cn(e);return Ja(s,t,n)},An=(t,n,s,o,i)=>{const a=cn(t),r=c(t,s)?e.some(n):er(a,n),l=c(t,i)?e.some(o):er(a,o);return r.bind(e=>l.bind(t=>Ja(a,e,t)))},Wl=(e,t,n)=>{const s=cn(e);return Ql(s,t,n)},cn=a.fromTable;ar=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],Ze=()=>{const s=e=>t.fromDom(e.dom.cloneNode(!1)),o=e=>hn(e).dom,i=e=>!!Y(e)&&(l(e)==="body"||f(ar,l(e))),a=e=>!!Y(e)&&f(["br","img","hr","input"],l(e)),r=e=>Y(e)&&De(e,"contenteditable")==="false",h=(e,t)=>e.dom.compareDocumentPosition(t.dom),m=(e,t)=>{const n=Oa(e);We(t,n)},p=e=>{const t=l(e);return f(["script","noscript","iframe","noframes","noembed","title","style","textarea","xmp"],t)},v=t=>Y(t)?re(t,"lang"):e.none();return{up:n({selector:ge,closest:y,predicate:$e,all:kr}),down:n({selector:U,predicate:Dr}),styles:n({get:je,getRaw:Tn,set:j,remove:ae}),attrs:n({get:De,set:g,remove:d,copyTo:m}),insert:n({before:Lt,after:dt,afterAll:gc,append:u,appendAll:se,prepend:Os,wrap:Q2}),remove:n({unwrap:K2,remove:C}),create:n({nu:t.fromTag,clone:s,text:t.fromText}),query:n({comparePosition:h,prevSibling:Fr,nextSibling:Gt}),property:n({children:z,name:l,parent:pe,document:o,isText:_e,isComment:N3,isElement:Y,isSpecial:p,getLanguage:v,getText:Qn,setText:Yd,isBoundary:i,isEmptyTag:a,isNonEditable:r}),eq:c,is:j3}};const $l=(e,t,n,s)=>{const o=n[0],i=n.slice(1);return s(e,t,o,i)},Il=(t,n,s)=>s.length>0?$l(t,n,s,Rl):e.none(),Rl=(e,t,n,s)=>{const o=t(e,n);return V(s,(n,s)=>{const o=t(e,s);return Tl(e,n,o)},o)},Tl=(e,t,n)=>t.bind(t=>n.filter(O(e.eq,t))),Ml=(e,t)=>O(e.eq,t),Al=(e,t,n,s=B)=>{const r=[t].concat(e.up().all(t)),c=[n].concat(e.up().all(n)),o=e=>{const t=xs(e,s);return t.fold(()=>e,t=>e.slice(0,t+1))},i=o(r),a=o(c),l=W(i,t=>D(a,Ml(e,t)));return{firstpath:i,secondpath:a,shared:l}},kl=Il,Cl=Al,gr=Ze(),jn=(e,t)=>kl(gr,(t,n)=>e(n),t),_l=(e,t,n)=>Cl(gr,e,t,n),ds=e=>ge(e,"table"),ln=(t,n,s)=>{const o=e=>t=>s!==void 0&&s(t)||c(t,e);return c(t,n)?e.some({boxes:e.some([t]),start:t,finish:n}):ds(t).bind(i=>ds(n).bind(a=>{if(c(i,a))return e.some({boxes:Ul(i,t,n),start:t,finish:n});if(Cn(i,a)){const s=ot(n,"td,th",o(i)),r=s.length>0?s[s.length-1]:n;return e.some({boxes:An(i,t,i,n,a),start:t,finish:r})}if(Cn(a,i)){const s=ot(t,"td,th",o(a)),r=s.length>0?s[s.length-1]:t;return e.some({boxes:An(a,t,i,n,a),start:t,finish:r})}return _l(t,n).shared.bind(r=>y(r,"table",s).bind(s=>{const r=ot(n,"td,th",o(s)),l=r.length>0?r[r.length-1]:n,c=ot(t,"td,th",o(s)),d=c.length>0?c[c.length-1]:t;return e.some({boxes:An(s,t,i,n,a),start:d,finish:l})}))}))},xn=(t,n)=>{const s=U(t,n);return s.length>0?e.some(s):e.none()},vl=(e,t)=>W(e,e=>F(e,t)),Or=(e,t,n)=>Je(e,t).bind(t=>Je(e,n).bind(e=>jn(ds,[t,e]).map(n=>({first:t,last:e,table:n})))),gl=(e,t)=>ge(e,"table").bind(n=>Je(n,t).bind(t=>ln(t,e).bind(e=>e.boxes.map(t=>({boxes:t,start:e.start,finish:e.finish}))))),pl=(e,t,n,s,o)=>vl(e,o).bind(e=>ql(e,t,n).bind(e=>gl(e,s))),Er=(e,t)=>xn(e,t),ml=(t,n,s)=>Or(t,n,s).bind(n=>{const s=e=>c(t,e),o="thead,tfoot,tbody,table",i=ge(n.first,o,s),a=ge(n.last,o,s);return i.bind(t=>a.bind(s=>c(t,s)?Wl(n.table,n.first,n.last):e.none()))}),Ar=h,ul=t=>{const n=(e,t)=>re(e,t).exists(e=>parseInt(e,10)>1),s=e=>n(e,"rowspan")||n(e,"colspan");return t.length>0&&H(t,s)?e.some(t):e.none()},dl=(t,n,s)=>n.length<=1?e.none():ml(t,s.firstSelectedSelector,s.lastSelectedSelector).map(e=>({bounds:e,cells:n})),en="data-mce-selected",al="td["+en+"],th["+en+"]",nl="["+en+"]",Nn="data-mce-first-selected",el="td["+Nn+"],th["+Nn+"]",Hn="data-mce-last-selected",Jc="td["+Hn+"],th["+Hn+"]",Xc=nl,me={selected:en,selectedSelector:al,firstSelected:Nn,firstSelectedSelector:el,lastSelected:Hn,lastSelectedSelector:Jc},Kt=(e,t,n)=>({element:n,mergable:dl(t,e,me),unmergable:ul(e),selection:Ar(e)}),Yc=(e,t,n)=>({element:e,clipboard:t,generators:n}),qc=(e,t,n,s)=>({selection:Ar(e),clipboard:n,generators:s}),Kc=e=>A(e).bind(e=>Er(e,me.firstSelectedSelector)).fold(n(e),e=>e[0]),Wr=e=>(t,n)=>{const s=l(t),o=s==="col"||s==="colgroup"?Kc(t):t;return y(o,e,n)},Uc=Wr("th,td,caption"),hs=Wr("th,td"),q=e=>vd(e.model.table.getSelectedCells()),$c=e=>p(q(e),e=>F(e,me.selectedSelector)),Ic=e=>A(e[0]).map(e=>{const t=hu(e,Xc);return ye(t),[t]}),Dc=(e,t)=>s(t,t=>e.selection.serializer.serialize(t.dom,{})).join(""),zc=e=>s(e,e=>e.dom.innerText).join(""),Tc=(e,n)=>{e.on("BeforeGetContent",t=>{const n=n=>{t.preventDefault(),Ic(n).each(n=>{t.content=t.format==="text"?zc(n):Dc(e,n)})};if(t.selection===!0){const t=$c(e);t.length>=1&&n(t)}}),e.on("BeforeSetContent",s=>{if(s.selection===!0&&s.paste===!0){const o=q(e);Ct(o).each(o=>{A(o).each(i=>{const a=p(_d(s.content),e=>l(e)!=="meta"),r=I("table");if(a.length===1&&r(a[0])){s.preventDefault();const r=t.fromDom(e.getDoc()),c=Da(r),l=Yc(o,a[0],c);n.pasteCells(i,l).each(()=>{e.focus()})}})})}})},ht=(e,t)=>({element:e,offset:t}),ec=(t,n,s)=>t.property().isText(n)&&t.property().getText(n).trim().length===0||t.property().isComment(n)?s(n).bind(n=>ec(t,n,s).orThunk(()=>e.some(n))):e.none(),tc=(e,t)=>{if(e.property().isText(t))return e.property().getText(t).length;const n=e.property().children(t);return n.length},nc=(e,t)=>{const n=ec(e,t,e.query().prevSibling).getOr(t);if(e.property().isText(n))return ht(n,tc(e,n));const s=e.property().children(n);return s.length>0?nc(e,s[s.length-1]):ht(n,tc(e,n))},Fc=nc,Mc=Ze(),Sc=e=>Fc(Mc,e),Ec=(e,t)=>{if(!fn(e)){const n=f1(e);n.each(n=>{const s=n.value/2;Mi(e,s,n.unit),Mi(t,s,n.unit)})}},Mt=e=>s(e,n(0)),cc=(e,t,n,s,o)=>o(e.slice(0,t)).concat(s).concat(o(e.slice(n))),lc=e=>(t,n,s,o)=>{if(e(s)){const i=Math.max(o,t[n]-Math.abs(s)),e=Math.abs(i-t[n]);return s>=0?e:-e}return s},St=lc(e=>e<0),Cc=lc(r),hc=()=>{const n=(e,t,n,s,o)=>{const i=St(e,t,s,o);return cc(e,t,n+1,[i,0],Mt)},e=(e,t,n,o)=>{const i=(100+n)/100,a=Math.max(o,(e[t]+n)/i);return s(e,(e,n)=>{const s=n===t?a:e/i;return s-e})},t=(t,s,o,i,a,r)=>r?e(t,s,i,a):n(t,s,o,i,a),o=(e,n,s,o,i,a,r)=>t(e,s,o,i,a,r),i=(e,t)=>e(t),a=(t,n,s,o,i,a)=>{if(a)return e(t,s,o,i);const r=St(t,s,o,i);return Mt(t.slice(0,s)).concat([r])},r=(e,t,n,o)=>{if(o){const i=t+n,o=i/t,a=s(e,e=>e/o);return{delta:o*100-100,newSizes:a}}return{delta:n,newSizes:e}};return{resizeTable:i,clampTableDelta:St,calcLeftEdgeDeltas:t,calcMiddleDeltas:o,calcRightEdgeDeltas:a,calcRedestributedWidths:r}},Ls=()=>{const e=(e,t,n,s,o)=>{const a=s>=0?n:t,i=Cc(e,a,s,o);return cc(e,t,n+1,[i,-i],Mt)},t=(t,n,s,o,i,a)=>e(t,s,o,i,a),o=(e,t,n)=>{n&&e(t)},i=(e,t,o,i,a,r)=>{if(r)return Mt(e);const c=i/e.length;return s(e,n(c))},a=(e,t,n,s,o)=>{if(o){if(n>=0)return n;const t=$(e,(e,t)=>e+t-s,0);return Math.max(-t,n)}else return St(e,t,n,s)},r=(e)=>({delta:0,newSizes:e});return{resizeTable:o,clampTableDelta:a,calcLeftEdgeDeltas:e,calcMiddleDeltas:t,calcRightEdgeDeltas:i,calcRedestributedWidths:r}},Ps=e=>{const t=a.fromTable(e);return t.grid},Ot=I("th"),wt=e=>H(e,e=>Ot(e.element)),xc=(e,t)=>e&&t?"sectionCells":e?"section":"cells",bc=e=>{const t=e.section==="thead",n=bn(Ks(e.cells),"th");return e.section==="tfoot"?{type:"footer"}:t||n?{type:"header",subType:xc(t,n)}:{type:"body"}},Ks=t=>{const n=p(t,e=>Ot(e.element));return n.length===0?e.some("td"):n.length===t.length?e.some("th"):e.none()},Oc=t=>{const n=s(t,e=>bc(e).type),o=f(n,"header"),i=f(n,"footer");if(!o&&!i)return e.some("body");const a=f(n,"body");return o&&!a&&!i?e.some("header"):!o&&!a&&i?e.some("footer"):e.none()},A4=t=>te(t.all,t=>{const n=bc(t);return n.type==="header"?e.from(n.subType):e.none()}),pn=(e,t,n)=>k(n(e.element,t),!0,e.isLocked),Qs=(e,t)=>e.section!==t?he(e.element,e.cells,t,e.isNew):e,vc=()=>({transformRow:Qs,transformCell:(e,t,n)=>{const s=n(e.element,t),o=l(s)!=="td"?W2(s,"td"):s;return k(o,e.isNew,e.isLocked)}}),uc=()=>({transformRow:Qs,transformCell:pn}),ac=()=>({transformRow:(e,t)=>{const n=t==="thead"?"tbody":t;return Qs(e,n)},transformCell:pn}),kc=()=>({transformRow:h,transformCell:pn}),Ac=(e,t)=>{const n=a.fromTable(e),s=A4(n).getOr(t);switch(s){case"section":return vc();case"sectionCells":return uc();case"cells":return ac()}},tt={getTableSectionType:Ac,section:vc,sectionCells:uc,cells:ac,fallback:kc},oc=e=>y(e,"[contenteditable]"),sc=(e,t=!1)=>X(e)?e.dom.isContentEditable:oc(e).fold(n(t),e=>Zr(e)==="true"),Zr=e=>e.dom.contentEditable,ut=(e,t,n,s)=>{n===s?d(e,t):g(e,t,n)},Xr=(e,t,n)=>{Po(tn(e,t)).fold(()=>Os(e,n),e=>dt(e,n))},Nc=(e,n)=>{const s=_n(e,n).getOrThunk(()=>{const s=t.fromTag(n,mn(e).dom);return n==="thead"?Xr(e,"caption,colgroup",s):n==="colgroup"?Xr(e,"caption",s):u(e,s),s});return Rs(s),s},Lc=(e,t)=>{const o=[],a=[],h=e=>s(e,e=>{e.isNew&&o.push(e.element);const t=e.element;return Rs(t),i(e.cells,e=>{e.isNew&&a.push(e.element),ut(e.element,"colspan",e.colspan,1),ut(e.element,"rowspan",e.rowspan,1),u(t,e.element)}),t}),m=e=>_(e,e=>s(e.cells,e=>(ut(e.element,"span",e.colspan,1),e.element))),f=(t,n)=>{const s=Nc(e,n),o=n==="colgroup"?m:h,i=o(t);se(s,i)},p=t=>{_n(e,t).each(C)},n=(e,t)=>{e.length>0?f(e,t):p(t)},r=[],c=[],l=[],d=[];return i(t,e=>{switch(e.section){case"thead":r.push(e);break;case"tbody":c.push(e);break;case"tfoot":l.push(e);break;case"colgroup":d.push(e);break}}),n(d,"colgroup"),n(r,"thead"),n(c,"tbody"),n(l,"tfoot"),{newRows:o,newCells:a}},Rc=e=>s(e,e=>{const t=jc(e.element);return i(e.cells,e=>{const n=xe(e.element);ut(n,"colspan",e.colspan,1),ut(n,"rowspan",e.rowspan,1),u(t,n)}),t}),Pc=(e,t)=>s(e,e=>P(e,t)),Hc=(e,t)=>e[t],Gr=(e,t)=>{if(e.length===0)return 0;const n=e[0],s=xs(e,e=>!t(n.element,e.element));return s.getOr(e.length)},Bc=(e,t,n,s)=>{const o=Hc(e,t),i=o.section==="colgroup",a=Gr(o.cells.slice(n),s),r=i?1:Gr(Pc(e.slice(t),n),s);return{colspan:a,rowspan:r}},Vc=(e,t)=>{const n=s(e,e=>s(e.cells,B)),o=(e,t,s,o)=>{for(let i=e;i<e+s;i++)for(let e=t;e<t+o;e++)n[i][e]=!0};return s(e,(s,i)=>{const a=_(s.cells,(s,a)=>{if(n[i][a]===!1){const n=Bc(e,i,a,t);return o(i,a,n.rowspan,n.colspan),[P2(s.element,n.rowspan,n.colspan,s.isNew)]}return[]});return N2(s.element,a,s.section,s.isNew)})},ct=(e,t,n)=>{const s=[];i(e.colgroups,o=>{const i=[];for(let s=0;s<e.grid.columns;s++){const o=a.getColumnAt(e,s).map(e=>k(e.element,n,!1)).getOrThunk(()=>k(t.colGap(),!0,!1));i.push(o)}s.push(he(o.element,i,"colgroup",n))});for(let o=0;o<e.grid.rows;o++){const i=[];for(let s=0;s<e.grid.columns;s++){const r=a.getAt(e,o,s).map(e=>k(e.element,n,e.isLocked)).getOrThunk(()=>k(t.gap(),!0,!1));i.push(r)}const r=e.all[o],c=he(r.element,i,r.section,n);s.push(c)}return s},Wc=(e,t)=>ct(e,t,!1),It=e=>Vc(e,c),us=(e,t)=>te(e.all,e=>W(e.cells,e=>c(t,e.element))),Gn=(e,t,n)=>{const i=s(t.selection,t=>Ea(t).bind(t=>us(e,t)).filter(n)),o=jr(i);return gn(o.length>0,o)},v=(t,n,s,o,i)=>(r,l,u,h)=>{const m=a.fromTable(r),f=e.from(h?.section).getOrThunk(tt.fallback),p=n(m,l).map(e=>{const s=Wc(m,u),n=t(s,e,c,i(u),f),o=ue(n.grid),a=It(n.grid);return{info:e,grid:a,cursor:n.cursor,lockedColumns:o}});return p.bind(t=>{const n=Lc(r,t.grid),i=e.from(h?.sizing).getOrThunk(()=>Re.getTableSize(r)),a=e.from(h?.resize).getOrThunk(Ls);return s(r,t.grid,t.info,{sizing:i,resize:a,section:f}),o(r),d(r,yt),t.lockedColumns.length>0&&g(r,yt,t.lockedColumns.join(",")),e.some({cursor:t.cursor,newRows:n.newRows,newCells:n.newCells})})},Gc=(e,t)=>Ea(t.element).bind(n=>us(e,n).map(e=>{const n={...e,generators:t.generators,clipboard:t.clipboard};return n})),Vn=(e,t)=>Gn(e,t,r).map(e=>({cells:e,generators:t.generators,clipboard:t.clipboard})),Qc=(e,t)=>t.mergable,Zc=(e,t)=>t.unmergable,G=(e,t)=>Gn(e,t,r),ne=(e,t)=>Gn(e,t,e=>!e.isLocked),tl=(e,t)=>us(e,t).exists(e=>!e.isLocked),zr=(e,t)=>H(t,t=>tl(e,t)),sl=(e,t)=>Qc(e,t).filter(t=>zr(e,t.cells)),ol=(e,t)=>Zc(e,t).filter(t=>zr(e,t)),il=(e,t,n,s)=>{const o=b(e).rows;if(o.length===0)return e;for(let e=t.startRow;e<=t.finishRow;e++)for(let n=t.startCol;n<=t.finishCol;n++){const i=o[e],a=P(i,n).isLocked;it(i,n,k(s(),!1,a))}return e},Tr=(e,t,n,s)=>{const o=b(e).rows;let i=!0;for(let e=0;e<o.length;e++)for(let a=0;a<R(o[0]);a++){const r=o[e],c=P(r,a),d=c.element,l=n(d,t);l&&!i?it(r,a,k(s(),!0,c.isLocked)):l&&(i=!1)}return e},rl=(e,t)=>$(e,(e,n)=>D(e,e=>t(e.element,n.element))?e:e.concat([n]),[]),cl=(e,t,n,s)=>(t>0&&t<e[0].cells.length&&i(e,e=>{const i=e.cells[t-1];let o=0;const a=s();for(;e.cells.length>t+o&&n(i.element,e.cells[t+o].element);)it(e,t+o,k(a,!0,e.cells[t+o].isLocked)),o++}),e),ll=(t,n,s,o)=>{const a=b(t).rows;if(n>0&&n<a.length){const t=a[n-1].cells,r=rl(t,s);i(r,t=>{let i=e.none();for(let r=n;r<a.length;r++)for(let n=0;n<R(a[0]);n++){const c=a[r],l=P(c,n),d=s(l.element,t.element);d&&(i.isNone()&&(i=e.some(o())),i.each(e=>{it(c,n,k(e,!0,l.isLocked))}))}})}return t},Mr=t=>{const s=e=>e(t),o=n(t),i=()=>a,a={tag:!0,inner:t,fold:(e,n)=>n(t),isValue:r,isError:B,map:e=>nn.value(e(t)),mapError:i,bind:s,exists:s,forall:s,getOr:o,or:i,getOrThunk:o,orThunk:i,getOrDie:o,each:e=>{e(t)},toOptional:()=>e.some(t)};return a},Sr=t=>{const n=()=>s,s={tag:!1,inner:t,fold:(e)=>e(t),isValue:B,isError:r,map:n,mapError:e=>nn.error(e(t)),bind:n,exists:B,forall:r,getOr:h,or:h,getOrThunk:ja,orThunk:ja,getOrDie:em(String(t)),each:o,toOptional:e.none};return s},hl=(e,t)=>e.fold(()=>Sr(t),Mr),nn={value:Mr,error:Sr,fromOption:hl},fl=(e,t,n)=>{if(e.row>=t.length||e.column>R(t[0]))return nn.error("invalid start address out of table bounds, row: "+e.row+", column: "+e.column);const s=t.slice(e.row),o=s[0].cells.slice(e.column),i=R(n[0]),a=n.length;return nn.value({rowDelta:s.length-a,colDelta:o.length-i})},Cr=(e,t)=>{const n=R(e[0]),s=R(t[0]);return{rowDelta:0,colDelta:n-s}},xr=(e,t)=>{const n=e.length,s=t.length;return{rowDelta:n-s,colDelta:0}},kn=(e,t,n,s)=>{const o=t.section==="colgroup"?n.col:n.cell;return N(e,e=>k(o(),!0,s(e)))},bl=(e,t,n,s)=>{const o=e[e.length-1];return e.concat(N(t,()=>{const t=o.section==="colgroup"?n.colgroup:n.row,e=mo(o,t,h),i=kn(e.cells.length,e,n,e=>Js(s,e.toString()));return ao(e,i)}))},jl=(e,t,n,o)=>s(e,e=>{const s=kn(t,e,n,B);return so(e,o,s)}),yl=(e,t,n)=>s(e,e=>$(n,(n,s)=>{const o=kn(1,e,t,r)[0];return ro(n,s,o)},e)),st=(e,t,n)=>{const i=t.colDelta<0?jl:h,a=t.rowDelta<0?bl:h,c=ue(e),s=R(e[0]),l=D(c,e=>e===s-1),o=i(e,Math.abs(t.colDelta),n,l?s-1:s),d=ue(o);return a(o,Math.abs(t.rowDelta),n,zs(d,r))},wl=(e,t,n,s)=>{const a=P(e[t],n),o=O(s,a.element),i=e[t];return e.length>1&&R(i)>1&&(n>0&&o(M(i,n-1))||n<i.cells.length-1&&o(M(i,n+1))||t>0&&o(M(e[t-1],n))||t<e.length-1&&o(M(e[t+1],n)))},Ol=(e,t,n,s,o,i)=>{const a=e.row,c=e.column,l=n.length,d=R(n[0]),u=a+l,h=c+d+i.length,m=zs(i,r);for(let e=a;e<u;e++){let i=0;for(let r=c;r<h;r++){if(m[r]){i++;continue}wl(t,e,r,o)&&Tr(t,M(t[e],r),o,s.cell);const d=r-c-i,l=P(n[e-a],d),u=l.element,f=s.replace(u);it(t[e],r,k(f,!0,l.isLocked))}}return t},xl=(e,t,n)=>{const s=R(t[0]),o=b(t).cols.length+e.row,i=N(s-e.column,t=>t+e.column),a=W(i,e=>H(n,t=>t!==e)).getOr(s-1);return{row:o,column:a}},pr=(e,t,n)=>p(n,n=>n>=e.column&&n<=R(t[0])+e.column),El=(e,t,n,s,o)=>{const r=ue(t),i=xl(e,t,r),a=b(n).rows,c=pr(i,a,r),l=fl(i,t,a);return l.map(e=>{const r={...e,colDelta:e.colDelta-c.length},n=st(t,r,s),l=ue(n),d=pr(i,a,l);return Ol(i,n,a,s,o,d)})},fr=(e,t,n,o,i)=>{cl(t,e,i,o.cell);const r=xr(n,t),a=st(n,r,o),c=xr(t,a),l=st(t,c,o);return s(l,(t,n)=>so(t,e,a[n].cells))},mr=(e,t,n,s,o)=>{ll(t,e,o,s.cell);const d=ue(t),a=Cr(t,n),u={...a,colDelta:a.colDelta-d.length},r=st(t,u,s),{cols:h,rows:i}=b(r),c=ue(r),l=Cr(n,t),m={...l,colDelta:l.colDelta+c.length},f=yl(n,s,c),p=st(f,m,s);return[...h,...i.slice(0,e),...p,...i.slice(e,i.length)]},Sl=(e,t,n,s)=>mo(e,e=>s(e,n),t),hr=(e,t,n,s,o)=>{const{rows:i,cols:a}=b(e),r=i.slice(0,t),c=i.slice(t),l=Sl(i[n],(e,n)=>{const a=t>0&&t<i.length&&s(M(i[t-1],n),M(i[t],n)),r=a?P(i[t],n):k(o(e.element,s),!0,e.isLocked);return r},s,o);return[...a,...r,l,...c]},Fl=(e,t,n,s,o,i,a)=>{if(n==="colgroup"||!s){const t=P(e,o);return k(a(t.element,i),!0,!1)}return P(e,t)},ur=(e,t,n,o,i)=>s(e,e=>{const s=t>0&&t<R(e)&&o(M(e,t-1),M(e,t)),a=Fl(e,t,e.section,s,n,o,i);return ro(e,t,a)}),zl=(e,t)=>_(e,e=>{const s=e.cells,n=V(t,(e,t)=>t>=0&&t<e.length?e.slice(0,t).concat(e.slice(t+1)):e,s);return n.length>0?[he(e.element,n,e.section,e.isNew)]:[]}),Dl=(e,t,n)=>{const{rows:s,cols:o}=b(e);return[...o,...s.slice(0,t),...s.slice(n+1)]},Nl=(e,t,n,s)=>M(e[t],n)!==void 0&&t>0&&s(M(e[t-1],n),M(e[t],n)),Ll=(e,t,n)=>t>0&&n(M(e,t-1),M(e,t)),dr=(e,t,n,s)=>Nl(e,t,n,s)||Ll(e[t],n,s),Pl=(e,t)=>{const n=H(t,h)&&wt(e.cells);return n?r:(e,n,s)=>{const o=l(e.element);return o!=="th"||!t[s]}},Hl=(e,t)=>{const n=H(t,h)&&wt(e);return n?r:(e,n)=>{const o=l(e.element);return o!=="th"||!t[n]}},lr=(e,t,n,s)=>{const i=e=>e==="row"?za(t):fn(t),o=e=>i(e)?`${e}group`:e;if(e)return Ot(t)?o(n):null;if(s&&Ot(t)){const e=n==="row"?"col":"row";return o(e)}return null},Bl=(t,n)=>(s,o,i)=>e.some(lr(t,s.element,"col",n[i])),Vl=(t,n)=>(s,o)=>e.some(lr(t,s.element,"row",n[o])),cr=(e,t,n)=>k(n(e.element,t),!0,e.isLocked),En=(t,n,o,i,a,r,c)=>{const l=e=>D(n,t=>o(e.element,t.element));return s(t,(t,n)=>D4(t,(t,s)=>{if(l(t)){const l=c(t,n,s)?a(t,o,i):t;return r(l,n,s).each(t=>{M3(l.element,{scope:e.from(t)})}),l}return t}))},nr=(e,t,n)=>_(e,(s,o)=>dr(e,o,t,n)?[]:[P(s,t)]),Kl=(e,t,n)=>{const s=e[t];return _(s.cells,(s,o)=>dr(e,t,o,n)?[]:[s])},tr=(e,t,n,o,i)=>{const a=b(e).rows,r=_(t,e=>nr(a,e,o)),c=s(a,e=>wt(e.cells)),l=Hl(r,c),d=Vl(n,c);return En(e,r,o,i,cr,d,l)},Yl=(e,t,n,o,a,r,c)=>{const{cols:m,rows:l}=b(e),d=l[t[0]],f=_(t,e=>Kl(l,e,a)),u=s(d.cells,(e,t)=>wt(nr(l,t,a))),h=[...l];i(t,e=>{h[e]=c.transformRow(l[e],n)});const p=[...m,...h],g=Pl(d,u),v=Bl(o,u);return En(p,f,a,r,c.transformCell,v,g)},Za=(t,n,o,i)=>{const a=b(t).rows,c=s(n,e=>P(a[e.row],e.column));return En(t,c,o,i,cr,e.none,r)},Xl=e=>{if(!Xt(e))throw new Error("cases must be an array");if(e.length===0)throw new Error("there must be at least one case");const t=[],n={};return i(e,(s,o)=>{const r=at(s);if(r.length!==1)throw new Error("one and only one name per case");const i=r[0],a=s[i];if(n[i]!==void 0)throw new Error("duplicate key detected:"+i);if(i==="cata")throw new Error("cannot have a case named cata (sorry)");if(!Xt(a))throw new Error("case arguments must be an array");t.push(i),n[i]=(...n)=>{const s=n.length;if(s!==a.length)throw new Error("Wrong number of arguments to case "+i+". Expected "+a.length+" ("+a+"), got "+s);const r=e=>{const s=at(e);if(t.length!==s.length)throw new Error("Wrong number of arguments to match. Expected: "+t.join(",")+`
Actual: `+s.join(","));const o=H(t,e=>f(s,e));if(!o)throw new Error("Not all branches were specified when using match. Specified: "+s.join(", ")+`
Required: `+t.join(", "));return e[i].apply(null,n)};return{fold:(...t)=>{if(t.length!==e.length)throw new Error("Wrong number of arguments to fold. Expected "+e.length+", got "+t.length);const s=t[o];return s.apply(null,n)},match:r,log:e=>{console.log(e,{constructors:t,constructor:i,params:n})}}}}),n},be={generate:Xl},Zl=be.generate([{none:[]},{only:["index"]},{left:["index","next"]},{middle:["prev","index","next"]},{right:["prev","index"]}]),Te={...Zl},ed=(e,t)=>e.length===0?Te.none():e.length===1?Te.only(0):t===0?Te.left(0,1):t===e.length-1?Te.right(t-1,t):t>0&&t<e.length-1?Te.middle(t-1,t,t+1):Te.none(),td=(e,t,o,i,a)=>{const r=e.slice(0),c=ed(e,t),l=n(s(r,n(0))),d=e=>i.singleColumnWidth(r[e],o),u=(e,t)=>a.calcLeftEdgeDeltas(r,e,t,o,i.minCellWidth(),i.isRelative),h=(e,t,n)=>a.calcMiddleDeltas(r,e,t,n,o,i.minCellWidth(),i.isRelative),m=(e,t)=>a.calcRightEdgeDeltas(r,e,t,o,i.minCellWidth(),i.isRelative);return c.fold(l,d,u,h,m)},Ya=(e,t,n)=>{let s=0;for(let o=e;o<t;o++)s+=n[o]!==void 0?n[o]:0;return s},sd=(e,t)=>{const n=a.justCells(e);return s(n,e=>{const n=Ya(e.column,e.column+e.colspan,t);return{element:e.element,width:n,colspan:e.colspan}})},od=(e,t)=>{const n=a.justColumns(e);return s(n,(e,n)=>({element:e.element,width:t[n],colspan:e.colspan}))},id=(e,t)=>{const n=a.justCells(e);return s(n,e=>{const n=Ya(e.row,e.row+e.rowspan,t);return{element:e.element,height:n,rowspan:e.rowspan}})},ad=(e,t)=>s(e.all,(e,n)=>({element:e.element,height:t[n]})),rd=e=>V(e,(e,t)=>e+t,0),cd=(e,t)=>a.hasColumns(e)?od(e,t):sd(e,t),Fn=(e,t,n)=>{const s=cd(e,t);i(s,e=>{n.setElementWidth(e.element,e.width)})},Ka=(e,t,n,o,i)=>{const r=a.fromTable(e),u=i.getCellDelta(t),c=i.getWidths(r,i),l=n===r.grid.columns-1,d=o.clampTableDelta(c,n,u,i.minCellWidth(),l),h=td(c,n,d,i,o),m=s(h,(e,t)=>e+c[t]);Fn(r,m,i),o.resizeTable(i.adjustTableWidth,d,l)},ud=(e,t,n,o)=>{const r=a.fromTable(e),l=Ku(r,e,o),c=s(l,(e,s)=>n===s?Math.max(t+e,Bn()):e),d=id(r,c),u=ad(r,c);i(u,e=>{Dt(e.element,e.height)}),i(d,e=>{Dt(e.element,e.height)});const h=rd(c);Dt(e,h)},hd=(e,t,n,s,o)=>{const i=a.generate(t),r=s.getWidths(i,s),c=s.pixelWidth(),{newSizes:l,delta:d}=o.calcRedestributedWidths(r,c,n.pixelDelta,s.isRelative);Fn(i,l,s),s.adjustTableWidth(d)},md=(e,t,n,s)=>{const o=a.generate(t),i=s.getWidths(o,s);Fn(o,i,s)},ze=e=>{const t=(e,t)=>{const n=D(e,e=>e.column===t.column);return n?e:e.concat([t])};return $(e,t,[]).sort((e,t)=>e.column-t.column)},Wa=I("col"),$a=I("colgroup"),La=e=>l(e)==="tr"||$a(e),bd=e=>{const t=oe(e,"colspan",1),n=oe(e,"rowspan",1);return{element:e,colspan:t,rowspan:n}},jd=(t,n=bd)=>{const i=e=>Wa(e.element)?t.col(e):t.cell(e),a=e=>$a(e.element)?t.colgroup(e):t.row(e),s=t=>{if(La(t))return a({element:t});const s=t,r=i(n(s));return o=e.some({item:s,replacement:r}),r};let o=e.none();const r=(e,t)=>o.fold(()=>s(e),n=>t(e,n.item)?n.replacement:s(e));return{getOrInit:r}},yd=e=>t=>{const n=[],o=(e,t)=>W(n,n=>t(n.item,e)),s=s=>{const i=e==="td"?{scope:null}:{},o=t.replace(s,e,i);return n.push({item:s,sub:o}),o},i=(e,t)=>{if(La(e)||Wa(e))return e;const n=e;return o(n,t).fold(()=>s(n),o=>t(e,o.item)?o.sub:s(n))};return{replaceOrInit:i}},Na=e=>re(e,"scope").map(e=>e.substr(0,3)),wd=t=>{const o=e=>{const n=Na(e);return n.each(t=>g(e,"scope",t)),()=>{const s=t.cell({element:e,colspan:1,rowspan:1});return ae(s,"width"),ae(e,"width"),n.each(e=>g(s,"scope",e)),s}},i=t=>{const o=()=>{const n=jr(s(t,Na));if(n.length===0)return e.none();const o=n[0],i=["row","col"],a=D(n,e=>e!==o&&f(i,e));return a?e.none():e.from(o)};return ae(t[0],"width"),o().fold(()=>d(t[0],"scope"),e=>g(t[0],"scope",e+"group")),n(t[0])};return{unmerge:o,merge:i}},E={modification:jd,transform:yd,merging:wd},xd=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","table","thead","tfoot","tbody","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],Cd=(e,t)=>{const n=e.property().name(t);return f(["ol","ul"],n)},Ed=(e,t)=>{const n=e.property().name(t);return f(xd,n)},kd=(e,t)=>f(["br","img","hr","input"],e.property().name(t)),In=Ze(),Wn=e=>Ed(In,e),Md=e=>Cd(In,e),Fd=e=>kd(In,e),Td=e=>{const n=I("br"),s=e=>H(e,e=>n(e)||_e(e)&&Qn(e).trim().length===0),o=e=>l(e)==="li"||$e(e,Md).isSome(),i=e=>Gt(e).map(e=>!!Wn(e)||!!Fd(e)&&l(e)!=="img").getOr(!1),a=e=>wa(e).bind(s=>{const a=i(s);return pe(s).map(i=>a===!0||o(i)||n(s)||Wn(i)&&!c(e,i)?[]:[t.fromTag("br")])}).getOr([]),r=()=>{const n=_(e,e=>{const t=z(e);return s(t)?[]:t.concat(a(e))});return n.length===0?[t.fromTag("br")]:n},d=r();Rs(e[0]),se(e[0],d)},Sa=e=>sc(e,!0),xa=e=>{const t=Pe(e);t.length===0&&C(e)},Ut=(e,t)=>({grid:e,cursor:t}),Ld=e=>te(e,e=>te(e.cells,e=>{const t=e.element;return gn(Sa(t),t)})),Rd=(t,n,s)=>{var o,i;const a=b(t).rows;return e.from((i=(o=a[n])===null||o===void 0?void 0:o.cells[s])===null||i===void 0?void 0:i.element).filter(Sa).orThunk(()=>Ld(a))},x=(e,t,n)=>{const s=Rd(e,t,n);return Ut(e,s)},Wt=e=>{const t=(e,t)=>{const n=D(e,e=>e.row===t.row);return n?e:e.concat([t])};return $(e,t,[]).sort((e,t)=>e.row-t.row)},Id=(e,t,n,s)=>{const o=t[0].row,i=Wt(t),a=V(i,(e,t)=>{const i=hr(e.grid,o,t.row+e.delta,n,s.getOrInit);return{grid:i,delta:e.delta+1}},{grid:e,delta:0}).grid;return x(a,o,t[0].column)},Bd=(e,t,n,s)=>{const o=Wt(t),i=o[o.length-1],a=i.row+i.rowspan,r=V(o,(e,t)=>hr(e,a,t.row,n,s.getOrInit),e);return x(r,a,t[0].column)},Vd=(e,t,n,s)=>{const o=t.details,i=ze(o),a=i[0].column,r=V(i,(e,t)=>{const o=ur(e.grid,a,t.column+e.delta,n,s.getOrInit);return{grid:o,delta:e.delta+1}},{grid:e,delta:0}).grid;return x(r,o[0].row,a)},$d=(e,t,n,s)=>{const o=t.details,i=o[o.length-1],a=i.column+i.colspan,r=ze(o),c=V(r,(e,t)=>ur(e,a,t.column,n,s.getOrInit),e);return x(c,o[0].row,a)},Wd=(e,t,n,o)=>{const i=ze(t),a=s(i,e=>e.column),r=tr(e,a,!0,n,o.replaceOrInit);return x(r,t[0].row,t[0].column)},Ud=(e,t,n,s)=>{const o=Za(e,t,n,s.replaceOrInit);return x(o,t[0].row,t[0].column)},Kd=(e,t,n,o)=>{const i=ze(t),a=s(i,e=>e.column),r=tr(e,a,!1,n,o.replaceOrInit);return x(r,t[0].row,t[0].column)},qd=(e,t,n,s)=>{const o=Za(e,t,n,s.replaceOrInit);return x(o,t[0].row,t[0].column)},Xn=(e,t)=>(n,o,i,a,r)=>{const c=Wt(o),l=s(c,e=>e.row),d=Yl(n,l,e,t,i,a.replaceOrInit,r);return x(d,o[0].row,o[0].column)},Gd=Xn("thead",!0),Xd=Xn("tbody",!1),Qd=Xn("tfoot",!1),Zd=(e,t)=>{const i=ze(t.details),a=zl(e,s(i,e=>e.column)),r=a.length>0?a[0].cells.length-1:0;return x(a,i[0].row,Math.min(i[0].column,r))},Jd=(e,t)=>{const o=Wt(t),i=Dl(e,o[0].row,o[o.length-1].row),a=i.length>0?i.length-1:0;return x(i,Math.min(t[0].row,a),t[0].column)},eu=(t,n,s,o)=>{const i=n.cells;Td(i);const a=il(t,n.bounds,s,o.merge(i));return Ut(a,e.from(i[0]))},tu=(t,n,s,o)=>{const i=(e,t)=>Tr(e,t,s,o.unmerge(t)),a=V(n,i,t);return Ut(a,e.from(n[0]))},nu=(t,n,s)=>{const i=(e,t)=>{const n=a.fromTable(e);return ct(n,t,!0)},r=i(n.clipboard,n.generators),c=H2(n.row,n.column),l=El(c,t,r,n.generators,s);return l.fold(()=>Ut(t,e.some(n.element)),e=>x(e,n.row,n.column))},Vt=(e,t,n)=>{const s=S0(e,n.section),o=a.generate(s);return ct(o,t,!0)},ou=(e,t,n)=>{const o=b(e).rows,i=t.cells[0].column,a=o[t.cells[0].row],r=Vt(t.clipboard,t.generators,a),c=fr(i,e,r,t.generators,n);return x(c,t.cells[0].row,t.cells[0].column)},iu=(e,t,n)=>{const o=b(e).rows,i=t.cells[t.cells.length-1].column+t.cells[t.cells.length-1].colspan,a=o[t.cells[0].row],r=Vt(t.clipboard,t.generators,a),c=fr(i,e,r,t.generators,n);return x(c,t.cells[0].row,t.cells[0].column)},au=(e,t,n)=>{const i=b(e).rows,o=t.cells[0].row,a=i[o],r=Vt(t.clipboard,t.generators,a),c=mr(o,e,r,t.generators,n);return x(c,t.cells[0].row,t.cells[0].column)},ru=(e,t,n)=>{const o=b(e).rows,i=t.cells[t.cells.length-1].row+t.cells[t.cells.length-1].rowspan,a=o[t.cells[0].row],r=Vt(t.clipboard,t.generators,a),c=mr(i,e,r,t.generators,n);return x(c,t.cells[0].row,t.cells[0].column)},cu=(e,t)=>{const n=a.fromTable(e),o=G(n,t);return o.bind(e=>{const t=e[e.length-1],o=e[0].column,i=t.column+t.colspan,a=ji(s(n.all,e=>p(e.cells,e=>e.column>=o&&e.column<i)));return Ks(a)}).getOr("")},lu=(e,t)=>{const n=a.fromTable(e),s=G(n,t);return s.bind(Ks).getOr("")},du=(e,t)=>{const n=a.fromTable(e),s=G(n,t);return s.bind(e=>{const t=e[e.length-1],s=e[0].row,o=t.row+t.rowspan,i=n.all.slice(s,o);return Oc(i)}).getOr("")},ns=(e,t,n,s)=>md(e,t,n,s.sizing),ss=(e,t,n,s)=>hd(e,t,n,s.sizing,s.resize),la=(e,t)=>D(t,e=>e.column===0&&e.isLocked),ca=(e,t)=>D(t,t=>t.column+t.colspan>=e.grid.columns&&t.isLocked),ra=(e,t)=>{const n=$s(e),s=ze(t);return $(s,(e,t)=>{const s=n[t.column],o=s.map(eo).getOr(0);return e+o},0)},aa=e=>(t,n)=>G(t,n).filter(n=>{const s=e?la:ca;return!s(t,n)}).map(e=>({details:e,pixelDelta:ra(t,e)})),vu=(e,t)=>ne(e,t).map(t=>({details:t,pixelDelta:-ra(e,t)})),ia=e=>(t,n)=>Vn(t,n).filter(n=>{const s=e?la:ca;return!s(t,n.cells)}),is=E.transform("th"),vt=E.transform("td"),_u=v(Id,G,o,o,E.modification),wu=v(Bd,G,o,o,E.modification),Ou=v(Vd,aa(!0),ss,o,E.modification),xu=v($d,aa(!1),ss,o,E.modification),Cu=v(Zd,vu,ss,xa,E.modification),Eu=v(Jd,G,o,xa,E.modification),ku=v(Wd,ne,o,o,is),Au=v(Kd,ne,o,o,vt),Su=v(Gd,ne,o,o,is),Mu=v(Xd,ne,o,o,vt),Fu=v(Qd,ne,o,o,vt),Tu=v(Ud,ne,o,o,is),zu=v(qd,ne,o,o,vt),Du=v(eu,sl,ns,o,E.merging),Nu=v(tu,ol,ns,o,E.merging),Lu=v(nu,Gc,ns,o,E.modification),Ru=v(ou,ia(!0),o,o,E.modification),Pu=v(iu,ia(!1),o,o,E.modification),Hu=v(au,Vn,o,o,E.modification),Iu=v(ru,Vn,o,o,E.modification),Bu=cu,Vu=lu,$u=du,ta=(e,t)=>e.dispatch("NewRow",{node:t}),Xi=(e,t)=>e.dispatch("NewCell",{node:t}),ce=(e,t,n)=>{e.dispatch("TableModified",{...n,table:t})},qu=(e,t,n,s,o)=>{e.dispatch("TableSelectionChange",{cells:t,start:n,finish:s,otherCells:o})},Yu=e=>{e.dispatch("TableSelectionClear")},Gu=(e,t,n,s,o)=>{e.dispatch("ObjectResizeStart",{target:t,width:n,height:s,origin:o})},Xu=(e,t,n,s,o)=>{e.dispatch("ObjectResized",{target:t,width:n,height:s,origin:o})},Rt={structure:!1,style:!0},m={structure:!0,style:!1},Ju={structure:!0,style:!0},Le=e=>t=>t.options.get(e),Ii="100%",Hi=e=>{var n;const s=e.dom,o=(n=s.getParent(e.selection.getStart(),s.isBlock))!==null&&n!==void 0?n:e.getBody();return to(t.fromDom(o))+"px"},s1=(e,t)=>Ge(e)||!Ci(e)?t:Ne(e)?{...t,width:Hi(e)}:{...t,width:Ii},o1=(e,t)=>Ge(e)||Ci(e)?t:Ne(e)?{...t,width:Hi(e)}:{...t,width:Ii},i1=e=>{const t=e.options.register;t("table_clone_elements",{processor:"string[]"}),t("table_use_colgroups",{processor:"boolean",default:!0}),t("table_header_type",{processor:e=>{const t=f(["section","cells","sectionCells","auto"],e);return t?{value:e,valid:t}:{valid:!1,message:"Must be one of: section, cells, sectionCells or auto."}},default:"section"}),t("table_sizing_mode",{processor:"string",default:"auto"}),t("table_default_attributes",{processor:"object",default:{border:"1"}}),t("table_default_styles",{processor:"object",default:{"border-collapse":"collapse"}}),t("table_column_resizing",{processor:e=>{const t=f(["preservetable","resizetable"],e);return t?{value:e,valid:t}:{valid:!1,message:"Must be preservetable, or resizetable."}},default:"preservetable"}),t("table_resize_bars",{processor:"boolean",default:!0}),t("table_style_by_css",{processor:"boolean",default:!0})},Pi=t=>e.from(t.options.get("table_clone_elements")),r1=e=>{const t=e.options.get("object_resizing");return f(t.split(","),"table")},Ri=Le("table_header_type"),_s=Le("table_column_resizing"),Ni=e=>_s(e)==="preservetable",Di=e=>_s(e)==="resizetable",ws=Le("table_sizing_mode"),Nt=e=>ws(e)==="relative",Ne=e=>ws(e)==="fixed",Ge=e=>ws(e)==="responsive",g1=Le("table_resize_bars"),Ci=Le("table_style_by_css"),b1=e=>{const t=e.options,n=t.get("table_default_attributes");return t.isSet("table_default_attributes")?n:o1(e,n)},j1=e=>{const t=e.options,n=t.get("table_default_styles");return t.isSet("table_default_styles")?n:s1(e,n)},y1=Le("table_use_colgroups"),wi=(e,t)=>Nt(e)?Re.percentageSize(t):Ne(e)?Re.pixelSize(t):Re.getTableSize(t),w1=(n,s,a)=>{const u=e=>l(Jt(e))==="table",C=e=>!u(n)||Ps(e).rows>1,b=e=>!u(n)||Ps(e).columns>1,k=Pi(n),d=Di(n)?o:Ec,p=e=>{switch(Ri(n)){case"section":return tt.section();case"sectionCells":return tt.sectionCells();case"cells":return tt.cells();default:return tt.getTableSectionType(e,"section")}},v=(t,s)=>s.cursor.fold(()=>{const e=Pe(t);return Ct(e).filter(X).map(e=>{a.clearSelectedCells(t.dom);const s=n.dom.createRng();return s.selectNode(e.dom),n.selection.setRng(s),g(e,"data-mce-selected","1"),s})},s=>{const o=Sc(s),i=n.dom.createRng();return i.setStart(o.element.dom,o.offset),i.setEnd(o.element.dom,o.offset),n.selection.setRng(i),a.clearSelectedCells(t.dom),e.some(i)}),c=(o,a,r,c)=>(l,d,u=!1)=>{ye(l);const h=t.fromDom(n.getDoc()),m=Pn(r,h,k),f={sizing:wi(n,l),resize:Di(n)?hc():Ls(),section:p(l)};return a(l)?o(l,d,m,f).bind(e=>{s.refresh(l.dom),i(e.newRows,e=>{ta(n,e.dom)}),i(e.newCells,e=>{Xi(n,e.dom)});const t=v(l,e);return X(l)&&(ye(l),u||ce(n,l.dom,c)),t.map(e=>({rng:e,effect:c}))}):e.none()},j=c(Eu,C,o,m),y=c(Cu,b,o,m),_=c(_u,r,o,m),w=c(wu,r,o,m),O=c(Ou,r,d,m),x=c(xu,r,d,m),h=c(Du,r,o,m),E=c(Nu,r,o,m),f=c(Ru,r,o,m),A=c(Pu,r,o,m),S=c(Hu,r,o,m),M=c(Iu,r,o,m),F=c(Lu,r,o,Ju),T=c(Tu,r,o,m),z=c(zu,r,o,m),D=c(ku,r,o,m),N=c(Au,r,o,m),L=c(Su,r,o,m),R=c(Mu,r,o,m),P=c(Fu,r,o,m),H=Vu,I=Bu,B=$u;return{deleteRow:j,deleteColumn:y,insertRowsBefore:_,insertRowsAfter:w,insertColumnsBefore:O,insertColumnsAfter:x,mergeCells:h,unmergeCells:E,pasteColsBefore:f,pasteColsAfter:A,pasteRowsBefore:S,pasteRowsAfter:M,pasteCells:F,makeCellsHeader:T,unmakeCellsHeader:z,makeColumnsHeader:D,unmakeColumnsHeader:N,makeRowsHeader:L,makeRowsBody:R,makeRowsFooter:P,getTableRowType:B,getTableCellType:H,getTableColType:I}},_i=(e,t,n)=>{const s=oe(e,t,1);n===1||s<=1?d(e,t):g(e,t,Math.min(n,s))},yi=(e,t)=>n=>{const s=n.column+n.colspan-1,o=n.column;return s>=e&&o<t},C1=(e,n,o)=>{if(a.hasColumns(e)){const r=p(a.justColumns(e),yi(n,o)),c=s(r,e=>{const t=xe(e.element);return _i(t,"span",o-n),t}),i=t.fromTag("colgroup");return se(i,c),[i]}return[]},E1=(e,n,o)=>s(e.all,e=>{const a=p(e.cells,yi(n,o)),r=s(a,e=>{const t=xe(e.element);return _i(t,"colspan",o-n),t}),i=t.fromTag("tr");return se(i,r),i}),k1=(e,t)=>{const n=a.fromTable(e),s=ne(n,t);return s.map(e=>{const t=e[e.length-1],s=e[0].column,o=t.column+t.colspan,i=C1(n,s,o),a=E1(n,s,o);return[...i,...a]})},A1=(e,t,n)=>{const s=a.fromTable(e),o=G(s,t);return o.bind(e=>{const o=ct(s,n,!1),i=b(o).rows,a=i.slice(e[0].row,e[e.length-1].row+e[e.length-1].rowspan),r=_(a,e=>{const t=p(e.cells,e=>!e.isLocked);return t.length>0?[{...e,cells:t}]:[]}),t=It(r);return gn(t.length>0,t)}).map(e=>Rc(e))},ft=be.generate([{invalid:["raw"]},{pixels:["value"]},{percent:["value"]}]),bi=(e,t,n)=>{const s=n.substring(0,n.length-e.length),o=parseFloat(s);return s===o.toString()?t(o):ft.invalid(n)},F1=e=>un(e,"%")?bi("%",ft.percent,e):un(e,"px")?bi("px",ft.pixels,e):ft.invalid(e),le={...ft,from:F1},z1=(e,t)=>s(e,e=>{const n=le.from(e);return n.fold(()=>e,e=>{const n=e/t*100;return n+"%"},e=>e+"%")}),D1=(e,t,n)=>{const o=n/t;return s(e,e=>{const t=le.from(e);return t.fold(()=>e,e=>e*o+"px",e=>e/100*n+"px")})},N1=(e,t)=>{const s=e.fold(()=>n(""),e=>{const s=e/t;return n(s+"px")},()=>{const e=100/t;return n(e+"%")});return N(t,s)},L1=(e,t,n)=>e.fold(()=>t,e=>D1(t,n,e),e=>z1(t,n)),hi=(e,t,n)=>{const s=le.from(n),o=H(e,e=>e==="0px")?N1(s,e.length):L1(s,e,t);return B1(o)},ks=(e,t)=>e.length===0?t:V(e,(e,t)=>le.from(t).fold(n(0),h,h)+e,0),H1=(e,t)=>{const n=Math.floor(e);return{value:n+t,remainder:e-n}},I1=(e,t)=>le.from(e).fold(n(e),e=>e+t+"px",e=>e+t+"%"),B1=e=>{if(e.length===0)return e;const n=V(e,(e,t)=>{const n=le.from(t).fold(()=>({value:t,remainder:0}),e=>H1(e,"px"),e=>({value:e+"%",remainder:0}));return{output:[n.value].concat(e.output),remainder:e.remainder+n.remainder}},{output:[],remainder:0}),t=n.output;return t.slice(0,t.length-1).concat([I1(t[t.length-1],Math.round(n.remainder))])},V1=le.from,$1=(e,t,n)=>{i(t,t=>{const s=e.slice(t.column,t.colspan+t.column),o=ks(s,nt());j(t.element,"width",o+n)})},W1=(e,t,n)=>{i(t,(t,s)=>{const o=ks([e[s]],nt());j(t.element,"width",o+n)})},U1=(e,t,n,s)=>{i(n,t=>{const n=e.slice(t.row,t.rowspan+t.row),o=ks(n,Bn());j(t.element,"height",o+s)}),i(t,(t,n)=>{j(t.element,"height",e[n])})},li=e=>V1(e).fold(n("px"),n("px"),n("%")),ci=(e,t,n)=>{const s=a.fromTable(e),i=s.all,o=a.justCells(s),r=a.justColumns(s);t.each(t=>{const n=li(t),c=Q(e),l=Zu(s,e),i=hi(l,c,t);a.hasColumns(s)?W1(i,r,n):$1(i,o,n),j(e,"width",t)}),n.each(t=>{const n=li(t),a=Is(e),r=Uu(s,e,Ms),c=hi(r,a,t);U1(c,i,o,n),j(e,"height",t)})},ri=h1,oi=u1,si=d1,Tt=e=>{d(e,"width")},mt=t=>{const n=Ti(t);ci(t,e.some(n),e.none()),Tt(t)},Ds=t=>{const n=m1(t);ci(t,e.some(n),e.none()),Tt(t)},Wo=e=>{ae(e,"width");const t=qn(e),n=t.length>0?t:Pe(e);i(n,e=>{ae(e,"width"),Tt(e)}),Tt(e)},t4={styles:{"border-collapse":"collapse",width:"100%"},attributes:{border:"1"},colGroups:!1},n4=()=>t.fromTag("th"),s4=()=>t.fromTag("td"),o4=()=>t.fromTag("col"),i4=(e,n,s,o)=>{const i=t.fromTag("tr");for(let a=0;a<e;a++){const r=o<n||a<s?n4():s4();a<s&&g(r,"scope","row"),o<n&&g(r,"scope","col"),u(r,t.fromTag("br")),u(i,r)}return i},a4=e=>{const n=t.fromTag("colgroup");return N(e,()=>u(n,o4())),n},Bo=(e,t,n,s)=>N(e,e=>i4(t,n,s,e)),c4=(e,n,s,o,i,a=t4)=>{const r=t.fromTag("table"),c=i!=="cells";Ke(r,a.styles),We(r,a.attributes),a.colGroups&&u(r,a4(n));const l=Math.min(e,s);if(c&&s>0){const e=t.fromTag("thead");u(r,e);const a=i==="sectionCells"?l:0,c=Bo(s,n,a,o);se(e,c)}const d=t.fromTag("tbody");u(r,d);const h=c?e-l:e,m=c?0:s,f=Bo(h,n,m,o);return se(d,f),r},l4=e=>e.dom.innerHTML,d4=e=>{const n=t.fromTag("div"),s=t.fromDom(e.dom.cloneNode(!0));return u(n,s),l4(n)},u4=(e,t)=>{e.selection.select(t.dom,!0),e.selection.collapse(!0)},h4=(e,t)=>{Je(t,"td,th").each(O(u4,e))},m4=(e,t)=>{i(U(t,"tr"),t=>{ta(e,t.dom),i(U(t,"th,td"),t=>{Xi(e,t.dom)})})},f4=e=>rt(e)&&e.indexOf("%")!==-1,p4=(e,t,n,s,o)=>{const i=j1(e),a={styles:i,attributes:b1(e),colGroups:y1(e)};return e.undoManager.ignore(()=>{const i=c4(n,t,o,s,Ri(e),a);g(i,"data-mce-id","__mce");const r=d4(i);e.insertContent(r),e.addVisual()}),Je(Jt(e),'table[data-mce-id="__mce"]').map(t=>(Ne(e)?Ds(t):Ge(e)?Wo(t):(Nt(e)||f4(i.width))&&mt(t),ye(t),d(t,"data-mce-id"),m4(e,t),h4(e,t),t.dom)).getOrNull()},g4=(e,t,n,s={})=>{const o=e=>Sn(e)&&e>0;if(o(t)&&o(n)){const o=s.headerRows||0,i=s.headerColumns||0;return p4(e,n,t,i,o)}return console.error("Invalid values for mceInsertTable - rows and columns values are required to insert a table."),null};Be=tinymce.util.Tools.resolve("tinymce.FakeClipboard");const Do="x-tinymce/dom-table-",Bs=Do+"rows",Ws=Do+"columns",Eo=e=>{const t=Be.FakeClipboardItem(e);Be.write([t])},Us=t=>{var n;const s=(n=Be.read())!==null&&n!==void 0?n:[];return te(s,n=>e.from(n.getType(t)))},xo=e=>{Us(e).isSome()&&Be.clear()},Oo=e=>{e.fold(E4,e=>Eo({[Bs]:e}))},_o=()=>Us(Bs),E4=()=>xo(Bs),jo=e=>{e.fold(S4,e=>Eo({[Ws]:e}))},bo=()=>Us(Ws),S4=()=>xo(Ws),Xs=e=>Uc(sn(e),Ie(e)),F4=e=>hs(sn(e),Ie(e)),T4=(n,a)=>{const l=Ie(n),w=()=>Xs(n).each(e=>{A(e,l).filter(Dn(l)).each(e=>{const s=t.fromText("");if(dt(e,s),C(e),n.dom.isEmpty(n.getBody()))n.setContent(""),n.selection.setCursorLocation();else{const e=n.dom.createRng();e.setStart(s.dom,0),e.setEnd(s.dom,0),n.selection.setRng(e),n.nodeChanged()}})}),_=e=>Xs(n).each(t=>{const s=Ge(n)||Ne(n)||Nt(n);s||A(t,l).each(t=>{e==="relative"&&!ri(t)?mt(t):e==="fixed"&&!oi(t)?Ds(t):e==="responsive"&&!si(t)&&Wo(t),ye(t),ce(n,t.dom,m)})}),f=e=>A(e,l),c=e=>F4(n).bind(t=>f(t).map(n=>e(n,t))),y=(e,t)=>{c(e=>{n.formatter.toggle("tableclass",{value:t},e.dom),ce(n,e.dom,Rt)})},b=(e,t)=>{c(e=>{const s=q(n),o=H(s,e=>n.formatter.match("tablecellclass",{value:t},e.dom)),a=o?n.formatter.remove:n.formatter.apply;i(s,e=>a("tablecellclass",{value:t},e.dom)),ce(n,e.dom,Rt)})},j=()=>{Xs(n).each(e=>{A(e,l).each(s=>{_n(s,"caption").fold(()=>{const e=t.fromTag("caption");u(e,t.fromText("Caption")),i3(s,e,0),n.selection.setCursorLocation(e.dom,0)},t=>{I("caption")(e)&&sr("td",s).each(e=>n.selection.setCursorLocation(e.dom,0)),C(t)}),ce(n,s.dom,m)})})},p=e=>{n.focus()},r=(e,t=!1)=>c((s,o)=>{const i=Kt(q(n),s,o);e(s,i,t).each(p)}),g=()=>c((s,i)=>{const a=Kt(q(n),s,i),r=Pn(o,t.fromDom(n.getDoc()),e.none());return A1(s,a,r)}),v=()=>c((e,t)=>{const s=Kt(q(n),e,t);return k1(e,s)}),d=(e,o)=>o().each(o=>{const i=s(o,e=>xe(e));c((s,o)=>{const a=Da(t.fromDom(n.getDoc())),r=qc(q(n),o,i,a);e(s,r).each(p)})}),h=e=>(t,n)=>mh(n,"type").each(t=>{r(e(t),n.no_events)});T({mceTableSplitCells:()=>r(a.unmergeCells),mceTableMergeCells:()=>r(a.mergeCells),mceTableInsertRowBefore:()=>r(a.insertRowsBefore),mceTableInsertRowAfter:()=>r(a.insertRowsAfter),mceTableInsertColBefore:()=>r(a.insertColumnsBefore),mceTableInsertColAfter:()=>r(a.insertColumnsAfter),mceTableDeleteCol:()=>r(a.deleteColumn),mceTableDeleteRow:()=>r(a.deleteRow),mceTableCutCol:()=>v().each(e=>{jo(e),r(a.deleteColumn)}),mceTableCutRow:()=>g().each(e=>{Oo(e),r(a.deleteRow)}),mceTableCopyCol:()=>v().each(e=>jo(e)),mceTableCopyRow:()=>g().each(e=>Oo(e)),mceTablePasteColBefore:()=>d(a.pasteColsBefore,bo),mceTablePasteColAfter:()=>d(a.pasteColsAfter,bo),mceTablePasteRowBefore:()=>d(a.pasteRowsBefore,_o),mceTablePasteRowAfter:()=>d(a.pasteRowsAfter,_o),mceTableDelete:w,mceTableCellToggleClass:b,mceTableToggleClass:y,mceTableToggleCaption:j,mceTableSizingMode:(e,t)=>_(t),mceTableCellType:h(e=>e==="th"?a.makeCellsHeader:a.unmakeCellsHeader),mceTableColType:h(e=>e==="th"?a.makeColumnsHeader:a.unmakeColumnsHeader),mceTableRowType:h(e=>{switch(e){case"header":return a.makeRowsHeader;case"footer":return a.makeRowsFooter;default:return a.makeRowsBody}})},(e,t)=>n.addCommand(t,e)),n.addCommand("mceInsertTable",(e,t)=>{g4(n,t.rows,t.columns,t.options)}),n.addCommand("mceTableApplyCellStyle",(e,t)=>{const o=e=>"tablecell"+e.toLowerCase().replace("-","");if(!km(t))return;const s=q(n);if(s.length===0)return;const a=fh(t,(e,t)=>n.formatter.has(o(t))&&rt(e));if(U3(a))return;T(a,(e,t)=>{const a=o(t);i(s,t=>{e===""?n.formatter.remove(a,{value:null},t.dom,!0):n.formatter.apply(a,{value:e},t.dom)})}),f(s[0]).each(e=>ce(n,e.dom,Rt))})},z4=(e,t)=>{const s=Ie(e),n=t=>hs(sn(e)).bind(n=>A(n,s).map(s=>{const o=Kt(q(e),s,n);return t(s,o)})).getOr("");T({mceTableRowType:()=>n(t.getTableRowType),mceTableCellType:()=>n(t.getTableCellType),mceTableColType:()=>n(t.getTableColType)},(t,n)=>e.addQueryValueHandler(n,t))},Rn=be.generate([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),N4=(e,t,n,s)=>e.fold(t,n,s),L4=e=>e.fold(h,h,h),R4=Rn.before,P4=Rn.on,H4=Rn.after,w={before:R4,on:P4,after:H4,cata:N4,getStart:L4},B4=(e,t)=>({selection:e,kill:t}),Oe={create:B4},$4=(e,t)=>{const n=e.document.createRange();return n.selectNode(t.dom),n},W4=(e,t)=>{const n=e.document.createRange();return U4(n,t),n},U4=(e,t)=>e.selectNodeContents(t.dom),K4=(e,t)=>{t.fold(t=>{e.setStartBefore(t.dom)},(t,n)=>{e.setStart(t.dom,n)},t=>{e.setStartAfter(t.dom)})},q4=(e,t)=>{t.fold(t=>{e.setEndBefore(t.dom)},(t,n)=>{e.setEnd(t.dom,n)},t=>{e.setEndAfter(t.dom)})},po=(e,t,n)=>{const s=e.document.createRange();return K4(s,t),q4(s,n),s},Gs=(e,t,n,s,o)=>{const i=e.document.createRange();return i.setStart(t.dom,n),i.setEnd(s.dom,o),i},X4=e=>({left:e.left,top:e.top,right:e.right,bottom:e.bottom,width:e.width,height:e.height}),Q4=t=>{const s=t.getClientRects(),n=s.length>0?s[0]:t.getBoundingClientRect();return n.width>0||n.height>0?e.some(n).map(X4):e.none()},Ue=be.generate([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),vo=(e,n,s)=>n(t.fromDom(s.startContainer),s.startOffset,t.fromDom(s.endContainer),s.endOffset),e0=(t,s)=>s.match({domRange:t=>({ltr:n(t),rtl:e.none}),relative:(n,s)=>({ltr:Ve(()=>po(t,n,s)),rtl:Ve(()=>e.some(po(t,s,n)))}),exact:(n,s,o,i)=>({ltr:Ve(()=>Gs(t,n,s,o,i)),rtl:Ve(()=>e.some(Gs(t,o,i,n,s)))})}),t0=(e,n)=>{const s=n.ltr();if(s.collapsed){const o=n.rtl().filter(e=>e.collapsed===!1);return o.map(e=>Ue.rtl(t.fromDom(e.endContainer),e.endOffset,t.fromDom(e.startContainer),e.startOffset)).getOrThunk(()=>vo(e,Ue.ltr,s))}return vo(e,Ue.ltr,s)},Co=(e,t)=>{const n=e0(e,t);return t0(e,n)},Vs=(e,t)=>{const n=Co(e,t);return n.match({ltr:(t,n,s,o)=>{const i=e.document.createRange();return i.setStart(t.dom,n),i.setEnd(s.dom,o),i},rtl:(t,n,s,o)=>{const i=e.document.createRange();return i.setStart(s.dom,o),i.setEnd(t.dom,n),i}})};Ue.ltr,Ue.rtl;const o0=(e,t,n,s)=>({start:e,soffset:t,finish:n,foffset:s}),qe={create:o0},a0=(e,t,n,s)=>({start:w.on(e,t),finish:w.on(n,s)}),Lo={create:a0},Io=(e,n)=>{const s=Vs(e,n);return qe.create(t.fromDom(s.startContainer),s.startOffset,t.fromDom(s.endContainer),s.endOffset)},At=Lo.create,d0=(t,n,s,o,i,a,r)=>c(s,i)&&o===a?e.none():y(s,"td,th",n).bind(e=>y(i,"td,th",n).bind(s=>vi(t,n,e,s,r))),vi=(t,n,s,o,i)=>c(s,o)?e.none():ln(s,o,n).bind(n=>{const o=n.boxes.getOr([]);return o.length>1?(i(t,o,n.start,n.finish),e.some(Oe.create(e.some(At(s,0,s,ie(s))),!0))):e.none()}),h0=(e,t,n,s,o)=>{const i=e=>(o.clearBeforeUpdate(n),o.selectRange(n,e.boxes,e.start,e.finish),e.boxes);return pl(s,e,t,o.firstSelectedSelector,o.lastSelectedSelector).map(i)},vs=(e,t)=>({item:e,mode:t}),qi=(e,t,n,s=we)=>e.property().parent(t).map(e=>vs(e,s)),we=(e,t,n,s=lt)=>n.sibling(e,t).map(e=>vs(e,s)),lt=(e,t,n,s=lt)=>{const o=e.property().children(t),i=n.first(o);return i.map(e=>vs(e,s))},v0=[{current:qi,next:we,fallback:e.none()},{current:we,next:lt,fallback:e.some(qi)},{current:lt,next:lt,fallback:e.some(we)}],na=(e,t,n,s,o=v0)=>{const i=W(o,e=>e.current===n);return i.bind(n=>n.current(e,t,s,n.next).orThunk(()=>n.fallback.bind(n=>na(e,t,n,s))))},j0=()=>{const t=(e,t)=>e.query().prevSibling(t),n=t=>t.length>0?e.some(t[t.length-1]):e.none();return{sibling:t,first:n}},y0=()=>{const t=(e,t)=>e.query().nextSibling(t),n=t=>t.length>0?e.some(t[0]):e.none();return{sibling:t,first:n}},oa={left:j0,right:y0},os=(t,n,s,o,i,a)=>{const r=na(t,n,o,i);return r.bind(n=>a(n.item)?e.none():s(n.item)?e.some(n.item):os(t,n.item,s,n.mode,i,a))},O0=(e,t,n,s)=>os(e,t,n,we,oa.left(),s),x0=(e,t,n,s)=>os(e,t,n,we,oa.right(),s),da=e=>t=>e.property().children(t).length===0,E0=(e,t,n)=>ua(e,t,da(e),n),k0=(e,t,n)=>io(e,t,da(e),n),ua=O0,io=x0,$t=Ze(),Ma=(e,t)=>E0($t,e,t),Pa=(e,t)=>k0($t,e,t),z0=(e,t,n)=>ua($t,e,t,n),D0=(e,t,n)=>io($t,e,t,n),N0=(e,t,n)=>$e(e,t,n).isSome(),an=be.generate([{none:["message"]},{success:[]},{failedUp:["cell"]},{failedDown:["cell"]}]),R0=(e,t,n)=>{const s=e.getRect(t),o=e.getRect(n);return o.right>s.left&&o.left<s.right},P0=e=>y(e,"tr"),H0=(e,t,n,s,o,i,a)=>y(s,"td,th",a).bind(n=>y(t,"td,th",a).map(t=>c(n,t)?c(s,n)&&ie(n)===o?i(t):an.none("in same cell"):jn(P0,[n,t]).fold(()=>R0(e,t,n)?an.success():i(t),e=>i(t)))).getOr(an.none("default")),I0=(e,t,n,s,o)=>e.fold(t,n,s,o),Me={...an,verify:H0,cata:I0},V0=(e,t,n,s)=>({parent:e,children:t,element:n,index:s}),$0=e=>pe(e).bind(t=>{const n=z(t);return W0(n,e).map(s=>V0(t,n,e,s))}),W0=(e,t)=>xs(e,O(c,t)),On=I("br"),wn=(t,n,s)=>n(t,s).bind(t=>_e(t)&&Qn(t).trim().length===0?wn(t,n,s):e.some(t)),q0=(e,t,n)=>n.traverse(t).orThunk(()=>wn(t,n.gather,e)).map(n.relative),Y0=(e,t)=>Yt(e,t).filter(On).orThunk(()=>Yt(e,t-1).filter(On)),G0=(e,t,n,s)=>Y0(t,n).bind(t=>s.traverse(t).fold(()=>wn(t,s.gather,e).map(s.relative),e=>$0(e).map(e=>w.on(e.parent,e.index)))),X0=(e,t,n,s)=>{const o=On(t)?q0(e,t,s):G0(e,t,n,s);return o.map(e=>({start:e,finish:e}))},Q0=t=>Me.cata(t,t=>e.none(),()=>e.none(),t=>e.some(ht(t,0)),t=>e.some(ht(t,ie(t)))),dn=(e,t)=>({left:e.left,top:e.top+t,right:e.right,bottom:e.bottom+t}),bt=(e,t)=>({left:e.left,top:e.top-t,right:e.right,bottom:e.bottom-t}),_r=(e,t,n)=>({left:e.left+t,top:e.top+n,right:e.right+t,bottom:e.bottom+n}),t2=e=>e.top,n2=e=>e.bottom,s2=(t,n,s)=>s>=0&&s<ie(n)?t.getRangedRect(n,s,n,s+1):s>0?t.getRangedRect(n,s-1,n,s):e.none(),rn=e=>({left:e.left,top:e.top,right:e.right,bottom:e.bottom}),wr=(t,n)=>e.some(t.getRect(n)),Lr=(t,n,s)=>Y(n)?wr(t,n).map(rn):_e(n)?s2(t,n,s).map(rn):e.none(),Pr=(t,n)=>Y(n)?wr(t,n).map(rn):_e(n)?t.getRangedRect(n,0,n,ie(n)).map(rn):e.none(),fe=5,l2=100,K=be.generate([{none:[]},{retry:["caret"]}]),u2=(e,t)=>e.left<t.left||Math.abs(t.right-e.left)<1||e.left>t.right,Ir=(e,t,n)=>i2(t,Wn).fold(B,t=>Pr(e,t).exists(e=>u2(n,e))),m2=(e,t,n,s,o)=>{const i=dn(o,fe);return Math.abs(n.bottom-s.bottom)<1?K.retry(i):n.top>o.bottom?K.retry(i):n.top===o.bottom?K.retry(dn(o,1)):Ir(e,t,o)?K.retry(_r(i,fe,0)):K.none()},f2=(e,t,n,s,o)=>{const i=bt(o,fe);return Math.abs(n.top-s.top)<1?K.retry(i):n.bottom<o.top?K.retry(i):n.bottom===o.top?K.retry(bt(o,1)):Ir(e,t,o)?K.retry(_r(i,fe,0)):K.none()},p2={point:t2,adjuster:f2,move:bt,gather:Ma},g2={point:n2,adjuster:m2,move:dn,gather:Pa},v2=(e,t,n)=>e.elementFromPoint(t,n).filter(e=>l(e)==="table").isSome(),b2=(e,t,n,s,o)=>Yn(e,t,n,t.move(s,fe),o),Yn=(t,n,s,o,i)=>i===0?e.some(o):v2(t,o.left,n.point(o))?b2(t,n,s,o,i-1):t.situsFromPoint(o.left,n.point(o)).bind(a=>a.start.fold(e.none,a=>Pr(t,a).bind(r=>n.adjuster(t,a,r,s,o).fold(e.none,e=>Yn(t,n,s,e,i-1))).orThunk(()=>e.some(o)),e.none)),y2=(t,n,s)=>t.point(n)>s.getInnerHeight()?e.some(t.point(n)-s.getInnerHeight()):t.point(n)<0?e.some(-t.point(n)):e.none(),Vr=(e,t,n)=>{const o=e.move(n,fe),s=Yn(t,e,n,o,l2).getOr(o);return y2(e,s,t).fold(()=>t.situsFromPoint(s.left,e.point(s)),n=>(t.scrollBy(0,n),t.situsFromPoint(s.left,e.point(s)-n)))},Zn={tryUp:O(Vr,p2),tryDown:O(Vr,g2),getJumpSize:n(fe)},O2=20,x2=(t,n,s)=>t.getSelection().bind(o=>X0(n,o.finish,o.foffset,s).fold(()=>e.some(ht(o.finish,o.foffset)),e=>{const i=t.fromSitus(e),a=Me.verify(t,o.finish,o.foffset,i.finish,i.foffset,s.failure,n);return Q0(a)})),es=(t,n,s,o,i,a)=>a===0?e.none():A2(t,n,s,o,i).bind(r=>{const l=t.fromSitus(r),d=Me.verify(t,s,o,l.finish,l.foffset,i.failure,n);return Me.cata(d,()=>e.none(),()=>e.some(r),e=>c(s,e)&&o===0?Ur(t,s,o,bt,i):es(t,n,e,0,i,a-1),e=>c(s,e)&&o===ie(e)?Ur(t,s,o,dn,i):es(t,n,e,ie(e),i,a-1))}),Ur=(e,t,n,s,o)=>Lr(e,t,n).bind(t=>Kr(e,o,s(t,Zn.getJumpSize()))),Kr=(t,n,s)=>{const o=So().browser;return o.isChromium()||o.isSafari()||o.isFirefox()?n.retry(t,s):e.none()},A2=(e,t,n,s,o)=>Lr(e,n,s).bind(t=>Kr(e,o,t)),S2=(e,t,n)=>x2(e,t,n).bind(s=>es(e,t,s.element,s.offset,n,O2).map(e.fromSitus)),M2=(e,t)=>N0(e,e=>pe(e).exists(e=>c(e,t))),Yr=(t,n,s,o,i)=>y(o,"td,th",n).bind(o=>y(o,"table",n).bind(a=>M2(i,a)?S2(t,n,s).bind(e=>y(e.finish,"td,th",n).map(t=>({start:o,finish:t,range:e}))):e.none())),Qr=(t,n,s,o,i,a)=>a(o,n).orThunk(()=>Yr(t,n,s,o,i).map(t=>{const n=t.range;return Oe.create(e.some(At(n.start,n.soffset,n.finish,n.foffset)),!0)})),z2=(t,n)=>y(t,"tr",n).bind(t=>y(t,"table",n).bind(s=>{const o=U(s,"tr");return c(t,o[0])?z0(s,e=>wa(e).isSome(),n).map(t=>{const n=ie(t);return Oe.create(e.some(At(t,n,t,n)),!0)}):e.none()})),D2=(t,n)=>y(t,"tr",n).bind(t=>y(t,"table",n).bind(s=>{const o=U(s,"tr");return c(t,o[o.length-1])?D0(s,e=>_a(e).isSome(),n).map(t=>Oe.create(e.some(At(t,0,t,0)),!0)):e.none()})),Jr=(e,t,n,s,o,i,a)=>Yr(e,n,s,o,i).bind(e=>vi(t,n,e.start,e.finish,a)),Fs=e=>{let t=e;const n=()=>t,s=e=>{t=e};return{get:n,set:s}},R2=t=>{const n=Fs(e.none()),s=()=>n.get().each(t),o=()=>{s(),n.set(e.none())},i=()=>n.get().isSome(),a=()=>n.get(),r=t=>{s(),n.set(e.some(t))};return{clear:o,isSet:i,get:a,set:r}},Ft=()=>{const e=R2(o),t=t=>e.get().each(t);return{...e,on:t}},dc=(e,t)=>y(e,"td,th",t),I2=(e,t,n,s)=>{const o=Ft(),i=o.clear,a=i=>{o.on(o=>{s.clearBeforeUpdate(t),dc(i.target,n).each(a=>{ln(o,a,n).each(n=>{const o=n.boxes.getOr([]);if(o.length===1){const n=o[0],a=Zr(n)==="false",r=bn(oc(i.target),n,c);a&&r&&(s.selectRange(t,o,n,n),e.selectContents(n))}else o.length>1&&(s.selectRange(t,o,n.start,n.finish),e.selectContents(a))})})})},r=e=>{s.clear(t),dc(e.target,n).each(o.set)},l=e=>{a(e)},d=e=>{a(e),i()};return{clearstate:i,mousedown:r,mouseover:l,mouseup:d}},mc={traverse:Gt,gather:Pa,relative:w.before,retry:Zn.tryDown,failure:Me.failedDown},fc={traverse:Fr,gather:Ma,relative:w.before,retry:Zn.tryUp,failure:Me.failedUp},Ce=e=>t=>t===e,Hs=Ce(38),xt=Ce(40),jt=e=>e>=37&&e<=40,q2={isBackward:Ce(37),isForward:Ce(39)},Y2={isBackward:Ce(39),isForward:Ce(37)},G2=e=>{const t=e!==void 0?e.dom:document,n=t.body.scrollLeft||t.documentElement.scrollLeft,s=t.body.scrollTop||t.documentElement.scrollTop;return J(n,s)},X2=(e,t,n)=>{const o=n!==void 0?n.dom:document,s=o.defaultView;s&&s.scrollBy(e,t)},Et=be.generate([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),Z2=e=>Et.exact(e.start,e.soffset,e.finish,e.foffset),J2=e=>e.match({domRange:e=>t.fromDom(e.startContainer),relative:(e)=>w.getStart(e),exact:(e)=>e}),e3=Et.domRange,t3=Et.relative,n3=Et.exact,s3=e=>{const t=J2(e);return g3(t)},o3=qe.create,Ee={domRange:e3,relative:t3,exact:n3,exactFromRange:Z2,getWin:s3,range:o3},a3=(t,n,s)=>{var o,i;return e.from((o=(i=t.dom).caretPositionFromPoint)===null||o===void 0?void 0:o.call(i,n,s)).bind(n=>{if(n.offsetNode===null)return e.none();const s=t.dom.createRange();return s.setStart(n.offsetNode,n.offset),s.collapse(),e.some(s)})},r3=(t,n,s)=>{var o,i;return e.from((o=(i=t.dom).caretRangeFromPoint)===null||o===void 0?void 0:o.call(i,n,s))},c3=(()=>document.caretPositionFromPoint?a3:document.caretRangeFromPoint?r3:e.none)(),l3=(e,n,s)=>{const o=t.fromDom(e.document);return c3(o,n,s).map(e=>qe.create(t.fromDom(e.startContainer),e.startOffset,t.fromDom(e.endContainer),e.endOffset))},qt=(e,t)=>{const n=l(e);return"input"===n?w.after(e):f(["br","img"],n)?t===0?w.before(e):w.after(e):w.on(e,t)},u3=(e,t)=>{const n=e.fold(w.before,qt,w.after),s=t.fold(w.before,qt,w.after);return Ee.relative(n,s)},h3=(e,t,n,s)=>{const o=qt(e,t),i=qt(n,s);return Ee.relative(o,i)},m3=(e,t,n,s)=>{const i=mn(e),o=i.dom.createRange();return o.setStart(e.dom,t),o.setEnd(n.dom,s),o},f3=(e,t,n,s)=>{const o=m3(e,t,n,s),i=c(e,n)&&t===s;return o.collapsed&&!i},on=t=>e.from(t.getSelection()),yr=(e,t)=>{on(e).each(e=>{e.removeAllRanges(),e.addRange(t)})},yn=(e,t,n,s,o)=>{const i=Gs(e,t,n,s,o);yr(e,i)},b3=(e,t,n,s,o,i)=>{t.collapse(n.dom,s),t.extend(o.dom,i)},ir=(e,t)=>Co(e,t).match({ltr:(t,n,s,o)=>{yn(e,t,n,s,o)},rtl:(t,n,s,o)=>{on(e).each(i=>{if(i.setBaseAndExtent)i.setBaseAndExtent(t.dom,n,s.dom,o);else if(i.extend)try{b3(e,i,t,n,s,o)}catch{yn(e,s,o,t,n)}else yn(e,s,o,t,n)})}}),Qa=(e,t,n,s,o)=>{const i=h3(t,n,s,o);ir(e,i)},Ia=(e,t,n)=>{const s=u3(t,n);ir(e,s)},Ra=n=>{if(n.rangeCount>0){const s=n.getRangeAt(0),o=n.getRangeAt(n.rangeCount-1);return e.some(qe.create(t.fromDom(s.startContainer),s.startOffset,t.fromDom(o.endContainer),o.endOffset))}return e.none()},O3=n=>{if(n.anchorNode===null||n.focusNode===null)return Ra(n);const s=t.fromDom(n.anchorNode),o=t.fromDom(n.focusNode);return f3(s,n.anchorOffset,o,n.focusOffset)?e.some(qe.create(s,n.anchorOffset,o,n.focusOffset)):Ra(n)},Fa=(e,t,n=!0)=>{const s=n?W4:$4,o=s(e,t);yr(e,o)},C3=e=>on(e).filter(e=>e.rangeCount>0).bind(O3),Ca=e=>C3(e).map(e=>Ee.exact(e.start,e.soffset,e.finish,e.foffset)),k3=(e,t)=>{const n=Vs(e,t);return Q4(n)},A3=(e,t,n)=>l3(e,t,n),S3=e=>{on(e).each(e=>e.removeAllRanges())},ts=e=>{const n=(n,s)=>t.fromPoint(t.fromDom(e.document),n,s),s=e=>e.dom.getBoundingClientRect(),o=(t,n,s,o)=>{const i=Ee.exact(t,n,s,o);return k3(e,i)},i=()=>Ca(e).map(t=>Io(e,t)),a=t=>{const n=Ee.relative(t.start,t.finish);return Io(e,n)},r=(t,n)=>A3(e,t,n).map(e=>Lo.create(e.start,e.soffset,e.finish,e.foffset)),c=()=>{S3(e)},l=(t=!1)=>{Ca(e).each(n=>n.fold(e=>e.collapse(t),(n,s)=>{const o=t?n:s;Ia(e,o,o)},(n,s,o,i)=>{const a=t?n:o,r=t?s:i;Qa(e,a,r,a,r)}))},d=t=>{Fa(e,t,!1)},u=t=>{Fa(e,t)},h=t=>{Qa(e,t.start,t.soffset,t.finish,t.foffset)},m=(t,n)=>{Ia(e,t,n)},f=()=>e.innerHeight,p=()=>{const n=G2(t.fromDom(e.document));return n.top},g=(n,s)=>{X2(n,s,t.fromDom(e.document))};return{elementFromPoint:n,getRect:s,getRangedRect:o,getSelection:i,fromSitus:a,situsFromPoint:r,clearSelection:c,collapseSelection:l,setSelection:h,setRelativeSelection:m,selectNode:d,selectContents:u,getInnerHeight:f,getScrollY:p,scrollBy:g}},Ae=(e,t)=>({rows:e,cols:t}),T3=(e,t,n,s)=>{const i=ts(e),o=I2(i,t,n,s);return{clearstate:o.clearstate,mousedown:o.mousedown,mouseover:o.mouseover,mouseup:o.mouseup}},z3=(t,n,s,o)=>{const i=ts(t),a=()=>(o.clear(n),e.none()),r=(t,r,c,l,d,u)=>{const f=t.raw,h=f.which,m=f.shiftKey===!0,p=xn(n,o.selectedSelector).fold(()=>(jt(h)&&!m&&o.clearBeforeUpdate(n),xt(h)&&m?O(Jr,i,n,s,mc,l,r,o.selectRange):Hs(h)&&m?O(Jr,i,n,s,fc,l,r,o.selectRange):xt(h)?O(Qr,i,s,mc,l,r,D2):Hs(h)?O(Qr,i,s,fc,l,r,z2):e.none),t=>{const s=s=>()=>{const a=te(s,e=>h0(e.rows,e.cols,n,t,o));return a.fold(()=>Or(n,o.firstSelectedSelector,o.lastSelectedSelector).map(t=>{const s=xt(h)||u.isForward(h)?w.after:w.before;return i.setRelativeSelection(w.on(t.first,0),s(t.table)),o.clear(n),Oe.create(e.none(),!0)}),t=>e.some(Oe.create(e.none(),!0)))};return xt(h)&&m?s([Ae(+1,0)]):Hs(h)&&m?s([Ae(-1,0)]):u.isBackward(h)&&m?s([Ae(0,-1),Ae(-1,0)]):u.isForward(h)&&m?s([Ae(0,+1),Ae(+1,0)]):jt(h)&&!m?a:e.none});return p()},c=(t,i,a,r,c)=>xn(n,o.selectedSelector).fold(()=>{const l=t.raw,d=l.which,u=l.shiftKey===!0;return u?jt(d)?d0(n,s,i,a,r,c,o.selectRange):e.none():e.none()},e.none);return{keydown:r,keyup:c}},D3=(e,t,n,s)=>{const o=ts(e);return(e,i)=>{s.clearBeforeUpdate(t),ln(e,i,n).each(e=>{const n=e.boxes.getOr([]);s.selectRange(t,n,e.start,e.finish),o.selectContents(i),o.collapseSelection()})}},ms=(e,t)=>{const n=De(e,t);return n===void 0||n===""?[]:n.split(" ")},L3=(e,t,n)=>{const s=ms(e,t),o=s.concat([n]);return g(e,t,o.join(" ")),!0},R3=(e,t,n)=>{const s=p(ms(e,t),e=>e!==n);return s.length>0?g(e,t,s.join(" ")):d(e,t),!1},_t=e=>e.dom.classList!==void 0,H3=e=>ms(e,"class"),I3=(e,t)=>L3(e,"class",t),B3=(e,t)=>R3(e,"class",t),Z=(e,t)=>{_t(e)?e.dom.classList.add(t):I3(e,t)},$3=e=>{const t=_t(e)?e.dom.classList:H3(e);t.length===0&&d(e,"class")},W3=(e,t)=>{if(_t(e)){const n=e.dom.classList;n.remove(t)}else B3(e,t);$3(e)},no=(e,t)=>_t(e)&&e.dom.classList.contains(t),K3=(e,t)=>{i(t,t=>{W3(e,t)})},q3=e=>t=>{Z(t,e)},Y3=e=>t=>{K3(t,e)},G3=e=>{const n=q3(e.selected),s=Y3([e.selected,e.lastSelected,e.firstSelected]),t=t=>{const n=U(t,e.selectedSelector);i(n,s)},o=(s,o,a,r)=>{t(s),i(o,n),Z(a,e.firstSelected),Z(r,e.lastSelected)};return{clearBeforeUpdate:t,clear:t,selectRange:o,selectedSelector:e.selectedSelector,firstSelectedSelector:e.firstSelectedSelector,lastSelectedSelector:e.lastSelectedSelector}},X3=(e,t,n)=>{const a=t=>{d(t,e.selected),d(t,e.firstSelected),d(t,e.lastSelected)},r=t=>{g(t,e.selected,"1")},s=e=>{o(e),n()},o=t=>{const n=U(t,`${e.selectedSelector},${e.firstSelectedSelector},${e.lastSelectedSelector}`);i(n,a)},c=(n,o,a,c)=>{s(n),i(o,r),g(a,e.firstSelected,"1"),g(c,e.lastSelected,"1"),t(o,a,c)};return{clearBeforeUpdate:o,clear:s,selectRange:c,selectedSelector:e.selectedSelector,firstSelectedSelector:e.firstSelectedSelector,lastSelectedSelector:e.lastSelectedSelector}},Q3={byClass:G3,byAttr:X3},Z3=(e,t,n,s)=>{switch(e.tag){case"none":return t();case"single":return s(e.element);case"multiple":return n(e.elements)}},J3=()=>({tag:"none"}),eh=e=>({tag:"multiple",elements:e}),th=e=>({tag:"single",element:e}),nh=(e,t,n)=>{const s=()=>Er(e(),n).fold(()=>t().fold(J3,th),eh);return{get:s}},sh=(e,t)=>{const n=e.slice(0,t[t.length-1].row+1),o=It(n);return _(o,e=>{const n=e.cells.slice(0,t[t.length-1].column+1);return s(n,e=>e.element)})},oh=(e,t)=>{const n=e.slice(t[0].row+t[0].rowspan-1,e.length),o=It(n);return _(o,e=>{const n=e.cells.slice(t[0].column+t[0].colspan-1,e.cells.length);return s(n,e=>e.element)})},ih=(e,t,n)=>{const s=a.fromTable(e),o=G(s,t);return o.map(e=>{const o=ct(s,n,!1),{rows:t}=b(o),i=sh(t,e),a=oh(t,e);return{upOrLeftCells:i,downOrRightCells:a}})},ah=(e,t,n,s,o,i,a)=>({target:e,x:t,y:n,stop:s,prevent:o,kill:i,raw:a}),ha=e=>{const o=t.fromDom(h2(e).getOr(e.target)),n=()=>e.stopPropagation(),s=()=>e.preventDefault(),i=im(s,n);return ah(o,e.clientX,e.clientY,n,s,i,e)},ch=(e,t)=>n=>{e(n)&&t(ha(n))},lh=(e,t,n,s,o)=>{const i=ch(n,s);return e.dom.addEventListener(t,i,o),{unbind:O(uh,e,t,i,o)}},dh=(e,t,n,s)=>lh(e,t,n,s,!1),uh=(e,t,n,s)=>{e.dom.removeEventListener(t,n,s)},hh=r,ke=(e,t,n)=>dh(e,t,hh,n),pt=ha,Zs=e=>!no(t.fromDom(e.target),"ephox-snooker-resizer-bar"),gh=(e,i)=>{const r=nh(()=>t.fromDom(e.getBody()),()=>hs(sn(e),Ie(e)),me.selectedSelector),l=(n,s,i)=>{const a=A(s);a.each(a=>{const r=Pi(e),c=Pn(o,t.fromDom(e.getDoc()),r),l=q(e),d=ih(a,{selection:l},c);qu(e,n,s,i,d)})},d=()=>Yu(e),a=Q3.byAttr(me,l,d);e.on("init",n=>{const l=e.getWin(),s=Jt(e),d=Ie(e),p=()=>{const n=e.selection,i=t.fromDom(n.getStart()),r=t.fromDom(n.getEnd()),c=jn(A,[i,r]);c.fold(()=>a.clear(s),o)},r=T3(l,s,d,a),h=z3(l,s,d,a),m=D3(l,s,d,a),b=e=>e.raw.shiftKey===!0;e.on("TableSelectorChange",e=>m(e.start,e.finish));const u=(t,n)=>{if(!b(t))return;n.kill&&t.kill(),n.selection.each(t=>{const n=Ee.relative(t.start,t.finish),s=Vs(l,n);e.selection.setRng(s)})},g=n=>{const s=pt(n);if(s.raw.shiftKey&&jt(s.raw.which)){const n=e.selection.getRng(),o=t.fromDom(n.startContainer),i=t.fromDom(n.endContainer);h.keyup(s,o,n.startOffset,i,n.endOffset).each(e=>{u(s,e)})}},v=n=>{const o=pt(n);i.hide();const s=e.selection.getRng(),a=t.fromDom(s.startContainer),r=t.fromDom(s.endContainer),c=zo(q2,Y2)(t.fromDom(e.selection.getStart()));h.keydown(o,a,s.startOffset,r,s.endOffset,c).each(e=>{u(o,e)}),i.show()},f=e=>e.button===0,j=e=>e.buttons===void 0||(e.buttons&1)!==0,y=e=>{r.clearstate()},_=e=>{f(e)&&Zs(e)&&r.mousedown(pt(e))},w=e=>{j(e)&&Zs(e)&&r.mouseover(pt(e))},O=e=>{f(e)&&Zs(e)&&r.mouseup(pt(e))},x=()=>{const e=Fs(t.fromDom(s)),n=Fs(0),o=s=>{const o=t.fromDom(s.target);if(I("td")(o)||I("th")(o)){const t=e.get(),i=n.get();c(t,o)&&s.timeStamp-i<300&&(s.preventDefault(),m(o,o))}e.set(o),n.set(s.timeStamp)};return{touchEnd:o}},C=x();e.on("dragstart",y),e.on("mousedown",_),e.on("mouseover",w),e.on("mouseup",O),e.on("touchend",C.touchEnd),e.on("keyup",g),e.on("keydown",v),e.on("NodeChange",p)}),e.on("PreInit",()=>{e.serializer.addTempAttr(me.firstSelected),e.serializer.addTempAttr(me.lastSelected)});const u=e=>a.clear(t.fromDom(e)),h=()=>Z3(r.get(),n([]),e=>s(e,e=>e.dom),e=>[e.dom]);return{getSelectedCells:h,clearSelectedCells:u}},L=e=>{let t=[];const n=e=>{if(e===void 0)throw new Error("Event bind error: undefined handler");t.push(e)},s=e=>{t=p(t,t=>t!==e)},o=(...n)=>{const s={};i(e,(e,t)=>{s[e]=n[t]}),i(t,e=>{e(s)})};return{bind:n,unbind:s,trigger:o}},de=e=>{const t=go(e,e=>({bind:e.bind,unbind:e.unbind})),n=go(e,e=>e.trigger);return{registry:t,trigger:n}},jh=(e,t)=>{let n=null;const s=()=>{Om(n)||(clearTimeout(n),n=null)},o=(...o)=>{s(),n=setTimeout(()=>{n=null,e.apply(null,o)},t)};return{cancel:s,throttle:o}},Ye=e=>e.slice(0).sort(),_h=(e,t)=>{throw new Error("All required keys ("+Ye(e).join(", ")+") were not specified. Specified keys were: "+Ye(t).join(", ")+".")},wh=e=>{throw new Error("Unsupported keys for object: "+Ye(e).join(", "))},Oh=(e,t)=>{if(!Xt(t))throw new Error("The "+e+" fields must be an array. Was: "+t+".");i(t,t=>{if(!rt(t))throw new Error("The value "+t+" in the "+e+" fields was not a string.")})},xh=(e,t)=>{throw new Error("All values need to be of type: "+t+". Keys ("+Ye(e).join(", ")+") were not.")},Ch=e=>{const t=Ye(e),n=W(t,(e,n)=>n<t.length-1&&e===t[n+1]);n.each(e=>{throw new Error("The field: "+e+" occurs more than once in the combined fields: ["+t.join(", ")+"].")})},Eh=(e,t)=>kh(e,t,{validate:ve,label:"function"}),kh=(e,t,n)=>{if(t.length===0)throw new Error("You must specify at least one required field.");return Oh("required",t),Ch(t),s=>{const o=at(s),a=H(t,e=>f(o,e));a||_h(t,o),e(t,o);const i=p(t,e=>!n.validate(s[e],e));return i.length>0&&xh(i,n.label),s}},Ah=(e,t)=>{const n=p(t,t=>!f(e,t));n.length>0&&wh(n)},Es=e=>Eh(Ah,e),Mh=Es(["compare","extract","mutate","sink"]),Fh=Es(["element","start","stop","destroy"]),Th=Es(["forceDrop","drop","move","delayDrop"]),zh=()=>{let t=e.none();const s=()=>{t=e.none()},o=(n,s)=>{const o=t.map(e=>n.compare(e,s));return t=e.some(s),o},i=(e,t)=>{const s=t.extract(e);s.each(e=>{const s=o(t,e);s.each(e=>{n.trigger.move(e)})})},n=de({move:L(["info"])});return{onEvent:i,reset:s,events:n.registry}},Dh=()=>{const e=de({move:L(["info"])});return{onEvent:o,reset:o,events:e.registry}},Nh=()=>{const n=Dh(),t=zh();let e=n;const s=()=>{e.reset(),e=t},o=()=>{e.reset(),e=n},i=(t,n)=>{e.onEvent(t,n)},a=()=>e===t;return{on:s,off:o,isOn:a,onEvent:i,events:t.events}},Lh=(e,t,n)=>{let i=!1;const a=de({start:L([]),stop:L([])}),s=Nh(),r=()=>{o.stop(),s.isOn()&&(s.off(),a.trigger.stop())},l=jh(r,200),d=e=>{o.start(e),s.on(),a.trigger.start()},u=e=>{l.cancel(),s.onEvent(e,t)};s.events.move.bind(n=>{t.mutate(e,n.info)});const h=()=>{i=!0},m=()=>{i=!1},c=e=>(...t)=>{i&&e.apply(null,t)},o=t.sink(Th({forceDrop:r,drop:c(r),move:c(u),delayDrop:c(l.throttle)}),n),f=()=>{o.destroy()};return{element:o.element,go:d,on:h,off:m,destroy:f,events:a.registry}},Ei=e=>{const t=e.replace(/\./g,"-"),n=e=>t+"-"+e;return{resolve:n}},Ph=Ei("ephox-dragster"),Bi=Ph.resolve,Ih=e=>{const o={layerClass:Bi("blocker"),...e},s=t.fromTag("div");g(s,"role","presentation"),Ke(s,{position:"fixed",left:"0px",top:"0px",width:"100%",height:"100%"}),Z(s,Bi("blocker")),Z(s,o.layerClass);const i=n(s),a=()=>{C(s)};return{element:i,destroy:a}},Bh=(e,t)=>J(t.left-e.left,t.top-e.top),Vh=t=>e.some(J(t.x,t.y)),$h=(e,t)=>{e.mutate(t.left,t.top)},Wh=(e,t)=>{const n=Ih(t),s=ke(n.element(),"mousedown",e.forceDrop),o=ke(n.element(),"mouseup",e.drop),i=ke(n.element(),"mousemove",e.move),a=ke(n.element(),"mouseout",e.delayDrop),r=()=>{n.destroy(),o.unbind(),i.unbind(),a.unbind(),s.unbind()},c=e=>{u(e,n.element())},l=()=>{C(n.element())};return Fh({element:n.element,start:c,stop:l,destroy:r})};Ui=Mh({compare:Bh,extract:Vh,sink:Wh,mutate:$h});const Kh=(e,t={})=>{var n;const s=(n=t.mode)!==null&&n!==void 0?n:Ui;return Lh(e,s,t)},qh=Ei("ephox-snooker"),Ht=qh.resolve,Gh=()=>{const e=de({drag:L(["xDelta","yDelta"])}),t=(t,n)=>{e.trigger.drag(t,n)};return{mutate:t,events:e.registry}},Xh=()=>{const n=de({drag:L(["xDelta","yDelta","target"])});let t=e.none();const s=Gh();s.events.drag.bind(e=>{t.each(t=>{n.trigger.drag(e.xDelta,e.yDelta,t)})});const o=n=>{t=e.some(n)},i=()=>t;return{assign:o,get:i,mutate:s.mutate,events:n.registry}},Qh=(e,n,s,o,i)=>{const a=t.fromTag("div");return Ke(a,{position:"absolute",left:n-o/2+"px",top:s+"px",height:i+"px",width:o+"px"}),We(a,{"data-column":e,role:"presentation"}),a},Zh=(e,n,s,o,i)=>{const a=t.fromTag("div");return Ke(a,{position:"absolute",left:n+"px",top:s-i/2+"px",height:i+"px",width:o+"px"}),We(a,{"data-row":e,role:"presentation"}),a},rs=Ht("resizer-bar"),Ta=Ht("resizer-rows"),Ha=Ht("resizer-cols"),Ua=7,sm=(e,t)=>_(e.all,(e,n)=>t(e.element)?[n]:[]),om=(e,t)=>{const n=[];return N(e.grid.columns,s=>{const o=a.getColumnAt(e,s).map(e=>e.element);o.forall(t)&&n.push(s)}),p(n,n=>{const s=a.filterItems(e,e=>e.column===n);return H(s,e=>t(e.element))})},Mn=e=>{const t=U(e.parent(),"."+rs);i(t,C)},rr=(e,t,n)=>{const s=e.origin();i(t,t=>{t.each(t=>{const o=n(s,t);Z(o,rs),u(e.parent(),o)})})},rm=(e,t,n,s)=>{rr(e,t,(e,t)=>{const o=Qh(t.col,t.x-e.left,n.top-e.top,Ua,s);return Z(o,Ha),o})},cm=(e,t,n,s)=>{rr(e,t,(e,t)=>{const o=Zh(t.row,n.left-e.left,t.y-e.top,s,Ua);return Z(o,Ta),o})},lm=(e,t,n,s,o)=>{const i=et(n),a=t.isResizable,r=s.length>0?Ms.positions(s,n):[],l=r.length>0?sm(e,a):[],d=p(r,(e,t)=>D(l,e=>t===e));cm(t,d,i,eo(n));const c=o.length>0?zt.positions(o,n):[],u=c.length>0?om(e,a):[],h=p(c,(e,t)=>D(u,e=>t===e));rm(t,h,i,Ro(n))},vn=(e,t)=>{if(Mn(e),e.isResizable(t)){const n=a.fromTable(t),s=Fo(n),o=$s(n);lm(n,e,t,s,o)}},Nr=(e,t)=>{const n=U(e.parent(),"."+rs);i(n,t)},hm=e=>{Nr(e,e=>{j(e,"display","none")})},mm=e=>{Nr(e,e=>{j(e,"display","block")})},fm=e=>no(e,Ta),pm=e=>no(e,Ha),gm=Ht("resizer-bar-dragging"),vm=t=>{const i=Xh(),n=Kh(i,{});let a=e.none();const o=(t,n)=>e.from(De(t,n));i.events.drag.bind(e=>{o(e.target,"data-row").each(t=>{const n=Zt(e.target,"top");j(e.target,"top",n+e.yDelta+"px")}),o(e.target,"data-column").each(t=>{const n=Zt(e.target,"left");j(e.target,"left",n+e.xDelta+"px")})});const r=(e,t)=>{const n=Zt(e,t),s=oe(e,"data-initial-"+t,0);return n-s};n.events.stop.bind(()=>{i.get().each(e=>{a.each(n=>{o(e,"data-row").each(t=>{const o=r(e,"top");d(e,"data-initial-top"),s.trigger.adjustHeight(n,o,parseInt(t,10))}),o(e,"data-column").each(t=>{const o=r(e,"left");d(e,"data-initial-left"),s.trigger.adjustWidth(n,o,parseInt(t,10))}),vn(t,n)})})});const l=(e,o)=>{s.trigger.startAdjust(),i.assign(e),g(e,"data-initial-"+o,Zt(e,o)),Z(e,gm),j(e,"opacity","0.2"),n.go(t.parent())},u=ke(t.parent(),"mousedown",e=>{fm(e.target)&&l(e.target,"top"),pm(e.target)&&l(e.target,"left")}),v=e=>c(e,t.view()),h=e=>y(e,"table",v).filter(sc),m=ke(t.view(),"mouseover",n=>{h(n.target).fold(()=>{X(n.target)&&Mn(t)},n=>{a=e.some(n),vn(t,n)})}),f=()=>{u.unbind(),m.unbind(),n.destroy(),Mn(t)},p=e=>{vn(t,e)},s=de({adjustHeight:L(["table","delta","row"]),adjustWidth:L(["table","delta","column"]),startAdjust:L([])});return{destroy:f,refresh:p,on:n.on,off:n.off,hideBars:O(hm,t),showBars:O(mm,t),events:s.registry}},bm=(e,t,n)=>{const i=Ms,a=zt,s=vm(e),o=de({beforeResize:L(["table","type"]),afterResize:L(["table","type"]),startDrag:L([])});return s.events.adjustHeight.bind(e=>{const t=e.table;o.trigger.beforeResize(t,"row");const n=i.delta(e.delta,t);ud(t,n,e.row,i),o.trigger.afterResize(t,"row")}),s.events.startAdjust.bind(e=>{o.trigger.startDrag()}),s.events.adjustWidth.bind(e=>{const s=e.table;o.trigger.beforeResize(s,"col");const i=a.delta(e.delta,s),r=n(s);Ka(s,i,e.column,t,r),o.trigger.afterResize(s,"col")}),{on:s.on,off:s.off,refreshBars:s.refresh,hideBars:s.hideBars,showBars:s.showBars,destroy:s.destroy,events:o.registry}},jm={create:bm},ym=(e,t)=>{const s=Gi(e)?v3(e):e;return{parent:n(s),view:n(e),origin:n(J(0,0)),isResizable:t}},_m=(e,t,s)=>{const o=()=>et(t);return{parent:n(t),view:n(e),origin:o,isResizable:s}},wm=(e,t,s)=>({parent:n(t),view:n(e),origin:n(J(0,0)),isResizable:s}),Rr={only:ym,detached:_m,body:wm},xm=()=>{const e=t.fromTag("div");return Ke(e,{position:"static",height:"0",width:"0",padding:"0",margin:"0",border:"0"}),u(c2(),e),e},Cm=(e,n)=>e.inline?Rr.body(t.fromDom(e.getBody()),xm(),n):Rr.only(t.fromDom(e.getDoc()),n),Em=(e,t)=>{e.inline&&C(t.parent())},Br=e=>Qe(e)&&e.nodeName==="TABLE",Cs="bar-",Sm=e=>De(e,"data-mce-resize")!=="false",Mm=e=>{const t=a.fromTable(e);a.hasColumns(t)||i(Pe(e),e=>{const t=je(e,"width");j(e,"width",t),d(e,"width")})},Fm=e=>{const l=Ft(),s=Ft(),r=Ft();let o,n;const c=t=>wi(e,t),a=()=>Ni(e)?Ls():hc(),d=e=>Ps(e).columns,u=(t,s,i)=>{const r=un(s,"e");if(n===""&&mt(t),i!==o&&n!==""){j(t,"width",n);const s=a(),l=c(t),u=Ni(e)||r?d(t)-1:0;Ka(t,i-o,u,s,l)}else if(pd(n)){const e=parseFloat(n.replace("%","")),s=i*e/o;j(t,"width",s+"%")}fd(n)&&Mm(t)},h=()=>{s.on(e=>{e.destroy()}),r.on(t=>{Em(e,t)})};e.on("init",()=>{const t=Cm(e,Sm);if(r.set(t),r1(e)&&g1(e)){const o=a(),n=jm.create(t,o,c);n.on(),n.events.startDrag.bind(t=>{l.set(e.selection.getRng())}),n.events.beforeResize.bind(t=>{const n=t.table.dom;Gu(e,n,Ba(n),Va(n),Cs+t.type)}),n.events.afterResize.bind(t=>{const s=t.table,n=s.dom;ye(s),l.on(t=>{e.selection.setRng(t),e.focus()}),Xu(e,n,Ba(n),Va(n),Cs+t.type),e.undoManager.add()}),s.set(n)}}),e.on("ObjectResizeStart",s=>{const a=s.target;if(Br(a)){const r=t.fromDom(a);i(e.dom.select(".mce-clonedresizable"),t=>{e.dom.addClass(t,"mce-"+_s(e)+"-columns")}),!oi(r)&&Ne(e)?Ds(r):!ri(r)&&Nt(e)&&mt(r),si(r)&&vr(s.origin,Cs)&&mt(r),o=s.width,n=Ge(e)?"":gd(e,a).getOr("")}}),e.on("ObjectResized",n=>{const s=n.target;if(Br(s)){const o=t.fromDom(s),i=n.origin;vr(i,"corner-")&&u(o,i,n.width),ye(o),ce(e,o.dom,Rt)}}),e.on("SwitchMode",()=>{s.on(t=>{e.mode.isReadOnly()?t.hideBars():t.showBars()})}),e.on("remove",()=>{h()});const m=e=>{s.on(n=>n.refreshBars(t.fromDom(e)))},f=()=>{s.on(e=>e.hideBars())},p=()=>{s.on(e=>e.showBars())};return{refresh:m,hide:f,show:p}},Tm=e=>{i1(e);const s=Fm(e),t=gh(e,s),n=w1(e,s,t);return T4(e,n),z4(e,n),Tc(e,n),{getSelectedCells:t.getSelectedCells,clearSelectedCells:t.clearSelectedCells}},zm=e=>{const t=Tm(e);return{table:t}};ic=()=>{Y4.add("dom",zm)},ic()})()