!function(){"use strict";Xr=tinymce.util.Tools.resolve("tinymce.ModelManager");const cs=e=>t=>(e=>{const t=typeof e;return null===e?"null":"object"===t&&Array.isArray(e)?"array":"object"===t&&(s=o=e,(i=String).prototype.isPrototypeOf(s)||(null===(n=o.constructor)||void 0===n?void 0:n.name)===i.name)?"string":t;var n,s,o,i})(t)===e,Ss=e=>t=>typeof t===e,oo=e=>t=>e===t,Ke=cs("string"),Jd=cs("object"),Ut=cs("array"),Xd=oo(null),qd=Ss("boolean"),Kd=oo(void 0),Xe=e=>!(e=>e==null)(e),ve=Ss("function"),Nn=Ss("number"),o=()=>{},n=e=>()=>e,d=e=>e,Pd=(e,t)=>e===t;function x(e,...t){return(...n)=>{const s=t.concat(n);return e.apply(null,s)}}const xn=e=>t=>!e(t),Oo=e=>e(),W=n(!1),a=n(!0);class e{constructor(e,t){this.tag=e,this.value=t}static some(t){return new e(!0,t)}static none(){return e.singletonNone}fold(e,t){return this.tag?t(this.value):e()}isSome(){return this.tag}isNone(){return!this.tag}map(t){return this.tag?e.some(t(this.value)):e.none()}bind(t){return this.tag?t(this.value):e.none()}exists(e){return this.tag&&e(this.value)}forall(e){return!this.tag||e(this.value)}filter(t){return!this.tag||t(this.value)?this:e.none()}getOr(e){return this.tag?this.value:e}or(e){return this.tag?this:e}getOrThunk(e){return this.tag?this.value:e()}orThunk(e){return this.tag?this:e()}getOrDie(e){if(this.tag)return this.value;throw new Error(e??"Called getOrDie on None")}static from(t){return Xe(t)?e.some(t):e.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(e){this.tag&&e(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}e.singletonNone=new e(!1);const xo=Array.prototype.slice,Dd=Array.prototype.indexOf,Td=Array.prototype.push,h=(e,t)=>{return n=e,s=t,Dd.call(n,s)>-1;var n,s},F=(e,t)=>{for(let n=0,s=e.length;n<s;n++)if(t(e[n],n))return!0;return!1},H=(e,t)=>{const n=[];for(let s=0;s<e;s++)n.push(t(s));return n},s=(e,t)=>{const n=e.length,s=new Array(n);for(let o=0;o<n;o++){const i=e[o];s[o]=t(i,o)}return s},i=(e,t)=>{for(let n=0,s=e.length;n<s;n++)t(e[n],n)},Co=(e,t)=>{const n=[],s=[];for(let o=0,a=e.length;o<a;o++){const i=e[o];(t(i,o)?n:s).push(i)}return{pass:n,fail:s}},p=(e,t)=>{const n=[];for(let s=0,i=e.length;s<i;s++){const o=e[s];t(o,s)&&n.push(o)}return n},V=(e,t,n)=>(((e,t)=>{for(let n=e.length-1;n>=0;n--)t(e[n],n)})(e,(e,s)=>{n=t(n,e,s)}),n),B=(e,t,n)=>(i(e,(e,s)=>{n=t(n,e,s)}),n),I=(t,n)=>((t,n,s)=>{for(let o=0,a=t.length;o<a;o++){const i=t[o];if(n(i,o))return e.some(i);if(s(i,o))break}return e.none()})(t,n,W),Ls=(t,n)=>{for(let s=0,o=t.length;s<o;s++)if(n(t[s],s))return e.some(s);return e.none()},ko=e=>{const t=[];for(let n=0,s=e.length;n<s;++n){if(!Ut(e[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+e);Td.apply(t,e[n])}return t},y=(e,t)=>ko(s(e,t)),R=(e,t)=>{for(let n=0,s=e.length;n<s;++n)if(!0!==t(e[n],n))return!1;return!0},Hs=(e,t)=>{const n={};for(let s=0,i=e.length;s<i;s++){const o=e[s];n[String(o)]=t(o,s)}return n},Do=(t,n)=>n>=0&&n<t.length?e.some(t[n]):e.none(),gt=e=>Do(e,0),Po=e=>Do(e,e.length-1),Z=(t,n)=>{for(let e=0;e<t.length;e++){const s=n(t[e],e);if(s.isSome())return s}return e.none()},it=Object.keys,Bo=Object.hasOwnProperty,M=(e,t)=>{const n=it(e);for(let s=0,i=n.length;s<i;s++){const o=n[s];t(e[o],o)}},$o=(e,t)=>dd(e,(e,n)=>({k:n,v:t(e,n)})),dd=(e,t)=>{const n={};return M(e,(e,s)=>{const o=t(e,s);n[o.k]=o.v}),n},oi=(e,t)=>{const n=[];return M(e,(e,s)=>{n.push(t(e,s))}),n},ai=e=>oi(e,d),Is=(e,t)=>Bo.call(e,t);"undefined"!=typeof window?window:Function("return this;")();const c=e=>e.dom.nodeName.toLowerCase(),ci=e=>e.dom.nodeType,rn=e=>t=>ci(t)===e,od=e=>8===ci(e)||"#comment"===c(e),Q=rn(1),ge=rn(3),li=rn(9),ed=rn(11),N=e=>t=>Q(t)&&c(t)===e,Ln=(e,t,n)=>{if(!(Ke(n)||qd(n)||Nn(n)))throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",n,":: Element ",e),new Error("Attribute value was not simple");e.setAttribute(t,n+"")},v=(e,t,n)=>{Ln(e.dom,t,n)},Ve=(e,t)=>{const n=e.dom;M(t,(e,t)=>{Ln(n,t,e)})},Ne=(e,t)=>{const n=e.dom.getAttribute(t);return null===n?void 0:n},ae=(t,n)=>e.from(Ne(t,n)),u=(e,t)=>{e.dom.removeAttribute(t)},di=e=>B(e.dom.attributes,(e,t)=>(e[t.name]=t.value,e),{}),Ye=e=>{if(e==null)throw new Error("Node cannot be null or undefined");return{dom:e}},t={fromHtml:(e,t)=>{const n=(t||document).createElement("div");if(n.innerHTML=e,!n.hasChildNodes()||n.childNodes.length>1){const t="HTML does not have a single root node";throw console.error(t,e),new Error(t)}return Ye(n.childNodes[0])},fromTag:(e,t)=>{const n=(t||document).createElement(e);return Ye(n)},fromText:(e,t)=>{const n=(t||document).createTextNode(e);return Ye(n)},fromDom:Ye,fromPoint:(t,n,s)=>e.from(t.dom.elementFromPoint(n,s)).map(Ye)},z=(e,t)=>{const n=e.dom;if(1!==n.nodeType)return!1;{const e=n;if(void 0!==e.matches)return e.matches(t);if(void 0!==e.msMatchesSelector)return e.msMatchesSelector(t);if(void 0!==e.webkitMatchesSelector)return e.webkitMatchesSelector(t);if(void 0!==e.mozMatchesSelector)return e.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")}},fi=e=>1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType||0===e.childElementCount,yi=(n,s)=>{const o=void 0===s?document:s.dom;return fi(o)?e.none():e.from(o.querySelector(n)).map(t.fromDom)},r=(e,t)=>e.dom===t.dom,En=(e,t)=>{const n=e.dom,s=t.dom;return n!==s&&n.contains(s)},ql=z,hn=e=>t.fromDom(e.dom.ownerDocument),dn=e=>li(e)?e:hn(e),be=n=>e.from(n.dom.parentNode).map(t.fromDom),Ri=(e,n)=>{const i=ve(n)?n:W;let s=e.dom;const o=[];for(;null!==s.parentNode&&void 0!==s.parentNode;){const e=s.parentNode,n=t.fromDom(e);if(o.push(n),!0===i(n))break;s=e}return o},Pi=n=>e.from(n.dom.previousSibling).map(t.fromDom),tn=n=>e.from(n.dom.nextSibling).map(t.fromDom),T=e=>s(e.dom.childNodes,t.fromDom),Ht=(n,s)=>{const o=n.dom.childNodes;return e.from(o[s]).map(t.fromDom)},At=(e,t)=>{be(e).each(n=>{n.dom.insertBefore(t.dom,e.dom)})},ht=(e,t)=>{tn(e).fold(()=>{be(e).each(e=>{l(e,t)})},e=>{At(e,t)})},Ws=(e,t)=>{const n=(e=>Ht(e,0))(e);n.fold(()=>{l(e,t)},n=>{e.dom.insertBefore(t.dom,n.dom)})},l=(e,t)=>{e.dom.appendChild(t.dom)},Dl=(e,t)=>{At(e,t),l(t,e)},Gi=(e,t)=>{i(t,(n,s)=>{const o=0===s?e:t[s-1];ht(o,n)})},X=(e,t)=>{i(t,t=>{l(e,t)})},Bn=e=>{e.dom.textContent="",i(T(e),e=>{E(e)})},E=e=>{const t=e.dom;null!==t.parentNode&&t.parentNode.removeChild(t)},kl=e=>{const t=T(e);t.length>0&&Gi(e,t),E(e)},Aa=(e,n)=>t.fromDom(e.dom.cloneNode(n)),Na=e=>Aa(e,!1),Oe=e=>Aa(e,!0),Ia=(e,n)=>{const s=t.fromTag(n),o=di(e);return Ve(s,o),s},_l=["tfoot","thead","tbody","colgroup"],Ba=(e,t,n)=>({element:e,rowspan:t,colspan:n}),Jn=(e,t,n)=>({element:e,cells:t,section:n}),C=(e,t,n)=>({element:e,isNew:t,isLocked:n}),de=(e,t,n,s)=>({element:e,cells:t,section:n,isNew:s}),Va=ve(Element.prototype.attachShadow)&&ve(Node.prototype.getRootNode),pl=n(Va),ul=Va?e=>t.fromDom(e.dom.getRootNode()):dn,cl=e=>t.fromDom(e.dom.host),J=n=>{const s=ge(n)?n.dom.parentNode:n.dom;if(s==null||null===s.ownerDocument)return!1;const a=s.ownerDocument;return(t=>{const n=ul(t);return ed(s=n)&&Xe(s.dom.host)?e.some(n):e.none();var s})(t.fromDom(s)).fold(()=>a.body.contains(s),(o=J,i=cl,e=>o(i(e))));var o,i},Ja=e=>{const n=e.dom.body;if(n==null)throw new Error("Body is not available yet");return t.fromDom(n)},ur=(e,t)=>{let n=[];return i(T(e),e=>{t(e)&&(n=n.concat([e])),n=n.concat(ur(e,t))}),n},st=(e,t,n)=>((e,n,s)=>p(Ri(e,s),e=>z(e,t)))(e,0,n),qt=(e,t)=>((e)=>p(T(e),e=>z(e,t)))(e),G=(e,n)=>((e,n)=>{const o=void 0===n?document:n.dom;return fi(o)?[]:s(o.querySelectorAll(e),t.fromDom)})(n,e);Xn=(t,n,s,o,i)=>t(s,o)?e.some(s):ve(i)&&i(s)?e.none():n(s,o,i);const rt=(n,s,o)=>{let i=n.dom;const a=ve(o)?o:W;for(;i.parentNode;){i=i.parentNode;const n=t.fromDom(i);if(s(n))return e.some(n);if(a(n))break}return e.none()},ue=(e,t,n)=>rt(e,e=>z(e,t),n),ks=(e,n)=>((e)=>I(e.dom.childNodes,e=>{return s=t.fromDom(e),z(s,n);var s}).map(t.fromDom))(e),dt=(e,t)=>yi(t,e),j=(e,t,n)=>Xn((e,t)=>z(e,t),ue,e,t,n),$s=(e,t,n=Pd)=>e.exists(e=>n(e,t)),mr=e=>{const t=[],n=e=>{t.push(e)};for(let t=0;t<e.length;t++)e[t].each(n);return t},gn=(t,n)=>t?e.some(n):e.none(),gr=(e,t,n)=>""===t||e.length>=t.length&&e.substr(n,n+t.length)===t,A=(e,t,n=0,s)=>{const o=e.indexOf(t,n);return-1!==o&&(!!Kd(s)||o+t.length<=s)},vr=(e,t)=>gr(e,t,0),bt=(e,t)=>gr(e,t,e.length-t.length),Xc=(e=>t=>t.replace(e,""))(/^\s+|\s+$/g),Yc=e=>e.length>0,ze=e=>void 0!==e.style&&ve(e.style.getPropertyValue),_r=(e,t,n)=>{if(!Ke(n))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",n,":: Element ",e),new Error("CSS value must be a string: "+n);ze(e)&&e.style.setProperty(t,n)},b=(e,t,n)=>{const s=e.dom;_r(s,t,n)},ut=(e,t)=>{const n=e.dom;M(t,(e,t)=>{_r(n,t,e)})},ce=(e,t)=>{const n=e.dom,s=window.getComputedStyle(n).getPropertyValue(t);return""!==s||J(e)?s:wr(n,t)},wr=(e,t)=>ze(e)?e.style.getPropertyValue(t):"",Ps=(t,n)=>{const s=t.dom,o=wr(s,n);return e.from(o).filter(e=>e.length>0)},ie=(e,t)=>{((e,t)=>{ze(e)&&e.style.removeProperty(t)})(e.dom,t),$s(ae(e,"style").map(Xc),"")&&u(e,"style")},Y=(e,t,n=0)=>ae(e,t).map(e=>parseInt(e,10)).getOr(n),Ds=(e,t)=>Y(e,t,1),Fs=e=>N("col")(e)?Y(e,"span",1)>1:Ds(e,"colspan")>1,Or=e=>Ds(e,"rowspan")>1,zt=(e,t)=>parseInt(ce(e,t),10),lt=n(10),Os=n(10),Lt=(e,t)=>ws(e,t,a),ws=(e,t,n)=>y(T(e),e=>z(e,t)?n(e)?[e]:[]:ws(e,t,n)),xr=(t,n)=>((t,n,s=W)=>s(n)?e.none():h(t,c(n))?e.some(n):ue(n,t.join(","),e=>z(e,"table")||s(e)))(["td","th"],t,n),Me=e=>Lt(e,"th,td"),vs=e=>z(e,"colgroup")?qt(e,"col"):y(Tr(e),e=>qt(e,"col")),S=(e,t)=>j(e,"table",t),Mr=e=>Lt(e,"tr"),Tr=e=>S(e).fold(n([]),e=>qt(e,"colgroup")),Lr=(e,t)=>s(e,e=>{if("colgroup"===c(e)){const t=s(vs(e),e=>{const t=Y(e,"span",1);return Ba(e,1,t)});return Jn(e,t,"colgroup")}{const n=s(Me(e),e=>{const t=Y(e,"rowspan",1),n=Y(e,"colspan",1);return Ba(e,t,n)});return Jn(e,n,t(e))}}),Ec=e=>be(e).map(e=>{const t=c(e);return(e=>h(_l,e))(t)?t:"tbody"}).getOr("tbody"),Jr=e=>{const t=Mr(e),n=[...Tr(e),...t];return Lr(n,Ec)},ot=e=>{let t,n=!1;return(...s)=>(n||(n=!0,t=e.apply(null,s)),t)},ec=()=>Un(0,0),Un=(e,t)=>({major:e,minor:t}),tt={nu:Un,detect:(e,t)=>{const n=String(t).toLowerCase();return 0===e.length?ec():((e,t)=>{const n=((e,t)=>{for(let n=0;n<e.length;n++){const s=e[n];if(s.test(t))return s}})(e,t);if(!n)return{major:0,minor:0};const s=e=>Number(t.replace(n,"$"+e));return Un(s(1),s(2))})(e,n)},unknown:ec},nc=(e,t)=>{const n=String(t).toLowerCase();return I(e,e=>e.search(n))},In=/.*?version\/ ?([0-9]+)\.([0-9]+).*/,K=e=>t=>A(t,e),gc=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:e=>A(e,"edge/")&&A(e,"chrome")&&A(e,"safari")&&A(e,"applewebkit")},{name:"Chromium",brand:"Chromium",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,In],search:e=>A(e,"chrome")&&!A(e,"chromeframe")},{name:"IE",versionRegexes:[/.*?msie ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:e=>A(e,"msie")||A(e,"trident")},{name:"Opera",versionRegexes:[In,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:K("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/ ?([0-9]+)\.([0-9]+).*/],search:K("firefox")},{name:"Safari",versionRegexes:[In,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:e=>(A(e,"safari")||A(e,"mobile/"))&&A(e,"applewebkit")}],vc=[{name:"Windows",search:K("win"),versionRegexes:[/.*?windows nt ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:e=>A(e,"iphone")||A(e,"ipad"),versionRegexes:[/.*?version\/ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:K("android"),versionRegexes:[/.*?android ?([0-9]+)\.([0-9]+).*/]},{name:"macOS",search:K("mac os x"),versionRegexes:[/.*?mac os x ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:K("linux"),versionRegexes:[]},{name:"Solaris",search:K("sunos"),versionRegexes:[]},{name:"FreeBSD",search:K("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:K("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],ic={browsers:n(gc),oses:n(vc)},no="Edge",Gr="Chromium",Yr="Opera",qr="Firefox",Wr="Safari",Hr=e=>{const n=e.current,s=e.version,t=e=>()=>n===e;return{current:n,version:s,isEdge:t(no),isChromium:t(Gr),isIE:t("IE"),isOpera:t(Yr),isFirefox:t(qr),isSafari:t(Wr)}},kc=()=>Hr({current:void 0,version:tt.unknown()}),Ac=Hr,Nr=(n(no),n(Gr),n("IE"),n(Yr),n(qr),n(Wr),"Windows"),lr="Android",cr="Linux",nr="macOS",tr="Solaris",er="FreeBSD",Xa="ChromeOS",Ga=e=>{const n=e.current,s=e.version,t=e=>()=>n===e;return{current:n,version:s,isWindows:t(Nr),isiOS:t("iOS"),isAndroid:t(lr),isMacOS:t(nr),isLinux:t(cr),isSolaris:t(tr),isFreeBSD:t(er),isChromeOS:t(Xa)}},ml=()=>Ga({current:void 0,version:tt.unknown()}),fl=Ga,bl=(n(Nr),n("iOS"),n(lr),n(cr),n(nr),n(tr),n(er),n(Xa),e=>window.matchMedia(e).matches);let yl=ot(()=>((e,t,s)=>{const o=ic.browsers(),r=ic.oses(),i=t.bind(e=>((e,t)=>Z(t.brands,t=>{const n=t.brand.toLowerCase();return I(e,e=>{var t;return n===(null===(t=e.brand)||void 0===t?void 0:t.toLowerCase())}).map(e=>({current:e.name,version:tt.nu(parseInt(t.version,10),0)}))}))(o,e)).orThunk(()=>((e,t)=>nc(e,t).map(e=>{const n=tt.detect(e.versionRegexes,t);return{current:e.name,version:n}}))(o,e)).fold(kc,Ac),a=((e,t)=>nc(e,t).map(e=>{const n=tt.detect(e.versionRegexes,t);return{current:e.name,version:n}}))(r,e).fold(ml,fl),c=((e,t,s,o)=>{const i=e.isiOS()&&!0===/ipad/i.test(s),a=e.isiOS()&&!i,r=e.isiOS()||e.isAndroid(),u=r||o("(pointer:coarse)"),c=i||!a&&r&&o("(min-device-width:768px)"),l=a||r&&!c,d=t.isSafari()&&e.isiOS()&&!1===/safari/i.test(s),h=!l&&!c&&!d;return{isiPad:n(i),isiPhone:n(a),isTablet:n(c),isPhone:n(l),isTouch:n(u),isAndroid:e.isAndroid,isiOS:e.isiOS,isWebView:n(d),isDesktop:n(h)}})(a,i,e,s);return{browser:i,os:a,deviceType:c}})(navigator.userAgent,e.from(navigator.userAgentData),bl));const Ra=()=>yl(),Fa=(e,t)=>{const n=n=>{const s=t(n);if(s<=0||null===s){const t=ce(n,e);return parseFloat(t)||0}return s},s=(e,t)=>B(t,(t,n)=>{const s=ce(e,n),o=void 0===s?0:parseInt(s,10);return isNaN(o)?t:t+o},0);return{set:(t,n)=>{if(!Nn(n)&&!n.match(/^[0-9]+$/))throw new Error(e+".set accepts only positive integer values. Value was "+n);const s=t.dom;ze(s)&&(s.style[e]=n+"px")},get:n,getOuter:n,aggregate:s,max:(e,t,n)=>{const o=s(e,n);return t>o?t-o:0}}},_e=(t,n,s)=>((t,n)=>(t=>{const n=parseFloat(t);return isNaN(n)?e.none():e.some(n)})(t).getOr(n))(ce(t,n),s),Sa=Fa("width",e=>e.dom.offsetWidth),ee=e=>Sa.get(e),Sn=e=>Sa.getOuter(e),Mn=e=>((e,t)=>{const n=e.dom,s=n.getBoundingClientRect().width||n.offsetWidth;return"border-box"===t?s:((e,t)=>t-_e(e,"padding-left",0)-_e(e,"padding-right",0)-_e(e,"border-left-width",0)-_e(e,"border-right-width",0))(e,s)})(e,"content-box"),Fn=(e,t,n)=>{const s=e.cells,o=s.slice(0,t),i=s.slice(t),a=o.concat(n).concat(i);return Ca(e,a)},Ea=(e,t,n)=>Fn(e,t,[n]),Qe=(e,t,n)=>{e.cells[t]=n},Ca=(e,t)=>de(e.element,t,e.section,e.isNew),L=(e,t)=>e.cells[t],k=(e,t)=>L(e,t).element,P=e=>e.cells.length,g=e=>{const t=Co(e,e=>"colgroup"===e.section);return{rows:t.fail,cols:t.pass}},_a=(e,t,n)=>{const o=s(e.cells,n);return de(t(e.element),o,e.section,!0)},Zt="data-snooker-locked-cols",Al=t=>ae(t,Zt).bind(t=>e.from(t.match(/\d+/g))).map(e=>Hs(e,a)),pe=e=>{const t=B(g(e).rows,(e,t)=>(i(t.cells,(t,n)=>{t.isLocked&&(e[n]=!0)}),e),{}),n=oi(t,(e,t)=>parseInt(t,10));return((e)=>{const n=xo.call(e,0);return n.sort(void 0),n})(n)},$n=(e,t)=>e+","+t,ca=(e,t)=>{const n=y(e.all,e=>e.cells);return p(n,t)},ia=e=>{const n={},o=[],r=gt(e).map(e=>e.element).bind(S).bind(Al).getOr({});let a=0,s=0,t=0;const{pass:c,fail:l}=Co(e,e=>"colgroup"===e.section);i(l,e=>{const c=[];i(e.cells,e=>{let o=0;for(;void 0!==n[$n(t,o)];)o++;const a=((e,t)=>Is(e,t)&&void 0!==e[t]&&null!==e[t])(r,o.toString()),i=((e,t,n,s,o,i)=>({element:e,rowspan:t,colspan:n,row:s,column:o,isLocked:i}))(e.element,e.rowspan,e.colspan,t,o,a);for(let a=0;a<e.colspan;a++)for(let r=0;r<e.rowspan;r++){const c=o+a,l=$n(t+r,c);n[l]=i,s=Math.max(s,c+1)}c.push(i)}),a++,o.push(Jn(e.element,c,e.section)),t++});const{columns:d,colgroups:u}=Po(c).map(e=>{const t=(e=>{const t={};let n=0;return i(e.cells,e=>{const s=e.colspan;H(s,o=>{const i=n+o;t[i]=((e,t,n)=>({element:e,colspan:t,column:n}))(e.element,s,i)}),n+=s}),t})(e),n=((e,t)=>({element:e,columns:t}))(e.element,ai(t));return{colgroups:[n],columns:t}}).getOrThunk(()=>({colgroups:[],columns:{}})),h=((e,t)=>({rows:e,columns:t}))(a,s);return{grid:h,access:n,all:o,columns:d,colgroups:u}},_=e=>{const t=Jr(e);return ia(t)},Yt=ia,re=(t,n,s)=>e.from(t.access[$n(n,s)]),Kt=(t,n,s)=>{const o=ca(t,e=>s(n,e.element));return o.length>0?e.some(o[0]):e.none()},ea=ca,Qn=e=>y(e.all,e=>e.cells),Wt=e=>ai(e.columns),qe=e=>it(e.columns).length>0,Ji=(t,n)=>e.from(t.columns[n]),ts=(e,t=a)=>{const n=e.grid,o=H(n.columns,d),i=H(n.rows,d);return s(o,n=>Zi(()=>y(i,t=>re(e,t,n).filter(e=>e.column===n).toArray()),e=>1===e.colspan&&t(e.element),()=>re(e,0,n)))},Zi=(t,n,s)=>{const o=t();return I(o,n).orThunk(()=>e.from(o[0]).orThunk(s)).map(e=>e.element)},Qi=e=>{const t=e.grid,o=H(t.rows,d),i=H(t.columns,d);return s(o,t=>Zi(()=>y(i,s=>re(e,t,s).filter(e=>e.row===t).fold(n([]),e=>[e])),e=>1===e.rowspan,()=>re(e,t,0)))},Xi=(e,t)=>n=>"rtl"===Fl(n)?t:e,Fl=e=>"rtl"===ce(e,"direction")?"rtl":"ltr",Yi=Fa("height",e=>{const t=e.dom;return J(e)?t.getBoundingClientRect().height:t.offsetHeight}),pn=e=>Yi.get(e),qi=e=>Yi.getOuter(e),Vi=(e,t)=>({left:e,top:t,translate:(n,s)=>Vi(e+n,t+s)}),q=Vi,Vt=(e,t)=>void 0!==e?e:void 0!==t?t:0,Bt=e=>{const o=e.dom.ownerDocument,t=o.body,n=o.defaultView,s=o.documentElement;if(t===e.dom)return q(t.offsetLeft,t.offsetTop);const i=Vt(n?.pageYOffset,s.scrollTop),a=Vt(n?.pageXOffset,s.scrollLeft),r=Vt(s.clientTop,t.clientTop),c=Vt(s.clientLeft,t.clientLeft);return Vl(e).translate(a-c,i-r)},Vl=e=>{const t=e.dom,n=t.ownerDocument.body;return n===t?q(n.offsetLeft,n.offsetTop):J(e)?(e=>{const t=e.getBoundingClientRect();return q(t.left,t.top)})(t):q(0,0)},Mi=(e,t)=>({row:e,y:t}),Si=(e,t)=>({col:e,x:t}),Ei=e=>Bt(e).left+Sn(e),Ci=e=>Bt(e).left,xi=(e,t)=>Si(e,Ci(t)),Oi=(e,t)=>Si(e,Ei(t)),_s=e=>Bt(e).top,Yl=(e,t)=>Mi(e,_s(t)),Gl=(e,t)=>Mi(e,_s(t)+qi(t)),xs=(e,t,n)=>{if(0===n.length)return[];const o=s(n.slice(1),(t,n)=>t.map(t=>e(n,t))),i=n[n.length-1].map(e=>t(n.length-1,e));return o.concat([i])},Cs={delta:d,positions:e=>xs(Yl,Gl,e),edge:_s},Es=Xi({delta:d,edge:Ci,positions:e=>xs(xi,Oi,e)},{delta:e=>-e,edge:Ei,positions:e=>xs(Oi,xi,e)}),Dt={delta:(e,t)=>Es(t).delta(e,t),positions:(e,t)=>Es(t).positions(e,t),edge:e=>Es(e).edge(e)},Jl={unsupportedLength:["em","ex","cap","ch","ic","rem","lh","rlh","vw","vh","vi","vb","vmin","vmax","cm","mm","Q","in","pc","pt","px"],fixed:["px","pt"],relative:["%"],empty:[""]},id=(()=>{const n="[0-9]+",t="[eE][+-]?[0-9]+",e=e=>`(?:${e})?`,s=["Infinity","[0-9]+\\."+e(n)+e(t),"\\.[0-9]+"+e(t),n+e(t)].join("|");return new RegExp(`^([+-]?(?:${s}))(.*)$`)})(),ri=/(\d+(\.\d+)?)%/,cd=/(\d+(\.\d+)?)px|em/,ld=N("col"),Go=(n,s,o)=>{const a=(i=n,e.from(i.dom.parentElement).map(t.fromDom)).getOrThunk(()=>Ja(hn(n)));var i;return s(n)/o(a)*100},Yo=(e,t)=>{b(e,"width",t+"px")},qo=(e,t)=>{b(e,"width",t+"%")},St=(e,t)=>{b(e,"height",t+"px")},gd=e=>{const t=(e=>{return _e(t=e,"height",t.dom.offsetHeight)+"px";var t})(e);return t?((e,t,n,s)=>{const o=parseFloat(e);return bt(e,"%")&&"table"!==c(t)?((e,t,n,s)=>{const o=S(e).map(e=>{const s=n(e);return Math.floor(t/100*s)}).getOr(t);return s(e,o),o})(t,o,n,s):o})(t,e,pn,St):pn(e)},Vo=(e,t)=>Ps(e,t).orThunk(()=>ae(e,t).map(e=>e+"px")),Ae=e=>Vo(e,"width"),yd=e=>Go(e,ee,Mn),Ho=e=>{return ld(e)?ee(e):_e(t=e,"width",t.dom.offsetWidth);var t},Mo=e=>((e,t,n)=>n(e)/Ds(e,"rowspan"))(e,0,gd),So=(e,t,n)=>{b(e,"width",t+n)},Ao=e=>Go(e,ee,Mn)+"%",Md=n(ri),Fd=N("col"),$d=e=>Ae(e).getOrThunk(()=>Ho(e)+"px"),Wd=e=>{return(t=e,Vo(t,"height")).getOrThunk(()=>Mo(e)+"px");var t},Gs=(t,n,s,o,i,a)=>t.filter(o).fold(()=>a(((t,n)=>{if(n<0||n>=t.length-1)return e.none();const s=t[n].fold(()=>{const e=(e=>{const t=xo.call(e,0);return t.reverse(),t})(t.slice(0,n));return Z(e,(e,t)=>e.map(e=>({value:e,delta:t+1})))},t=>e.some({value:t,delta:0})),o=t[n+1].fold(()=>{const e=t.slice(n+1);return Z(e,(e,t)=>e.map(e=>({value:e,delta:t+1})))},t=>e.some({value:t,delta:1}));return s.bind(e=>o.map(t=>{const n=t.delta+e.delta;return Math.abs(t.value-e.value)/n}))})(s,n)),e=>i(e)),Xs=(t,n,o,i)=>{const a=ts(t),l=qe(t)?(t=>s(Wt(t),t=>e.from(t.element)))(t):a,r=[e.some(Dt.edge(n))].concat(s(Dt.positions(a,n),e=>e.map(e=>e.x))),c=xn(Fs);return s(l,(t,n)=>Gs(t,n,r,c,t=>{if((e=>{const t=Ra().browser,n=t.isChromium()||t.isFirefox();return!Fd(e)||n})(t))return o(t);{const t=null!=(s=a[n])?d(s):e.none();return Gs(t,n,r,c,t=>i(e.some(ee(t))),i)}var s},i))},ho=e=>e.map(e=>e+"px").getOr(""),Zs=(e,t,n)=>Xs(e,t,Ho,e=>e.getOrThunk(n.minCellWidth)),co=(t,n,o,i,a)=>{const r=Qi(t),c=[e.some(o.edge(n))].concat(s(o.positions(r,n),e=>e.map(e=>e.y)));return s(r,(e,t)=>Gs(e,t,c,xn(Or),i,a))},vt=(e,t)=>()=>J(e)?t(e):parseFloat(Ps(e,"width").getOr("0")),ro=e=>{const n=vt(e,e=>parseFloat(Ao(e))),t=vt(e,ee);return{width:n,pixelWidth:t,getWidths:(t,n)=>((e,t,n)=>Xs(e,t,yd,e=>e.fold(()=>n.minCellWidth(),e=>e/n.pixelWidth()*100)))(t,e,n),getCellDelta:e=>e/t()*100,singleColumnWidth:(e)=>[100-e],minCellWidth:()=>lt()/t()*100,setElementWidth:qo,adjustTableWidth:t=>{const s=n();qo(e,s+t/100*s)},isRelative:!0,label:"percent"}},Dr=e=>{const t=vt(e,ee);return{width:t,pixelWidth:t,getWidths:(t,n)=>Zs(t,e,n),getCellDelta:d,singleColumnWidth:(e,t)=>[Math.max(lt(),e+t)-e],minCellWidth:lt,setElementWidth:Yo,adjustTableWidth:n=>{const s=t()+n;Yo(e,s)},isRelative:!1,label:"pixel"}},Ct=e=>Ae(e).fold(()=>(e=>{const t=vt(e,ee),s=n(0);return{width:t,pixelWidth:t,getWidths:(t,n)=>Zs(t,e,n),getCellDelta:s,singleColumnWidth:n([0]),minCellWidth:s,setElementWidth:o,adjustTableWidth:o,isRelative:!0,label:"none"}})(e),t=>((e,t)=>null!==Md().exec(t)?ro(e):Dr(e))(e,t)),ru=Dr,au=ro,eu=(e,n,s)=>{const i=e[s].element,o=t.fromTag("td");l(o,t.fromTag("br")),(n?l:Ws)(i,o)},to=((t)=>{const s=n=>t(n)?e.from(n.dom.nodeValue):e.none();return{get:e=>{if(!t(e))throw new Error("Can only get text value of a text node");return s(e).getOr("")},getOption:s,set:(e,n)=>{if(!t(e))throw new Error("Can only set raw text value of a text node");e.dom.nodeValue=n}}})(ge),Js=e=>to.get(e),lo=e=>to.getOption(e),Qd=(e,t)=>to.set(e,t),oe=e=>"img"===c(e)?1:lo(e).fold(()=>T(e).length,e=>e.length),Gd=["img","br"],fo=e=>lo(e).filter(e=>0!==e.trim().length||e.indexOf("\xa0")>-1).isSome()||h(Gd,c(e)),po=n=>((n,s)=>{const o=n=>{for(let i=0;i<n.childNodes.length;i++){const a=t.fromDom(n.childNodes[i]);if(s(a))return e.some(a);const r=o(n.childNodes[i]);if(r.isSome())return r}return e.none()};return o(n.dom)})(n,fo),go=e=>Yd(e,fo),Yd=(t,n)=>{const s=t=>{const o=T(t);for(let t=o.length-1;t>=0;t--){const i=o[t];if(n(i))return e.some(i);const a=s(i);if(a.isSome())return a}return e.none()};return s(t)},Ud={scope:["row","col"]},Ys=e=>()=>{const n=t.fromTag("td",e.dom);return l(n,t.fromTag("br",e.dom)),n},qs=e=>()=>t.fromTag("col",e.dom),_o=e=>()=>t.fromTag("colgroup",e.dom),wo=e=>()=>t.fromTag("tr",e.dom),Ld=(e,t,n)=>{const s=((e,t)=>{const n=Ia(e,t),s=T(Oe(e));return X(n,s),n})(e,t);return M(n,(e,t)=>{null===e?u(s,t):v(s,t,e)}),s},Nd=e=>e,Ks=(e,n,s)=>{const o=(e,t)=>{((e,t)=>{const n=e.dom,s=t.dom;ze(n)&&ze(s)&&(s.style.cssText=n.style.cssText)})(e.element,t),ie(t,"height"),1!==e.colspan&&ie(t,"width")};return{col:s=>{const i=t.fromTag(c(s.element),n.dom);return o(s,i),e(s.element,i),i},colgroup:_o(n),row:wo(n),cell:i=>{const a=t.fromTag(c(i.element),n.dom),d=s.getOr(["strong","em","b","i","span","font","h1","h2","h3","h4","h5","h6","p","div"]),m=d.length>0?((e,t,n)=>po(e).map(s=>{const o=n.join(","),i=st(s,o,t=>r(t,e));return V(i,(e,t)=>{const n=Na(t);return u(n,"contenteditable"),l(e,n),n},t)}).getOr(t))(i.element,a,d):a;return l(m,t.fromTag("br")),o(i,a),((e,t)=>{M(Ud,(n,s)=>ae(e,s).filter(e=>h(n,e)).each(e=>v(t,s,e)))})(i.element,a),e(i.element,a),a},replace:Ld,colGap:qs(n),gap:Ys(n)}},Eo=e=>({col:qs(e),colgroup:_o(e),row:wo(e),cell:Ys(e),replace:Nd,colGap:qs(e),gap:Ys(e)}),yt=e=>t.fromDom(e.getBody()),Pe=e=>t=>r(t,yt(e)),he=e=>{u(e,"data-mce-style");const t=e=>u(e,"data-mce-style");i(Me(e),t),i(vs(e),t),i(Mr(e),t)},Ot=e=>t.fromDom(e.selection.getStart()),Fo=e=>e.getBoundingClientRect().width,To=e=>e.getBoundingClientRect().height,kd=(e,t)=>{const n=t.column,s=t.column+t.colspan-1,o=t.row,i=t.row+t.rowspan-1;return n<=e.finishCol&&s>=e.startCol&&o<=e.finishRow&&i>=e.startRow},Od=(e,t)=>t.column>=e.startCol&&t.column+t.colspan-1<=e.finishCol&&t.row>=e.startRow&&t.row+t.rowspan-1<=e.finishRow,No=(e,t,n)=>{const s=Kt(e,t,r),o=Kt(e,n,r);return s.bind(e=>o.map(t=>{return n=e,s=t,{startRow:Math.min(n.row,s.row),startCol:Math.min(n.column,s.column),finishRow:Math.max(n.row+n.rowspan-1,s.row+s.rowspan-1),finishCol:Math.max(n.column+n.colspan-1,s.column+s.colspan-1)};var n,s}))},Lo=(e,t,n)=>No(e,t,n).map(t=>{const n=ea(e,x(kd,t));return s(n,e=>e.element)}),Ro=(e,t)=>Kt(e,t,(e,t)=>En(t,e)).map(e=>e.element),wd=(e,t,n)=>{const s=xt(e);return Lo(s,t,n)},Bs=(t,n,s,o,i)=>{const a=xt(t),c=r(t,s)?e.some(n):Ro(a,n),l=r(t,i)?e.some(o):Ro(a,o);return c.bind(e=>l.bind(t=>Lo(a,e,t)))},xt=_;var Xr,Xn,jd=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],kt=()=>({up:n({selector:ue,closest:j,predicate:rt,all:Ri}),down:n({selector:G,predicate:ur}),styles:n({get:ce,getRaw:Ps,set:b,remove:ie}),attrs:n({get:Ne,set:v,remove:u,copyTo:(e,t)=>{const n=di(e);Ve(t,n)}}),insert:n({before:At,after:ht,afterAll:Gi,append:l,appendAll:X,prepend:Ws,wrap:Dl}),remove:n({unwrap:kl,remove:E}),create:n({nu:t.fromTag,clone:e=>t.fromDom(e.dom.cloneNode(!1)),text:t.fromText}),query:n({comparePosition:(e,t)=>e.dom.compareDocumentPosition(t.dom),prevSibling:Pi,nextSibling:tn}),property:n({children:T,name:c,parent:be,document:e=>dn(e).dom,isText:ge,isComment:od,isElement:Q,isSpecial:e=>{const t=c(e);return h(["script","noscript","iframe","noframes","noembed","title","style","textarea","xmp"],t)},getLanguage:t=>Q(t)?ae(t,"lang"):e.none(),getText:Js,setText:Qd,isBoundary:e=>!!Q(e)&&("body"===c(e)||h(jd,c(e))),isEmptyTag:e=>!!Q(e)&&h(["br","img","hr","input"],c(e)),isNonEditable:e=>Q(e)&&"false"===Ne(e,"contenteditable")}),eq:r,is:ql}),at,bo;const bd=(e,t,n,s)=>{const o=t(e,n);return V(s,(n,s)=>{const o=t(e,s);return vd(e,n,o)},o)},vd=(e,t,n)=>t.bind(t=>n.filter(x(e.eq,t))),Uo=kt(),Rs=(t,n)=>((t,n,s)=>s.length>0?((e,t,n,s)=>s(e,t,n[0],n.slice(1)))(t,n,s,bd):e.none())(Uo,(e,n)=>t(n),n),Ns=e=>ue(e,"table"),Mt=(t,n,s)=>{const o=e=>t=>void 0!==s&&s(t)||r(t,e);return r(t,n)?e.some({boxes:e.some([t]),start:t,finish:n}):Ns(t).bind(i=>Ns(n).bind(a=>{if(r(i,a))return e.some({boxes:wd(i,t,n),start:t,finish:n});if(En(i,a)){const s=st(n,"td,th",o(i)),r=s.length>0?s[s.length-1]:n;return e.some({boxes:Bs(i,t,i,n,a),start:t,finish:r})}if(En(a,i)){const s=st(t,"td,th",o(a)),r=s.length>0?s[s.length-1]:t;return e.some({boxes:Bs(a,t,i,n,a),start:t,finish:r})}return((e,t)=>((e,t,n,s=W)=>{const r=[t].concat(e.up().all(t)),c=[n].concat(e.up().all(n)),o=e=>Ls(e,s).fold(()=>e,t=>e.slice(0,t+1)),i=o(r),a=o(c),l=I(i,t=>F(a,((e,t)=>x(e.eq,t))(e,t)));return{firstpath:i,secondpath:a,shared:l}})(Uo,e,t,void 0))(t,n).shared.bind(r=>j(r,"table",s).bind(s=>{const r=st(n,"td,th",o(s)),l=r.length>0?r[r.length-1]:n,c=st(t,"td,th",o(s)),d=c.length>0?c[c.length-1]:t;return e.some({boxes:Bs(s,t,i,n,a),start:d,finish:l})}))}))},zs=(t,n)=>{const s=G(t,n);return s.length>0?e.some(s):e.none()},Xo=(e,t,n)=>dt(e,t).bind(t=>dt(e,n).bind(e=>Rs(Ns,[t,e]).map(n=>({first:t,last:e,table:n})))),fd=(e,t,n,s,o)=>((e,t)=>I(e,e=>z(e,t)))(e,o).bind(e=>((e,t,n)=>S(e).bind(s=>((e,t,n,s)=>Kt(e,t,r).bind(t=>{const o=n>0?t.row+t.rowspan-1:t.row,i=s>0?t.column+t.colspan-1:t.column;return re(e,o+n,i+s).map(e=>e.element)}))(xt(s),e,t,n)))(e,t,n).bind(e=>((e,t)=>ue(e,"table").bind(n=>dt(n,t).bind(t=>Mt(t,e).bind(e=>e.boxes.map(t=>({boxes:t,start:e.start,finish:e.finish}))))))(e,s))),Zo=(e,t)=>zs(e,t),md=(t,n,s)=>Xo(t,n,s).bind(n=>{const s=e=>r(t,e),o="thead,tfoot,tbody,table",i=ue(n.first,o,s),a=ue(n.last,o,s);return i.bind(t=>a.bind(s=>r(t,s)?((t,n,s)=>((t,n,s)=>No(t,n,s).bind(n=>((t,n)=>{let s=!0;const o=x(Od,n);for(let e=n.startRow;e<=n.finishRow;e++)for(let i=n.startCol;i<=n.finishCol;i++)s=s&&re(t,e,i).exists(o);return s?e.some(n):e.none()})(t,n)))(xt(t),n,s))(n.table,n.first,n.last):e.none()))}),ei=d,hd=t=>{const n=(e,t)=>ae(e,t).exists(e=>parseInt(e,10)>1);return t.length>0&&R(t,e=>n(e,"rowspan")||n(e,"colspan"))?e.some(t):e.none()},ud=(t,n,s)=>n.length<=1?e.none():md(t,s.firstSelectedSelector,s.lastSelectedSelector).map(e=>({bounds:e,cells:n})),fe={selected:"data-mce-selected",selectedSelector:"td[data-mce-selected],th[data-mce-selected]",firstSelected:"data-mce-first-selected",firstSelectedSelector:"td[data-mce-first-selected],th[data-mce-first-selected]",lastSelected:"data-mce-last-selected",lastSelectedSelector:"td[data-mce-last-selected],th[data-mce-last-selected]"},Ft=(e,t,n)=>({element:n,mergable:ud(t,e,fe),unmergable:hd(e),selection:ei(e)}),ii=e=>(t,s)=>{const o=c(t),a="col"===o||"colgroup"===o?S(i=t).bind(e=>Zo(e,fe.firstSelectedSelector)).fold(n(i),e=>e[0]):t;var i;return j(a,e,s)},rd=ii("th,td,caption"),Ms=ii("th,td"),U=e=>{return n=e.model.table.getSelectedCells(),s(n,t.fromDom);var n},td=(e,n)=>{e.on("BeforeGetContent",t=>{const n=n=>{t.preventDefault(),(e=>S(e[0]).map(e=>{const t=((e,t)=>{const a=e=>z(e.element,t),n=Oe(e),r=Jr(n),c=Ct(e),s=Yt(r),o=((e,t)=>{const c=e.grid.columns;let n=e.grid.rows,s=c,o=0,i=0;const a=[],r=[];return M(e.access,e=>{if(a.push(e),t(e)){r.push(e);const t=e.row,c=t+e.rowspan-1,a=e.column,l=a+e.colspan-1;t<n?n=t:c>o&&(o=c),a<s?s=a:l>i&&(i=l)}}),((e,t,n,s,o,i)=>({minRow:e,minCol:t,maxRow:n,maxCol:s,allCells:o,selectedCells:i}))(n,s,o,i,a,r)})(s,a),l="th:not("+t+"),td:not("+t+")",d=ws(n,"th,td",e=>z(e,l));i(d,E),((e,t,n,s)=>{const o=p(e,e=>"colgroup"!==e.section),i=t.grid.columns,a=t.grid.rows;for(let e=0;e<a;e++){let r=!1;for(let a=0;a<i;a++)e<n.minRow||e>n.maxRow||a<n.minCol||a>n.maxCol||(re(t,e,a).filter(s).isNone()?eu(o,r,e):r=!0)}})(r,s,o,a);const h=((e,t,n,s)=>{if(0===s.minCol&&t.grid.columns===s.maxCol+1)return 0;const o=Zs(t,e,n),i=B(o,(e,t)=>e+t,0),a=B(o.slice(s.minCol,s.maxCol+1),(e,t)=>e+t,0),r=a/i*n.pixelWidth()-n.pixelWidth();return n.getCellDelta(r)})(e,_(e),c,o);return((e,t,n,s)=>{M(n.columns,e=>{(e.column<t.minCol||e.column>t.maxCol)&&E(e.element)});const o=p(Lt(e,"tr"),e=>0===e.dom.childElementCount);i(o,E),t.minCol!==t.maxCol&&t.minRow!==t.maxRow||i(Lt(e,"th,td"),e=>{u(e,"rowspan"),u(e,"colspan")}),u(e,Zt),u(e,"data-snooker-col-series"),Ct(e).adjustTableWidth(s)})(n,o,s,h),n})(e,"[data-mce-selected]");return he(t),[t]}))(n).each(n=>{t.content="text"===t.format?(e=>s(e,e=>e.dom.innerText).join(""))(n):((e,t)=>s(t,t=>e.selection.serializer.serialize(t.dom,{})).join(""))(e,n)})};if(!0===t.selection){const t=(e=>p(U(e),e=>z(e,fe.selectedSelector)))(e);t.length>=1&&n(t)}}),e.on("BeforeSetContent",s=>{if(!0===s.selection&&!0===s.paste){const o=U(e);gt(o).each(o=>{S(o).each(i=>{const a=p(((e)=>{const s=document.createElement("div");return s.innerHTML=e,T(t.fromDom(s))})(s.content),e=>"meta"!==c(e)),r=N("table");if(1===a.length&&r(a[0])){s.preventDefault();const r=t.fromDom(e.getDoc()),c=Eo(r),l=((e,t,n)=>({element:e,clipboard:t,generators:n}))(o,a[0],c);n.pasteCells(i,l).each(()=>{e.focus()})}})})}})},$e=(e,t)=>({element:e,offset:t}),ui=(t,n,s)=>t.property().isText(n)&&0===t.property().getText(n).trim().length||t.property().isComment(n)?s(n).bind(n=>ui(t,n,s).orThunk(()=>e.some(n))):e.none(),hi=(e,t)=>e.property().isText(t)?e.property().getText(t).length:e.property().children(t).length,mi=(e,t)=>{const n=ui(e,t,e.query().prevSibling).getOr(t);if(e.property().isText(n))return $e(n,hi(e,n));const s=e.property().children(n);return s.length>0?mi(e,s[s.length-1]):$e(n,hi(e,n))},Zl=mi,Ql=kt(),Xl=(t,n)=>{if(!Fs(t)){const s=(t=>Ae(t).bind(t=>{return n=t,s=["fixed","relative","empty"],e.from(id.exec(n)).bind(t=>{const o=Number(t[1]),n=t[2];return((e,t)=>F(t,t=>F(Jl[t],t=>e===t)))(n,s)?e.some({value:o,unit:n}):e.none()});var n,s}))(t);s.each(e=>{const s=e.value/2;So(t,s,e.unit),So(n,s,e.unit)})}},Nt=e=>s(e,n(0)),bi=(e,t,n,s,o)=>o(e.slice(0,t)).concat(s).concat(o(e.slice(n))),ji=e=>(t,n,s,o)=>{if(e(s)){const i=Math.max(o,t[n]-Math.abs(s)),e=Math.abs(i-t[n]);return s>=0?e:-e}return s},Rt=ji(e=>e<0),Rl=ji(a),wi=()=>{const e=(e,t,n,o)=>{const i=(100+n)/100,a=Math.max(o,(e[t]+n)/i);return s(e,(e,n)=>(n===t?a:e/i)-e)},t=(t,n,s,o,i,a)=>a?e(t,n,o,i):((e,t,n,s,o)=>{const i=Rt(e,t,s,o);return bi(e,t,n+1,[i,0],Nt)})(t,n,s,o,i);return{resizeTable:(e,t)=>e(t),clampTableDelta:Rt,calcLeftEdgeDeltas:t,calcMiddleDeltas:(e,n,s,o,i,a,r)=>t(e,s,o,i,a,r),calcRightEdgeDeltas:(t,n,s,o,i,a)=>{if(a)return e(t,s,o,i);{const e=Rt(t,s,o,i);return Nt(t.slice(0,s)).concat([e])}},calcRedestributedWidths:(e,t,n,o)=>{if(o){const o=(t+n)/t,i=s(e,e=>e/o);return{delta:100*o-100,newSizes:i}}return{delta:n,newSizes:e}}}},ys=()=>{const e=(e,t,n,s,o)=>{const i=Rl(e,s>=0?n:t,s,o);return bi(e,t,n+1,[i,-i],Nt)};return{resizeTable:(e,t,n)=>{n&&e(t)},clampTableDelta:(e,t,n,s,o)=>{if(o){if(n>=0)return n;{const t=B(e,(e,t)=>e+t-s,0);return Math.max(-t,n)}}return Rt(e,t,n,s)},calcLeftEdgeDeltas:e,calcMiddleDeltas:(t,n,s,o,i,a)=>e(t,s,o,i,a),calcRightEdgeDeltas:(e,t,o,i,a,r)=>{if(r)return Nt(e);{const t=i/e.length;return s(e,n(t))}},calcRedestributedWidths:(e)=>({delta:0,newSizes:e})}},js=e=>_(e).grid,Pt=N("th"),It=e=>R(e,e=>Pt(e.element)),$l=(e,t)=>e&&t?"sectionCells":e?"section":"cells",Ai=e=>{const t="thead"===e.section,n=$s(gs(e.cells),"th");return"tfoot"===e.section?{type:"footer"}:t||n?{type:"header",subType:$l(t,n)}:{type:"body"}},gs=t=>{const n=p(t,e=>Pt(e.element));return 0===n.length?e.some("td"):n.length===t.length?e.some("th"):e.none()},ps=(e,t,n)=>C(n(e.element,t),!0,e.isLocked),fs=(e,t)=>e.section!==t?de(e.element,e.cells,t,e.isNew):e,Ti=()=>({transformRow:fs,transformCell:(e,t,n)=>{const s=n(e.element,t),o="td"!==c(s)?((e)=>{const n=Ia(e,"td");ht(e,n);const s=T(e);return X(n,s),E(e),n})(s):s;return C(o,e.isNew,e.isLocked)}}),zi=()=>({transformRow:fs,transformCell:ps}),Di=()=>({transformRow:(e,t)=>fs(e,"thead"===t?"tbody":t),transformCell:ps}),Il=Ti,mc=zi,Qc=Di,Ll=()=>({transformRow:d,transformCell:ps}),Hi=e=>j(e,"[contenteditable]"),Ii=(e,t=!1)=>J(e)?e.dom.isContentEditable:Hi(e).fold(n(t),e=>"true"===Bi(e)),Bi=e=>e.dom.contentEditable,We=(e,t,n,s)=>{n===s?u(e,t):v(e,t,n)},$i=(e,t,n)=>{Po(qt(e,t)).fold(()=>Ws(e,n),e=>ht(e,n))},Nl=(e,n)=>{const a=[],r=[],m=e=>s(e,e=>{e.isNew&&a.push(e.element);const t=e.element;return Bn(t),i(e.cells,e=>{e.isNew&&r.push(e.element),We(e.element,"colspan",e.colspan,1),We(e.element,"rowspan",e.rowspan,1),l(t,e.element)}),t}),f=e=>y(e,e=>s(e.cells,e=>(We(e.element,"span",e.colspan,1),e.element))),p=(n,s)=>{const o=((e,n)=>{const s=ks(e,n).getOrThunk(()=>{const s=t.fromTag(n,hn(e).dom);return"thead"===n?$i(e,"caption,colgroup",s):"colgroup"===n?$i(e,"caption",s):l(e,s),s});return Bn(s),s})(e,s),i=("colgroup"===s?f:m)(n);X(o,i)},o=(t,n)=>{t.length>0?p(t,n):(t=>{ks(e,t).each(E)})(n)},c=[],d=[],u=[],h=[];return i(n,e=>{switch(e.section){case"thead":c.push(e);break;case"tbody":d.push(e);break;case"tfoot":u.push(e);break;case"colgroup":h.push(e)}}),o(h,"colgroup"),o(c,"thead"),o(d,"tbody"),o(u,"tfoot"),{newRows:a,newCells:r}},Ui=(e,t)=>{if(0===e.length)return 0;const n=e[0];return Ls(e,e=>!t(n.element,e.element)).getOr(e.length)},Tl=(e,t)=>{const n=s(e,e=>s(e.cells,W));return s(e,(o,i)=>{const a=y(o.cells,(o,a)=>{if(!1===n[i][a]){const u=((e,t,n,o)=>{const i=((e,t)=>e[t])(e,t),a="colgroup"===i.section,r=Ui(i.cells.slice(n),o),c=a?1:Ui(((e,t)=>s(e,e=>L(e,t)))(e.slice(t),n),o);return{colspan:r,rowspan:c}})(e,i,a,t);return((e,t,s,o)=>{for(let i=e;i<e+s;i++)for(let e=t;e<t+o;e++)n[i][e]=!0})(i,a,u.rowspan,u.colspan),[(r=o.element,c=u.rowspan,l=u.colspan,d=o.isNew,{element:r,rowspan:c,colspan:l,isNew:d})]}return[];var r,c,l,d});return((e,t,n,s)=>({element:e,cells:t,section:n,isNew:s}))(o.element,a,o.section,o.isNew)})},Ue=(e,t,n)=>{const s=[];i(e.colgroups,o=>{const i=[];for(let s=0;s<e.grid.columns;s++){const o=Ji(e,s).map(e=>C(e.element,n,!1)).getOrThunk(()=>C(t.colGap(),!0,!1));i.push(o)}s.push(de(o.element,i,"colgroup",n))});for(let o=0;o<e.grid.rows;o++){const i=[];for(let s=0;s<e.grid.columns;s++){const a=re(e,o,s).map(e=>C(e.element,n,e.isLocked)).getOrThunk(()=>C(t.gap(),!0,!1));i.push(a)}const a=e.all[o],r=de(a.element,i,a.section,n);s.push(r)}return s},$t=e=>Tl(e,r),is=(e,t)=>Z(e.all,e=>I(e.cells,e=>r(t,e.element))),os=(e,t,n)=>{const i=s(t.selection,t=>xr(t).bind(t=>is(e,t)).filter(n)),o=mr(i);return gn(o.length>0,o)},f=(t,n,s,o,i)=>(a,c,l,d)=>{const h=_(a),m=e.from(d?.section).getOrThunk(Ll);return n(h,c).map(e=>{const s=((e,t)=>Ue(e,t,!1))(h,l),n=t(s,e,r,i(l),m),o=pe(n.grid);return{info:e,grid:$t(n.grid),cursor:n.cursor,lockedColumns:o}}).bind(t=>{const n=Nl(a,t.grid),i=e.from(d?.sizing).getOrThunk(()=>Ct(a)),r=e.from(d?.resize).getOrThunk(ys);return s(a,t.grid,t.info,{sizing:i,resize:r,section:m}),o(a),u(a,Zt),t.lockedColumns.length>0&&v(a,Zt,t.lockedColumns.join(",")),e.some({cursor:t.cursor,newRows:n.newRows,newCells:n.newCells})})},ns=(e,t)=>os(e,t,a).map(e=>({cells:e,generators:t.generators,clipboard:t.clipboard})),ne=(e,t)=>os(e,t,a),te=(e,t)=>os(e,t,e=>!e.isLocked),ta=(e,t)=>R(t,t=>((e,t)=>is(e,t).exists(e=>!e.isLocked))(e,t)),na=(e,t,n,s)=>{const o=g(e).rows;let i=!0;for(let e=0;e<o.length;e++)for(let a=0;a<P(o[0]);a++){const r=o[e],c=L(r,a),l=n(c.element,t);l&&!i?Qe(r,a,C(s(),!0,c.isLocked)):l&&(i=!1)}return e},sa=t=>{const s=e=>e(t),o=n(t),i=()=>r,r={tag:!0,inner:t,fold:(e,n)=>n(t),isValue:a,isError:W,map:e=>Gt.value(e(t)),mapError:i,bind:s,exists:s,forall:s,getOr:o,or:i,getOrThunk:o,orThunk:i,getOrDie:o,each:e=>{e(t)},toOptional:()=>e.some(t)};return r},oa=t=>{const n=()=>s,s={tag:!1,inner:t,fold:(e)=>e(t),isValue:W,isError:a,map:n,mapError:e=>Gt.error(e(t)),bind:n,exists:W,forall:a,getOr:d,or:d,getOrThunk:Oo,orThunk:Oo,getOrDie:(i=String(t),()=>{throw new Error(i)}),each:o,toOptional:e.none};var i;return s},Gt={value:sa,error:oa,fromOption:(e,t)=>e.fold(()=>oa(t),sa)},aa=(e,t)=>({rowDelta:0,colDelta:P(e[0])-P(t[0])}),ra=(e,t)=>({rowDelta:e.length-t.length,colDelta:0}),Wn=(e,t,n,s)=>{const o="colgroup"===t.section?n.col:n.cell;return H(e,e=>C(o(),!0,s(e)))},Ml=(e,t,n,s)=>{const o=e[e.length-1];return e.concat(H(t,()=>{const t="colgroup"===o.section?n.colgroup:n.row,e=_a(o,t,d),i=Wn(e.cells.length,e,n,e=>Is(s,e.toString()));return Ca(e,i)}))},Sl=(e,t,n,o)=>s(e,e=>{const s=Wn(t,e,n,W);return Fn(e,o,s)}),Ge=(e,t,n)=>{const i=t.colDelta<0?Sl:d,r=t.rowDelta<0?Ml:d,c=pe(e),s=P(e[0]),l=F(c,e=>e===s-1),o=i(e,Math.abs(t.colDelta),n,l?s-1:s),u=pe(o);return r(o,Math.abs(t.rowDelta),n,Hs(u,a))},El=(e,t,n,s)=>{const o=x(s,L(e[t],n).element),i=e[t];return e.length>1&&P(i)>1&&(n>0&&o(k(i,n-1))||n<i.cells.length-1&&o(k(i,n+1))||t>0&&o(k(e[t-1],n))||t<e.length-1&&o(k(e[t+1],n)))},ma=(e,t,n)=>p(n,n=>n>=e.column&&n<=P(t[0])+e.column),fa=(e,t,n,o,a)=>{((e,t,n,s)=>{t>0&&t<e[0].cells.length&&i(e,e=>{const i=e.cells[t-1];let o=0;const a=s();for(;e.cells.length>t+o&&n(i.element,e.cells[t+o].element);)Qe(e,t+o,C(a,!0,e.cells[t+o].isLocked)),o++})})(t,e,a,o.cell);const c=ra(n,t),r=Ge(n,c,o),l=ra(t,r),d=Ge(t,l,o);return s(d,(t,n)=>Fn(t,e,r[n].cells))},pa=(t,n,o,r,c)=>{((t,n,s,o)=>{const a=g(t).rows;if(n>0&&n<a.length){const t=((e,t)=>B(e,(e,n)=>F(e,e=>t(e.element,n.element))?e:e.concat([n]),[]))(a[n-1].cells,s);i(t,t=>{let i=e.none();for(let r=n;r<a.length;r++)for(let n=0;n<P(a[0]);n++){const c=a[r],l=L(c,n);s(l.element,t.element)&&(i.isNone()&&(i=e.some(o())),i.each(e=>{Qe(c,n,C(e,!0,l.isLocked))}))}})}})(n,t,c,r.cell);const j=pe(n),h=aa(n,o),v={...h,colDelta:h.colDelta-j.length},u=Ge(n,v,r),{cols:b,rows:l}=g(u),d=pe(u),m=aa(o,n),y={...m,colDelta:m.colDelta+d.length},_=(f=r,p=d,s(o,e=>B(p,(t,n)=>{const s=Wn(1,e,f,a)[0];return Ea(t,n,s)},e))),w=Ge(_,y,r);var f,p;return[...b,...l.slice(0,t),...w,...l.slice(t,l.length)]},ga=(e,t,n,s,o)=>{const{rows:i,cols:a}=g(e),r=i.slice(0,t),c=i.slice(t);return[...a,...r,((e,t,n,s)=>_a(e,e=>s(e,n),t))(i[n],(e,n)=>t>0&&t<i.length&&s(k(i[t-1],n),k(i[t],n))?L(i[t],n):C(o(e.element,s),!0,e.isLocked),s,o),...c]},va=(e,t,n,o,i)=>s(e,e=>{const s=t>0&&t<P(e)&&o(k(e,t-1),k(e,t)),a=((e,t,n,s,o,i,a)=>{if("colgroup"!==n&&s)return L(e,t);{const t=L(e,o);return C(a(t.element,i),!0,!1)}})(e,t,e.section,s,n,o,i);return Ea(e,t,a)}),ba=(e,t,n,s)=>((e,t,n,s)=>void 0!==k(e[t],n)&&t>0&&s(k(e[t-1],n),k(e[t],n)))(e,t,n,s)||((e,t,n)=>t>0&&n(k(e,t-1),k(e,t)))(e[t],n,s),ja=(e,t,n,s)=>{const o=e=>(e=>"row"===e?Or(t):Fs(t))(e)?`${e}group`:e;return e?Pt(t)?o(n):null:s&&Pt(t)?o("row"===n?"col":"row"):null},ya=(e,t,n)=>C(n(e.element,t),!0,e.isLocked),Hn=(t,n,o,i,a,r,c)=>s(t,(t,l)=>((t)=>{const h=t.cells,m=s(h,(t,s)=>{if((e=>F(n,t=>o(e.element,t.element)))(t)){const n=c(t,l,s)?a(t,o,i):t;return r(n,l,s).each(t=>{var s=n.element,o={scope:e.from(t)};M(o,(e,t)=>{e.fold(()=>{u(s,t)},e=>{Ln(s.dom,t,e)})})}),n}return t});return de(t.element,m,t.section,t.isNew)})(t)),wa=(e,t,n)=>y(e,(s,o)=>ba(e,o,t,n)?[]:[L(s,t)]),Oa=(t,n,o,i,r)=>{const l=g(t).rows,u=y(n,e=>wa(l,e,i)),h=s(l,e=>It(e.cells)),m=((e,t)=>R(t,d)&&It(e)?a:(e,n)=>"th"!==c(e.element)||!t[n])(u,h),f=((t,n)=>(s,o)=>e.some(ja(t,s.element,"row",n[o])))(o,h);return Hn(t,u,i,r,ya,f,m)},xa=(t,n,o,i)=>{const r=g(t).rows,c=s(n,e=>L(r[e.row],e.column));return Hn(t,c,o,i,ya,e.none,a)},je=e=>{if(!Ut(e))throw new Error("cases must be an array");if(0===e.length)throw new Error("there must be at least one case");const t=[],n={};return i(e,(s,o)=>{const r=it(s);if(1!==r.length)throw new Error("one and only one name per case");const i=r[0],a=s[i];if(void 0!==n[i])throw new Error("duplicate key detected:"+i);if("cata"===i)throw new Error("cannot have a case named cata (sorry)");if(!Ut(a))throw new Error("case arguments must be an array");t.push(i),n[i]=(...n)=>{const s=n.length;if(s!==a.length)throw new Error("Wrong number of arguments to case "+i+". Expected "+a.length+" ("+a+"), got "+s);return{fold:(...t)=>{if(t.length!==e.length)throw new Error("Wrong number of arguments to fold. Expected "+e.length+", got "+t.length);return t[o].apply(null,n)},match:e=>{const s=it(e);if(t.length!==s.length)throw new Error("Wrong number of arguments to match. Expected: "+t.join(",")+`
Actual: `+s.join(","));if(!R(t,e=>h(s,e)))throw new Error("Not all branches were specified when using match. Specified: "+s.join(", ")+`
Required: `+t.join(", "));return e[i].apply(null,n)},log:e=>{console.log(e,{constructors:t,constructor:i,params:n})}}}}),n},xe={...je([{none:[]},{only:["index"]},{left:["index","next"]},{middle:["prev","index","next"]},{right:["prev","index"]}])},ka=(e,t,n)=>{let s=0;for(let o=e;o<t;o++)s+=void 0!==n[o]?n[o]:0;return s},Cl=(e,t)=>{const n=Qn(e);return s(n,e=>{const n=ka(e.row,e.row+e.rowspan,t);return{element:e.element,height:n,rowspan:e.rowspan}})},kn=(e,t,n)=>{const o=((e,t)=>qe(e)?((e,t)=>{const n=Wt(e);return s(n,(e,n)=>({element:e.element,width:t[n],colspan:e.colspan}))})(e,t):((e,t)=>{const n=Qn(e);return s(n,e=>{const n=ka(e.column,e.column+e.colspan,t);return{element:e.element,width:n,colspan:e.colspan}})})(e,t))(e,t);i(o,e=>{n.setElementWidth(e.element,e.width)})},Ma=(e,t,o,i,a)=>{const r=_(e),u=a.getCellDelta(t),c=a.getWidths(r,a),l=o===r.grid.columns-1,d=i.clampTableDelta(c,o,u,a.minCellWidth(),l),h=((e,t,o,i,a)=>{const r=e.slice(0),c=((e,t)=>0===e.length?xe.none():1===e.length?xe.only(0):0===t?xe.left(0,1):t===e.length-1?xe.right(t-1,t):t>0&&t<e.length-1?xe.middle(t-1,t,t+1):xe.none())(e,t),l=n(s(r,n(0)));return c.fold(l,e=>i.singleColumnWidth(r[e],o),(e,t)=>a.calcLeftEdgeDeltas(r,e,t,o,i.minCellWidth(),i.isRelative),(e,t,n)=>a.calcMiddleDeltas(r,e,t,n,o,i.minCellWidth(),i.isRelative),(e,t)=>a.calcRightEdgeDeltas(r,e,t,o,i.minCellWidth(),i.isRelative))})(c,o,d,a,i),m=s(h,(e,t)=>e+c[t]);kn(r,m,a),i.resizeTable(a.adjustTableWidth,d,l)},we=e=>B(e,(e,t)=>F(e,e=>e.column===t.column)?e:e.concat([t]),[]).sort((e,t)=>e.column-t.column),Ta=N("col"),za=N("colgroup"),Da=e=>"tr"===c(e)||za(e),xl=e=>({element:e,colspan:Y(e,"colspan",1),rowspan:Y(e,"rowspan",1)}),La=e=>ae(e,"scope").map(e=>e.substr(0,3)),$=(t,n=xl)=>{const s=s=>{if(Da(s))return za((i={element:s}).element)?t.colgroup(i):t.row(i);{const i=s,a=(e=>Ta(e.element)?t.col(e):t.cell(e))(n(i));return o=e.some({item:i,replacement:a}),a}var i};let o=e.none();return{getOrInit:(e,t)=>o.fold(()=>s(e),n=>t(e,n.item)?n.replacement:s(e))}},Pa=e=>t=>{const n=[],s=s=>{const i="td"===e?{scope:null}:{},o=t.replace(s,e,i);return n.push({item:s,sub:o}),o};return{replaceOrInit:(e,t)=>{if(Da(e)||Ta(e))return e;{const o=e;return((e,t)=>I(n,n=>t(n.item,e)))(o,t).fold(()=>s(o),n=>t(e,n.item)?n.sub:s(o))}}}},Ha=t=>({unmerge:e=>{const n=La(e);return n.each(t=>v(e,"scope",t)),()=>{const s=t.cell({element:e,colspan:1,rowspan:1});return ie(s,"width"),ie(e,"width"),n.each(e=>v(s,"scope",e)),s}},merge:t=>(ie(t[0],"width"),(()=>{const n=mr(s(t,La));if(0===n.length)return e.none();{const t=n[0],s=["row","col"];return F(n,e=>e!==t&&h(s,e))?e.none():e.from(t)}})().fold(()=>u(t[0],"scope"),e=>v(t[0],"scope",e+"group")),n(t[0]))}),wl=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","table","thead","tfoot","tbody","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],On=kt(),wn=e=>((e,t)=>{const n=e.property().name(t);return h(wl,n)})(On,e),vl=e=>((e,t)=>{const n=e.property().name(t);return h(["ol","ul"],n)})(On,e),gl=e=>{const n=N("br"),s=e=>go(e).bind(s=>{const o=tn(s).map(e=>!!wn(e)||!!((e,t)=>h(["br","img","hr","input"],e.property().name(t)))(On,e)&&"img"!==c(e)).getOr(!1);return be(s).map(i=>{return!0===o||"li"===c(a=i)||rt(a,vl).isSome()||n(s)||wn(i)&&!r(e,i)?[]:[t.fromTag("br")];var a})}).getOr([]),o=(()=>{const o=y(e,e=>{const t=T(e);return(e=>R(e,e=>n(e)||ge(e)&&0===Js(e).trim().length))(t)?[]:t.concat(s(e))});return 0===o.length?[t.fromTag("br")]:o})();Bn(e[0]),X(e[0],o)},Ua=e=>Ii(e,!0),Ka=e=>{0===Me(e).length&&E(e)},cn=(e,t)=>({grid:e,cursor:t}),O=(t,n,s)=>{const o=((t,n,s)=>{var o,i;const a=g(t).rows;return e.from(null===(i=null===(o=a[n])||void 0===o?void 0:o.cells[s])||void 0===i?void 0:i.element).filter(Ua).orThunk(()=>(e=>Z(e,e=>Z(e.cells,e=>{const t=e.element;return gn(Ua(t),t)})))(a))})(t,n,s);return cn(t,o)},ft=e=>B(e,(e,t)=>F(e,e=>e.row===t.row)?e:e.concat([t]),[]).sort((e,t)=>e.row-t.row),bn=(t,n)=>(o,r,l,u,h)=>{const m=ft(r),f=s(m,e=>e.row),p=((t,n,o,r,l,u,h)=>{const{cols:b,rows:m}=g(t),f=m[n[0]],j=y(n,e=>((e,t,n)=>{const s=e[t];return y(s.cells,(s,o)=>ba(e,t,o,n)?[]:[s])})(m,e,l)),p=s(f.cells,(e,t)=>It(wa(m,t,l))),v=[...m];i(n,e=>{v[e]=h.transformRow(m[e],o)});const _=[...b,...v],w=((e,t)=>R(t,d)&&It(e.cells)?a:(e,n,s)=>"th"!==c(e.element)||!t[s])(f,p),O=((t,n)=>(s,o,i)=>e.some(ja(t,s.element,"col",n[i])))(r,p);return Hn(_,j,l,u,h.transformCell,O,w)})(o,f,t,n,l,u.replaceOrInit,h);return O(p,r[0].row,r[0].column)},hl=bn("thead",!0),dl=bn("tbody",!1),rl=bn("tfoot",!1),fn=(e,t,n)=>{const s=((e,t)=>Lr(e,()=>t))(e,n.section),o=Yt(s);return Ue(o,t,!0)},ls=(e,t,n,s)=>((e,t,n,s)=>{const o=Yt(t),i=s.getWidths(o,s);kn(o,i,s)})(0,t,0,s.sizing),Qs=(e,t,n,s)=>((e,t,n,s,o)=>{const i=Yt(t),a=s.getWidths(i,s),r=s.pixelWidth(),{newSizes:c,delta:l}=o.calcRedestributedWidths(a,r,n.pixelDelta,s.isRelative);kn(i,c,s),s.adjustTableWidth(l)})(0,t,n,s.sizing,s.resize),sr=(e,t)=>F(t,e=>0===e.column&&e.isLocked),or=(e,t)=>F(t,t=>t.column+t.colspan>=e.grid.columns&&t.isLocked),ir=(e,t)=>{const n=ts(e),s=we(t);return B(s,(e,t)=>e+n[t.column].map(Sn).getOr(0),0)},ar=e=>(t,n)=>ne(t,n).filter(n=>!(e?sr:or)(t,n)).map(e=>({details:e,pixelDelta:ir(t,e)})),rr=e=>(t,n)=>ns(t,n).filter(n=>!(e?sr:or)(t,n.cells)),vn=Pa("th"),mn=Pa("td"),al=f((e,t,n,s)=>{const o=t[0].row,i=ft(t),a=V(i,(e,t)=>({grid:ga(e.grid,o,t.row+e.delta,n,s.getOrInit),delta:e.delta+1}),{grid:e,delta:0}).grid;return O(a,o,t[0].column)},ne,o,o,$),il=f((e,t,n,s)=>{const o=ft(t),i=o[o.length-1],a=i.row+i.rowspan,r=V(o,(e,t)=>ga(e,a,t.row,n,s.getOrInit),e);return O(r,a,t[0].column)},ne,o,o,$),ol=f((e,t,n,s)=>{const o=t.details,i=we(o),a=i[0].column,r=V(i,(e,t)=>({grid:va(e.grid,a,t.column+e.delta,n,s.getOrInit),delta:e.delta+1}),{grid:e,delta:0}).grid;return O(r,o[0].row,a)},ar(!0),Qs,o,$),sl=f((e,t,n,s)=>{const o=t.details,i=o[o.length-1],a=i.column+i.colspan,r=we(o),c=V(r,(e,t)=>va(e,a,t.column,n,s.getOrInit),e);return O(c,o[0].row,a)},ar(!1),Qs,o,$),nl=f((e,t)=>{const i=we(t.details),a=((e,t)=>y(e,e=>{const s=e.cells,n=V(t,(e,t)=>t>=0&&t<e.length?e.slice(0,t).concat(e.slice(t+1)):e,s);return n.length>0?[de(e.element,n,e.section,e.isNew)]:[]}))(e,s(i,e=>e.column)),r=a.length>0?a[0].cells.length-1:0;return O(a,i[0].row,Math.min(i[0].column,r))},(e,t)=>te(e,t).map(t=>({details:t,pixelDelta:-ir(e,t)})),Qs,Ka,$),tl=f((e,t)=>{const o=ft(t),i=((e,t,n)=>{const{rows:s,cols:o}=g(e);return[...o,...s.slice(0,t),...s.slice(n+1)]})(e,o[0].row,o[o.length-1].row),a=i.length>0?i.length-1:0;return O(i,Math.min(t[0].row,a),t[0].column)},ne,o,Ka,$),el=f((e,t,n,o)=>{const i=we(t),a=s(i,e=>e.column),r=Oa(e,a,!0,n,o.replaceOrInit);return O(r,t[0].row,t[0].column)},te,o,o,vn),Jc=f((e,t,n,o)=>{const i=we(t),a=s(i,e=>e.column),r=Oa(e,a,!1,n,o.replaceOrInit);return O(r,t[0].row,t[0].column)},te,o,o,mn),Zc=f(hl,te,o,o,vn),fc=f(dl,te,o,o,mn),qc=f(rl,te,o,o,mn),$c=f((e,t,n,s)=>{const o=xa(e,t,n,s.replaceOrInit);return O(o,t[0].row,t[0].column)},te,o,o,vn),Vc=f((e,t,n,s)=>{const o=xa(e,t,n,s.replaceOrInit);return O(o,t[0].row,t[0].column)},te,o,o,mn),Bc=f((t,n,s,o)=>{const i=n.cells;gl(i);const a=((e,t,n,s)=>{const o=g(e).rows;if(0===o.length)return e;for(let e=t.startRow;e<=t.finishRow;e++)for(let n=t.startCol;n<=t.finishCol;n++){const i=o[e],a=L(i,n).isLocked;Qe(i,n,C(s(),!1,a))}return e})(t,n.bounds,0,o.merge(i));return cn(a,e.from(i[0]))},(e,t)=>((e,t)=>t.mergable)(0,t).filter(t=>ta(e,t.cells)),ls,o,Ha),Hc=f((t,n,s,o)=>{const i=V(n,(e,t)=>na(e,t,s,o.unmerge(t)),t);return cn(i,e.from(n[0]))},(e,t)=>((e,t)=>t.unmergable)(0,t).filter(t=>ta(e,t)),ls,o,Ha),Rc=f((t,n,s)=>{const c=((e,t)=>{const n=_(e);return Ue(n,t,!0)})(n.clipboard,n.generators);var i,r;return((e,t,n,s,o)=>{const c=pe(t),i=((e,t,n)=>{const s=P(t[0]),o=g(t).cols.length+e.row,i=H(s-e.column,t=>t+e.column);return{row:o,column:I(i,e=>R(n,t=>t!==e)).getOr(s-1)}})(e,t,c),r=g(n).rows,l=ma(i,r,c),d=((e,t,n)=>{if(e.row>=t.length||e.column>P(t[0]))return Gt.error("invalid start address out of table bounds, row: "+e.row+", column: "+e.column);const s=t.slice(e.row),o=s[0].cells.slice(e.column),i=P(n[0]),a=n.length;return Gt.value({rowDelta:s.length-a,colDelta:o.length-i})})(i,t,r);return d.map(e=>{const c={...e,colDelta:e.colDelta-l.length},n=Ge(t,c,s),d=pe(n),u=ma(i,r,d);return((e,t,n,s,o,i)=>{const r=e.row,c=e.column,l=r+n.length,d=c+P(n[0])+i.length,u=Hs(i,a);for(let e=r;e<l;e++){let i=0;for(let a=c;a<d;a++){if(u[a]){i++;continue}El(t,e,a,o)&&na(t,k(t[e],a),o,s.cell);const h=a-c-i,l=L(n[e-r],h),m=l.element,f=s.replace(m);Qe(t[e],a,C(f,!0,l.isLocked))}}return t})(i,n,r,s,o,u)})})((i=n.row,r=n.column,{row:i,column:r}),t,c,n.generators,s).fold(()=>cn(t,e.some(n.element)),e=>O(e,n.row,n.column))},(e,t)=>xr(t.element).bind(n=>is(e,n).map(e=>({...e,generators:t.generators,clipboard:t.clipboard}))),ls,o,$),Lc=f((e,t,n)=>{const o=g(e).rows,i=t.cells[0].column,a=o[t.cells[0].row],r=fn(t.clipboard,t.generators,a),c=fa(i,e,r,t.generators,n);return O(c,t.cells[0].row,t.cells[0].column)},rr(!0),o,o,$),Dc=f((e,t,n)=>{const o=g(e).rows,i=t.cells[t.cells.length-1].column+t.cells[t.cells.length-1].colspan,a=o[t.cells[0].row],r=fn(t.clipboard,t.generators,a),c=fa(i,e,r,t.generators,n);return O(c,t.cells[0].row,t.cells[0].column)},rr(!1),o,o,$),zc=f((e,t,n)=>{const i=g(e).rows,o=t.cells[0].row,a=i[o],r=fn(t.clipboard,t.generators,a),c=pa(o,e,r,t.generators,n);return O(c,t.cells[0].row,t.cells[0].column)},ns,o,o,$),Tc=f((e,t,n)=>{const o=g(e).rows,i=t.cells[t.cells.length-1].row+t.cells[t.cells.length-1].rowspan,a=o[t.cells[0].row],r=fn(t.clipboard,t.generators,a),c=pa(i,e,r,t.generators,n);return O(c,t.cells[0].row,t.cells[0].column)},ns,o,o,$),Fc=(e,t)=>{const n=_(e);return ne(n,t).bind(e=>{const t=e[e.length-1],o=e[0].column,i=t.column+t.colspan,a=ko(s(n.all,e=>p(e.cells,e=>e.column>=o&&e.column<i)));return gs(a)}).getOr("")},Mc=(e,t)=>{const n=_(e);return ne(n,t).bind(gs).getOr("")},Sc=(t,n)=>{const o=_(t);return ne(o,n).bind(t=>{const n=t[t.length-1],i=t[0].row,a=n.row+n.rowspan;return(t=>{const n=s(t,e=>Ai(e).type),o=h(n,"header"),i=h(n,"footer");if(o||i){const t=h(n,"body");return!o||t||i?o||t||!i?e.none():e.some("footer"):e.some("header")}return e.some("body")})(o.all.slice(i,a))}).getOr("")},zr=(e,t)=>e.dispatch("NewRow",{node:t}),so=(e,t)=>e.dispatch("NewCell",{node:t}),le=(e,t,n)=>{e.dispatch("TableModified",{...n,table:t})},un={structure:!1,style:!0},m={structure:!0,style:!1},Oc={structure:!0,style:!0},Ee=e=>t=>t.options.get(e),Ir="100%",Br=e=>{var n;const s=e.dom,o=null!==(n=s.getParent(e.selection.getStart(),s.isBlock))&&void 0!==n?n:e.getBody();return Mn(t.fromDom(o))+"px"},Vr=t=>e.from(t.options.get("table_clone_elements")),$r=Ee("table_header_type"),_n=Ee("table_column_resizing"),Ur=e=>"preservetable"===_n(e),Kr=e=>"resizetable"===_n(e),Tn=Ee("table_sizing_mode"),an=e=>"relative"===Tn(e),ke=e=>"fixed"===Tn(e),et=e=>"responsive"===Tn(e),_c=Ee("table_resize_bars"),Zr=Ee("table_style_by_css"),yc=e=>{const t=e.options,n=t.get("table_default_attributes");return t.isSet("table_default_attributes")?n:((e,t)=>et(e)||Zr(e)?t:ke(e)?{...t,width:Br(e)}:{...t,width:Ir})(e,n)},jc=Ee("table_use_colgroups"),tc=(e,t)=>an(e)?au(t):ke(e)?ru(t):Ct(t),bc=(n,s,r)=>{const d=e=>"table"===c(yt(e)),h=Vr(n),u=Kr(n)?o:Xl,f=t=>{switch($r(n)){case"section":return Il();case"sectionCells":return mc();case"cells":return Qc();default:return((t,n)=>{var s;switch((s=_(t),Z(s.all,t=>{const n=Ai(t);return"header"===n.type?e.from(n.subType):e.none()})).getOr(n)){case"section":return Ti();case"sectionCells":return zi();case"cells":return Di()}})(t,"section")}},l=(o,a,c,l)=>(d,u,m=!1)=>{he(d);const p=t.fromDom(n.getDoc()),g=Ks(c,p,h),b={sizing:tc(n,d),resize:Kr(n)?wi():ys(),section:f(d)};return a(d)?o(d,u,g,b).bind(t=>{s.refresh(d.dom),i(t.newRows,e=>{zr(n,e.dom)}),i(t.newCells,e=>{so(n,e.dom)});const o=((t,s)=>s.cursor.fold(()=>{const e=Me(t);return gt(e).filter(J).map(e=>{r.clearSelectedCells(t.dom);const s=n.dom.createRng();return s.selectNode(e.dom),n.selection.setRng(s),v(e,"data-mce-selected","1"),s})},s=>{const o=Zl(Ql,s),i=n.dom.createRng();return i.setStart(o.element.dom,o.offset),i.setEnd(o.element.dom,o.offset),n.selection.setRng(i),r.clearSelectedCells(t.dom),e.some(i)}))(d,t);return J(d)&&(he(d),m||le(n,d.dom,l)),o.map(e=>({rng:e,effect:l}))}):e.none()},p=l(tl,e=>!d(n)||js(e).rows>1,o,m),g=l(nl,e=>!d(n)||js(e).columns>1,o,m);return{deleteRow:p,deleteColumn:g,insertRowsBefore:l(al,a,o,m),insertRowsAfter:l(il,a,o,m),insertColumnsBefore:l(ol,a,u,m),insertColumnsAfter:l(sl,a,u,m),mergeCells:l(Bc,a,o,m),unmergeCells:l(Hc,a,o,m),pasteColsBefore:l(Lc,a,o,m),pasteColsAfter:l(Dc,a,o,m),pasteRowsBefore:l(zc,a,o,m),pasteRowsAfter:l(Tc,a,o,m),pasteCells:l(Rc,a,o,Oc),makeCellsHeader:l($c,a,o,m),unmakeCellsHeader:l(Vc,a,o,m),makeColumnsHeader:l(el,a,o,m),unmakeColumnsHeader:l(Jc,a,o,m),makeRowsHeader:l(Zc,a,o,m),makeRowsBody:l(fc,a,o,m),makeRowsFooter:l(qc,a,o,m),getTableRowType:Sc,getTableCellType:Mc,getTableColType:Fc}},sc=(e,t,n)=>{const s=Y(e,t,1);1===n||s<=1?u(e,t):v(e,t,Math.min(n,s))},oc=(e,t)=>n=>{const s=n.column+n.colspan-1,o=n.column;return s>=e&&o<t},Ie=je([{invalid:["raw"]},{pixels:["value"]},{percent:["value"]}]),ac=(e,t,n)=>{const s=n.substring(0,n.length-e.length),o=parseFloat(s);return s===o.toString()?t(o):Ie.invalid(n)},me={...Ie,from:e=>bt(e,"%")?ac("%",Ie.percent,e):bt(e,"px")?ac("px",Ie.pixels,e):Ie.invalid(e)},cc=(e,t,o)=>{const i=me.from(o),a=R(e,e=>"0px"===e)?((e,t)=>{const s=e.fold(()=>n(""),e=>n(e/t+"px"),()=>n(100/t+"%"));return H(t,s)})(i,e.length):((e,t,n)=>e.fold(()=>t,e=>((e,t,n)=>{const o=n/t;return s(e,e=>me.from(e).fold(()=>e,e=>e*o+"px",e=>e/100*n+"px"))})(t,n,e),e=>((e,t)=>s(e,e=>me.from(e).fold(()=>e,e=>e/t*100+"%",e=>e+"%")))(t,n)))(i,e,t);return Pl(a)},Rn=(e,t)=>0===e.length?t:V(e,(e,t)=>me.from(t).fold(n(0),d,d)+e,0),pc=(e,t)=>me.from(e).fold(n(e),e=>e+t+"px",e=>e+t+"%"),Pl=e=>{if(0===e.length)return e;const n=V(e,(e,t)=>{const n=me.from(t).fold(()=>({value:t,remainder:0}),e=>((e)=>{const n=Math.floor(e);return{value:n+"px",remainder:e-n}})(e),e=>({value:e+"%",remainder:0}));return{output:[n.value].concat(e.output),remainder:e.remainder+n.remainder}},{output:[],remainder:0}),t=n.output;return t.slice(0,t.length-1).concat([pc(t[t.length-1],Math.round(n.remainder))])},Nc=me.from,hc=e=>Nc(e).fold(n("px"),n("px"),n("%")),uc=(e,t,n)=>{const s=_(e),a=s.all,o=Qn(s),r=Wt(s);t.each(t=>{const n=hc(t),c=ee(e),l=((e,t)=>Xs(e,t,$d,ho))(s,e),a=cc(l,c,t);qe(s)?((e,t,n)=>{i(t,(t,s)=>{const o=Rn([e[s]],lt());b(t.element,"width",o+n)})})(a,r,n):((e,t,n)=>{i(t,t=>{const s=e.slice(t.column,t.colspan+t.column),o=Rn(s,lt());b(t.element,"width",o+n)})})(a,o,n),b(e,"width",t)}),n.each(t=>{const n=hc(t),r=pn(e),c=((e,t,n)=>co(e,t,n,Wd,ho))(s,e,Cs);((e,t,n,s)=>{i(n,t=>{const n=e.slice(t.row,t.rowspan+t.row),o=Rn(n,Os());b(t.element,"height",o+s)}),i(t,(t,n)=>{b(t.element,"height",e[n])})})(cc(c,r,t),a,o,n),b(e,"height",t)})},dc=e=>Ae(e).exists(e=>ri.test(e)),lc=e=>Ae(e).exists(e=>cd.test(e)),rc=e=>Ae(e).isNone(),Qt=e=>{u(e,"width")},nt=t=>{const n=Ao(t);uc(t,e.some(n),e.none()),Qt(t)},Gn=t=>{const n=(e=>ee(e)+"px")(t);uc(t,e.some(n),e.none()),Qt(t)},Qr=e=>{ie(e,"width");const t=vs(e),n=t.length>0?t:Me(e);i(n,e=>{ie(e,"width"),Qt(e)}),Qt(e)},wc={styles:{"border-collapse":"collapse",width:"100%"},attributes:{border:"1"},colGroups:!1},Pr=(e,n,s,o)=>H(e,e=>((e,n,s,o)=>{const i=t.fromTag("tr");for(let a=0;a<e;a++){const r=t.fromTag(o<n||a<s?"th":"td");a<s&&v(r,"scope","row"),o<n&&v(r,"scope","col"),l(r,t.fromTag("br")),l(i,r)}return i})(n,s,o,e)),xc=(e,t)=>{e.selection.select(t.dom,!0),e.selection.collapse(!0)},Cc=(e,n,s,o,a)=>{const r=(e=>{const t=e.options,n=t.get("table_default_styles");return t.isSet("table_default_styles")?n:((e,t)=>et(e)||!Zr(e)?t:ke(e)?{...t,width:Br(e)}:{...t,width:Ir})(e,n)})(e),c={styles:r,attributes:yc(e),colGroups:jc(e)};return e.undoManager.ignore(()=>{const i=((e,n,s,o,i,a=wc)=>{const r=t.fromTag("table"),c="cells"!==i;ut(r,a.styles),Ve(r,a.attributes),a.colGroups&&l(r,(e=>{const n=t.fromTag("colgroup");return H(e,()=>l(n,t.fromTag("col"))),n})(n));const d=Math.min(e,s);if(c&&s>0){const e=t.fromTag("thead");l(r,e);const a=Pr(s,n,"sectionCells"===i?d:0,o);X(e,a)}const u=t.fromTag("tbody");l(r,u);const h=Pr(c?e-d:e,n,c?0:s,o);return X(u,h),r})(s,n,a,o,$r(e),c);v(i,"data-mce-id","__mce");const r=(e=>{const n=t.fromTag("div"),s=t.fromDom(e.dom.cloneNode(!0));return l(n,s),(e=>e.dom.innerHTML)(n)})(i);e.insertContent(r),e.addVisual()}),dt(yt(e),'table[data-mce-id="__mce"]').map(t=>(ke(e)?Gn(t):et(e)?Qr(t):(an(e)||(e=>Ke(e)&&-1!==e.indexOf("%"))(r.width))&&nt(t),he(t),u(t,"data-mce-id"),((e,t)=>{i(G(t,"tr"),t=>{zr(e,t.dom),i(G(t,"th,td"),t=>{so(e,t.dom)})})})(e,t),((e,t)=>{dt(t,"td,th").each(x(xc,e))})(e,t),t.dom)).getOrNull()};at=tinymce.util.Tools.resolve("tinymce.FakeClipboard");const Rr="x-tinymce/dom-table-",Zn=Rr+"rows",rs=Rr+"columns",Fr=e=>{const t=at.FakeClipboardItem(e);at.write([t])},hs=t=>{var n;const s=null!==(n=at.read())&&void 0!==n?n:[];return Z(s,n=>e.from(n.getType(t)))},Sr=e=>{hs(e).isSome()&&at.clear()},Ar=e=>{e.fold(Hl,e=>Fr({[Zn]:e}))},kr=()=>hs(Zn),Hl=()=>Sr(Zn),Er=e=>{e.fold(Pc,e=>Fr({[rs]:e}))},Cr=()=>hs(rs),Pc=()=>Sr(rs),bs=e=>rd(Ot(e),Pe(e)),Ic=(n,a)=>{const d=Pe(n),f=e=>S(e,d),c=e=>(e=>Ms(Ot(e),Pe(e)))(n).bind(t=>f(t).map(n=>e(n,t))),v=e=>{n.focus()},r=(e,t=!1)=>c((s,o)=>{const i=Ft(U(n),s,o);e(s,i,t).each(v)}),b=()=>c((a,r)=>((e,t,n)=>{const o=_(e);return ne(o,t).bind(e=>{const s=Ue(o,n,!1),i=g(s).rows.slice(e[0].row,e[e.length-1].row+e[e.length-1].rowspan),a=y(i,e=>{const t=p(e.cells,e=>!e.isLocked);return t.length>0?[{...e,cells:t}]:[]}),t=$t(a);return gn(t.length>0,t)}).map(e=>s(e,e=>{const t=Na(e.element);return i(e.cells,e=>{const n=Oe(e.element);We(n,"colspan",e.colspan,1),We(n,"rowspan",e.rowspan,1),l(t,n)}),t}))})(a,Ft(U(n),a,r),Ks(o,t.fromDom(n.getDoc()),e.none()))),j=()=>c((e,o)=>((e,n)=>{const o=_(e);return te(o,n).map(e=>{const n=e[e.length-1],i=e[0].column,a=n.column+n.colspan,r=((e,n,o)=>{if(qe(e)){const a=p(Wt(e),oc(n,o)),r=s(a,e=>{const t=Oe(e.element);return sc(t,"span",o-n),t}),i=t.fromTag("colgroup");return X(i,r),[i]}return[]})(o,i,a),c=((e,n,o)=>s(e.all,e=>{const a=p(e.cells,oc(n,o)),r=s(a,e=>{const t=Oe(e.element);return sc(t,"colspan",o-n),t}),i=t.fromTag("tr");return X(i,r),i}))(o,i,a);return[...r,...c]})})(e,Ft(U(n),e,o))),u=(e,o)=>o().each(o=>{const i=s(o,e=>Oe(e));c((s)=>{const a=Eo(t.fromDom(n.getDoc())),r=((e,t,n,s)=>({selection:ei(e),clipboard:n,generators:s}))(U(n),0,i,a);e(s,r).each(v)})}),h=t=>(n,s)=>((t,n)=>Is(t,n)?e.from(t.type):e.none())(s,"type").each(e=>{r(t(e),s.no_events)});M({mceTableSplitCells:()=>r(a.unmergeCells),mceTableMergeCells:()=>r(a.mergeCells),mceTableInsertRowBefore:()=>r(a.insertRowsBefore),mceTableInsertRowAfter:()=>r(a.insertRowsAfter),mceTableInsertColBefore:()=>r(a.insertColumnsBefore),mceTableInsertColAfter:()=>r(a.insertColumnsAfter),mceTableDeleteCol:()=>r(a.deleteColumn),mceTableDeleteRow:()=>r(a.deleteRow),mceTableCutCol:()=>j().each(e=>{Er(e),r(a.deleteColumn)}),mceTableCutRow:()=>b().each(e=>{Ar(e),r(a.deleteRow)}),mceTableCopyCol:()=>j().each(e=>Er(e)),mceTableCopyRow:()=>b().each(e=>Ar(e)),mceTablePasteColBefore:()=>u(a.pasteColsBefore,Cr),mceTablePasteColAfter:()=>u(a.pasteColsAfter,Cr),mceTablePasteRowBefore:()=>u(a.pasteRowsBefore,kr),mceTablePasteRowAfter:()=>u(a.pasteRowsAfter,kr),mceTableDelete:()=>bs(n).each(e=>{S(e,d).filter(xn(d)).each(e=>{const s=t.fromText("");if(ht(e,s),E(e),n.dom.isEmpty(n.getBody()))n.setContent(""),n.selection.setCursorLocation();else{const e=n.dom.createRng();e.setStart(s.dom,0),e.setEnd(s.dom,0),n.selection.setRng(e),n.nodeChanged()}})}),mceTableCellToggleClass:(e,t)=>{c(e=>{const s=U(n),o=R(s,e=>n.formatter.match("tablecellclass",{value:t},e.dom)),a=o?n.formatter.remove:n.formatter.apply;i(s,e=>a("tablecellclass",{value:t},e.dom)),le(n,e.dom,un)})},mceTableToggleClass:(e,t)=>{c(e=>{n.formatter.toggle("tableclass",{value:t},e.dom),le(n,e.dom,un)})},mceTableToggleCaption:()=>{bs(n).each(e=>{S(e,d).each(s=>{ks(s,"caption").fold(()=>{const e=t.fromTag("caption");l(e,t.fromText("Caption")),((e,t)=>{Ht(e,0).fold(()=>{l(e,t)},e=>{At(e,t)})})(s,e),n.selection.setCursorLocation(e.dom,0)},t=>{N("caption")(e)&&yi("td",s).each(e=>n.selection.setCursorLocation(e.dom,0)),E(t)}),le(n,s.dom,m)})})},mceTableSizingMode:(e,t)=>(e=>bs(n).each(t=>{et(n)||ke(n)||an(n)||S(t,d).each(t=>{"relative"!==e||dc(t)?"fixed"!==e||lc(t)?"responsive"!==e||rc(t)||Qr(t):Gn(t):nt(t),he(t),le(n,t.dom,m)})}))(t),mceTableCellType:h(e=>"th"===e?a.makeCellsHeader:a.unmakeCellsHeader),mceTableColType:h(e=>"th"===e?a.makeColumnsHeader:a.unmakeColumnsHeader),mceTableRowType:h(e=>{switch(e){case"header":return a.makeRowsHeader;case"footer":return a.makeRowsFooter;default:return a.makeRowsBody}})},(e,t)=>n.addCommand(t,e)),n.addCommand("mceInsertTable",(e,t)=>{((e,t,n,s={})=>{const o=e=>Nn(e)&&e>0;if(o(t)&&o(n)){const o=s.headerRows||0,i=s.headerColumns||0;return Cc(e,n,t,i,o)}console.error("Invalid values for mceInsertTable - rows and columns values are required to insert a table.")})(n,t.rows,t.columns,t.options)}),n.addCommand("mceTableApplyCellStyle",(e,t)=>{const a=e=>"tablecell"+e.toLowerCase().replace("-","");if(!Jd(t))return;const s=U(n);if(0===s.length)return;const r=((e,t)=>{const n={};return((e,t,n,s)=>{M(e,(e,o)=>{(t(e,o)?n:s)(e,o)})})(e,t,(e=>(t,n)=>{e[n]=t})(n),o),n})(t,(e,t)=>n.formatter.has(a(t))&&Ke(e));(e=>{for(const t in e)if(Bo.call(e,t))return!1;return!0})(r)||(M(r,(e,t)=>{const o=a(t);i(s,t=>{""===e?n.formatter.remove(o,{value:null},t.dom,!0):n.formatter.apply(o,{value:e},t.dom)})}),f(s[0]).each(e=>le(n,e.dom,un)))})},As=je([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),w={before:As.before,on:As.on,after:As.after,cata:(e,t,n,s)=>e.fold(t,n,s),getStart:e=>e.fold(d,d,d)},Te=(e,t)=>({selection:e,kill:t}),Wc=(e,t)=>{const n=e.document.createRange();return n.selectNode(t.dom),n},Uc=(e,t)=>{const n=e.document.createRange();return Kc(n,t),n},Kc=(e,t)=>e.selectNodeContents(t.dom),yr=(e,t,n)=>{const o=e.document.createRange();var s;return s=o,t.fold(e=>{s.setStartBefore(e.dom)},(e,t)=>{s.setStart(e.dom,t)},e=>{s.setStartAfter(e.dom)}),((e,t)=>{t.fold(t=>{e.setEndBefore(t.dom)},(t,n)=>{e.setEnd(t.dom,n)},t=>{e.setEndAfter(t.dom)})})(o,n),o},Us=(e,t,n,s,o)=>{const i=e.document.createRange();return i.setStart(t.dom,n),i.setEnd(s.dom,o),i},Gc=e=>({left:e.left,top:e.top,right:e.right,bottom:e.bottom,width:e.width,height:e.height}),mt=je([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),jr=(e,n,s)=>n(t.fromDom(s.startContainer),s.startOffset,t.fromDom(s.endContainer),s.endOffset),br=(s,o)=>{const i=((t,s)=>s.match({domRange:t=>({ltr:n(t),rtl:e.none}),relative:(n,s)=>({ltr:ot(()=>yr(t,n,s)),rtl:ot(()=>e.some(yr(t,s,n)))}),exact:(n,s,o,i)=>({ltr:ot(()=>Us(t,n,s,o,i)),rtl:ot(()=>e.some(Us(t,o,i,n,s)))})}))(s,o);return((e,n)=>{const s=n.ltr();return s.collapsed?n.rtl().filter(e=>!1===e.collapsed).map(e=>mt.rtl(t.fromDom(e.endContainer),e.endOffset,t.fromDom(e.startContainer),e.startOffset)).getOrThunk(()=>jr(0,mt.ltr,s)):jr(0,mt.ltr,s)})(0,i)},eo=(e,t)=>br(e,t).match({ltr:(t,n,s,o)=>{const i=e.document.createRange();return i.setStart(t.dom,n),i.setEnd(s.dom,o),i},rtl:(t,n,s,o)=>{const i=e.document.createRange();return i.setStart(s.dom,o),i.setEnd(t.dom,n),i}});mt.ltr,mt.rtl;const Be=(e,t,n,s)=>({start:e,soffset:t,finish:n,foffset:s}),pr=(e,t,n,s)=>({start:w.on(e,t),finish:w.on(n,s)}),fr=(e,n)=>{const s=eo(e,n);return Be(t.fromDom(s.startContainer),s.startOffset,t.fromDom(s.endContainer),s.endOffset)},jt=pr,hr=(t,n,s,o,i)=>r(s,o)?e.none():Mt(s,o,n).bind(n=>{const o=n.boxes.getOr([]);return o.length>1?(i(t,o,n.start,n.finish),e.some(Te(e.some(jt(s,0,s,oe(s))),!0))):e.none()}),qn=(e,t)=>({item:e,mode:t}),dr=(e,t,n,s=Le)=>e.property().parent(t).map(e=>qn(e,s)),Le=(e,t,n,s=Je)=>n.sibling(e,t).map(e=>qn(e,s)),Je=(e,t,n,s=Je)=>{const o=e.property().children(t);return n.first(o).map(e=>qn(e,s))},ll=[{current:dr,next:Le,fallback:e.none()},{current:Le,next:Je,fallback:e.some(dr)},{current:Je,next:Je,fallback:e.some(Le)}],Za=(e,t,n,s,o=ll)=>I(o,e=>e.current===n).bind(n=>n.current(e,t,s,n.next).orThunk(()=>n.fallback.bind(n=>Za(e,t,n,s)))),yn=(t,n,s,o,i,a)=>Za(t,n,o,i).bind(n=>a(n.item)?e.none():s(n.item)?e.some(n.item):yn(t,n.item,s,n.mode,i,a)),Qa=e=>t=>0===e.property().children(t).length,Ya=(t,n,s,o)=>yn(t,n,s,Le,{sibling:(e,t)=>e.query().prevSibling(t),first:t=>t.length>0?e.some(t[t.length-1]):e.none()},o),qa=(t,n,s,o)=>yn(t,n,s,Le,{sibling:(e,t)=>e.query().nextSibling(t),first:t=>t.length>0?e.some(t[0]):e.none()},o),on=kt(),Wa=(e,t)=>((e,t,n)=>Ya(e,t,Qa(e),n))(on,e,t),$a=(e,t)=>((e,t,n)=>qa(e,t,Qa(e),n))(on,e,t),en=je([{none:["message"]},{success:[]},{failedUp:["cell"]},{failedDown:["cell"]}]),jl=e=>j(e,"tr"),He={...en,verify:(e,t,n,s,o,i,a)=>j(s,"td,th",a).bind(n=>j(t,"td,th",a).map(t=>r(n,t)?r(s,n)&&oe(n)===o?i(t):en.none("in same cell"):Rs(jl,[n,t]).fold(()=>((e,t,n)=>{const s=e.getRect(t),o=e.getRect(n);return o.right>s.left&&o.left<s.right})(e,t,n)?en.success():i(t),e=>i(t)))).getOr(en.none("default")),cata:(e,t,n,s,o)=>e.fold(t,n,s,o)},Dn=N("br"),Vn=(t,n,s)=>n(t,s).bind(t=>ge(t)&&0===Js(t).trim().length?Vn(t,n,s):e.some(t)),Ol=(e,t,n,s)=>((e,t)=>Ht(e,t).filter(Dn).orThunk(()=>Ht(e,t-1).filter(Dn)))(t,n).bind(t=>s.traverse(t).fold(()=>Vn(t,s.gather,e).map(s.relative),e=>(e=>be(e).bind(t=>{const n=T(t);return((e,t)=>Ls(e,x(r,t)))(n,e).map(s=>((e,t,n,s)=>({parent:e,children:t,element:n,index:s}))(t,n,e,s))}))(e).map(e=>w.on(e.parent,e.index)))),_t=(e,t)=>({left:e.left,top:e.top+t,right:e.right,bottom:e.bottom+t}),ln=(e,t)=>({left:e.left,top:e.top-t,right:e.right,bottom:e.bottom-t}),ha=(e,t,n)=>({left:e.left+t,top:e.top+n,right:e.right+t,bottom:e.bottom+n}),Tt=e=>({left:e.left,top:e.top,right:e.right,bottom:e.bottom}),ua=(t,n)=>e.some(t.getRect(n)),da=(t,n,s)=>Q(n)?ua(t,n).map(Tt):ge(n)?((t,n,s)=>s>=0&&s<oe(n)?t.getRangedRect(n,s,n,s+1):s>0?t.getRangedRect(n,s-1,n,s):e.none())(t,n,s).map(Tt):e.none(),la=(t,n)=>Q(n)?ua(t,n).map(Tt):ge(n)?t.getRangedRect(n,0,n,oe(n)).map(Tt):e.none(),se=je([{none:[]},{retry:["caret"]}]),Ki=(e,t,n)=>{return(s=t,o=wn,Xn((e,t)=>t(e),rt,s,o,void 0)).fold(W,t=>la(e,t).exists(e=>((e,t)=>e.left<t.left||Math.abs(t.right-e.left)<1||e.left>t.right)(n,e)));var s,o},zl={point:e=>e.bottom,adjuster:(e,t,n,s,o)=>{const i=_t(o,5);return Math.abs(n.bottom-s.bottom)<1||n.top>o.bottom?se.retry(i):n.top===o.bottom?se.retry(_t(o,1)):Ki(e,t,o)?se.retry(ha(i,5,0)):se.none()},move:_t,gather:$a},ms=(t,n,s,o,i)=>0===i?e.some(o):((e,t,n)=>e.elementFromPoint(t,n).filter(e=>"table"===c(e)).isSome())(t,o.left,n.point(o))?((e,t,n,s,o)=>ms(e,t,n,t.move(s,5),o))(t,n,s,o,i-1):t.situsFromPoint(o.left,n.point(o)).bind(a=>a.start.fold(e.none,a=>la(t,a).bind(r=>n.adjuster(t,a,r,s,o).fold(e.none,e=>ms(t,n,s,e,i-1))).orThunk(()=>e.some(o)),e.none)),Wi=(t,n,s)=>{const i=t.move(s,5),o=ms(n,t,s,i,100).getOr(i);return((t,n,s)=>t.point(n)>s.getInnerHeight()?e.some(t.point(n)-s.getInnerHeight()):t.point(n)<0?e.some(-t.point(n)):e.none())(t,o,n).fold(()=>n.situsFromPoint(o.left,t.point(o)),e=>(n.scrollBy(0,e),n.situsFromPoint(o.left,t.point(o)-e)))},zn={tryUp:x(Wi,{point:e=>e.top,adjuster:(e,t,n,s,o)=>{const i=ln(o,5);return Math.abs(n.top-s.top)<1||n.bottom<o.top?se.retry(i):n.bottom===o.top?se.retry(ln(o,1)):Ki(e,t,o)?se.retry(ha(i,5,0)):se.none()},move:ln,gather:Wa}),tryDown:x(Wi,zl),getJumpSize:n(5)},Kl=(t,n,s)=>t.getSelection().bind(o=>((e,t,n,s)=>{const o=Dn(t)?((e,t,n)=>n.traverse(t).orThunk(()=>Vn(t,n.gather,e)).map(n.relative))(e,t,s):Ol(e,t,n,s);return o.map(e=>({start:e,finish:e}))})(n,o.finish,o.foffset,s).fold(()=>e.some($e(o.finish,o.foffset)),i=>{const a=t.fromSitus(i);return r=He.verify(t,o.finish,o.foffset,a.finish,a.foffset,s.failure,n),He.cata(r,t=>e.none(),()=>e.none(),t=>e.some($e(t,0)),t=>e.some($e(t,oe(t))));var r})),jn=(t,n,s,o,i,a)=>0===a?e.none():Bl(t,n,s,o,i).bind(c=>{const l=t.fromSitus(c),d=He.verify(t,s,o,l.finish,l.foffset,i.failure,n);return He.cata(d,()=>e.none(),()=>e.some(c),e=>r(s,e)&&0===o?Li(t,s,o,ln,i):jn(t,n,e,0,i,a-1),e=>r(s,e)&&o===oe(e)?Li(t,s,o,_t,i):jn(t,n,e,oe(e),i,a-1))}),Li=(e,t,n,s,o)=>da(e,t,n).bind(t=>Ni(e,o,s(t,zn.getJumpSize()))),Ni=(t,n,s)=>{const o=Ra().browser;return o.isChromium()||o.isSafari()||o.isFirefox()?n.retry(t,s):e.none()},Bl=(e,t,n,s,o)=>da(e,n,s).bind(t=>Ni(e,o,t)),Fi=(t,n,s,o,i)=>j(o,"td,th",n).bind(o=>j(o,"table",n).bind(a=>((e,t)=>rt(e,e=>be(e).exists(e=>r(e,t)),void 0).isSome())(i,a)?((e,t,n)=>Kl(e,t,n).bind(s=>jn(e,t,s.element,s.offset,n,20).map(e.fromSitus)))(t,n,s).bind(e=>j(e.finish,"td,th",n).map(t=>({start:o,finish:t,range:e}))):e.none())),ki=(t,n,s,o,i,a)=>a(o,n).orThunk(()=>Fi(t,n,s,o,i).map(t=>{const n=t.range;return Te(e.some(jt(n.start,n.soffset,n.finish,n.foffset)),!0)})),Wl=(t,n)=>j(t,"tr",n).bind(t=>j(t,"table",n).bind(s=>{const o=G(s,"tr");return r(t,o[0])?((e,t,n)=>Ya(on,e,e=>go(e).isSome(),n))(s,0,n).map(t=>{const n=oe(t);return Te(e.some(jt(t,n,t,n)),!0)}):e.none()})),Ul=(t,n)=>j(t,"tr",n).bind(t=>j(t,"table",n).bind(s=>{const o=G(s,"tr");return r(t,o[o.length-1])?((e,t,n)=>qa(on,e,e=>po(e).isSome(),n))(s,0,n).map(t=>Te(e.some(jt(t,0,t,0)),!0)):e.none()})),_i=(e,t,n,s,o,i,a)=>Fi(e,n,s,o,i).bind(e=>hr(t,n,e.start,e.finish,a)),Cn=e=>{let t=e;return{get:()=>t,set:e=>{t=e}}},pt=()=>{const t=(t=>{const n=Cn(e.none()),s=()=>n.get().each(t);return{clear:()=>{s(),n.set(e.none())},isSet:()=>n.get().isSome(),get:()=>n.get(),set:t=>{s(),n.set(e.some(t))}}})(o);return{...t,on:e=>t.get().each(e)}},vi=(e,t)=>j(e,"td,th",t),gi={traverse:tn,gather:$a,relative:w.before,retry:zn.tryDown,failure:He.failedDown},pi={traverse:Pi,gather:Wa,relative:w.before,retry:zn.tryUp,failure:He.failedUp},Ce=e=>t=>t===e,Ts=Ce(38),wt=Ce(40),Et=e=>e>=37&&e<=40,nd={isBackward:Ce(37),isForward:Ce(39)},sd={isBackward:Ce(39),isForward:Ce(37)},nn=je([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),Se={domRange:nn.domRange,relative:nn.relative,exact:nn.exact,exactFromRange:e=>nn.exact(e.start,e.soffset,e.finish,e.foffset),getWin:e=>{const n=(e=>e.match({domRange:e=>t.fromDom(e.startContainer),relative:(e)=>w.getStart(e),exact:(e)=>e}))(e);return t.fromDom(dn(n).dom.defaultView)},range:Be},ad=document.caretPositionFromPoint?(t,n,s)=>{var o,i;return e.from(null===(o=(i=t.dom).caretPositionFromPoint)||void 0===o?void 0:o.call(i,n,s)).bind(n=>{if(null===n.offsetNode)return e.none();const s=t.dom.createRange();return s.setStart(n.offsetNode,n.offset),s.collapse(),e.some(s)})}:document.caretRangeFromPoint?(t,n,s)=>{var o,i;return e.from(null===(o=(i=t.dom).caretRangeFromPoint)||void 0===o?void 0:o.call(i,n,s))}:e.none,Xt=(e,t)=>{const n=c(e);return"input"===n?w.after(e):h(["br","img"],n)?0===t?w.before(e):w.after(e):w.on(e,t)},sn=t=>e.from(t.getSelection()),si=(e,t)=>{sn(e).each(e=>{e.removeAllRanges(),e.addRange(t)})},ss=(e,t,n,s,o)=>{const i=Us(e,t,n,s,o);si(e,i)},ni=(e,t)=>br(e,t).match({ltr:(t,n,s,o)=>{ss(e,t,n,s,o)},rtl:(t,n,s,o)=>{sn(e).each(i=>{if(i.setBaseAndExtent)i.setBaseAndExtent(t.dom,n,s.dom,o);else if(i.extend)try{((e,t,n,s,o,i)=>{t.collapse(n.dom,s),t.extend(o.dom,i)})(0,i,t,n,s,o)}catch{ss(e,s,o,t,n)}else ss(e,s,o,t,n)})}}),ti=(e,t,n,s,o)=>{const i=((e,t,n,s)=>{const o=Xt(e,t),i=Xt(n,s);return Se.relative(o,i)})(t,n,s,o);ni(e,i)},Jo=(e,t,n)=>{const s=((e,t)=>{const n=e.fold(w.before,Xt,w.after),s=t.fold(w.before,Xt,w.after);return Se.relative(n,s)})(t,n);ni(e,s)},Qo=n=>{if(n.rangeCount>0){const s=n.getRangeAt(0),o=n.getRangeAt(n.rangeCount-1);return e.some(Be(t.fromDom(s.startContainer),s.startOffset,t.fromDom(o.endContainer),o.endOffset))}return e.none()},pd=n=>{if(null===n.anchorNode||null===n.focusNode)return Qo(n);{const s=t.fromDom(n.anchorNode),o=t.fromDom(n.focusNode);return((e,t,n,s)=>{const o=((e,t,n,s)=>{const o=hn(e).dom.createRange();return o.setStart(e.dom,t),o.setEnd(n.dom,s),o})(e,t,n,s),i=r(e,n)&&t===s;return o.collapsed&&!i})(s,n.anchorOffset,o,n.focusOffset)?e.some(Be(s,n.anchorOffset,o,n.focusOffset)):Qo(n)}},Ko=(e,t,n=!0)=>{const s=(n?Uc:Wc)(e,t);si(e,s)},Wo=e=>(e=>sn(e).filter(e=>e.rangeCount>0).bind(pd))(e).map(e=>Se.exact(e.start,e.soffset,e.finish,e.foffset)),ds=n=>({elementFromPoint:(e,s)=>t.fromPoint(t.fromDom(n.document),e,s),getRect:e=>e.dom.getBoundingClientRect(),getRangedRect:(t,s,o,i)=>{const a=Se.exact(t,s,o,i);return((t,n)=>(t=>{const s=t.getClientRects(),n=s.length>0?s[0]:t.getBoundingClientRect();return n.width>0||n.height>0?e.some(n).map(Gc):e.none()})(eo(t,n)))(n,a)},getSelection:()=>Wo(n).map(e=>fr(n,e)),fromSitus:e=>{const t=Se.relative(e.start,e.finish);return fr(n,t)},situsFromPoint:(e,s)=>((e,n,s)=>((e,n,s)=>{const o=t.fromDom(e.document);return ad(o,n,s).map(e=>Be(t.fromDom(e.startContainer),e.startOffset,t.fromDom(e.endContainer),e.endOffset))})(e,n,s))(n,e,s).map(e=>pr(e.start,e.soffset,e.finish,e.foffset)),clearSelection:()=>{(e=>{sn(e).each(e=>e.removeAllRanges())})(n)},collapseSelection:(e=!1)=>{Wo(n).each(t=>t.fold(t=>t.collapse(e),(t,s)=>{const o=e?t:s;Jo(n,o,o)},(t,s,o,i)=>{const a=e?t:o,r=e?s:i;ti(n,a,r,a,r)}))},setSelection:e=>{ti(n,e.start,e.soffset,e.finish,e.foffset)},setRelativeSelection:(e,t)=>{Jo(n,e,t)},selectNode:e=>{Ko(n,e,!1)},selectContents:e=>{Ko(n,e)},getInnerHeight:()=>n.innerHeight,getScrollY:()=>(e=>{const t=void 0!==e?e.dom:document,n=t.body.scrollLeft||t.documentElement.scrollLeft,s=t.body.scrollTop||t.documentElement.scrollTop;return q(n,s)})(t.fromDom(n.document)).top,scrollBy:(e,s)=>{((e,t,n)=>{const s=(void 0!==n?n.dom:document).defaultView;s&&s.scrollBy(e,t)})(e,s,t.fromDom(n.document))}}),Re=(e,t)=>({rows:e,cols:t}),Io=e=>void 0!==e.dom.classList,_d=(e,t)=>((e,t,n)=>{const s=((e,t)=>{const n=Ne(e,t);return void 0===n||""===n?[]:n.split(" ")})(e,t).concat([n]);return v(e,t,s.join(" ")),!0})(e,"class",t),De=(e,t)=>{Io(e)?e.dom.classList.add(t):_d(e,t)},Vs=(e,t)=>Io(e)&&e.dom.classList.contains(t),xd=()=>({tag:"none"}),Cd=e=>({tag:"multiple",elements:e}),Ed=e=>({tag:"single",element:e}),zo=n=>{const r=t.fromDom((n=>{if(pl()&&Xe(n.target)){const e=t.fromDom(n.target);if(Q(e)&&Xe(e.dom.shadowRoot)&&n.composed&&n.composedPath){const e=n.composedPath();if(e)return gt(e)}}return e.from(n.target)})(n).getOr(n.target)),s=()=>n.stopPropagation(),o=()=>n.preventDefault(),c=(i=o,a=s,(...e)=>i(a.apply(null,e)));var i,a;return((e,t,n,s,o,i,a)=>({target:e,x:t,y:n,stop:s,prevent:o,kill:i,raw:a}))(r,n.clientX,n.clientY,s,o,c,n)},Ad=(e,t,n,s)=>{e.dom.removeEventListener(t,n,s)},Sd=a,Fe=(e,t,n)=>((e,t,n,s)=>((e,t,n,s,o)=>{const i=((e,t)=>n=>{e(n)&&t(zo(n))})(n,s);return e.dom.addEventListener(t,i,o),{unbind:x(Ad,e,t,i,o)}})(e,t,n,s,!1))(e,t,Sd,n),ct=zo,Pn=e=>!Vs(t.fromDom(e.target),"ephox-snooker-resizer-bar"),zd=(a,c)=>{const h=(d=fe.selectedSelector,{get:()=>Zo(t.fromDom(a.getBody()),d).fold(()=>Ms(Ot(a),Pe(a)).fold(xd,Ed),Cd)}),l=((e,t,n)=>{const a=t=>{u(t,e.selected),u(t,e.firstSelected),u(t,e.lastSelected)},r=t=>{v(t,e.selected,"1")},s=e=>{o(e),n()},o=t=>{const n=G(t,`${e.selectedSelector},${e.firstSelectedSelector},${e.lastSelectedSelector}`);i(n,a)};return{clearBeforeUpdate:o,clear:s,selectRange:(n,o,a,c)=>{s(n),i(o,r),v(a,e.firstSelected,"1"),v(c,e.lastSelected,"1"),t(o,a,c)},selectedSelector:e.selectedSelector,firstSelectedSelector:e.firstSelectedSelector,lastSelectedSelector:e.lastSelectedSelector}})(fe,(e,n,i)=>{S(n).each(r=>{const c=Vr(a),l=Ks(o,t.fromDom(a.getDoc()),c),d=((e,t,n)=>{const o=_(e);return ne(o,t).map(e=>{const i=Ue(o,n,!1),{rows:t}=g(i),a=((e,t)=>{const n=e.slice(0,t[t.length-1].row+1),o=$t(n);return y(o,e=>{const n=e.cells.slice(0,t[t.length-1].column+1);return s(n,e=>e.element)})})(t,e),r=((e,t)=>{const n=e.slice(t[0].row+t[0].rowspan-1,e.length),o=$t(n);return y(o,e=>{const n=e.cells.slice(t[0].column+t[0].colspan-1,e.cells.length);return s(n,e=>e.element)})})(t,e);return{upOrLeftCells:a,downOrRightCells:r}})})(r,{selection:U(a)},l);((e,t,n,s,o)=>{e.dispatch("TableSelectionChange",{cells:t,start:n,finish:s,otherCells:o})})(a,e,n,i,d)})},()=>(e=>{e.dispatch("TableSelectionClear")})(a));var d;return a.on("init",n=>{const i=a.getWin(),s=yt(a),u=Pe(a),d=((e,t,n,s)=>{const o=((e,t,n,s)=>{const o=pt(),i=o.clear,a=i=>{o.on(o=>{s.clearBeforeUpdate(t),vi(i.target,n).each(a=>{Mt(o,a,n).each(n=>{const o=n.boxes.getOr([]);if(1===o.length){const n=o[0],a="false"===Bi(n),c=$s(Hi(i.target),n,r);a&&c&&(s.selectRange(t,o,n,n),e.selectContents(n))}else o.length>1&&(s.selectRange(t,o,n.start,n.finish),e.selectContents(a))})})})};return{clearstate:i,mousedown:e=>{s.clear(t),vi(e.target,n).each(o.set)},mouseover:e=>{a(e)},mouseup:e=>{a(e),i()}}})(ds(e),t,n,s);return{clearstate:o.clearstate,mousedown:o.mousedown,mouseover:o.mouseover,mouseup:o.mouseup}})(i,s,u,l),h=((t,n,s,o)=>{const i=ds(t),a=()=>(o.clear(n),e.none());return{keydown:(t,r,c,l,d,u)=>{const f=t.raw,h=f.which,m=!0===f.shiftKey,p=zs(n,o.selectedSelector).fold(()=>(Et(h)&&!m&&o.clearBeforeUpdate(n),wt(h)&&m?x(_i,i,n,s,gi,l,r,o.selectRange):Ts(h)&&m?x(_i,i,n,s,pi,l,r,o.selectRange):wt(h)?x(ki,i,s,gi,l,r,Ul):Ts(h)?x(ki,i,s,pi,l,r,Wl):e.none),t=>{const s=s=>()=>{const a=Z(s,e=>((e,t,n,s,o)=>fd(s,e,t,o.firstSelectedSelector,o.lastSelectedSelector).map(e=>(o.clearBeforeUpdate(n),o.selectRange(n,e.boxes,e.start,e.finish),e.boxes)))(e.rows,e.cols,n,t,o));return a.fold(()=>Xo(n,o.firstSelectedSelector,o.lastSelectedSelector).map(t=>{const s=wt(h)||u.isForward(h)?w.after:w.before;return i.setRelativeSelection(w.on(t.first,0),s(t.table)),o.clear(n),Te(e.none(),!0)}),t=>e.some(Te(e.none(),!0)))};return wt(h)&&m?s([Re(1,0)]):Ts(h)&&m?s([Re(-1,0)]):u.isBackward(h)&&m?s([Re(0,-1),Re(-1,0)]):u.isForward(h)&&m?s([Re(0,1),Re(1,0)]):Et(h)&&!m?a:e.none});return p()},keyup:(t,i,a,c,l)=>zs(n,o.selectedSelector).fold(()=>{const d=t.raw,u=d.which;return!0===d.shiftKey&&Et(u)?((t,n,s,o,i,a,c)=>r(s,i)&&o===a?e.none():j(s,"td,th",n).bind(e=>j(i,"td,th",n).bind(s=>hr(t,n,e,s,c))))(n,s,i,a,c,l,o.selectRange):e.none()},e.none)}})(i,s,u,l),m=((e,t,n,s)=>{const o=ds(e);return(e,i)=>{s.clearBeforeUpdate(t),Mt(e,i,n).each(e=>{const n=e.boxes.getOr([]);s.selectRange(t,n,e.start,e.finish),o.selectContents(i),o.collapseSelection()})}})(i,s,u,l);a.on("TableSelectorChange",e=>m(e.start,e.finish));const f=(e,t)=>{(e=>!0===e.raw.shiftKey)(e)&&(t.kill&&e.kill(),t.selection.each(e=>{const t=Se.relative(e.start,e.finish),n=eo(i,t);a.selection.setRng(n)}))},p=e=>0===e.button,g=(()=>{const e=Cn(t.fromDom(s)),n=Cn(0);return{touchEnd:s=>{const o=t.fromDom(s.target);if(N("td")(o)||N("th")(o)){const t=e.get(),i=n.get();r(t,o)&&s.timeStamp-i<300&&(s.preventDefault(),m(o,o))}e.set(o),n.set(s.timeStamp)}}})();a.on("dragstart",e=>{d.clearstate()}),a.on("mousedown",e=>{p(e)&&Pn(e)&&d.mousedown(ct(e))}),a.on("mouseover",e=>{var t;void 0!==(t=e).buttons&&0==(1&t.buttons)||!Pn(e)||d.mouseover(ct(e))}),a.on("mouseup",e=>{p(e)&&Pn(e)&&d.mouseup(ct(e))}),a.on("touchend",g.touchEnd),a.on("keyup",e=>{const n=ct(e);if(n.raw.shiftKey&&Et(n.raw.which)){const e=a.selection.getRng(),s=t.fromDom(e.startContainer),o=t.fromDom(e.endContainer);h.keyup(n,s,e.startOffset,o,e.endOffset).each(e=>{f(n,e)})}}),a.on("keydown",e=>{const s=ct(e);c.hide();const n=a.selection.getRng(),o=t.fromDom(n.startContainer),i=t.fromDom(n.endContainer),r=Xi(nd,sd)(t.fromDom(a.selection.getStart()));h.keydown(s,o,n.startOffset,i,n.endOffset,r).each(e=>{f(s,e)}),c.show()}),a.on("NodeChange",()=>{const e=a.selection,n=t.fromDom(e.getStart()),i=t.fromDom(e.getEnd());Rs(S,[n,i]).fold(()=>l.clear(s),o)})}),a.on("PreInit",()=>{a.serializer.addTempAttr(fe.firstSelected),a.serializer.addTempAttr(fe.lastSelected)}),{getSelectedCells:()=>((e,t)=>{switch(e.tag){case"none":return t();case"single":return(e=>[e.dom])(e.element);case"multiple":return(e=>s(e,e=>e.dom))(e.elements)}})(h.get(),n([])),clearSelectedCells:e=>l.clear(t.fromDom(e))}},D=e=>{let t=[];return{bind:e=>{if(void 0===e)throw new Error("Event bind error: undefined handler");t.push(e)},unbind:e=>{t=p(t,t=>t!==e)},trigger:(...n)=>{const s={};i(e,(e,t)=>{s[e]=n[t]}),i(t,e=>{e(s)})}}},ye=e=>({registry:$o(e,e=>({bind:e.bind,unbind:e.unbind})),trigger:$o(e,e=>e.trigger)}),Ze=e=>e.slice(0).sort(),Rd=(e,t)=>{const n=p(t,t=>!h(e,t));n.length>0&&(e=>{throw new Error("Unsupported keys for object: "+Ze(e).join(", "))})(n)},An=e=>((e,t)=>((e,t,n)=>{if(0===t.length)throw new Error("You must specify at least one required field.");return((e,t)=>{if(!Ut(t))throw new Error("The required fields must be an array. Was: "+t+".");i(t,t=>{if(!Ke(t))throw new Error("The value "+t+" in the "+e+" fields was not a string.")})})("required",t),(e=>{const t=Ze(e);I(t,(e,n)=>n<t.length-1&&e===t[n+1]).each(e=>{throw new Error("The field: "+e+" occurs more than once in the combined fields: ["+t.join(", ")+"].")})})(t),s=>{const o=it(s);R(t,e=>h(o,e))||((e,t)=>{throw new Error("All required keys ("+Ze(e).join(", ")+") were not specified. Specified keys were: "+Ze(t).join(", ")+".")})(t,o),e(t,o);const i=p(t,e=>!n.validate(s[e],e));return i.length>0&&((e,t)=>{throw new Error("All values need to be of type: "+t+". Keys ("+Ze(e).join(", ")+") were not.")})(i,n.label),s}})(e,t,{validate:ve,label:"function"}))(Rd,e),Hd=An(["compare","extract","mutate","sink"]),Id=An(["element","start","stop","destroy"]),Bd=An(["forceDrop","drop","move","delayDrop"]),Vd=()=>{const s=(()=>{const e=ye({move:D(["info"])});return{onEvent:o,reset:o,events:e.registry}})(),n=(()=>{let t=e.none();const n=ye({move:D(["info"])});return{onEvent:(s,o)=>{o.extract(s).each(s=>{const i=((n,s)=>{const o=t.map(e=>n.compare(e,s));return t=e.some(s),o})(o,s);i.each(e=>{n.trigger.move(e)})})},reset:()=>{t=e.none()},events:n.registry}})();let t=s;return{on:()=>{t.reset(),t=n},off:()=>{t.reset(),t=s},isOn:()=>t===n,onEvent:(e,n)=>{t.onEvent(e,n)},events:n.events}},yo=e=>{const t=e.replace(/\./g,"-");return{resolve:e=>t+"-"+e}},jo=yo("ephox-dragster").resolve;bo=Hd({compare:(e,t)=>q(t.left-e.left,t.top-e.top),extract:t=>e.some(q(t.x,t.y)),sink:(e,s)=>{const o=(e=>{const o={layerClass:jo("blocker"),...e},s=t.fromTag("div");return v(s,"role","presentation"),ut(s,{position:"fixed",left:"0px",top:"0px",width:"100%",height:"100%"}),De(s,jo("blocker")),De(s,o.layerClass),{element:n(s),destroy:()=>{E(s)}}})(s),i=Fe(o.element(),"mousedown",e.forceDrop),a=Fe(o.element(),"mouseup",e.drop),r=Fe(o.element(),"mousemove",e.move),c=Fe(o.element(),"mouseout",e.delayDrop);return Id({element:o.element,start:e=>{l(e,o.element())},stop:()=>{E(o.element())},destroy:()=>{o.destroy(),a.unbind(),r.unbind(),c.unbind(),i.unbind()}})},mutate:(e,t)=>{e.mutate(t.left,t.top)}});const Jt=yo("ephox-snooker").resolve,Kn=Jt("resizer-bar"),vo=Jt("resizer-rows"),mo=Jt("resizer-cols"),Yn=e=>{const t=G(e.parent(),"."+Kn);i(t,E)},uo=(e,t,n)=>{const s=e.origin();i(t,t=>{t.each(t=>{const o=n(s,t);De(o,Kn),l(e.parent(),o)})})},Zd=(e,n,s,o,i)=>{const a=Bt(s),r=n.isResizable,c=o.length>0?Cs.positions(o,s):[],d=c.length>0?((e,t)=>y(e.all,(e,n)=>t(e.element)?[n]:[]))(e,r):[];((e,n,s,o)=>{uo(e,n,(e,n)=>{const i=((e,n,s,o)=>{const a=t.fromTag("div");return ut(a,{position:"absolute",left:n+"px",top:s-3.5+"px",height:"7px",width:o+"px"}),Ve(a,{"data-row":e,role:"presentation"}),a})(n.row,s.left-e.left,n.y-e.top,o);return De(i,vo),i})})(n,p(c,(e,t)=>F(d,e=>t===e)),a,Sn(s));const l=i.length>0?Dt.positions(i,s):[],u=l.length>0?((e,t)=>{const n=[];return H(e.grid.columns,s=>{Ji(e,s).map(e=>e.element).forall(t)&&n.push(s)}),p(n,n=>{const s=ea(e,e=>e.column===n);return R(s,e=>t(e.element))})})(e,r):[];((e,n,s,o)=>{uo(e,n,(e,n)=>{const i=((e,n,s,o,i)=>{const a=t.fromTag("div");return ut(a,{position:"absolute",left:n-3.5+"px",top:s+"px",height:i+"px",width:"7px"}),Ve(a,{"data-column":e,role:"presentation"}),a})(n.col,n.x-e.left,s.top-e.top,0,o);return De(i,mo),i})})(n,p(l,(e,t)=>F(u,e=>t===e)),a,qi(s))},es=(e,t)=>{if(Yn(e),e.isResizable(t)){const n=_(t),s=Qi(n),o=ts(n);Zd(n,e,t,s,o)}},ao=(e,t)=>{const n=G(e.parent(),"."+Kn);i(n,t)},tu=e=>{ao(e,e=>{b(e,"display","none")})},nu=e=>{ao(e,e=>{b(e,"display","block")})},su=Jt("resizer-bar-dragging"),ou=t=>{const s=(()=>{const n=ye({drag:D(["xDelta","yDelta","target"])});let t=e.none();const s=(()=>{const e=ye({drag:D(["xDelta","yDelta"])});return{mutate:(t,n)=>{e.trigger.drag(t,n)},events:e.registry}})();return s.events.drag.bind(e=>{t.each(t=>{n.trigger.drag(e.xDelta,e.yDelta,t)})}),{assign:n=>{t=e.some(n)},get:()=>t,mutate:s.mutate,events:n.registry}})(),n=((e,t={})=>{var n;return((e,t,n)=>{let i=!1;const a=ye({start:D([]),stop:D([])}),s=Vd(),r=()=>{o.stop(),s.isOn()&&(s.off(),a.trigger.stop())},l=((e)=>{let n=null;const s=()=>{Xd(n)||(clearTimeout(n),n=null)};return{cancel:s,throttle:(...t)=>{s(),n=setTimeout(()=>{n=null,e.apply(null,t)},200)}}})(r);s.events.move.bind(n=>{t.mutate(e,n.info)});const c=e=>(...t)=>{i&&e.apply(null,t)},o=t.sink(Bd({forceDrop:r,drop:c(r),move:c(e=>{l.cancel(),s.onEvent(e,t)}),delayDrop:c(l.throttle)}),n);return{element:o.element,go:e=>{o.start(e),s.on(),a.trigger.start()},on:()=>{i=!0},off:()=>{i=!1},destroy:()=>{o.destroy()},events:a.registry}})(e,null!==(n=t.mode)&&void 0!==n?n:bo,t)})(s,{});let a=e.none();const o=(t,n)=>e.from(Ne(t,n));s.events.drag.bind(e=>{o(e.target,"data-row").each(t=>{const n=zt(e.target,"top");b(e.target,"top",n+e.yDelta+"px")}),o(e.target,"data-column").each(t=>{const n=zt(e.target,"left");b(e.target,"left",n+e.xDelta+"px")})});const c=(e,t)=>zt(e,t)-Y(e,"data-initial-"+t,0);n.events.stop.bind(()=>{s.get().each(e=>{a.each(n=>{o(e,"data-row").each(t=>{const s=c(e,"top");u(e,"data-initial-top"),i.trigger.adjustHeight(n,s,parseInt(t,10))}),o(e,"data-column").each(t=>{const s=c(e,"left");u(e,"data-initial-left"),i.trigger.adjustWidth(n,s,parseInt(t,10))}),es(t,n)})})});const l=(e,o)=>{i.trigger.startAdjust(),s.assign(e),v(e,"data-initial-"+o,zt(e,o)),De(e,su),b(e,"opacity","0.2"),n.go(t.parent())},d=Fe(t.parent(),"mousedown",e=>{var t=e.target;Vs(t,vo)&&l(e.target,"top"),(e=>Vs(e,mo))(e.target)&&l(e.target,"left")}),h=e=>r(e,t.view()),m=Fe(t.view(),"mouseover",n=>{var s;(s=n.target,j(s,"table",h).filter(Ii)).fold(()=>{J(n.target)&&Yn(t)},n=>{a=e.some(n),es(t,n)})}),i=ye({adjustHeight:D(["table","delta","row"]),adjustWidth:D(["table","delta","column"]),startAdjust:D([])});return{destroy:()=>{d.unbind(),m.unbind(),n.destroy(),Yn(t)},refresh:e=>{es(t,e)},on:n.on,off:n.off,hideBars:x(tu,t),showBars:x(nu,t),events:i.registry}},iu=(e,t,n)=>{const r=Cs,c=Dt,o=ou(e),a=ye({beforeResize:D(["table","type"]),afterResize:D(["table","type"]),startDrag:D([])});return o.events.adjustHeight.bind(e=>{const t=e.table;a.trigger.beforeResize(t,"row"),((e,t,n,o)=>{const a=_(e),c=((e,t,n)=>co(e,t,n,Mo,e=>e.getOrThunk(Os)))(a,e,o),r=s(c,(e,s)=>n===s?Math.max(t+e,Os()):e),l=Cl(a,r),d=((e,t)=>s(e.all,(e,n)=>({element:e.element,height:t[n]})))(a,r);i(d,e=>{St(e.element,e.height)}),i(l,e=>{St(e.element,e.height)});const u=V(r,(e,t)=>e+t,0);St(e,u)})(t,r.delta(e.delta,t),e.row,r),a.trigger.afterResize(t,"row")}),o.events.startAdjust.bind(e=>{a.trigger.startDrag()}),o.events.adjustWidth.bind(e=>{const s=e.table;a.trigger.beforeResize(s,"col");const o=c.delta(e.delta,s),i=n(s);Ma(s,o,e.column,t,i),a.trigger.afterResize(s,"col")}),{on:o.on,off:o.off,refreshBars:o.refresh,hideBars:o.hideBars,showBars:o.showBars,destroy:o.destroy,events:a.registry}},io=e=>Xe(e)&&"TABLE"===e.nodeName,us="bar-",cu=e=>"false"!==Ne(e,"data-mce-resize"),lu=s=>{const c=pt(),a=pt(),d=pt();let r,o;const m=e=>tc(s,e),f=()=>Ur(s)?ys():wi();return s.on("init",()=>{const e=((e,s)=>e.inline?((e,t,s)=>({parent:n(t),view:n(e),origin:n(q(0,0)),isResizable:s}))(t.fromDom(e.getBody()),(()=>{const e=t.fromTag("div");return ut(e,{position:"static",height:"0",width:"0",padding:"0",margin:"0",border:"0"}),l(Ja(t.fromDom(document)),e),e})(),s):((e,s)=>{const o=li(e)?(e=>t.fromDom(dn(e).dom.documentElement))(e):e;return{parent:n(o),view:n(e),origin:n(q(0,0)),isResizable:s}})(t.fromDom(e.getDoc()),s))(s,cu);if(d.set(e),(e=>{const t=e.options.get("object_resizing");return h(t.split(","),"table")})(s)&&_c(s)){const n=f(),t=iu(e,n,m);t.on(),t.events.startDrag.bind(e=>{c.set(s.selection.getRng())}),t.events.beforeResize.bind(e=>{const t=e.table.dom;((e,t,n,s,o)=>{e.dispatch("ObjectResizeStart",{target:t,width:n,height:s,origin:o})})(s,t,Fo(t),To(t),us+e.type)}),t.events.afterResize.bind(e=>{const n=e.table,t=n.dom;he(n),c.on(e=>{s.selection.setRng(e),s.focus()}),((e,t,n,s,o)=>{e.dispatch("ObjectResized",{target:t,width:n,height:s,origin:o})})(s,t,Fo(t),To(t),us+e.type),s.undoManager.add()}),a.set(t)}}),s.on("ObjectResizeStart",n=>{const a=n.target;if(io(a)){const c=t.fromDom(a);i(s.dom.select(".mce-clonedresizable"),e=>{s.dom.addClass(e,"mce-"+_n(s)+"-columns")}),!lc(c)&&ke(s)?Gn(c):!dc(c)&&an(s)&&nt(c),rc(c)&&vr(n.origin,us)&&nt(c),r=n.width,o=et(s)?"":((t,n)=>{const s=t.dom.getStyle(n,"width")||t.dom.getAttrib(n,"width");return e.from(s).filter(Yc)})(s,a).getOr("")}}),s.on("ObjectResized",e=>{const n=e.target;if(io(n)){const a=t.fromDom(n),c=e.origin;vr(c,"corner-")&&((e,t,n)=>{const a=bt(t,"e");if(""===o&&nt(e),n!==r&&""!==o){b(e,"width",o);const t=f(),i=m(e),c=Ur(s)||a?(e=>js(e).columns)(e)-1:0;Ma(e,n-r,c,t,i)}else if((e=>/^(\d+(\.\d+)?)%$/.test(e))(o)){const t=parseFloat(o.replace("%",""));b(e,"width",n*t/r+"%")}(e=>/^(\d+(\.\d+)?)px$/.test(e))(o)&&(e=>{const t=_(e);qe(t)||i(Me(e),e=>{const t=ce(e,"width");b(e,"width",t),u(e,"width")})})(e)})(a,c,e.width),he(a),le(s,a.dom,un)}}),s.on("SwitchMode",()=>{a.on(e=>{s.mode.isReadOnly()?e.hideBars():e.showBars()})}),s.on("remove",()=>{a.on(e=>{e.destroy()}),d.on(e=>{((e,t)=>{e.inline&&E(t.parent())})(s,e)})}),{refresh:e=>{a.on(n=>n.refreshBars(t.fromDom(e)))},hide:()=>{a.on(e=>e.hideBars())},show:()=>{a.on(e=>e.showBars())}}},du=e=>{(e=>{const t=e.options.register;t("table_clone_elements",{processor:"string[]"}),t("table_use_colgroups",{processor:"boolean",default:!0}),t("table_header_type",{processor:e=>{const t=h(["section","cells","sectionCells","auto"],e);return t?{value:e,valid:t}:{valid:!1,message:"Must be one of: section, cells, sectionCells or auto."}},default:"section"}),t("table_sizing_mode",{processor:"string",default:"auto"}),t("table_default_attributes",{processor:"object",default:{border:"1"}}),t("table_default_styles",{processor:"object",default:{"border-collapse":"collapse"}}),t("table_column_resizing",{processor:e=>{const t=h(["preservetable","resizetable"],e);return t?{value:e,valid:t}:{valid:!1,message:"Must be preservetable, or resizetable."}},default:"preservetable"}),t("table_resize_bars",{processor:"boolean",default:!0}),t("table_style_by_css",{processor:"boolean",default:!0})})(e);const s=lu(e),t=zd(e,s),n=bc(e,s,t);return Ic(e,n),((e,t)=>{const s=Pe(e),n=t=>Ms(Ot(e)).bind(n=>S(n,s).map(s=>{const o=Ft(U(e),s,n);return t(s,o)})).getOr("");M({mceTableRowType:()=>n(t.getTableRowType),mceTableCellType:()=>n(t.getTableCellType),mceTableColType:()=>n(t.getTableColType)},(t,n)=>e.addQueryValueHandler(n,t))})(e,n),td(e,n),{getSelectedCells:t.getSelectedCells,clearSelectedCells:t.clearSelectedCells}};Xr.add("dom",e=>({table:du(e)}))}()