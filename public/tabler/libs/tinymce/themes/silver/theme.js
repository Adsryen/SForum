(function(){"use strict";const HM=Object.getPrototypeOf,Yv=(e,t,n)=>{var s;return!!n(e,t.prototype)||((s=e.constructor)===null||s===void 0?void 0:s.name)===t.name},x$=e=>{const t=typeof e;return e===null?"null":t==="object"&&Array.isArray(e)?"array":t==="object"&&Yv(e,String,(e,t)=>t.isPrototypeOf(e))?"string":t},nl=e=>t=>x$(t)===e,sl=e=>t=>typeof t===e,Pv=e=>t=>e===t,m$=(e,t)=>Os(e)&&Yv(e,t,(e,t)=>HM(e)===t),L=nl("string"),Os=nl("object"),Nv=e=>m$(e,Object),bs=nl("array"),zc=Pv(null),ts=sl("boolean"),ls=Pv(void 0),xc=e=>e==null,en=e=>!xc(e),Mt=sl("function"),gs=sl("number"),Hi=(e,t)=>{if(bs(e)){for(let n=0,s=e.length;n<s;++n)if(!t(e[n]))return!1;return!0}return!1},l=()=>{},d$=e=>()=>e(),ol=(e,t)=>(...n)=>e(t.apply(null,n)),a$=(e,t)=>n=>e(t(n)),n=e=>()=>e,z=e=>e,Mv=(e,t)=>e===t;function Tt(e,...t){return(...n)=>{const s=t.concat(n);return e.apply(null,s)}}const ra=e=>t=>!e(t),rl=e=>()=>{throw new Error(e)},Ov=e=>e(),U=n(!1),ye=n(!0);gv=tinymce.util.Tools.resolve("tinymce.ThemeManager");class e{constructor(e,t){this.tag=e,this.value=t}static some(t){return new e(!0,t)}static none(){return e.singletonNone}fold(e,t){return this.tag?t(this.value):e()}isSome(){return this.tag}isNone(){return!this.tag}map(t){return this.tag?e.some(t(this.value)):e.none()}bind(t){return this.tag?t(this.value):e.none()}exists(e){return this.tag&&e(this.value)}forall(e){return!this.tag||e(this.value)}filter(t){return!this.tag||t(this.value)?this:e.none()}getOr(e){return this.tag?this.value:e}or(e){return this.tag?this:e}getOrThunk(e){return this.tag?this.value:e()}orThunk(e){return this.tag?this:e()}getOrDie(e){if(this.tag)return this.value;throw new Error(e??"Called getOrDie on None")}static from(t){return en(t)?e.some(t):e.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(e){this.tag&&e(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}e.singletonNone=new e(!1);const Pr=Array.prototype.slice,o$=Array.prototype.indexOf,s$=Array.prototype.push,av=(e,t)=>o$.call(e,t),sv=(t,n)=>{const s=av(t,n);return s===-1?e.none():e.some(s)},Oe=(e,t)=>av(e,t)>-1,vn=(e,t)=>{for(let n=0,s=e.length;n<s;n++){const o=e[n];if(t(o,n))return!0}return!1},gl=(e,t)=>{const n=[];for(let s=0;s<e;s++)n.push(t(s));return n},K7=(e,t)=>{const n=[];for(let s=0;s<e.length;s+=t){const o=Pr.call(e,s,s+t);n.push(o)}return n},a=(e,t)=>{const n=e.length,s=new Array(n);for(let o=0;o<n;o++){const i=e[o];s[o]=t(i,o)}return s},h=(e,t)=>{for(let n=0,s=e.length;n<s;n++){const o=e[n];t(o,n)}},t$=(e,t)=>{for(let n=e.length-1;n>=0;n--){const s=e[n];t(s,n)}},L7=(e,t)=>{const n=[],s=[];for(let o=0,a=e.length;o<a;o++){const i=e[o],r=t(i,o)?n:s;r.push(i)}return{pass:n,fail:s}},q=(e,t)=>{const n=[];for(let s=0,i=e.length;s<i;s++){const o=e[s];t(o,s)&&n.push(o)}return n},qo=(e,t,n)=>(t$(e,(e,s)=>{n=t(n,e,s)}),n),He=(e,t,n)=>(h(e,(e,s)=>{n=t(n,e,s)}),n),QV=(t,n,s)=>{for(let o=0,a=t.length;o<a;o++){const i=t[o];if(n(i,o))return e.some(i);if(s(i,o))break}return e.none()},se=(e,t)=>QV(e,t,U),Zo=(t,n)=>{for(let s=0,o=t.length;s<o;s++){const i=t[s];if(n(i,s))return e.some(s)}return e.none()},Fe=e=>{const t=[];for(let n=0,s=e.length;n<s;++n){if(!bs(e[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+e);s$.apply(t,e[n])}return t},le=(e,t)=>Fe(a(e,t)),si=(e,t)=>{for(let n=0,s=e.length;n<s;++n){const o=e[n];if(t(o,n)!==!0)return!1}return!0},Li=e=>{const t=Pr.call(e,0);return t.reverse(),t},uo=(e,t)=>q(e,e=>!Oe(t,e)),D7=(e,t)=>{const n={};for(let s=0,i=e.length;s<i;s++){const o=e[s];n[String(o)]=t(o,s)}return n},YV=e=>[e],S7=(e,t)=>{const n=Pr.call(e,0);return n.sort(t),n},Pa=(t,n)=>n>=0&&n<t.length?e.some(t[n]):e.none(),os=e=>Pa(e,0),Cl=e=>Pa(e,e.length-1),qV=Mt(Array.from)?Array.from:e=>Pr.call(e),En=(t,n)=>{for(let e=0;e<t.length;e++){const s=n(t[e],e);if(s.isSome())return s}return e.none()},de=Object.keys,KV=Object.hasOwnProperty,Ie=(e,t)=>{const n=de(e);for(let s=0,i=n.length;s<i;s++){const o=n[s],a=e[o];t(a,o)}},_e=(e,t)=>O7(e,(e,n)=>({k:n,v:t(e,n)})),O7=(e,t)=>{const n={};return Ie(e,(e,s)=>{const o=t(e,s);n[o.k]=o.v}),n},Sl=e=>(t,n)=>{e[n]=t},y7=(e,t,n,s)=>{Ie(e,(e,o)=>{(t(e,o)?n:s)(e,o)})},UV=(e,t)=>{const n={},s={};return y7(e,t,Sl(n),Sl(s)),{t:n,f:s}},f7=(e,t)=>{const n={};return y7(e,t,Sl(n),l),n},tr=(e,t)=>{const n=[];return Ie(e,(e,s)=>{n.push(t(e,s))}),n},Dl=(t,n)=>{const s=de(t);for(let o=0,r=s.length;o<r;o++){const i=s[o],a=t[i];if(n(a,i,t))return e.some(a)}return e.none()},Nl=e=>tr(e,z),f=(t,n)=>R(t,n)?e.from(t[n]):e.none(),R=(e,t)=>KV.call(e,t),Vt=(e,t)=>R(e,t)&&e[t]!==void 0&&e[t]!==null,hn=(e,t,n=Mv)=>e.exists(e=>n(e,t)),WV=(e,t,n=Mv)=>rr(e,t,n).getOr(e.isNone()&&t.isNone()),po=e=>{const t=[],n=e=>{t.push(e)};for(let t=0;t<e.length;t++)e[t].each(n);return t},$V=t=>{const n=[];for(let s=0;s<t.length;s++){const o=t[s];if(o.isSome())n.push(o.getOrDie());else return e.none()}return e.some(n)},rr=(t,n,s)=>t.isSome()&&n.isSome()?e.some(s(t.getOrDie(),n.getOrDie())):e.none(),VV=(t,n,s,o)=>t.isSome()&&n.isSome()&&s.isSome()?e.some(o(t.getOrDie(),n.getOrDie(),s.getOrDie())):e.none(),HV=(t,n)=>t!=null?e.some(n(t)):e.none(),Ti=(t,n)=>t?e.some(n):e.none(),PV=(e,t)=>e+t,RV=(e,t)=>e.substring(t),T5=(e,t,n)=>t===""||e.length>=t.length&&e.substr(n,n+t.length)===t,LV=(e,t)=>DV(e,t)?RV(e,t.length):e,NV=(e,t)=>_r(e,t)?e:PV(e,t),st=(e,t,n=0,s)=>{const o=e.indexOf(t,n);return o!==-1&&(!!ls(s)||o+t.length<=s)},DV=(e,t)=>T5(e,t,0),_r=(e,t)=>T5(e,t,e.length-t.length),zV=e=>t=>t.replace(e,""),TV=zV(/^\s+|\s+$/g),Zl=e=>e.length>0,FV=e=>!Zl(e),Ri=e=>e.style!==void 0&&Mt(e.style.getPropertyValue),MV=(e,t)=>{const s=t||document,n=s.createElement("div");if(n.innerHTML=e,!n.hasChildNodes()||n.childNodes.length>1){const t="HTML does not have a single root node";throw console.error(t,e),new Error(t)}return sa(n.childNodes[0])},kV=(e,t)=>{const n=t||document,s=n.createElement(e);return sa(s)},EV=(e,t)=>{const n=t||document,s=n.createTextNode(e);return sa(s)},sa=e=>{if(e==null)throw new Error("Node cannot be null or undefined");return{dom:e}},CV=(t,n,s)=>e.from(t.dom.elementFromPoint(n,s)).map(sa),c={fromHtml:MV,fromTag:kV,fromText:EV,fromDom:sa,fromPoint:CV},xV=typeof window!="undefined"?window:Function("return this;")(),OV=(e,t)=>{let n=t??xV;for(let t=0;t<e.length&&n!==void 0&&n!==null;++t)n=n[e[t]];return n},yg=(e,t)=>{const n=e.split(".");return OV(n,t)},wV=(e,t)=>yg(e,t),_V=(e,t)=>{const n=wV(e,t);if(n==null)throw new Error(e+" not available on this browser");return n},yV=Object.getPrototypeOf,jV=e=>_V("HTMLElement",e),bV=e=>{const t=yg("ownerDocument.defaultView",e);return Os(e)&&(jV(t).prototype.isPrototypeOf(e)||/^HTML\w*Element$/.test(yV(e).constructor.name))},ng=9,eg=11,yd=1,vV=3,Wn=e=>{const t=e.dom.nodeName;return t.toLowerCase()},gV=e=>e.dom.nodeType,Yr=e=>t=>gV(t)===e,pV=e=>At(e)&&bV(e.dom),At=Yr(yd),ro=Yr(vV),fV=Yr(ng),mV=Yr(eg),Dp=e=>t=>At(t)&&Wn(t)===e,Md=(e,t)=>{const s=e.dom;if(s.nodeType!==yd)return!1;const n=s;if(n.matches!==void 0)return n.matches(t);if(n.msMatchesSelector!==void 0)return n.msMatchesSelector(t);if(n.webkitMatchesSelector!==void 0)return n.webkitMatchesSelector(t);if(n.mozMatchesSelector!==void 0)return n.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")},Tp=e=>e.nodeType!==yd&&e.nodeType!==ng&&e.nodeType!==eg||e.childElementCount===0,hV=(e,t)=>{const n=t===void 0?document:t.dom;return Tp(n)?[]:a(n.querySelectorAll(e),c.fromDom)},uV=(t,n)=>{const s=n===void 0?document:n.dom;return Tp(s)?e.none():e.from(s.querySelector(t)).map(c.fromDom)},Y=(e,t)=>e.dom===t.dom,tc=(e,t)=>{const n=e.dom,s=t.dom;return n!==s&&n.contains(s)},an=e=>c.fromDom(e.dom.ownerDocument),La=e=>fV(e)?e:an(e),Ld=e=>c.fromDom(La(e).dom.documentElement),bi=e=>c.fromDom(La(e).dom.defaultView),Rn=t=>e.from(t.dom.parentNode).map(c.fromDom),Ii=t=>e.from(t.dom.parentElement).map(c.fromDom),Op=t=>e.from(t.dom.offsetParent).map(c.fromDom),dV=t=>e.from(t.dom.nextSibling).map(c.fromDom),kn=e=>a(e.dom.childNodes,c.fromDom),wo=(t,n)=>{const s=t.dom.childNodes;return e.from(s[n]).map(c.fromDom)},lV=e=>wo(e,0),fp=(e,t)=>({element:e,offset:t}),lp=(e,t)=>{const n=kn(e);return n.length>0&&t<n.length?fp(n[t],0):fp(e,t)},Rd=e=>mV(e)&&en(e.dom.host),op=Mt(Element.prototype.attachShadow)&&Mt(Node.prototype.getRootNode),cV=n(op),Pt=op?e=>c.fromDom(e.dom.getRootNode()):La,Kc=e=>Rd(e)?e:c.fromDom(La(e).dom.body),rV=e=>Z6(e).isSome(),Z6=t=>{const n=Pt(t);return Rd(n)?e.some(n):e.none()},aV=e=>c.fromDom(e.dom.host),iV=t=>{if(cV()&&en(t.target)){const e=c.fromDom(t.target);if(At(e)&&oV(e)&&t.composed&&t.composedPath){const e=t.composedPath();if(e)return os(e)}}return e.from(t.target)},oV=e=>en(e.dom.shadowRoot),Xt=e=>{const t=ro(e)?e.dom.parentNode:e.dom;if(t==null||t.ownerDocument===null)return!1;const n=t.ownerDocument;return Z6(c.fromDom(t)).fold(()=>n.body.contains(t),a$(Xt,aV))},Un=()=>sV(c.fromDom(document)),sV=e=>{const t=e.dom.body;if(t==null)throw new Error("Body is not available yet");return c.fromDom(t)},X6=(e,t,n)=>{if(L(n)||ts(n)||gs(n))e.setAttribute(t,n+"");else throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",n,":: Element ",e),new Error("Attribute value was not simple")},w=(e,t,n)=>{X6(e.dom,t,n)},G6=(e,t)=>{const n=e.dom;Ie(t,(e,t)=>{X6(n,t,e)})},De=(e,t)=>{const n=e.dom.getAttribute(t);return n===null?void 0:n},ut=(t,n)=>e.from(De(t,n)),Y6=(e,t)=>{const n=e.dom;return!!(n&&n.hasAttribute)&&n.hasAttribute(t)},pe=(e,t)=>{e.dom.removeAttribute(t)},nV=e=>He(e.dom.attributes,(e,t)=>(e[t.name]=t.value,e),{}),Ud=(e,t,n)=>{if(!L(n))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",n,":: Element ",e),new Error("CSS value must be a string: "+n);Ri(e)&&e.style.setProperty(t,n)},H6=(e,t)=>{Ri(e)&&e.style.removeProperty(t)},y=(e,t,n)=>{const s=e.dom;Ud(s,t,n)},ko=(e,t)=>{const n=e.dom;Ie(t,(e,t)=>{Ud(n,t,e)})},Zc=(e,t)=>{const n=e.dom;Ie(t,(e,t)=>{e.fold(()=>{H6(n,t)},e=>{Ud(n,t,e)})})},ft=(e,t)=>{const n=e.dom,o=window.getComputedStyle(n),s=o.getPropertyValue(t);return s===""&&!Xt(e)?R6(n,t):s},R6=(e,t)=>Ri(e)?e.style.getPropertyValue(t):"",Re=(t,n)=>{const s=t.dom,o=R6(s,n);return e.from(o).filter(e=>e.length>0)},w6=e=>{const n={},t=e.dom;if(Ri(t))for(let e=0;e<t.style.length;e++){const s=t.style.item(e);n[s]=t.style[s]}return n},b6=(e,t,n)=>{const s=c.fromTag(e);y(s,t,n);const o=Re(s,t);return o.isSome()},B=(e,t)=>{const n=e.dom;H6(n,t),hn(ut(e,"style").map(TV),"")&&pe(e,"style")},wa=e=>e.dom.offsetWidth,p6=(e,t)=>{const o=(t,n)=>{if(!gs(n)&&!n.match(/^[0-9]+$/))throw new Error(e+".set accepts only positive integer values. Value was "+n);const s=t.dom;Ri(s)&&(s.style[e]=n+"px")},n=n=>{const s=t(n);if(s<=0||s===null){const t=ft(n,e);return parseFloat(t)||0}return s},i=n,s=(e,t)=>He(t,(t,n)=>{const s=ft(e,n),o=s===void 0?0:parseInt(s,10);return isNaN(o)?t:t+o},0),a=(e,t,n)=>{const o=s(e,n),i=t>o?t-o:0;return i};return{set:o,get:n,getOuter:i,aggregate:s,max:a}},Gd=p6("height",e=>{const t=e.dom;return Xt(e)?t.getBoundingClientRect().height:t.offsetHeight}),Ve=e=>Gd.get(e),to=e=>Gd.getOuter(e),eV=(e,t)=>{const n=["margin-top","border-top-width","padding-top","padding-bottom","border-bottom-width","margin-bottom"],s=Gd.max(e,t,n);y(e,"max-height",s+"px")},l6=(e,t)=>{const n=(n,s)=>l6(e+n,t+s);return{left:e,top:t,translate:n}},Z=l6,JB=e=>{const t=e.getBoundingClientRect();return Z(t.left,t.top)},$c=(e,t)=>e!==void 0?e:t!==void 0?t:0,zs=e=>{const o=e.dom.ownerDocument,n=o.body,t=o.defaultView,s=o.documentElement;if(n===e.dom)return Z(n.offsetLeft,n.offsetTop);const i=$c(t?.pageYOffset,s.scrollTop),a=$c(t?.pageXOffset,s.scrollLeft),r=$c(s.clientTop,n.clientTop),c=$c(s.clientLeft,n.clientLeft);return Qd(e).translate(a-c,i-r)},Qd=e=>{const t=e.dom,s=t.ownerDocument,n=s.body;return n===t?Z(n.offsetLeft,n.offsetTop):Xt(e)?JB(t):Z(0,0)},Vc=p6("width",e=>e.dom.offsetWidth),ZB=(e,t)=>Vc.set(e,t),et=e=>Vc.get(e),fa=e=>Vc.getOuter(e),QB=(e,t)=>{const n=["margin-left","border-left-width","padding-left","padding-right","border-right-width","margin-right"],s=Vc.max(e,t,n);y(e,"max-width",s+"px")},hs=e=>{let t=!1,n;return(...s)=>(t||(t=!0,n=e.apply(null,s)),n)},XB=(e,t,s,o)=>{const i=e.isiOS()&&/ipad/i.test(s)===!0,a=e.isiOS()&&!i,r=e.isiOS()||e.isAndroid(),u=r||o("(pointer:coarse)"),c=i||!a&&r&&o("(min-device-width:768px)"),l=a||r&&!c,d=t.isSafari()&&e.isiOS()&&/safari/i.test(s)===!1,h=!l&&!c&&!d;return{isiPad:n(i),isiPhone:n(a),isTablet:n(c),isPhone:n(l),isTouch:n(u),isAndroid:e.isAndroid,isiOS:e.isiOS,isWebView:n(d),isDesktop:n(h)}},GB=(e,t)=>{for(let n=0;n<e.length;n++){const s=e[n];if(s.test(t))return s}},YB=(e,t)=>{const n=GB(e,t);if(!n)return{major:0,minor:0};const s=e=>Number(t.replace(n,"$"+e));return tu(s(1),s(2))},qB=(e,t)=>{const n=String(t).toLowerCase();return e.length===0?Zf():YB(e,n)},Zf=()=>tu(0,0),tu=(e,t)=>({major:e,minor:t}),ca={nu:tu,detect:qB,unknown:Zf},KB=(e,t)=>En(t.brands,t=>{const n=t.brand.toLowerCase();return se(e,e=>{var t;return n===((t=e.brand)===null||t===void 0?void 0:t.toLowerCase())}).map(e=>({current:e.name,version:ca.nu(parseInt(t.version,10),0)}))}),qf=(e,t)=>{const n=String(t).toLowerCase();return se(e,e=>e.search(n))},UB=(e,t)=>qf(e,t).map(e=>{const n=ca.detect(e.versionRegexes,t);return{current:e.name,version:n}}),WB=(e,t)=>qf(e,t).map(e=>{const n=ca.detect(e.versionRegexes,t);return{current:e.name,version:n}}),nu=/.*?version\/ ?([0-9]+)\.([0-9]+).*/,Gn=e=>t=>st(t,e),$B=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:e=>st(e,"edge/")&&st(e,"chrome")&&st(e,"safari")&&st(e,"applewebkit")},{name:"Chromium",brand:"Chromium",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,nu],search:e=>st(e,"chrome")&&!st(e,"chromeframe")},{name:"IE",versionRegexes:[/.*?msie ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:e=>st(e,"msie")||st(e,"trident")},{name:"Opera",versionRegexes:[nu,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:Gn("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/ ?([0-9]+)\.([0-9]+).*/],search:Gn("firefox")},{name:"Safari",versionRegexes:[nu,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:e=>(st(e,"safari")||st(e,"mobile/"))&&st(e,"applewebkit")}],VB=[{name:"Windows",search:Gn("win"),versionRegexes:[/.*?windows nt ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:e=>st(e,"iphone")||st(e,"ipad"),versionRegexes:[/.*?version\/ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:Gn("android"),versionRegexes:[/.*?android ?([0-9]+)\.([0-9]+).*/]},{name:"macOS",search:Gn("mac os x"),versionRegexes:[/.*?mac os x ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:Gn("linux"),versionRegexes:[]},{name:"Solaris",search:Gn("sunos"),versionRegexes:[]},{name:"FreeBSD",search:Gn("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:Gn("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],Bf={browsers:n($B),oses:n(VB)},If="Edge",zf="Chromium",Af="IE",jf="Opera",bf="Firefox",pf="Safari",BB=()=>nf({current:void 0,version:ca.unknown()}),nf=e=>{const n=e.current,s=e.version,t=e=>()=>n===e;return{current:n,version:s,isEdge:t(If),isChromium:t(zf),isIE:t(Af),isOpera:t(jf),isFirefox:t(bf),isSafari:t(pf)}},tf={unknown:BB,nu:nf,edge:n(If),chromium:n(zf),ie:n(Af),opera:n(jf),firefox:n(bf),safari:n(pf)},X8="Windows",Y8="iOS",K8="Android",P8="Linux",z8="macOS",A8="Solaris",x8="FreeBSD",f8="ChromeOS",HB=()=>h8({current:void 0,version:ca.unknown()}),h8=e=>{const n=e.current,s=e.version,t=e=>()=>n===e;return{current:n,version:s,isWindows:t(X8),isiOS:t(Y8),isAndroid:t(K8),isMacOS:t(z8),isLinux:t(P8),isSolaris:t(A8),isFreeBSD:t(x8),isChromeOS:t(f8)}},u8={unknown:HB,nu:h8,windows:n(X8),ios:n(Y8),android:n(K8),linux:n(P8),macos:n(z8),solaris:n(A8),freebsd:n(x8),chromeos:n(f8)},PB=(e,t,n)=>{const s=Bf.browsers(),a=Bf.oses(),o=t.bind(e=>KB(s,e)).orThunk(()=>UB(s,e)).fold(tf.unknown,tf.nu),i=WB(a,e).fold(u8.unknown,u8.nu),r=XB(i,o,e,n);return{browser:o,os:i,deviceType:r}},DB={detect:PB},FB=e=>window.matchMedia(e).matches;let kB=hs(()=>DB.detect(navigator.userAgent,e.from(navigator.userAgentData),FB));const ho=()=>kB(),EB=(e,t,n,s,o,i,a)=>({target:e,x:t,y:n,stop:s,prevent:o,kill:i,raw:a}),Gm=e=>{const s=c.fromDom(iV(e).getOr(e.target)),t=()=>e.stopPropagation(),n=()=>e.preventDefault(),o=ol(n,t);return EB(s,e.clientX,e.clientY,t,n,o,e)},xB=(e,t)=>n=>{e(n)&&t(Gm(n))},$m=(e,t,n,s,o)=>{const i=xB(n,s);return e.dom.addEventListener(t,i,o),{unbind:Tt(bB,e,t,i,o)}},OB=(e,t,n,s)=>$m(e,t,n,s,!1),jB=(e,t,n,s)=>$m(e,t,n,s,!0),bB=(e,t,n,s)=>{e.dom.removeEventListener(t,n,s)},Ei=(e,t)=>{const n=Rn(e);n.each(n=>{n.dom.insertBefore(t.dom,e.dom)})},vB=(e,t)=>{const n=dV(e);n.fold(()=>{const n=Rn(e);n.each(e=>{Jt(e,t)})},e=>{Ei(e,t)})},gB=(e,t)=>{const n=lV(e);n.fold(()=>{Jt(e,t)},n=>{e.dom.insertBefore(t.dom,n.dom)})},Jt=(e,t)=>{e.dom.appendChild(t.dom)},pB=(e,t,n)=>{wo(e,n).fold(()=>{Jt(e,t)},e=>{Ei(e,t)})},Tm=(e,t)=>{h(t,t=>{Jt(e,t)})},Lu=e=>{e.dom.textContent="",h(kn(e),e=>{Bn(e)})},Bn=e=>{const t=e.dom;t.parentNode!==null&&t.parentNode.removeChild(t)},Cn=e=>{const t=e!==void 0?e.dom:document,n=t.body.scrollLeft||t.documentElement.scrollLeft,s=t.body.scrollTop||t.documentElement.scrollTop;return Z(n,s)},km=(e,t,n)=>{const o=n!==void 0?n.dom:document,s=o.defaultView;s&&s.scrollTo(e,t)},fB=t=>{const n=t===void 0?window:t;return ho().browser.isFirefox()?e.none():e.from(n.visualViewport)},Cm=(e,t,n,s)=>({x:e,y:t,width:n,height:s,right:e+n,bottom:t+s}),xm=e=>{const n=e===void 0?window:e,s=n.document,t=Cn(c.fromDom(s));return fB(n).fold(()=>{const e=n.document.documentElement,s=e.clientWidth,o=e.clientHeight;return Cm(t.left,t.top,s,o)},e=>Cm(Math.max(e.pageLeft,t.left),Math.max(e.pageTop,t.top),e.width,e.height))},Hu=()=>c.fromDom(document),wm=(e,t)=>{const s=e.view(t);return s.fold(n([]),t=>{const n=e.owner(t),s=wm(e,n);return[t].concat(s)})},hB=(t,n)=>{const s=n.owner(t),o=wm(n,s);return e.some(o)},uB=t=>{var n;const s=t.dom===document?e.none():e.from((n=t.dom.defaultView)===null||n===void 0?void 0:n.frameElement);return s.map(c.fromDom)},lB=e=>an(e);fm=Object.freeze({__proto__:null,view:uB,owner:lB});const $u=e=>{const n=Hu(),t=Cn(n),s=hB(e,fm);return s.fold(Tt(zs,e),n=>{const s=Qd(e),o=qo(n,(e,t)=>{const n=Qd(t);return{left:e.left+n.left,top:e.top+n.top}},{left:0,top:0});return Z(o.left+s.left+t.left,o.top+s.top+t.top)})},cB=(e,t,n)=>({point:e,width:t,height:n}),rB=(e,t,n,s)=>({x:e,y:t,width:n,height:s}),Be=(e,t,n,s)=>({x:e,y:t,width:n,height:s,right:e+n,bottom:t+s}),at=e=>{const t=zs(e),n=fa(e),s=to(e);return Be(t.left,t.top,n,s)},Ps=e=>{const t=$u(e),n=fa(e),s=to(e);return Be(t.left,t.top,n,s)},Sn=()=>xm(window),nm=t=>{const s=e=>e(t),o=n(t),i=()=>a,a={tag:!0,inner:t,fold:(e,n)=>n(t),isValue:ye,isError:U,map:e=>_.value(e(t)),mapError:i,bind:s,exists:s,forall:s,getOr:o,or:i,getOrThunk:o,orThunk:i,getOrDie:o,each:e=>{e(t)},toOptional:()=>e.some(t)};return a},Zh=t=>{const n=()=>s,s={tag:!1,inner:t,fold:(e)=>e(t),isValue:U,isError:ye,map:n,mapError:e=>_.error(e(t)),bind:n,exists:U,forall:ye,getOr:z,or:z,getOrThunk:Ov,orThunk:Ov,getOrDie:rl(String(t)),each:l,toOptional:e.none};return s},nB=(e,t)=>e.fold(()=>Zh(t),nm),_={value:nm,error:Zh,fromOption:nB};(function(e){e[e.Error=0]="Error",e[e.Value=1]="Value"})(St||(St={}));const Gu=(e,t,n)=>e.stype===St.Error?t(e.serror):n(e.svalue),YI=e=>{const t=[],n=[];return h(e,e=>{Gu(e,e=>n.push(e),e=>t.push(e))}),{values:t,errors:n}},II=(e,t)=>e.stype===St.Error?{stype:St.Error,serror:t(e.serror)}:e,HI=(e,t)=>e.stype===St.Value?{stype:St.Value,svalue:t(e.svalue)}:e,PI=(e,t)=>e.stype===St.Value?t(e.svalue):e,TI=(e,t)=>e.stype===St.Error?t(e.serror):e,Ah=e=>({stype:St.Value,svalue:e}),kh=e=>({stype:St.Error,serror:e}),_I=e=>Gu(e,_.error,_.value),jI=e=>e.fold(kh,Ah),ie={fromResult:jI,toResult:_I,svalue:Ah,partition:YI,serror:kh,bind:PI,bindError:TI,map:HI,mapError:II,fold:Gu},lh=(e,t,n,s)=>({tag:"field",key:e,newKey:t,presence:n,prop:s}),bI=(e,t)=>({tag:"custom",newKey:e,instantiator:t}),S1=(e,t,n)=>{switch(e.tag){case"field":return t(e.key,e.newKey,e.presence,e.prop);case"custom":return n(e.newKey,e.instantiator)}},aI=(e,t)=>t,QH=(e,t)=>{const n=Nv(e)&&Nv(t);return n?Q(e,t):t},Y3=e=>(...t)=>{if(t.length===0)throw new Error(`Can't merge zero objects`);const n={};for(let s=0;s<t.length;s++){const o=t[s];for(const t in o)R(o,t)&&(n[t]=e(n[t],o[t]))}return n},Q=Y3(QH),q3=Y3(aI),ln=()=>({tag:"required",process:{}}),$r=e=>({tag:"defaultedThunk",process:e}),Vr=e=>$r(n(e)),T1=()=>({tag:"option",process:{}}),z1=e=>({tag:"mergeWithThunk",process:e}),vH=e=>z1(n(e)),gH=(e,t)=>e.length>0?ie.svalue(Q(t,q3.apply(void 0,e))):ie.svalue(t),N3=e=>ol(ie.serror,Fe)(e),cH=(e,t)=>{const n=ie.partition(e);return n.errors.length>0?N3(n.errors):gH(n.values,t)},rH=e=>{const t=ie.partition(e);return t.errors.length>0?N3(t.errors):ie.svalue(t.values)},x3={consolidateObj:cH,consolidateArr:rH},B1=e=>Os(e)&&de(e).length>100?" removed due to size":JSON.stringify(e,null,2),aH=e=>{const t=e.length>10?e.slice(0,10).concat([{path:[],getErrorInfo:n("... (only showing first ten failures)")}]):e;return a(t,e=>"Failed path: ("+e.path.join(" > ")+`)
`+e.getErrorInfo())},aa=(e,t)=>ie.serror([{path:e,getErrorInfo:t}]),sH=(e,t,n)=>aa(e,()=>'Could not find valid *required* value for "'+t+'" in '+B1(n)),eH=(e,t)=>aa(e,()=>'Choice schema did not contain choice key: "'+t+'"'),GP=(e,t,n)=>aa(e,()=>'The chosen schema: "'+n+'" did not exist in branches: '+B1(t)),UP=(e,t)=>aa(e,()=>"There are unsupported fields: ["+t.join(", ")+"] specified"),$P=(e,t)=>aa(e,n(t)),Yo=e=>{const t=(t,n)=>ie.bindError(e(n),e=>$P(t,e)),s=n("val");return{extract:t,toString:s}},p3=Yo(ie.svalue),BP=(e,t,n,s)=>f(t,n).fold(()=>sH(e,n,t),s),d3=(e,t,n,s)=>{const o=f(e,t).getOrThunk(()=>n(e));return s(o)},PP=(e,t,n)=>n(f(e,t)),LP=(e,t,n,s)=>{const o=f(e,t).map(t=>t===!0?n(e):t);return s(o)},NP=(t,s,o,i,a)=>{const r=e=>a.extract(s.concat([i]),e),c=t=>t.fold(()=>ie.svalue(e.none()),t=>{const n=a.extract(s.concat([i]),t);return ie.map(n,e.some)});switch(t.tag){case"required":return BP(s,o,i,r);case"defaultedThunk":return d3(o,i,t.process,r);case"option":return PP(o,i,c);case"defaultedOptionThunk":return LP(o,i,t.process,c);case"mergeWithThunk":return d3(o,i,n({}),e=>{const n=Q(t.process(o),e);return r(n)})}},DP=(e,t,n)=>{const s={},o=[];for(const i of n)S1(i,(n,i,a,r)=>{const c=NP(a,e,t,n,r);ie.fold(c,e=>{o.push(...e)},e=>{s[i]=e})},(e,n)=>{s[e]=n(t)});return o.length>0?ie.serror(o):ie.svalue(s)},z2=e=>{const t=(t,n)=>e().extract(t,n),n=()=>e().toString();return{extract:t,toString:n}},zP=e=>de(f7(e,en)),wt=e=>{const t=m(e),s=qo(e,(e,t)=>S1(t,t=>Q(e,{[t]:!0}),n(e)),{}),o=(e,n)=>{const i=ts(n)?[]:zP(n),o=q(i,e=>!Vt(s,e));return o.length===0?t.extract(e,n):UP(e,o)};return{extract:o,toString:t.toString}},m=e=>{const t=(t,n)=>DP(t,n,e),n=()=>{const t=a(e,e=>S1(e,(e,t,n,s)=>e+" -> "+s.toString(),(e)=>"state("+e+")"));return`obj{
`+t.join(`
`)+"}"};return{extract:t,toString:n}},Ss=e=>{const t=(t,n)=>{const s=a(n,(n,s)=>e.extract(t.concat(["["+s+"]"]),n));return x3.consolidateArr(s)},n=()=>"array("+e.toString()+")";return{extract:t,toString:n}},t4=(e,t)=>{const n=t!==void 0?t:z,s=(t,s)=>{const o=[];for(const a of e){const i=a.extract(t,s);if(i.stype===St.Value)return{stype:St.Value,svalue:n(i.svalue)};o.push(i)}return x3.consolidateArr(o)},o=()=>"oneOf("+a(e,e=>e.toString()).join(", ")+")";return{extract:s,toString:o}},TP=(e,t)=>{const n=(t,n)=>Ss(Yo(e)).extract(t,n),s=(e,s)=>{const o=de(s),i=n(e,o);return ie.bind(i,n=>{const o=a(n,e=>lh(e,e,ln(),t));return m(o).extract(e,s)})},o=()=>"setOf("+t.toString()+")";return{extract:s,toString:o}},FP=(e,t)=>{const n=hs(t),s=(e,t)=>n().extract(e,t),o=()=>n().toString();return{extract:s,toString:o}},d4=ol(Ss,m),yn=n(p3),br=(e,t)=>Yo(n=>{const s=typeof n;return e(n)?ie.svalue(n):ie.serror(`Expected type: ${t} but got: ${s}`)}),vr=br(gs,"number"),Ae=br(L,"string"),pi=br(ts,"boolean"),h4=br(Mt,"function"),c2=e=>{if(Object(e)!==e)return!0;switch({}.toString.call(e).slice(8,-1)){case"Boolean":case"Number":case"String":case"Date":case"RegExp":case"Blob":case"FileList":case"ImageData":case"ImageBitmap":case"ArrayBuffer":return!0;case"Array":case"Object":return Object.keys(e).every(t=>c2(e[t]));default:return!1}},MP=Yo(e=>c2(e)?ie.svalue(e):ie.serror("Expected value to be acceptable for sending via postMessage")),AP=(e,t,n,s)=>{const o=f(n,s);return o.fold(()=>GP(e,n,s),n=>n.extract(e.concat(["branch: "+s]),t))},fr=(e,t)=>{const n=(n,s)=>{const o=f(s,e);return o.fold(()=>eH(n,e),e=>AP(n,s,t,e))},s=()=>"chooseOn("+e+"). Possible values: "+de(t);return{extract:n,toString:s}},_P=()=>Ss(p3),wi=e=>Yo(t=>e(t).fold(ie.serror,ie.svalue)),n2=(e,t)=>TP(t=>ie.fromResult(e(t)),t),yP=(e,t,n)=>{const s=t.extract([e],n);return ie.mapError(s,e=>({input:n,errors:e}))},X=(e,t,n)=>ie.toResult(yP(e,t,n)),pn=e=>e.fold(e=>{throw new Error(oi(e))},z),Je=(e,t,n)=>pn(X(e,t,n)),oi=e=>`Errors: 
`+aH(e.errors).join(`
`)+`

Input object: `+B1(e.input),yt=(e,t)=>fr(e,_e(t,m)),fP=(e,t)=>FP(e,t),Me=lh,Xe=bI,b4=e=>wi(t=>Oe(e,t)?_.value(t):_.error(`Unsupported value: "${t}", choose one of "${e.join(", ")}".`)),s=e=>Me(e,e,ln(),yn()),Ot=(e,t)=>Me(e,e,ln(),t),mP=e=>Ot(e,vr),he=e=>Ot(e,Ae),Pi=(e,t)=>Me(e,e,ln(),b4(t)),lP=e=>Ot(e,pi),Ht=e=>Ot(e,h4),cP=(e,t)=>Me(e,e,T1(),Yo(n=>ie.serror("The field: "+e+" is forbidden. "+t))),ys=(e,t)=>Me(e,e,ln(),m(t)),s0=(e,t)=>Me(e,e,ln(),d4(t)),xt=(e,t)=>Me(e,e,ln(),Ss(t)),D=e=>Me(e,e,T1(),yn()),is=(e,t)=>Me(e,e,T1(),t),qi=e=>is(e,vr),ct=e=>is(e,Ae),J4=(e,t)=>is(e,b4(t)),Qa=e=>is(e,h4),Q4=(e,t)=>is(e,Ss(t)),vt=(e,t)=>is(e,m(t)),rP=(e,t)=>is(e,wt(t)),t=(e,t)=>Me(e,e,Vr(t),yn()),Rt=(e,t,n)=>Me(e,e,Vr(t),n),w4=(e,t)=>Rt(e,t,vr),qn=(e,t)=>Rt(e,t,Ae),Kn=(e,t,n)=>Rt(e,t,b4(n)),ht=(e,t)=>Rt(e,t,pi),fe=(e,t)=>Rt(e,t,h4),aP=(e,t)=>Rt(e,t,MP),Xa=(e,t,n)=>Rt(e,t,Ss(n)),O4=(e,t,n)=>Rt(e,t,m(n)),g=e=>{let t=e;const n=()=>t,s=e=>{t=e};return{get:n,set:s}},tP=e=>{if(!bs(e))throw new Error("cases must be an array");if(e.length===0)throw new Error("there must be at least one case");const t=[],n={};return h(e,(s,o)=>{const r=de(s);if(r.length!==1)throw new Error("one and only one name per case");const i=r[0],a=s[i];if(n[i]!==void 0)throw new Error("duplicate key detected:"+i);if(i==="cata")throw new Error("cannot have a case named cata (sorry)");if(!bs(a))throw new Error("case arguments must be an array");t.push(i),n[i]=(...n)=>{const s=n.length;if(s!==a.length)throw new Error("Wrong number of arguments to case "+i+". Expected "+a.length+" ("+a+"), got "+s);const r=e=>{const s=de(e);if(t.length!==s.length)throw new Error("Wrong number of arguments to match. Expected: "+t.join(",")+`
Actual: `+s.join(","));const o=si(t,e=>Oe(s,e));if(!o)throw new Error("Not all branches were specified when using match. Specified: "+s.join(", ")+`
Required: `+t.join(", "));return e[i].apply(null,n)};return{fold:(...t)=>{if(t.length!==e.length)throw new Error("Wrong number of arguments to fold. Expected "+e.length+", got "+t.length);const s=t[o];return s.apply(null,n)},match:r,log:e=>{console.log(e,{constructors:t,constructor:i,params:n})}}}}),n},Lt={generate:tP};Lt.generate([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]);const eP=e=>{const t=[],n=[];return h(e,e=>{e.fold(e=>{t.push(e)},e=>{n.push(e)})}),{errors:t,values:n}},JR=(e,t)=>{const n={};return Ie(e,(e,s)=>{Oe(t,s)||(n[s]=e)}),n},QR=(e,t)=>({[e]:t}),YR=e=>{const t={};return h(e,e=>{t[e.key]=e.value}),t},qR=(e,t)=>JR(e,t),eo=(e,t)=>QR(e,t),Po=e=>YR(e),VR=(e,t)=>e.length===0?_.value(t):_.value(Q(t,q3.apply(void 0,e))),NR=e=>_.error(Fe(e)),DR=(e,t)=>{const n=eP(e);return n.errors.length>0?NR(n.errors):VR(n.values,t)},I2=e=>Mt(e)?e:U,B2=(t,n,s)=>{let o=t.dom;const i=I2(s);for(;o.parentNode;){o=o.parentNode;const e=c.fromDom(o),t=n(e);if(t.isSome())return t;if(i(e))break}return e.none()},q1=(t,n,s)=>{const i=n(t),o=I2(s);return i.orThunk(()=>o(t)?e.none():B2(t,n,o))},a3=(e,t)=>Y(e.element,t.event.target),zR={can:ye,abort:U,run:l},Fo=e=>{if(!Vt(e,"can")&&!Vt(e,"abort")&&!Vt(e,"run"))throw new Error("EventHandler defined by: "+JSON.stringify(e,null,2)+" does not have can, abort, or run!");return{...zR,...e}},TR=(e,t)=>(...n)=>He(e,(e,s)=>e&&t(s).apply(void 0,n),!0),FR=(e,t)=>(...n)=>He(e,(e,s)=>e||t(s).apply(void 0,n),!1),SR=e=>Mt(e)?{can:ye,abort:U,run:e}:e,ER=e=>{const t=TR(e,e=>e.can),n=FR(e,e=>e.abort),s=(...t)=>{h(e,e=>{e.run.apply(void 0,t)})};return{can:t,abort:n,run:s}},Se=n,ds=Se("touchstart"),Na=Se("touchmove"),Ki=Se("touchend"),w3=Se("touchcancel"),Kt=Se("mousedown"),Ha=Se("mousemove"),A1=Se("mouseout"),x1=Se("mouseup"),_s=Se("mouseover"),Cs=Se("focusin"),CR=Se("focusout"),_a=Se("keydown"),xR=Se("keyup"),oo=Se("input"),pa=Se("change"),ua=Se("click"),OR=Se("transitioncancel"),Xi=Se("transitionend"),wR=Se("transitionstart"),_R=Se("selectstart"),oe=e=>n("alloy."+e),yR={tap:oe("tap")},ps=oe("focus"),_1=oe("blur.post"),y1=oe("paste.post"),ao=oe("receive"),bt=oe("execute"),Ni=oe("focus.item"),Di=yR.tap,vR=oe("longpress"),dr=oe("sandbox.close"),m1=oe("typeahead.cancel"),hr=oe("system.init"),gR=oe("system.touchmove"),hR=oe("system.touchend"),Xu=oe("system.scroll"),gr=oe("system.resize"),no=oe("system.attached"),hi=oe("system.detached"),di=oe("system.dismissRequested"),Yh=oe("system.repositionRequested"),sm=oe("focusmanager.shifted"),Ku=oe("slotcontainer.visibility"),cm=oe("change.tab"),jm=oe("dismiss.tab"),Fm=oe("highlight"),Du=oe("dehighlight"),T=(e,t)=>{Su(e,e.element,t,{})},p=(e,t,n)=>{Su(e,e.element,t,n)},mo=e=>{T(e,bt())},Mu=(e,t,n)=>{Su(e,t,n,{})},Su=(e,t,n,s)=>{const o={target:t,...s};e.getSystem().triggerEvent(n,t,o)},uR=(e,t,n,s)=>{const o={...s,target:t};e.getSystem().triggerEvent(n,t,o)},cf=(e,t,n,s)=>{e.getSystem().triggerEvent(n,t,s.event)},$=e=>Po(e),hf=(e,t)=>({key:e,value:Fo({abort:t})}),dR=(e,t)=>({key:e,value:Fo({can:t})}),mf=e=>({key:e,value:Fo({run:(e,t)=>{t.event.prevent()}})}),o=(e,t)=>({key:e,value:Fo({run:t})}),lu=(e,t,n)=>({key:e,value:Fo({run:(e,s)=>{t.apply(void 0,[e,s].concat(n))}})}),lR=e=>t=>o(e,t),Br=e=>t=>({key:e,value:Fo({run:(e,n)=>{a3(e,n)&&t(e,n)}})}),JL=(e,t)=>o(e,(n,s)=>{n.getSystem().getByUid(t).each(t=>{cf(t,t.element,e,s)})}),Mo=(e,t,n)=>{const s=t.partUids[n];return JL(e,s)},Xd=(e,t)=>o(e,(e,n)=>{const s=n.event,o=e.getSystem().getByDom(s.target).getOrThunk(()=>{const t=q1(s.target,t=>e.getSystem().getByDom(t).toOptional(),U);return t.getOr(e)});t(e,o,n)}),Hs=e=>o(e,(e,t)=>{t.cut()}),QL=e=>o(e,(e,t)=>{t.stop()}),So=(e,t)=>Br(e)(t),J=Br(no()),Hn=Br(hi()),KL=Br(hr()),Jn=lR(bt()),WL=(e,t)=>{const s=t||document,n=s.createElement("div");return n.innerHTML=e,kn(c.fromDom(n))},Id=e=>e.dom.innerHTML,ai=(e,t)=>{const o=an(e),n=o.dom,s=c.fromDom(n.createDocumentFragment()),i=WL(t,n);Tm(s,i),Lu(e),Jt(e,s)},$L=e=>{const t=c.fromTag("div"),n=c.fromDom(e.dom.cloneNode(!0));return Jt(t,n),Id(t)},IL=(e,t)=>c.fromDom(e.dom.cloneNode(t)),PL=e=>IL(e,!1),AL=e=>{if(Rd(e))return"#shadow-root";const t=PL(e);return $L(t)},Ls=e=>AL(e),_L=(e,t,n)=>Y(t,e.element)&&!Y(t,n),jL=$([dR(ps(),(e,t)=>{const n=t.event,s=n.originator,o=n.target;return!_L(e,s,o)||(console.warn(ps()+` did not get interpreted by the desired target. 
Originator: `+Ls(s)+`
Target: `+Ls(o)+`
Check the `+ps()+" event handlers"),!1)})]);Np=Object.freeze({__proto__:null,events:jL});let Pp=0;const d=e=>{const t=new Date,n=t.getTime(),s=Math.floor(Math.random()*1e9);return Pp++,e+"_"+s+Pp+String(n)},uL=n("alloy-id-"),sL=n("data-alloy-id"),tL=uL(),Bp=sL(),eL=(e,t)=>{const n=d(tL+e);return vd(t,n),n},vd=(e,t)=>{Object.defineProperty(e.dom,Bp,{value:t,writable:!0})},Ui=t=>{const n=At(t)?t.dom[Bp]:null;return e.from(n)},xo=e=>d(e),JN=z,yc=e=>{const o=t=>`The component must be in a context to execute: ${t}`+(e?`
`+Ls(e().element)+" is not in context.":""),t=e=>()=>{throw new Error(o(e))},s=e=>()=>{console.warn(o(e))};return{debugInfo:n("fake"),triggerEvent:s("triggerEvent"),triggerFocus:s("triggerFocus"),triggerEscape:s("triggerEscape"),broadcast:s("broadcast"),broadcastOn:s("broadcastOn"),broadcastEvent:s("broadcastEvent"),build:t("build"),buildOrPatch:t("buildOrPatch"),addToWorld:t("addToWorld"),removeFromWorld:t("removeFromWorld"),addToGui:t("addToGui"),removeFromGui:t("removeFromGui"),getByUid:t("getByUid"),getByDom:t("getByDom"),isConnected:U}},ZN=yc(),UN=(e,t,n)=>{const s=n.toString(),i=s.indexOf(")")+1,a=s.indexOf("("),o=s.substring(a+1,i-1).split(/,\s*/);return e.toFunctionAnnotation=()=>({name:t,parameters:id(o.slice(0,1).concat(o.slice(3)))}),e},id=e=>a(e,e=>_r(e,"/*")?e.substring(0,e.length-"/*".length):e),od=(e,t)=>{const n=e.toString(),s=n.indexOf(")")+1,o=n.indexOf("("),i=n.substring(o+1,s-1).split(/,\s*/);return e.toFunctionAnnotation=()=>({name:t,parameters:id(i)}),e},BN=(e,t)=>{const n=t.toString(),s=n.indexOf(")")+1,o=n.indexOf("("),i=n.substring(o+1,s-1).split(/,\s*/);return e.toFunctionAnnotation=()=>({name:"OVERRIDE",parameters:id(i.slice(1))}),e},Ec=d("alloy-premade"),Jg=e=>(Object.defineProperty(e.element.dom,Ec,{value:e.uid,writable:!0}),eo(Ec,e)),PN=e=>R(e.dom,Ec),u5=e=>f(e,Ec),Mc=e=>BN((t,...n)=>e(t.getApis(),t,...n),e),un={init:()=>jt({readState:n("No State required")})},jt=e=>e,RN=(e,o)=>{const i=a(o,e=>vt(e.name(),[s("config"),t("state",un)])),r=X("component.behaviours",m(i),e.behaviours).fold(t=>{throw new Error(oi(t)+`
Complete spec:
`+JSON.stringify(e,null,2))},z);return{list:o,data:_e(r,e=>{const t=e.map(e=>({config:e.config,state:e.state.init(e.config)}));return n(t)})}},LN=e=>e.list,NN=e=>e.data,z5=(e,t)=>{const n={};return Ie(e,(e,s)=>{Ie(e,(e,o)=>{const i=f(n,o).getOr([]);n[o]=i.concat([t(s,e)])})}),n},sn=e=>({classes:ls(e.classes)?[]:e.classes,attributes:ls(e.attributes)?{}:e.attributes,styles:ls(e.styles)?{}:e.styles}),FN=(e,t)=>({...e,attributes:{...e.attributes,...t.attributes},styles:{...e.styles,...t.styles},classes:e.classes.concat(t.classes)}),SN=(e,t,n,s)=>{const i={...t};h(n,t=>{i[t.name()]=t.exhibit(e,s)});const o=z5(i,(e,t)=>({name:e,modification:t})),a=e=>qo(e,(e,t)=>({...t.modification,...e}),{}),r=qo(o.classes,(e,t)=>t.modification.concat(e),[]),c=a(o.attributes),l=a(o.styles);return sn({classes:r,attributes:c,styles:l})},EN=(e,t,n,s)=>{try{const o=S7(n,(n,o)=>{const r=n[t],c=o[t],i=s.indexOf(r),a=s.indexOf(c);if(i===-1)throw new Error("The ordering for "+e+" does not have an entry for "+r+`.
Order specified: `+JSON.stringify(s,null,2));if(a===-1)throw new Error("The ordering for "+e+" does not have an entry for "+c+`.
Order specified: `+JSON.stringify(s,null,2));return i<a?-1:a<i?1:0});return _.value(o)}catch(e){return _.error([e])}},yN=(e,t)=>({handler:e,purpose:t}),bN=(e,t)=>({cHandler:e,purpose:t}),pN=(e,t)=>bN(Tt.apply(void 0,[e.handler].concat(t)),e.purpose),jl=e=>e.cHandler,uN=(e,t)=>({name:e,handler:t}),lN=(e,t)=>{const n={};return h(e,e=>{n[e.name()]=e.handlers(t)}),n},cN=(e,t,n)=>{const s={...n,...lN(t,e)};return z5(s,uN)},aN=(e,t,n,s)=>{const o=cN(e,n,s);return eN(o,t)},sN=e=>{const t=SR(e);return(e,n,...s)=>{const o=[e,n].concat(s);t.abort.apply(void 0,o)?n.stop():t.can.apply(void 0,o)&&t.run.apply(void 0,o)}},nN=(e,t)=>_.error(["The event ("+e+`) has more than one behaviour that listens to it.
When this occurs, you must specify an event ordering for the behaviours in your spec (e.g. [ "listing", "toggling" ]).
The behaviours that can trigger it are: `+JSON.stringify(a(t,e=>e.name),null,2)]),tN=(e,t,n)=>{const s=t[n];return s?EN("Event: "+n,"name",e,s).map(e=>{const t=a(e,e=>e.handler);return ER(t)}):nN(n,e)},eN=(e,t)=>{const n=tr(e,(e,n)=>{const s=e.length===1?_.value(e[0].handler):tN(e,t,n);return s.map(s=>{const o=sN(s),i=e.length>1?q(t[n],t=>vn(e,e=>e.name===t)).join(" > "):e[0].name;return eo(n,yN(o,i))})});return DR(n,{})},Oo="alloy.base.behaviour",GD=m([Me("dom","dom",ln(),m([s("tag"),t("styles",{}),t("classes",[]),t("attributes",{}),D("value"),D("innerHtml")])),s("components"),s("uid"),t("events",{}),t("apis",{}),Me("eventOrder","eventOrder",vH({[bt()]:["disabling",Oo,"toggling","typeaheadevents"],[ps()]:[Oo,"focusing","keying"],[hr()]:[Oo,"disabling","toggling","representing"],[oo()]:[Oo,"representing","streaming","invalidating"],[hi()]:[Oo,"representing","item-events","tooltipping"],[Kt()]:["focusing",Oo,"item-type-events"],[ds()]:["focusing",Oo,"item-type-events"],[_s()]:["item-type-events","tooltipping"],[ao()]:["receiving","reflecting","tooltipping"]}),yn()),D("domModification")]),YD=e=>X("custom.definition",GD,e),qD=e=>({...e.dom,uid:e.uid,domChildren:a(e.components,e=>e.element)}),BD=e=>e.domModification.fold(()=>sn({}),sn),PD=e=>e.events,il=(e,t)=>{const n=De(e,t);return n===void 0||n===""?[]:n.split(" ")},DD=(e,t,n)=>{const s=il(e,t),o=s.concat([n]);return w(e,t,o.join(" ")),!0},TD=(e,t,n)=>{const s=q(il(e,t),e=>e!==n);return s.length>0?w(e,t,s.join(" ")):pe(e,t),!1},ka=e=>e.dom.classList!==void 0,Av=e=>il(e,"class"),MD=(e,t)=>DD(e,"class",t),AD=(e,t)=>TD(e,"class",t),me=(e,t)=>{ka(e)?e.dom.classList.add(t):MD(e,t)},kD=e=>{const t=ka(e)?e.dom.classList:Av(e);t.length===0&&pe(e,"class")},ae=(e,t)=>{if(ka(e)){const n=e.dom.classList;n.remove(t)}else AD(e,t);kD(e)},mt=(e,t)=>ka(e)&&e.dom.classList.contains(t),qs=(e,t)=>{h(t,t=>{me(e,t)})},On=(e,t)=>{h(t,t=>{ae(e,t)})},ED=(e,t)=>si(t,t=>mt(e,t)),OD=e=>{const t=e.dom.classList,n=new Array(t.length);for(let e=0;e<t.length;e++){const s=t.item(e);s!==null&&(n[e]=s)}return n},vD=e=>ka(e)?OD(e):Av(e),Fn=e=>e.dom.value,Is=(e,t)=>{if(t===void 0)throw new Error("Value.set was undefined");e.dom.value=t},gD=(e,t,n)=>{const s=wo(e,t);return s.map(e=>{const t=n.exists(t=>!Y(t,e));if(t){const s=n.map(Wn).getOr("span"),t=c.fromTag(s);return Ei(e,t),t}return e})},M7=(e,t,n)=>{n.fold(()=>Jt(e,t),e=>{Y(e,t)||(Ei(e,t),Bn(e))})},A7=(e,t,n)=>{const s=a(t,n),o=kn(e);return h(o.slice(s.length),Bn),s},E7=(e,t,n,s)=>{const o=wo(e,t),i=s(n,o),a=gD(e,t,o);return M7(e,i.element,a),i},fD=(e,t,n)=>A7(e,t,(t,s)=>E7(e,s,t,n)),mD=(e,t)=>A7(e,t,(t,n)=>{const s=wo(e,n);return M7(e,t,s),t}),_7=(e,t)=>{const n=de(e),s=de(t),o=uo(s,n),i=UV(e,(e,n)=>!R(t,n)||e!==t[n]).t;return{toRemove:o,toSet:i}},uD=(e,t)=>{const{class:j,style:b,...l}=nV(t),{toSet:i,toRemove:a}=_7(e.attributes,l),u=()=>{h(a,e=>pe(t,e)),G6(t,i)},c=w6(t),{toSet:o,toRemove:s}=_7(e.styles,c),r=()=>{h(s,e=>B(t,e)),ko(t,o)},n=vD(t),f=uo(n,e.classes),p=uo(e.classes,n),g=()=>{qs(t,p),On(t,f)},v=e=>{ai(t,e)},m=()=>{const n=e.domChildren;mD(t,n)},d=()=>{const s=t,n=e.value.getOrUndefined();n!==Fn(s)&&Is(s,n??"")};return u(),g(),r(),e.innerHtml.fold(m,v),d(),t},rD=e=>{const t=c.fromTag(e.tag);G6(t,e.attributes),qs(t,e.classes),ko(t,e.styles),e.innerHtml.each(e=>ai(t,e));const n=e.domChildren;return Tm(t,n),e.value.each(e=>{Is(t,e)}),t},oD=(t,n)=>{try{const s=uD(t,n);return e.some(s)}catch{return e.none()}},Xz=e=>e.innerHtml.isSome()&&e.domChildren.length>0,Yz=(e,t)=>{const s=t=>Wn(t)===e.tag&&!Xz(e)&&!PN(t),n=t.filter(s).bind(t=>oD(e,t)).getOrThunk(()=>rD(e));return vd(n,e.uid),n},Wz=e=>{const t=f(e,"behaviours").getOr({});return le(de(t),e=>{const n=t[e];return en(n)?[n.me]:[]})},$z=(e,t)=>RN(e,t),Iz=e=>{const t=Wz(e);return $z(e,t)},Hz=(e,t,n)=>{const s=qD(e),o=BD(e),i={"alloy.base.modification":o},a=t.length>0?SN(n,i,t,s):o;return FN(s,a)},Pz=(e,t,n)=>{const s={"alloy.base.behaviour":PD(e)};return aN(n,e.eventOrder,t,s).getOrDie()},Lz=(e,t)=>{const u=()=>c,s=g(ZN),o=pn(YD(e)),a=Iz(e),r=LN(a),n=NN(a),y=Hz(o,r,n),l=Yz(y,t),d=Pz(o,r,n),i=g(o.components),h=e=>{s.set(e)},m=()=>{s.set(yc(u))},f=()=>{const e=kn(l),t=le(e,e=>s.get().getByDom(e).fold(()=>[],YV));i.set(t)},p=t=>{const s=n,o=Mt(s[t.name()])?s[t.name()]:()=>{throw new Error("Could not find "+t.name()+" in "+JSON.stringify(e,null,2))};return o()},v=e=>Mt(n[e.name()]),b=()=>o.apis,j=e=>n[e]().map(e=>e.state.readState()).getOr("not enabled"),c={uid:e.uid,getSystem:s.get,config:p,hasConfigured:v,spec:e,readState:j,getApis:b,connect:h,disconnect:m,element:l,syncComponents:f,components:i.get,events:d};return c},zz=(e,t)=>{const n=f(e,"components").getOr([]);return t.fold(()=>a(n,Ye),e=>a(n,(t,n)=>ql(t,wo(e,n))))},Tz=(e,t)=>{const{events:s,...n}=JN(e),o=zz(n,t),i={...n,events:{...Np,...s},components:o};return _.value(Lz(i,t))},je=e=>{const t=c.fromText(e);return w5({element:t})},w5=t=>{const o=Je("external.component",wt([s("element"),D("uid")]),t),i=g(yc()),c=e=>{i.set(e)},d=()=>{i.set(yc(()=>r))},a=o.uid.getOrThunk(()=>xo("external"));vd(o.element,a);const r={uid:a,getSystem:i.get,config:e.none,hasConfigured:U,connect:c,disconnect:d,getApis:()=>({}),element:o.element,spec:t,readState:n("No state"),syncComponents:l,components:n([]),events:{}};return Jg(r)},Mz=xo,Sz=e=>R(e,"uid"),ql=(e,t)=>u5(e).getOrThunk(()=>{const n=Sz(e)?e:{uid:Mz(""),...e};return Tz(n,t).getOrDie()}),Ye=t=>ql(t,e.none()),tn=Jg;Xl=(t,n,s,o,i)=>t(s,o)?e.some(s):Mt(i)&&i(s)?e.none():n(s,o,i);const l5=(t,n,s)=>{let o=t.dom;const i=Mt(s)?s:U;for(;o.parentNode;){o=o.parentNode;const t=c.fromDom(o);if(n(t))return e.some(t);if(i(t))break}return e.none()},c5=(e,t,n)=>{const s=(e,t)=>t(e);return Xl(s,l5,e,t,n)},Az=(e,t)=>{const n=e=>t(c.fromDom(e)),s=se(e.dom.childNodes,n);return s.map(c.fromDom)},kz=(t,n)=>{const s=t=>{for(let o=0;o<t.childNodes.length;o++){const i=c.fromDom(t.childNodes[o]);if(n(i))return e.some(i);const a=s(t.childNodes[o]);if(a.isSome())return a}return e.none()};return s(t.dom)},Xg=(e,t,n)=>c5(e,t,n).isSome(),Cc=(e,t,n)=>l5(e,e=>Md(e,t),n),xz=(e,t)=>Az(e,e=>Md(e,t)),be=(e,t)=>uV(t,e),cn=(e,t,n)=>{const s=(e,t)=>Md(e,t);return Xl(s,Cc,e,t,n)},Zi="aria-controls",_z=e=>{const t=c5(e,e=>{if(!At(e))return!1;const t=De(e,"id");return t!==void 0&&t.indexOf(Zi)>-1});return t.bind(e=>{const t=De(e,"id"),n=Pt(e);return be(n,`[${Zi}="${t}"]`)})},fg=()=>{const e=d(Zi),t=t=>{w(t,Zi,e)},n=e=>{pe(e,Zi)};return{id:e,link:t,unlink:n}},jz=(e,t)=>_z(t).exists(t=>Zs(e,t)),Zs=(e,t)=>Xg(t,t=>Y(t,e.element),U)||jz(e,t),dg="unknown";(function(e){e[e.STOP=0]="STOP",e[e.NORMAL=1]="NORMAL",e[e.LOGGING=2]="LOGGING"})(Xo||(Xo={}));const md=g({}),bz=(e,t)=>{const n=[],s=(new Date).getTime();return{logEventCut:(e,t,s)=>{n.push({outcome:"cut",target:t,purpose:s})},logEventStopped:(e,t,s)=>{n.push({outcome:"stopped",target:t,purpose:s})},logNoParent:(e,t,s)=>{n.push({outcome:"no-parent",target:t,purpose:s})},logEventNoHandlers:(e,t)=>{n.push({outcome:"no-handlers-left",target:t})},logEventResponse:(e,t,s)=>{n.push({outcome:"response",purpose:s,target:t})},write:()=>{const o=(new Date).getTime();if(Oe(["mousemove","mouseover","mouseout",hr()],e))return;console.log(e,{event:e,time:o-s,target:t.dom,sequence:a(n,e=>Oe(["cut","stopped","response"],e.outcome)?"{"+e.purpose+"} "+e.outcome+" at ("+Ls(e.target)+")":e.outcome)})}}},vz=(t,n,s)=>{const o=f(md.get(),t).orThunk(()=>{const n=de(md.get());return En(n,n=>t.indexOf(n)>-1?e.some(md.get()[n]):e.none())}).getOr(Xo.NORMAL);switch(o){case Xo.NORMAL:return s(GT());case Xo.LOGGING:{const e=bz(t,n),o=s(e);return e.write(),o}case Xo.STOP:return!0}},pz=["alloy/data/Fields","alloy/debugging/Debugging"],mz=()=>{const e=new Error;if(e.stack!==void 0){const t=e.stack.split(`
`);return se(t,e=>e.indexOf("alloy")>0&&!vn(pz,t=>e.indexOf(t)>-1)).getOr(dg)}return dg},JT={logEventCut:l,logEventStopped:l,logNoParent:l,logEventNoHandlers:l,logEventResponse:l,write:l},jd=(e,t,n)=>vz(e,t,n),GT=n(JT),Kp=n([s("menu"),s("selectedMenu")]),wd=n([s("item"),s("selectedItem")]);n(m(wd().concat(Kp())));const UT=n(m(wd())),VT=ys("initSize",[s("numColumns"),s("numRows")]),zT=()=>Ot("markers",UT()),hc=()=>ys("markers",[s("backgroundMenu")].concat(Kp()).concat(wd())),go=e=>ys("markers",a(e,s)),lc=(e,t,n)=>(mz(),Me(t,t,n,wi(e=>_.value((...t)=>e.apply(void 0,t))))),E=e=>lc("onHandler",e,Vr(l)),rt=t=>lc("onKeyboardHandler",t,Vr(e.none)),Vs=e=>lc("onHandler",e,ln()),Td=e=>lc("onKeyboardHandler",e,ln()),W=(e,t)=>Xe(e,n(t)),Sp=e=>Xe(e,z),kp=n(VT),Te=(e,t,n,s,o,i,a,r=!1)=>({x:e,y:t,bubble:n,direction:s,placement:o,restriction:i,label:`${a}-${o}`,alwaysFit:r}),Ms=Lt.generate([{southeast:[]},{southwest:[]},{northeast:[]},{northwest:[]},{south:[]},{north:[]},{east:[]},{west:[]}]),MT=(e,t,n,s,o,i,a,r,c)=>e.fold(t,n,s,o,i,a,r,c),ST=(e,t,n,s)=>e.fold(t,t,s,s,t,s,n,n),AT=(e,t,n,s)=>e.fold(t,s,t,s,n,n,t,s),Xr=Ms.southeast,Vd=Ms.southwest,$d=Ms.northeast,Wd=Ms.northwest,q6=Ms.south,U6=Ms.north,D6=Ms.east,x6=Ms.west,$o=(e,t,n,s)=>{const o=e+t;return o>s?n:o<n?s:o},Nt=(e,t,n)=>Math.min(Math.max(e,t),n),kT=(e,t)=>{switch(t){case 1:return e.x;case 0:return e.x+e.width;case 2:return e.y;case 3:return e.y+e.height}},Ee=(e,t)=>D7(["left","right","top","bottom"],n=>f(t,n).map(t=>kT(e,t))),ET=(e,t,n)=>{const s=(s,o)=>t[s].map(t=>{const i=s==="top"||s==="bottom",r=i?n.top:n.left,c=s==="left"||s==="top"?Math.max:Math.min,a=c(t,o)+r;return i?Nt(a,e.y,e.bottom):Nt(a,e.x,e.right)}).getOr(o),o=s("left",e.x),i=s("top",e.y),a=s("right",e.right),r=s("bottom",e.bottom);return Be(o,i,a-o,r-i)},fs="layout",Xf=e=>e.x,$f=(e,t)=>e.x+e.width/2-t.width/2,Vf=(e,t)=>e.x+e.width-t.width,ou=(e,t)=>e.y-t.height,iu=e=>e.y+e.height,Pf=(e,t)=>e.y+e.height/2-t.height/2,xT=e=>e.x+e.width,OT=(e,t)=>e.x-t.width,Ne=(e,t,n)=>Te(Xf(e),iu(e),n.southeast(),Xr(),"southeast",Ee(e,{left:1,top:3}),fs),Le=(e,t,n)=>Te(Vf(e,t),iu(e),n.southwest(),Vd(),"southwest",Ee(e,{right:0,top:3}),fs),Qe=(e,t,n)=>Te(Xf(e),ou(e,t),n.northeast(),$d(),"northeast",Ee(e,{left:1,bottom:2}),fs),tt=(e,t,n)=>Te(Vf(e,t),ou(e,t),n.northwest(),Wd(),"northwest",Ee(e,{right:0,bottom:2}),fs),pt=(e,t,n)=>Te($f(e,t),ou(e,t),n.north(),U6(),"north",Ee(e,{bottom:2}),fs),Ce=(e,t,n)=>Te($f(e,t),iu(e),n.south(),q6(),"south",Ee(e,{top:3}),fs),pu=(e,t,n)=>Te(xT(e),Pf(e,t),n.east(),D6(),"east",Ee(e,{left:0}),fs),gu=(e,t,n)=>Te(OT(e,t),Pf(e,t),n.west(),x6(),"west",Ee(e,{right:1}),fs),B8=()=>[Ne,Le,Qe,tt,Ce,pt,pu,gu],M8=()=>[Le,Ne,tt,Qe,Ce,pt,pu,gu],E8=()=>[Qe,tt,Ne,Le,pt,Ce],O8=()=>[tt,Qe,Le,Ne,pt,Ce],_u=()=>[Ne,Le,Qe,tt,Ce,pt],wu=()=>[Le,Ne,tt,Qe,Ce,pt],jT=(e,t)=>t.universal?e:q(e,e=>Oe(t.channels,e)),vT=e=>$([o(ao(),(t,n)=>{const s=e.channels,i=de(s),o=n,a=jT(i,o);h(a,e=>{const n=s[e],i=n.schema,a=Je("channel["+e+`] data
Receiver: `+Ls(t.element),i,o.data);n.onReceive(t,a)})})]);a8=Object.freeze({__proto__:null,events:vT}),i8=[Ot("channels",n2(_.value,wt([Vs("onReceive"),t("schema",yn())])))];const gT=(e,t,n)=>Jn(s=>{n(s,e,t)}),Au=(e,t,n)=>KL((s)=>{n(s,e,t)}),pT=(e,t,n,s,o,i)=>{const a=wt(e),r=vt(t,[rP("config",e)]);return Ym(a,r,t,n,s,o,i)},uT=(e,t,n,s,o,i)=>{const a=e,r=vt(t,[is("config",e)]);return Ym(a,r,t,n,s,o,i)},cT=(e,t,s)=>{const o=(o,...i)=>{const a=[o].concat(i);return o.config({name:n(e)}).fold(()=>{throw new Error("We could not find any behaviour configuration for: "+e+". Using API: "+s)},e=>{const n=Array.prototype.slice.call(a,1);return t.apply(void 0,[o,e.config,e.state].concat(n))})};return UN(o,s,t)},rT=e=>({key:e,value:void 0}),Ym=(t,s,o,i,a,r,c)=>{const l=t=>Vt(t,o)?t[o]():e.none(),u=_e(a,(e,t)=>cT(o,e,t)),h=_e(r,(e,t)=>od(e,t)),d={...h,...u,revoke:Tt(rT,o),config:e=>{const n=Je(o+"-config",t,e);return{key:o,value:{config:n,me:d,configAsRaw:hs(()=>Je(o+"-config",t,e)),initialConfig:e,state:c}}},schema:n(s),exhibit:(e,t)=>rr(l(e),f(i,"exhibit"),(e,n)=>n(t,e.config,e.state)).getOrThunk(()=>sn({})),name:n(o),handlers:e=>l(e).map(e=>{const t=f(i,"events").getOr(()=>({}));return t(e.config,e.state)}).getOr({})};return d},i=e=>Po(e),aT=wt([s("fields"),s("name"),t("active",{}),t("apis",{}),t("state",un),t("extra",{})]),xe=e=>{const t=Je("Creating behaviour: "+e.name,aT,e);return pT(t.fields,t.name,t.active,t.apis,t.extra,t.state)},sT=wt([s("branchKey"),s("branches"),s("name"),t("active",{}),t("apis",{}),t("state",un),t("extra",{})]),Em=e=>{const t=Je("Creating behaviour: "+e.name,sT,e);return uT(yt(t.branchKey,t.branches),t.name,t.active,t.apis,t.extra,t.state)},eT=n(void 0),It=xe({fields:i8,name:"receiving",active:a8}),JF=(e,t)=>sn({classes:[],styles:t.useFixed()?{}:{position:"relative"}});lm=Object.freeze({__proto__:null,exhibit:JF});const es=e=>e.dom.focus(),QF=e=>e.dom.blur(),om=e=>{const t=Pt(e).dom;return e.dom===t.activeElement},cs=(t=Hu())=>e.from(t.dom.activeElement).map(c.fromDom),rn=e=>cs(Pt(e)).filter(t=>e.dom.contains(t.dom)),Yu=(t,n)=>{const s=Pt(n),o=cs(s).bind(t=>{const s=e=>Y(t,e);return s(n)?e.some(n):kz(n,s)}),i=t(n);return o.each(e=>{cs(s).filter(t=>Y(t,e)).fold(()=>{es(e)},l)}),i},wn=(e,t,n,s,o)=>{const i=e=>e+"px";return{position:e,left:t.map(i),top:n.map(i),right:s.map(i),bottom:o.map(i)}},UF=t=>({...t,position:e.some(t.position)}),Wh=(e,t)=>{Zc(e,UF(t))},Zu=Lt.generate([{none:[]},{relative:["x","y","width","height"]},{fixed:["x","y","width","height"]}]),$h=(t,n,s,o,i,a)=>{const d=n.rect,m=d.x-s,f=d.y-o,p=d.width,g=d.height,v=i-(m+p),b=a-(f+g),c=e.some(m),l=e.some(f),u=e.some(v),h=e.some(b),r=e.none();return MT(n.direction,()=>wn(t,c,l,r,r),()=>wn(t,r,l,u,r),()=>wn(t,c,r,r,h),()=>wn(t,r,r,u,h),()=>wn(t,c,l,r,r),()=>wn(t,c,r,r,h),()=>wn(t,c,l,r,r),()=>wn(t,r,l,u,r))},Ph=(t,n)=>t.fold(()=>{const t=n.rect;return wn("absolute",e.some(t.x),e.some(t.y),e.none(),e.none())},(e,t,s,o)=>$h("absolute",n,e,t,s,o),(e,t,s,o)=>$h("fixed",n,e,t,s,o)),t1=(e,t)=>{const n=Tt($u,t),s=e.fold(n,n,()=>{const e=Cn();return $u(t).translate(-e.left,-e.top)}),o=fa(t),i=to(t);return Be(s.left,s.top,o,i)},WF=(e,t)=>t.fold(()=>e.fold(Sn,Sn,Be),t=>e.fold(t,t,()=>{const n=t(),s=Th(e,n.x,n.y);return Be(s.left,s.top,n.width,n.height)})),Th=(e,t,s)=>{const o=Z(t,s),i=()=>{const e=Cn();return o.translate(-e.left,-e.top)};return e.fold(n(o),n(o),i)},$F=(e,t,n,s)=>e.fold(t,n,s);Zu.none;const NF=Zu.relative,zF=Zu.fixed,MF=(e,t)=>({anchorBox:e,origin:t}),SF=(e,t)=>MF(e,t),l1="data-alloy-placement",kF=(e,t)=>{w(e,l1,t)},fh=e=>ut(e,l1),EF=e=>pe(e,l1),ur=Lt.generate([{fit:["reposition"]},{nofit:["reposition","visibleW","visibleH","isVisible"]}]),wF=(e,t)=>{const{x:n,y:s,right:a,bottom:r}=t,{x:o,y:i,right:c,bottom:l,width:d,height:u}=e,h=o>=n&&o<=a,m=i>=s&&i<=r,f=h&&m,p=c<=a&&c>=n,g=l<=r&&l>=s,v=p&&g,b=Math.min(d,o>=n?a-o:c-n),j=Math.min(u,i>=s?r-i:l-s);return{originInBounds:f,sizeInBounds:v,visibleW:b,visibleH:j}},_F=(e,t)=>{const{x:a,y:l,right:c,bottom:i}=t,{x:d,y:u,width:o,height:r}=e,h=Math.max(a,c-o),m=Math.max(l,i-r),n=Nt(d,a,h),s=Nt(u,l,m),f=Math.min(n+o,c)-n,p=Math.min(s+r,i)-s;return Be(n,s,f,p)},uF=(e,t,s)=>{const a=n(t.bottom-s.y),o=n(s.bottom-t.y),r=ST(e,o,o,a),c=n(t.right-s.x),i=n(s.right-t.x),l=AT(e,i,i,c);return{maxWidth:l,maxHeight:r}},rF=(e,t,n,s)=>{const i=e.bubble,a=i.offset,c=ET(s,e.restriction,a),j=e.x+a.left,d=e.y+a.top,r=Be(j,d,t,n),{originInBounds:p,sizeInBounds:f,visibleW:h,visibleH:m}=wF(r,c),u=p&&f,o=u?r:_F(r,c),g=o.width>0&&o.height>0,{maxWidth:v,maxHeight:b}=uF(e.direction,o,s),l={rect:o,maxHeight:b,maxWidth:v,direction:e.direction,placement:e.placement,classes:{on:i.classesOn,off:i.classesOff},layout:e.label,testY:d};return u||e.alwaysFit?ur.fit(l):ur.nofit(l,h,m,g)},iF=(e,t,s,o,i,a)=>{const r=o.width,c=o.height,l=(t,l,d,u,h)=>{const f=t(s,o,i,e,a),m=rF(f,r,c,a);return m.fold(n(m),(e,t,n,s)=>{const o=h===s?n>u||t>d:!h&&s;return o?m:ur.nofit(l,d,u,h)})},d=He(t,(e,t)=>{const s=Tt(l,t);return e.fold(n(e),s)},ur.nofit({rect:s,maxHeight:o.height,maxWidth:o.width,direction:Xr(),placement:"southeast",classes:{on:[],off:[]},layout:"none",testY:s.y},-1,-1,!1));return d.fold(z,z)},j1=t=>{const n=g(e.none()),s=()=>n.get().each(t),o=()=>{s(),n.set(e.none())},i=()=>n.get().isSome(),a=()=>n.get(),r=t=>{s(),n.set(e.some(t))};return{clear:o,isSet:i,get:a,set:r}},oF=()=>j1(e=>e.destroy()),Qo=()=>j1(e=>e.unbind()),K=()=>{const e=j1(l),t=t=>e.get().each(t);return{...e,on:t}},nh=ye,qe=(e,t,n)=>OB(e,t,nh,n),th=(e,t,n)=>jB(e,t,nh,n),eh=Gm,Z3=["top","bottom","right","left"],Ia="data-alloy-transition-timer",sF=(e,t)=>ED(e,t.classes),tF=(e,t,n)=>n.exists(n=>{const s=e.mode;return s==="all"||n[s]!==t[s]}),eF=(e,t)=>{const n=e=>parseFloat(e).toFixed(3);return Dl(t,(t,s)=>{const o=e[s].map(n),i=t.map(n);return!WV(o,i)}).isSome()},QM=e=>{const t=t=>{const n=ft(e,t),s=n.split(/\s*,\s*/);return q(s,Zl)},n=e=>{if(L(e)&&/^[\d.]+/.test(e)){const t=parseFloat(e);return _r(e,"ms")?t:t*1e3}return 0},s=t("transition-delay"),o=t("transition-duration");return He(o,(e,t,o)=>{const i=n(s[o])+n(t);return Math.max(e,i)},0)},qM=(e,t)=>{const o=Qo(),i=Qo();let n;const a=t=>{var n;const s=(n=t.raw.pseudoElement)!==null&&n!==void 0?n:"";return Y(t.target,e)&&FV(s)&&Oe(Z3,t.raw.propertyName)},s=s=>{if(xc(s)||a(s)){o.clear(),i.clear();const a=s?.raw.type;(xc(a)||a===Xi())&&(clearTimeout(n),pe(e,Ia),On(e,t.classes))}},r=qe(e,wR(),t=>{a(t)&&(r.unbind(),o.set(qe(e,Xi(),s)),i.set(qe(e,OR(),s)))}),c=QM(e);requestAnimationFrame(()=>{n=setTimeout(s,c+17),w(e,Ia,n)})},KM=(e,t)=>{qs(e,t.classes),ut(e,Ia).each(t=>{clearTimeout(parseInt(t,10)),pe(e,Ia)}),qM(e,t)},Qv=(e,t,n,s,o,i)=>{const a=tF(s,o,i);if(a||sF(e,s)){y(e,"position",n.position);const r=t1(t,e),c=Ph(t,{...o,rect:r}),i=D7(Z3,e=>c[e]);eF(n,i)&&(Zc(e,i),a&&KM(e,s),wa(e))}else On(e,s.classes)},PM=e=>({width:fa(e),height:to(e)}),LM=(e,t,n,s)=>{B(t,"max-height"),B(t,"max-width");const o=PM(t);return iF(t,s.preference,e,o,n,s.bounds)},NM=(e,t)=>{const n=t.classes;On(e,n.off),qs(e,n.on)},DM=(e,t,n)=>{const s=n.maxHeightFunction;s(e,t.maxHeight)},zM=(e,t,n)=>{const s=n.maxWidthFunction;s(e,t.maxWidth)},TM=(e,t,n)=>{const s=Ph(n.origin,t);n.transition.each(o=>{Qv(e,n.origin,s,o,t,n.lastPlacement)}),Wh(e,s)},FM=(e,t)=>{kF(e,t.placement)},u3=(e,t)=>{eV(e,Math.floor(t))},MM=n((e,t)=>{u3(e,t),ko(e,{"overflow-x":"hidden","overflow-y":"auto"})}),Ea=n((e,t)=>{u3(e,t)}),n3=(e,t,n)=>e[t]===void 0?n:e[t],EM=(e,t,n,s,o,i,a,r)=>{const d=n3(a,"maxHeightFunction",MM()),u=n3(a,"maxWidthFunction",l),h=e.anchorBox,c=e.origin,m={bounds:WF(c,i),origin:c,preference:s,maxHeightFunction:d,maxWidthFunction:u,lastPlacement:o,transition:r};return wM(h,t,n,m)},wM=(e,t,n,s)=>{const o=LM(e,t,n,s);return TM(t,o,s),FM(t,o),NM(t,o),DM(t,o,s),zM(t,o,s),{layout:o.layout,placement:o.placement}},gM=["valignCentre","alignLeft","alignRight","alignCentre","top","bottom","left","right","inset"],To=(e,t,n,s=1)=>{const i=e*s,a=t*s,r=e=>f(n,e).getOr([]),o=(e,t,n)=>{const s=uo(gM,n);return{offset:Z(e,t),classesOn:le(n,r),classesOff:le(s,r)}};return{southeast:()=>o(-e,t,["top","alignLeft"]),southwest:()=>o(e,t,["top","alignRight"]),south:()=>o(-e/2,t,["top","alignCentre"]),northeast:()=>o(-e,-t,["bottom","alignLeft"]),northwest:()=>o(e,-t,["bottom","alignRight"]),north:()=>o(-e/2,-t,["bottom","alignCentre"]),east:()=>o(e,-t/2,["valignCentre","left"]),west:()=>o(-e,-t/2,["valignCentre","right"]),insetNortheast:()=>o(i,a,["top","alignLeft","inset"]),insetNorthwest:()=>o(-i,a,["top","alignRight","inset"]),insetNorth:()=>o(-i/2,a,["top","alignCentre","inset"]),insetSoutheast:()=>o(i,-a,["bottom","alignLeft","inset"]),insetSouthwest:()=>o(-i,-a,["bottom","alignRight","inset"]),insetSouth:()=>o(-i/2,-a,["bottom","alignCentre","inset"]),insetEast:()=>o(-i,-a/2,["valignCentre","right","inset"]),insetWest:()=>o(i,-a/2,["valignCentre","left","inset"])}},Wa=()=>To(0,0,{}),Ua=z,el=(e,t)=>n=>pM(n)==="rtl"?t:e,pM=e=>ft(e,"direction")==="rtl"?"rtl":"ltr";(function(e){e.TopToBottom="toptobottom",e.BottomToTop="bottomtotop"})(rs||(rs={}));const n4="data-alloy-vertical-dir",lM=e=>Xg(e,e=>At(e)&&De(e,"data-alloy-vertical-dir")===rs.BottomToTop),Ns=()=>vt("layouts",[s("onLtr"),s("onRtl"),D("onBottomLtr"),D("onBottomRtl")]),Ya=(e,t,n,s,o,i,a)=>{const r=a.map(lM).getOr(!1),c=t.layouts.map(t=>t.onLtr(e)),l=t.layouts.map(t=>t.onRtl(e)),d=r?t.layouts.bind(t=>t.onBottomLtr.map(t=>t(e))).or(c).getOr(o):c.getOr(n),u=r?t.layouts.bind(t=>t.onBottomRtl.map(t=>t(e))).or(l).getOr(i):l.getOr(s),h=el(d,u);return h(e)},cM=(t,n,s)=>{const o=n.hotspot,i=t1(s,o.element),a=Ya(t.element,n,_u(),wu(),E8(),O8(),e.some(n.hotspot.element));return e.some(Ua({anchorBox:i,bubble:n.bubble.getOr(Wa()),overrides:n.overrides,layouts:a,placer:e.none()}))};y2=[s("hotspot"),D("bubble"),t("overrides",{}),Ns(),W("placement",cM)];const rM=(t,n,s)=>{const o=Th(s,n.x,n.y),i=Be(o.left,o.top,n.width,n.height),a=Ya(t.element,n,B8(),M8(),B8(),M8(),e.none());return e.some(Ua({anchorBox:i,bubble:n.bubble,overrides:n.overrides,layouts:a,placer:e.none()}))};g2=[s("x"),s("y"),t("height",0),t("width",0),t("bubble",Wa()),t("overrides",{}),Ns(),W("placement",rM)];const m2=Lt.generate([{screen:["point"]},{absolute:["point","scrollLeft","scrollTop"]}]),aM=e=>e.fold(z,(e,t,n)=>e.translate(-t,-n)),oM=e=>e.fold(z,z),d2=e=>He(e,(e,t)=>e.translate(t.left,t.top),Z(0,0)),sM=e=>{const t=a(e,aM);return d2(t)},Z0=e=>{const t=a(e,oM);return d2(t)},nM=m2.screen,tM=m2.absolute,eM=(t,n,s)=>{const o=bi(s.root).dom,i=e=>{const n=an(e),s=an(t.element);return Y(n,s)};return e.from(o.frameElement).map(c.fromDom).filter(i).map(zs)},p0=(e,t,n)=>{const o=an(e.element),s=Cn(o),i=eM(e,t,n).getOr(s);return tM(i,s.left,s.top)},t0=(t,n,s,o)=>{const i=nM(Z(t,n));return e.some(cB(i,s,o))},X4=(t,n,s,o,i)=>t.map(t=>{const a=[n,t.point],r=$F(o,()=>Z0(a),()=>Z0(a),()=>sM(a)),d=rB(r.left,r.top,t.width,t.height),c=s.showAbove?E8():_u(),l=s.showAbove?O8():wu(),u=Ya(i,s,c,l,c,l,e.none());return Ua({anchorBox:d,bubble:s.bubble.getOr(Wa()),overrides:s.overrides,layouts:u,placer:e.none()})}),JS=(e,t,n)=>{const s=p0(e,n,t);return t.node.filter(Xt).bind(o=>{const i=o.dom.getBoundingClientRect(),a=t0(i.left,i.top,i.width,i.height),r=t.node.getOr(e.element);return X4(a,s,t,n,r)})};$4=[s("node"),s("root"),D("bubble"),Ns(),t("overrides",{}),t("showAbove",!1),W("placement",JS)];const QS="﻿",XS="\xA0",YS=(e,t,n,s)=>({start:e,soffset:t,finish:n,foffset:s}),k4={create:YS},A4=Lt.generate([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),WS=(e,t,n,s)=>e.fold(t,n,s),$S=e=>e.fold(z,z,z),IS=A4.before,HS=A4.on,PS=A4.after,zS={before:IS,on:HS,after:PS,cata:WS,getStart:$S},Ga=Lt.generate([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),FS=e=>Ga.exact(e.start,e.soffset,e.finish,e.foffset),MS=e=>e.match({domRange:e=>c.fromDom(e.startContainer),relative:(e)=>zS.getStart(e),exact:(e)=>e}),xS=Ga.domRange,OS=Ga.relative,wS=Ga.exact,_S=e=>{const t=MS(e);return bi(t)},yS=k4.create,la={domRange:xS,relative:OS,exact:wS,exactFromRange:FS,getWin:_S,range:yS},vS=(e,t)=>{t.fold(t=>{e.setStartBefore(t.dom)},(t,n)=>{e.setStart(t.dom,n)},t=>{e.setStartAfter(t.dom)})},mS=(e,t)=>{t.fold(t=>{e.setEndBefore(t.dom)},(t,n)=>{e.setEnd(t.dom,n)},t=>{e.setEndAfter(t.dom)})},K4=(e,t,n)=>{const s=e.document.createRange();return vS(s,t),mS(s,n),s},q4=(e,t,n,s,o)=>{const i=e.document.createRange();return i.setStart(t.dom,n),i.setEnd(s.dom,o),i},Y4=e=>({left:e.left,top:e.top,right:e.right,bottom:e.bottom,width:e.width,height:e.height}),hS=t=>{const s=t.getClientRects(),n=s.length>0?s[0]:t.getBoundingClientRect();return n.width>0||n.height>0?e.some(n).map(Y4):e.none()},iS=t=>{const n=t.getBoundingClientRect();return n.width>0||n.height>0?e.some(n).map(Y4):e.none()},Qi=Lt.generate([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),Z4=(e,t,n)=>t(c.fromDom(n.startContainer),n.startOffset,c.fromDom(n.endContainer),n.endOffset),oS=(t,s)=>s.match({domRange:t=>({ltr:n(t),rtl:e.none}),relative:(n,s)=>({ltr:hs(()=>K4(t,n,s)),rtl:hs(()=>e.some(K4(t,s,n)))}),exact:(n,s,o,i)=>({ltr:hs(()=>q4(t,n,s,o,i)),rtl:hs(()=>e.some(q4(t,o,i,n,s)))})}),ZA=(e,t)=>{const n=t.ltr();if(n.collapsed){const s=t.rtl().filter(e=>e.collapsed===!1);return s.map(e=>Qi.rtl(c.fromDom(e.endContainer),e.endOffset,c.fromDom(e.startContainer),e.startOffset)).getOrThunk(()=>Z4(e,Qi.ltr,n))}return Z4(e,Qi.ltr,n)},YA=(e,t)=>{const n=oS(e,t);return ZA(e,n)},n0=(e,t)=>{const n=YA(e,t);return n.match({ltr:(t,n,s,o)=>{const i=e.document.createRange();return i.setStart(t.dom,n),i.setEnd(s.dom,o),i},rtl:(t,n,s,o)=>{const i=e.document.createRange();return i.setStart(s.dom,o),i.setEnd(t.dom,n),i}})};Qi.ltr,Qi.rtl;const Ue=(e,t)=>hV(t,e),KA=(e,t,n,s)=>{const i=an(e),o=i.dom.createRange();return o.setStart(e.dom,t),o.setEnd(n.dom,s),o},VA=(e,t,n,s)=>{const o=KA(e,t,n,s),i=Y(e,n)&&t===s;return o.collapsed&&!i},BA=t=>e.from(t.getSelection()),r0=t=>{if(t.rangeCount>0){const n=t.getRangeAt(0),s=t.getRangeAt(t.rangeCount-1);return e.some(k4.create(c.fromDom(n.startContainer),n.startOffset,c.fromDom(s.endContainer),s.endOffset))}return e.none()},HA=t=>{if(t.anchorNode===null||t.focusNode===null)return r0(t);const n=c.fromDom(t.anchorNode),s=c.fromDom(t.focusNode);return VA(n,t.anchorOffset,s,t.focusOffset)?e.some(k4.create(n,t.anchorOffset,s,t.focusOffset)):r0(t)},PA=e=>BA(e).filter(e=>e.rangeCount>0).bind(HA),d0=(e,t)=>{const n=n0(e,t);return hS(n)},RA=(e,t)=>{const n=n0(e,t);return iS(n)},EA=(t,n)=>{const o=e=>{if(!t(e))throw new Error("Can only get "+n+" value of a "+n+" node");return s(e).getOr("")},s=n=>t(n)?e.from(n.dom.nodeValue):e.none(),i=(e,s)=>{if(!t(e))throw new Error("Can only set raw "+n+" value of a "+n+" node");e.dom.nodeValue=s};return{get:o,getOption:s,set:i}},CA=EA(ro,"text"),_A=e=>CA.get(e),or=(e,t)=>({element:e,offset:t}),bA=(e,t)=>{const n=kn(e);if(n.length===0)return or(e,t);if(t<n.length)return or(n[t],0);const s=n[n.length-1],o=ro(s)?_A(s).length:kn(s).length;return or(s,o)},v0=(e,t)=>ro(e)?or(e,t):bA(e,t),b0=(e,t)=>{const n=t.getSelection.getOrThunk(()=>()=>PA(e));return n().map(e=>{const t=v0(e.start,e.soffset),n=v0(e.finish,e.foffset);return la.range(t.element,t.offset,n.element,n.offset)})},pA=(t,n,s)=>{const o=bi(n.root).dom,i=p0(t,s,n),a=b0(o,n).bind(e=>{const t=RA(o,la.exactFromRange(e)).orThunk(()=>{const t=c.fromText(QS);Ei(e.start,t);const n=d0(o,la.exact(t,0,t,1));return Bn(t),n});return t.bind(e=>t0(e.left,e.top,e.width,e.height))}),r=b0(o,n).bind(t=>At(t.start)?e.some(t.start):Ii(t.start)),l=r.getOr(t.element);return X4(a,i,n,s,l)};y0=[D("getSelection"),s("root"),D("bubble"),Ns(),t("overrides",{}),t("showAbove",!1),W("placement",pA)];const ar="link-layout",w0=e=>e.x+e.width,O0=(e,t)=>e.x-t.width,x0=(e,t)=>e.y-t.height+e.height,C0=e=>e.y,E0=(e,t,n)=>Te(w0(e),C0(e),n.southeast(),Xr(),"southeast",Ee(e,{left:0,top:2}),ar),k0=(e,t,n)=>Te(O0(e,t),C0(e),n.southwest(),Vd(),"southwest",Ee(e,{right:1,top:2}),ar),A0=(e,t,n)=>Te(w0(e),x0(e,t),n.northeast(),$d(),"northeast",Ee(e,{left:0,bottom:3}),ar),S0=(e,t,n)=>Te(O0(e,t),x0(e,t),n.northwest(),Wd(),"northwest",Ee(e,{right:1,bottom:3}),ar),M0=()=>[E0,k0,A0,S0],F0=()=>[k0,E0,S0,A0],uA=(t,n,s)=>{const o=t1(s,n.item.element),i=Ya(t.element,n,M0(),F0(),M0(),F0(),e.none());return e.some(Ua({anchorBox:o,bubble:Wa(),overrides:n.overrides,layouts:i,placer:e.none()}))};z0=[s("item"),Ns(),t("overrides",{}),W("placement",uA)],D0=yt("type",{selection:y0,node:$4,hotspot:y2,submenu:z0,makeshift:g2});const dA=[xt("classes",Ae),Kn("mode","all",["all","layout","placement"])],cA=[t("useFixed",U),D("getBounds")],aA=[Ot("anchor",D0),vt("transition",dA)],tA=()=>{const e=document.documentElement;return zF(0,0,e.clientWidth,e.clientHeight)},eA=e=>{const t=zs(e.element),n=e.element.dom.getBoundingClientRect();return NF(t.left,t.top,n.width,n.height)},Jk=(e,t,n,s,o,i,a)=>{const r=SF(n.anchorBox,t);return EM(r,o.element,n.bubble,n.layouts,i,s,n.overrides,a)},Hk=(t,n,s,o,i)=>{V0(t,n,s,o,i,e.none())},V0=(e,t,n,s,o,i)=>{const a=i.map(at);return $0(e,t,n,s,o,a)},$0=(e,t,s,o,i,a)=>{const c=Je("placement.info",m(aA),i),l=c.anchor,r=o.element,d=s.get(o.uid);Yu(()=>{y(r,"position","fixed");const u=Re(r,"visibility");y(r,"visibility","hidden");const i=t.useFixed()?tA():eA(e),h=l.placement,m=a.map(n).or(t.getBounds);h(e,l,i).each(t=>{const n=t.placer.getOr(Jk),a=n(e,i,t,m,o,d,c.transition);s.set(o.uid,a)}),u.fold(()=>{B(r,"visibility")},e=>{y(r,"visibility",e)}),Re(r,"left").isNone()&&Re(r,"top").isNone()&&Re(r,"right").isNone()&&Re(r,"bottom").isNone()&&hn(Re(r,"position"),"fixed")&&B(r,"position")},r)},Lk=(e,t)=>t.useFixed()?"fixed":"absolute",Dk=(e,t,n,s)=>{const o=s.element;h(["position","left","right","top","bottom"],e=>B(o,e)),EF(o),n.clear(s.uid)};K0=Object.freeze({__proto__:null,position:Hk,positionWithin:V0,positionWithinBounds:$0,getMode:Lk,reset:Dk});const zk=()=>{let e={};const t=(t,n)=>{e[t]=n},n=t=>f(e,t),s=t=>{en(t)?delete e[t]:e={}};return jt({readState:()=>e,clear:s,set:t,get:n})};Y0=Object.freeze({__proto__:null,init:zk});const Ke=xe({fields:cA,name:"positioning",active:lm,apis:K0,state:Y0}),g4=e=>e.getSystem().isConnected(),Mi=e=>{T(e,hi());const t=e.components();h(t,Mi)},xi=e=>{const t=e.components();h(t,xi),T(e,no())},J0=(e,t)=>{e.getSystem().addToWorld(t),Xt(e.element)&&xi(t)},f4=e=>{Mi(e),e.getSystem().removeFromWorld(e)},t2=(e,t)=>{Jt(e.element,t.element)},Tk=e=>{h(e.components(),e=>Bn(e.element)),Lu(e.element),e.syncComponents()},Fk=(e,t,n)=>{const o=e.components();Tk(e);const s=n(t),i=uo(o,s);h(i,t=>{Mi(t),e.getSystem().removeFromWorld(t)}),h(s,t=>{g4(t)?t2(e,t):(e.getSystem().addToWorld(t),t2(e,t),Xt(e.element)&&xi(t))}),e.syncComponents()},Mk=(e,t,n)=>{const s=e.components(),i=le(t,e=>u5(e).toArray());h(s,e=>{Oe(i,e)||f4(e)});const o=n(t),a=uo(s,o);h(a,e=>{g4(e)&&f4(e)}),h(o,t=>{g4(t)||J0(e,t)}),e.syncComponents()},Us=(e,t)=>{a2(e,t,Jt)},a2=(e,t,n)=>{e.getSystem().addToWorld(t),n(e.element,t.element),Xt(e.element)&&xi(t),e.syncComponents()},r2=e=>{Mi(e),Bn(e.element),e.getSystem().removeFromWorld(e)},Yn=e=>{const t=Rn(e.element).bind(t=>e.getSystem().getByDom(t).toOptional());r2(e),t.each(e=>{e.syncComponents()})},l2=e=>{const t=e.components();h(t,r2),Lu(e.element),e.syncComponents()},m4=(e,t)=>{h2(e,t,Jt)},Sk=(e,t)=>{h2(e,t,vB)},h2=(e,t,n)=>{n(e,t.element);const s=kn(t.element);h(s,e=>{t.getByDom(e).each(xi)})},Ak=e=>{const t=kn(e.element);h(t,t=>{e.getByDom(t).each(Mi)}),Bn(e.element)},f2=(e,t,n,s)=>{n.get().each(t=>{l2(e)});const i=t.getAttachPoint(e);Us(i,e);const o=e.getSystem().build(s);return Us(e,o),n.set(o),o},p2=(e,t,n,s)=>{const o=f2(e,t,n,s);return t.onOpen(e,o),o},kk=(e,t,n,s)=>n.get().map(()=>f2(e,t,n,s)),Ek=(e,t,n,s,o)=>{x2(e,t),p2(e,t,n,s),o(),E2(e,t)},b2=(e,t,n)=>{n.get().each(s=>{l2(e),Yn(e),t.onClose(e,s),n.clear()})},j2=(e,t,n)=>n.isOpen(),Ck=(e,t,n,s)=>j2(e,t,n)&&n.get().exists(n=>t.isPartOf(e,n,s)),xk=(e,t,n)=>n.get(),Ok=(e,t,n,s)=>{Re(e.element,t).fold(()=>{pe(e.element,n)},t=>{w(e.element,n,t)}),y(e.element,t,s)},wk=(e,t,n)=>{ut(e.element,n).fold(()=>B(e.element,t),n=>y(e.element,t,n))},x2=(e,t)=>{const s=t.getAttachPoint(e);y(e.element,"position",Ke.getMode(s)),Ok(e,"visibility",t.cloakVisibilityAttr,"hidden")},_k=e=>vn(["top","left","right","bottom"],t=>Re(e,t).isSome()),E2=(e,t)=>{_k(e.element)||B(e.element,"position"),wk(e,"visibility",t.cloakVisibilityAttr)};k2=Object.freeze({__proto__:null,cloak:x2,decloak:E2,open:p2,openWhileCloaked:Ek,close:b2,isOpen:j2,isPartOf:Ck,getState:xk,setContent:kk});const yk=(e,t)=>$([o(dr(),(n)=>{b2(n,e,t)})]);S2=Object.freeze({__proto__:null,events:yk}),M2=[E("onOpen"),E("onClose"),s("isPartOf"),s("getAttachPoint"),t("cloakVisibilityAttr","data-precloak-visibility")];const jk=()=>{const e=K(),t=n("not-implemented");return jt({readState:t,isOpen:e.isSet,clear:e.clear,set:e.set,get:e.get})};T2=Object.freeze({__proto__:null,init:jk});const k=xe({fields:M2,name:"sandboxing",active:S2,apis:k2,state:T2}),Es=n("dismiss.popups"),ei=n("reposition.popups"),e4=n("mouse.released"),bk=wt([t("isExtraPart",U),vt("fireEventInstead",[t("event",di())])]),Z1=e=>{const t=Je("Dismissal",bk,e);return{[Es()]:{schema:wt([s("target")]),onReceive:(e,n)=>{if(k.isOpen(e)){const s=k.isPartOf(e,n.target)||t.isExtraPart(e,n.target);s||t.fireEventInstead.fold(()=>k.close(e),t=>T(e,t.event))}}}}},vk=wt([vt("fireEventInstead",[t("event",Yh())]),Ht("doReposition")]),Q1=e=>{const t=Je("Reposition",vk,e);return{[ei()]:{onReceive:e=>{k.isOpen(e)&&t.fireEventInstead.fold(()=>t.doReposition(e),t=>T(e,t.event))}}}},X1=(e,t,n)=>{t.store.manager.onLoad(e,t,n)},V2=(e,t,n)=>{t.store.manager.onUnload(e,t,n)},mk=(e,t,n,s)=>{t.store.manager.setValue(e,t,n,s)},ak=(e,t,n)=>t.store.manager.getValue(e,t,n),ok=(e,t,n)=>n;K2=Object.freeze({__proto__:null,onLoad:X1,onUnload:V2,setValue:mk,getValue:ak,getState:ok});const QE=(e,t)=>{const n=e.resetOnDom?[J((n)=>{X1(n,e,t)}),Hn((n)=>{V2(n,e,t)})]:[Au(e,t,X1)];return $(n)};Y2=Object.freeze({__proto__:null,events:QE});const G2=()=>{const e=g(null),t=()=>({mode:"memory",value:e.get()}),n=()=>e.get()===null,s=()=>{e.set(null)};return jt({set:e.set,get:e.get,isNotSet:n,clear:s,readState:t})},YE=()=>{const e=l;return jt({readState:e})},Q2=()=>{const e=g({}),t=g({}),n=()=>({mode:"dataset",dataByValue:e.get(),dataByText:t.get()}),s=()=>{e.set({}),t.set({})},o=n=>f(e.get(),n).orThunk(()=>f(t.get(),n)),i=n=>{const i=e.get(),a=t.get(),s={},o={};h(n,e=>{s[e.value]=e,f(e,"meta").each(t=>{f(t,"text").each(t=>{o[t]=e})})}),e.set({...i,...s}),t.set({...a,...o})};return jt({readState:n,lookup:o,update:i,clear:s})},WE=e=>e.store.manager.state(e);J2=Object.freeze({__proto__:null,memory:G2,dataset:Q2,manual:YE,init:WE});const e3=(e,t,n,s)=>{const o=t.store;n.update([s]),o.setValue(e,s),t.onSetValue(e,s)},BE=(e,t,n)=>{const s=t.store,o=s.getDataKey(e);return n.lookup(o).getOrThunk(()=>s.getFallbackEntry(o))},IE=(e,t,n)=>{const s=t.store;s.initialValue.each(s=>{e3(e,t,n,s)})},HE=(e,t,n)=>{n.clear()};o3=[D("initialValue"),s("getFallbackEntry"),s("getDataKey"),s("setValue"),W("manager",{setValue:e3,getValue:BE,onLoad:IE,onUnload:HE,state:Q2})];const LE=(e,t)=>t.store.getValue(e),DE=(e,t,n,s)=>{t.store.setValue(e,s),t.onSetValue(e,s)},kE=(e,t)=>{t.store.initialValue.each(n=>{t.store.setValue(e,n)})};c3=[s("getValue"),t("setValue",l),D("initialValue"),W("manager",{setValue:DE,getValue:LE,onLoad:kE,onUnload:l,state:un.init})];const EE=(e,t,n,s)=>{n.set(s),t.onSetValue(e,s)},CE=(e,t,n)=>n.get(),yE=(e,t,n)=>{t.store.initialValue.each(e=>{n.isNotSet()&&n.set(e)})},vE=(e,t,n)=>{n.clear()};m3=[D("initialValue"),W("manager",{setValue:EE,getValue:CE,onLoad:yE,onUnload:vE,state:G2})],f3=[Rt("store",{mode:"memory"},yt("mode",{memory:m3,manual:c3,dataset:o3})),E("onSetValue"),t("resetOnDom",!1)];const r=xe({fields:f3,name:"representing",active:Y2,apis:K2,extra:{setValueFrom:(e,t)=>{const n=r.getValue(t);r.setValue(e,n)}},state:J2}),ve=(e,t)=>O4(e,{},a(t,t=>cP(t.name(),"Cannot configure "+t.name()+" for "+e)).concat([Xe("dump",z)])),Ar=e=>e.dump,we=(e,t)=>({...i(t),...e.dump}),$t={field:ve,augment:we,get:Ar},y3="placeholder",Tr=Lt.generate([{single:["required","valueThunk"]},{multiple:["required","valueThunks"]}]),I1=e=>R(e,"uiType"),gE=(e,t,s,o)=>e.exists(e=>e!==s.owner)?Tr.single(!0,n(s)):f(o,s.name).fold(()=>{throw new Error("Unknown placeholder component: "+s.name+`
Known: [`+de(o)+`]
Namespace: `+e.getOr("none")+`
Spec: `+JSON.stringify(s,null,2))},e=>e.replace()),pE=(e,t,s,o)=>I1(s)&&s.uiType===y3?gE(e,t,s,o):Tr.single(!1,n(s)),C3=(e,t,n,s)=>{const o=pE(e,t,n,s);return o.fold((o,i)=>{const a=I1(n)?i(t,n.config,n.validated):i(t),r=f(a,"components").getOr([]),c=le(r,n=>C3(e,t,n,s));return[{...a,components:c}]},(e,s)=>{if(I1(n)){const e=s(t,n.config,n.validated),o=n.validated.preprocess.getOr(z);return o(e)}return s(t)})},fE=(e,t,n,s)=>le(n,n=>C3(e,t,n,s)),mE=(e,t)=>{let s=!1;const o=()=>s,i=()=>{if(s)throw new Error("Trying to use the same placeholder more than once: "+e);return s=!0,t},a=()=>t.fold((e)=>e,(e)=>e);return{name:n(e),required:a,used:o,replace:i}},uE=(e,t,n,s)=>{const o=_e(s,(e,t)=>mE(t,e)),i=fE(e,t,n,o);return Ie(o,n=>{if(n.used()===!1&&n.required())throw new Error("Placeholder: "+n.name()+` was not found in components list
Namespace: `+e.getOr("none")+`
Components: `+JSON.stringify(t.components,null,2))}),i},S3=Tr.single,lE=Tr.multiple,F3=n(y3),Dr=Lt.generate([{required:["data"]},{external:["data"]},{optional:["data"]},{group:["data"]}]),Nr=t("factory",{sketch:z}),N1=t("schema",[]),Rr=s("name"),D1=Me("pname","pname",$r(e=>"<alloy."+d(e.name)+">"),yn()),cE=Xe("schema",()=>[D("preprocess")]),Hr=t("defaults",n({})),Ir=t("overrides",n({})),aE=m([Nr,N1,Rr,D1,Hr,Ir]),nE=m([Nr,N1,Rr,Hr,Ir]),XC=m([Nr,N1,Rr,D1,Hr,Ir]),GC=m([Nr,cE,Rr,s("unit"),D1,Hr,Ir]),W3=t=>t.fold(e.some,e.none,e.some,e.some),U3=e=>{const t=e=>e.name;return e.fold(t,t,t,t)},YC=e=>e.fold(z,z,z,z),Wr=(e,t)=>n=>{const s=Je("Converting part type",t,n);return e(s)},Pe=Wr(Dr.required,aE),Wt=Wr(Dr.external,nE),Dt=Wr(Dr.optional,XC),qr=Wr(Dr.group,GC),k1=n("entirety");J3=Object.freeze({__proto__:null,required:Pe,external:Wt,optional:Dt,group:qr,asNamedPart:W3,name:U3,asCommon:YC,original:k1});const E1=(e,t,n,s)=>Q(t.defaults(e,n,s),n,{uid:e.partUids[t.name]},t.overrides(e,n,s)),KC=(e,t,s)=>{const o={},i={};return h(s,e=>{e.fold(e=>{o[e.pname]=S3(!0,(t,n,s)=>e.factory.sketch(E1(t,e,n,s)))},e=>{const s=t.parts[e.name];i[e.name]=n(e.factory.sketch(E1(t,e,s[k1()]),s))},e=>{o[e.pname]=S3(!1,(t,n,s)=>e.factory.sketch(E1(t,e,n,s)))},e=>{o[e.pname]=lE(!0,(t,n,s)=>{const o=t[e.name];return a(o,n=>e.factory.sketch(Q(e.defaults(t,n,s),n,e.overrides(t,n))))})})}),{internals:n(o),externals:n(i)}},O1=(e,t)=>{const n={};return h(t,t=>{W3(t).each(t=>{const s=$C(e,t.pname);n[t.name]=n=>{const o=Je("Part: "+t.name+" in "+e,m(t.schema),n);return{...s,config:n,validated:o}}})}),n},$C=(e,t)=>({uiType:F3(),owner:e,name:t}),b1=(e,t,n)=>({uiType:F3(),owner:e,name:t,config:n,validated:{}}),ih=t=>le(t,t=>t.fold(e.none,e.some,e.none,e.none).map(e=>ys(e.name,e.schema.concat([Sp(k1())]))).toArray()),ah=e=>a(e,U3),v1=(e,t,n)=>KC(e,t,n),g1=(t,n,s)=>uE(e.some(t),n,n.components,s),H=(e,t,n)=>{const s=t.partUids[n];return e.getSystem().getByUid(s).toOptional()},Ln=(e,t,n)=>H(e,t,n).getOrDie("Could not find part: "+n),uh=(e,t,s)=>{const o={},i=t.partUids,a=e.getSystem();return h(s,e=>{o[e]=n(a.getByUid(i[e]))}),o},hh=(e,t)=>{const s=e.getSystem();return _e(t.partUids,(e)=>n(s.getByUid(e)))},mh=e=>de(e.partUids),u1=(e,t,s)=>{const o={},i=t.partUids,a=e.getSystem();return h(s,e=>{o[e]=n(a.getByUid(i[e]).getOrDie())}),o},ph=(e,t)=>{const n=ah(t);return Po(a(n,t=>({key:t,value:e+"-"+t})))},d1=e=>Me("partUids","partUids",z1(t=>ph(t.uid,e)),yn());vh=Object.freeze({__proto__:null,generate:O1,generateOne:b1,schemas:ih,names:ah,substitutes:v1,components:g1,defaultUids:ph,defaultUidsSchema:d1,getAllParts:hh,getAllPartNames:mh,getPart:H,getPartOrDie:Ln,getParts:uh,getPartsOrDie:u1});const NC=(e,n)=>{const o=e.length>0?[ys("parts",e)]:[];return o.concat([s("uid"),t("dom",{}),t("components",[]),Sp("originalSpec"),t("debug.sketcher",{})]).concat(n)},jh=(e,t,n,s,o)=>{const i=NC(s,o);return Je(e+" [SpecSchema]",wt(i.concat(t)),n)},DC=(e,t,n,s)=>{const o=Oh(s),i=jh(e,t,o,[],[]);return n(i,o)},r1=(e,t,n,s,o)=>{const a=Oh(o),c=ih(n),l=d1(n),i=jh(e,t,a,c,[l]),r=v1(e,i,n),d=g1(e,i,r.internals());return s(i,d,a,r.externals())},zC=e=>R(e,"uid"),Oh=e=>zC(e)?e:{...e,uid:xo("uid")},TC=e=>e.uid!==void 0,FC=wt([s("name"),s("factory"),s("configFields"),t("apis",{}),t("extraApis",{})]),AC=wt([s("name"),s("factory"),s("configFields"),s("partFields"),t("apis",{}),t("extraApis",{})]),gt=e=>{const t=Je("Sketcher for "+e.name,FC,e),n=e=>DC(t.name,t.configFields,t.factory,e),s=_e(t.apis,Mc),o=_e(t.extraApis,(e,t)=>od(e,t));return{name:t.name,configFields:t.configFields,sketch:n,...s,...o}},We=e=>{const t=Je("Sketcher for "+e.name,AC,e),n=e=>r1(t.name,t.configFields,t.partFields,t.factory,e),s=O1(t.name,t.partFields),o=_e(t.apis,Mc),i=_e(t.extraApis,(e,t)=>od(e,t));return{name:t.name,partFields:t.partFields,configFields:t.configFields,sketch:n,parts:s,...o,...i}},Ho=e=>Dp("input")(e)&&De(e,"type")!=="radio"||Dp("textarea")(e),wC=(e,t)=>t.find(e);Fh=Object.freeze({__proto__:null,getCurrent:wC});const yC=[s("find")],x=xe({fields:yC,name:"composing",apis:Fh}),jC=["input","button","textarea","select"],Nh=(e,t)=>{const s=t.disabled()?Ju:Qu;s(e,t)},n1=(e,t)=>t.useNative===!0&&Oe(jC,Wn(e.element)),bC=e=>Y6(e.element,"disabled"),vC=e=>{w(e.element,"disabled","disabled")},gC=e=>{pe(e.element,"disabled")},pC=e=>De(e.element,"aria-disabled")==="true",fC=e=>{w(e.element,"aria-disabled","true")},mC=e=>{w(e.element,"aria-disabled","false")},Ju=(e,t)=>{t.disableClass.each(t=>{me(e.element,t)});const s=n1(e,t)?vC:fC;s(e),t.onDisabled(e)},Qu=(e,t)=>{t.disableClass.each(t=>{ae(e.element,t)});const s=n1(e,t)?gC:mC;s(e),t.onEnabled(e)},Uh=(e,t)=>n1(e,t)?bC(e):pC(e),uC=(e,t,n,s)=>{const o=s?Ju:Qu;o(e,t)};qh=Object.freeze({__proto__:null,enable:Qu,disable:Ju,isDisabled:Uh,onLoad:Nh,set:uC});const sC=(e,t)=>sn({classes:t.disabled()?t.disableClass.toArray():[]}),tC=(e,t)=>$([hf(bt(),(t)=>Uh(t,e)),Au(e,t,Nh)]);Xh=Object.freeze({__proto__:null,exhibit:sC,events:tC}),S4=[fe("disabled",U),t("useNative",!0),D("disableClass"),E("onDisabled"),E("onEnabled")];const v=xe({fields:S4,name:"disabling",active:Xh,apis:qh}),Jh=(e,t,n,s)=>{const o=Ue(e.element,"."+t.highlightClass);h(o,n=>{const o=vn(s,e=>Y(e.element,n));o||(ae(n,t.highlightClass),e.getSystem().getByDom(n).each(n=>{t.onDehighlight(e,n),T(n,Du())}))})},eC=(e,t,n)=>Jh(e,t,n,[]),Jx=(e,t,n,s)=>{Wu(e,t,n,s)&&(ae(s.element,t.highlightClass),t.onDehighlight(e,s),T(s,Du()))},Fi=(e,t,n,s)=>{Jh(e,t,n,[s]),Wu(e,t,n,s)||(me(s.element,t.highlightClass),t.onHighlight(e,s),T(s,Fm()))},Zx=(e,t,n)=>{dm(e,t).each(s=>{Fi(e,t,n,s)})},Qx=(e,t,n)=>{um(e,t).each(s=>{Fi(e,t,n,s)})},qx=(e,t,n,s)=>{Lx(e,t,n,s).fold(e=>{throw e},s=>{Fi(e,t,n,s)})},Wx=(e,t,n,s)=>{const o=pm(e,t),i=se(o,s);i.each(s=>{Fi(e,t,n,s)})},Wu=(e,t,n,s)=>mt(s.element,t.highlightClass),Ix=(e,t)=>be(e.element,"."+t.highlightClass).bind(t=>e.getSystem().getByDom(t).toOptional()),Lx=(t,n,s,o)=>{const i=Ue(t.element,"."+n.itemClass);return e.from(i[o]).fold(()=>_.error(new Error("No element found with index "+o)),t.getSystem().getByDom)},dm=(e,t)=>be(e.element,"."+t.itemClass).bind(t=>e.getSystem().getByDom(t).toOptional()),um=(t,n)=>{const o=Ue(t.element,"."+n.itemClass),i=o.length>0?e.some(o[o.length-1]):e.none();return i.bind(e=>t.getSystem().getByDom(e).toOptional())},hm=(e,t,n,s)=>{const o=Ue(e.element,"."+t.itemClass),i=Zo(o,e=>mt(e,t.highlightClass));return i.bind(t=>{const n=$o(t,s,0,o.length-1);return e.getSystem().getByDom(o[n]).toOptional()})},Nx=(e,t,n)=>hm(e,t,n,-1),Tx=(e,t,n)=>hm(e,t,n,+1),pm=(e,t)=>{const s=Ue(e.element,"."+t.itemClass);return po(a(s,t=>e.getSystem().getByDom(t).toOptional()))};gm=Object.freeze({__proto__:null,dehighlightAll:eC,dehighlight:Jx,highlight:Fi,highlightFirst:Zx,highlightLast:Qx,highlightAt:qx,highlightBy:Wx,isHighlighted:Wu,getHighlighted:Ix,getFirst:dm,getLast:um,getPrevious:Nx,getNext:Tx,getCandidates:pm}),vm=[s("highlightClass"),s("itemClass"),E("onHighlight"),E("onDehighlight")];const F=xe({fields:vm,name:"highlighting",apis:gm}),Cx=[8],Ts=[9],Nn=[13],sc=[27],dt=[32],ic=[37],mi=[38],ac=[39],ui=[40],xx=(e,t,n)=>{const s=Li(e.slice(0,t)),o=Li(e.slice(t+1));return se(s.concat(o),n)},Ox=(e,t,n)=>{const s=Li(e.slice(0,t));return se(s,n)},wx=(e,t,n)=>{const s=e.slice(0,t),o=e.slice(t+1);return se(o.concat(s),n)},_x=(e,t,n)=>{const s=e.slice(t+1);return se(s,n)},C=e=>t=>{const n=t.raw;return Oe(e,n.which)},bn=e=>t=>si(e,e=>e(t)),ii=e=>{const t=e.raw;return t.shiftKey===!0},vx=e=>{const t=e.raw;return t.ctrlKey===!0},_i=ra(ii),S=(e,t)=>({matches:e,classification:t}),px=(e,t)=>{const n=se(e,e=>e.matches(t));return n.map(e=>e.classification)},Hm=(e,t,n)=>{const s=t.exists(e=>n.exists(t=>Y(t,e)));s||p(e,sm(),{prevFocus:t,newFocus:n})},Nu=()=>{const e=e=>rn(e.element),t=(t,n)=>{const s=e(t);t.getSystem().triggerFocus(n,t.element);const o=e(t);Hm(t,s,o)};return{get:e,set:t}},mx=()=>{const e=e=>F.getHighlighted(e).map(e=>e.element),t=(t,n)=>{const s=e(t);t.getSystem().getByDom(n).fold(l,e=>{F.highlight(t,e)});const o=e(t);Hm(t,s,o)};return{get:e,set:t}};(function(e){e.OnFocusMode="onFocus",e.OnEnterOrSpaceMode="onEnterOrSpace",e.OnApiMode="onApi"})(rc||(rc={}));const Js=(n,s,i,a,r)=>{const d=()=>n.concat([t("focusManager",Nu()),Rt("focusInside","onFocus",wi(e=>Oe(["onFocus","onEnterOrSpace","onApi"],e)?_.value(e):_.error("Invalid value for focusInside"))),W("handler",l),W("state",s),W("sendFocusIn",r)]),c=(e,t,n,s,o)=>{const i=n(e,t,s,o);return px(i,t.event).bind(n=>n(e,t,s,o))},u=(t,n)=>{const s=t.focusInside!==rc.OnFocusMode?e.none():r(t).map(e=>o(ps(),(s,o)=>{e(s,t,n),o.stop()})),l=(e,s)=>{const o=C(dt.concat(Nn))(s.event);t.focusInside===rc.OnEnterOrSpaceMode&&o&&a3(e,s)&&r(t).each(o=>{o(e,t,n),s.stop()})},d=[o(_a(),(e,s)=>{c(e,s,i,t,n).fold(()=>{l(e,s)},e=>{s.stop()})}),o(xR(),(e,s)=>{c(e,s,a,t,n).each(e=>{s.stop()})})];return $(s.toArray().concat(d))},l={schema:d,processKey:c,toEvents:u};return l},Wm=s=>{const d=[D("onEscape"),D("onEnter"),t("selector",'[data-alloy-tabstop="true"]:not(:disabled)'),t("firstTabstop",0),t("useTabstopAt",ye),D("visibilitySelector")].concat([s]),i=(e,t)=>{const n=e.visibilitySelector.bind(e=>cn(t,e)).getOr(t);return Ve(n)>0},u=(t,n)=>{const s=Ue(t.element,n.selector),o=q(s,e=>i(n,e));return e.from(o[n.firstTabstop])},r=(e,t)=>t.focusManager.get(e).bind(e=>cn(e,t.selector)),c=(e,t)=>i(e,t)&&e.useTabstopAt(t),l=(e,t)=>{u(e,t).each(n=>{t.focusManager.set(e,n)})},a=(t,n,s,o,i)=>i(n,s,e=>c(o,e)).fold(()=>o.cyclic?e.some(!0):e.none(),n=>(o.focusManager.set(t,n),e.some(!0))),o=(e,t,n,s)=>{const o=Ue(e.element,n.selector);return r(e,n).bind(t=>{const i=Zo(o,Tt(Y,t));return i.bind(t=>a(e,o,t,n,s))})},h=(e,t,n)=>{const s=n.cyclic?xx:Ox;return o(e,t,n,s)},m=(e,t,n)=>{const s=n.cyclic?wx:_x;return o(e,t,n,s)},f=(e,t,n)=>n.onEnter.bind(n=>n(e,t)),p=(e,t,n)=>n.onEscape.bind(n=>n(e,t)),g=n([S(bn([ii,C(Ts)]),h),S(C(Ts),m),S(bn([_i,C(Nn)]),f)]),v=n([S(C(sc),p)]);return Js(d,un.init,g,v,()=>e.some(l))};Um=Wm(Xe("cyclic",U)),Km=Wm(Xe("cyclic",ye));const hx=(t,n,s)=>(Mu(t,s,bt()),e.some(!0)),Si=(t,n,s)=>{const o=Ho(s)&&C(dt)(n.event);return o?e.none():hx(t,n,s)},Jo=()=>e.some(!0),ux=[t("execute",Si),t("useSpace",!1),t("useEnter",!0),t("useControlEnter",!1),t("useDown",!1)],Qm=(e,t,n)=>n.execute(e,t,e.element),dx=(e,t,n)=>{const o=n.useSpace&&!Ho(e.element)?dt:[],i=n.useEnter?Nn:[],a=n.useDown?ui:[],r=o.concat(i).concat(a);return[S(C(r),Qm)].concat(n.useControlEnter?[S(bn([vx,C(Nn)]),Qm)]:[])},rx=(e,t,n)=>n.useSpace&&!Ho(e.element)?[S(C(dt),Jo)]:[];e8=Js(ux,un.init,dx,rx,()=>e.none());const t8=()=>{const e=K(),t=(t,n)=>{e.set({numRows:t,numColumns:n})},n=()=>e.get().map(e=>e.numRows),s=()=>e.get().map(e=>e.numColumns);return jt({readState:()=>e.get().map(e=>({numRows:String(e.numRows),numColumns:String(e.numColumns)})).getOr({numRows:"?",numColumns:"?"}),setGridSize:t,getNumRows:n,getNumColumns:s})},QO=e=>e.state(e);s8=Object.freeze({__proto__:null,flatgrid:t8,init:QO});const o8=e=>(t,n,s,o)=>{const i=e(t.element);return c8(i,t,n,s,o)},Eu=(e,t)=>{const n=el(e,t);return o8(n)},Cu=(e,t)=>{const n=el(t,e);return o8(n)},xu=e=>(t,n,s,o)=>c8(e,t,n,s,o),c8=(e,t,n,s,o)=>{const i=s.focusManager.get(t).bind(n=>e(t.element,n,s,o));return i.map(e=>(s.focusManager.set(t,e),!0))},l8=xu,d8=xu,fc=xu,YO=e=>e.offsetWidth<=0&&e.offsetHeight<=0,m8=e=>!YO(e.dom),qO=(e,t)=>Zo(e,t).map(t=>({index:t,candidates:e})),p8=(e,t,n)=>{const s=e=>Y(e,t),o=Ue(e,n),i=q(o,m8);return qO(i,s)},g8=(e,t)=>Zo(e,e=>Y(t,e)),v8=(t,n,s,o)=>{const i=Math.floor(n/s),a=n%s;return o(i,a).bind(n=>{const o=n.row*s+n.column;return o>=0&&o<t.length?e.some(t[o]):e.none()})},b8=(t,n,s,o,i)=>v8(t,n,o,(n,a)=>{const r=n===s-1,c=r?t.length-n*o:o,l=$o(a,i,0,c-1);return e.some({row:n,column:l})}),j8=(t,n,s,o,i)=>v8(t,n,o,(n,a)=>{const r=$o(n,i,0,s-1),c=r===s-1,l=c?t.length-r*o:o,d=Nt(a,0,l-1);return e.some({row:r,column:d})}),KO=(e,t,n,s)=>b8(e,t,n,s,+1),HO=(e,t,n,s)=>b8(e,t,n,s,-1),LO=(e,t,n,s)=>j8(e,t,n,s,-1),FO=(e,t,n,s)=>j8(e,t,n,s,+1),MO=[s("selector"),t("execute",Si),rt("onEscape"),t("captureTab",!1),kp()],SO=(e,t)=>{be(e.element,t.selector).each(n=>{t.focusManager.set(e,n)})},wO=(e,t)=>t.focusManager.get(e).bind(e=>cn(e,t.selector)),jO=(e,t,n)=>wO(e,n).bind(s=>n.execute(e,t,s)),bc=e=>(t,n,s,o)=>p8(t,n,s.selector).bind(t=>e(t.candidates,t.index,o.getNumRows().getOr(s.initSize.numRows),o.getNumColumns().getOr(s.initSize.numColumns))),S8=(t,n,s)=>s.captureTab?e.some(!0):e.none(),fO=(e,t,n)=>n.onEscape(e,t),F8=bc(HO),T8=bc(KO),mO=bc(LO),hO=bc(FO),uO=n([S(C(ic),Eu(F8,T8)),S(C(ac),Cu(F8,T8)),S(C(mi),l8(mO)),S(C(ui),d8(hO)),S(bn([ii,C(Ts)]),S8),S(bn([_i,C(Ts)]),S8),S(C(dt.concat(Nn)),jO)]),dO=n([S(C(sc),fO),S(C(dt),Jo)]);R8=Js(MO,t8,uO,dO,()=>e.some(SO));const _c=(t,n,s,o)=>{const a=e=>Wn(e)==="button"&&De(e,"disabled")==="disabled",i=(t,n,s)=>{const r=$o(n,o,0,s.length-1);return r===t?e.none():a(s[r])?i(t,r,s):e.from(s[r])};return p8(t,s,n).bind(e=>{const t=e.index,n=e.candidates;return i(t,t,n)})},lO=[s("selector"),t("getInitial",e.none),t("execute",Si),rt("onEscape"),t("executeOnMove",!1),t("allowVertical",!0)],cO=(e,t)=>t.focusManager.get(e).bind(e=>cn(e,t.selector)),vu=(e,t,n)=>cO(e,n).bind(s=>n.execute(e,t,s)),rO=(e,t)=>{t.getInitial(e).orThunk(()=>be(e.element,t.selector)).each(n=>{t.focusManager.set(e,n)})},$8=(e,t,n)=>_c(e,n.selector,t,-1),W8=(e,t,n)=>_c(e,n.selector,t,+1),U8=t=>(n,s,o,i)=>t(n,s,o,i).bind(()=>o.executeOnMove?vu(n,s,o):e.some(!0)),aO=(e,t,n)=>n.onEscape(e,t),iO=(e,t,n)=>{const o=ic.concat(n.allowVertical?mi:[]),i=ac.concat(n.allowVertical?ui:[]);return[S(C(o),U8(Eu($8,W8))),S(C(i),U8(Cu($8,W8))),S(C(Nn),vu),S(C(dt),vu)]},oO=n([S(C(dt),Jo),S(C(sc),aO)]);G8=Js(lO,un.init,iO,oO,()=>e.some(rO));const Sc=(t,n,s)=>e.from(t[n]).bind(t=>e.from(t[s]).map(e=>({rowIndex:n,columnIndex:s,cell:e}))),Q8=(e,t,n,s)=>{const o=e[t],i=o.length,a=$o(n,s,0,i-1);return Sc(e,t,a)},Z8=(e,t,n,s)=>{const o=$o(n,s,0,e.length-1),i=e[o].length,a=Nt(t,0,i-1);return Sc(e,o,a)},J8=(e,t,n,s)=>{const o=e[t],i=o.length,a=Nt(n+s,0,i-1);return Sc(e,t,a)},ef=(e,t,n,s)=>{const o=Nt(n+s,0,e.length-1),i=e[o].length,a=Nt(t,0,i-1);return Sc(e,o,a)},sO=(e,t,n)=>Q8(e,t,n,+1),nO=(e,t,n)=>Q8(e,t,n,-1),Jw=(e,t,n)=>Z8(e,n,t,-1),Zw=(e,t,n)=>Z8(e,n,t,+1),Qw=(e,t,n)=>J8(e,t,n,-1),Xw=(e,t,n)=>J8(e,t,n,+1),Gw=(e,t,n)=>ef(e,n,t,-1),Yw=(e,t,n)=>ef(e,n,t,+1),Uw=[ys("selectors",[s("row"),s("cell")]),t("cycles",!0),t("previousSelector",e.none),t("execute",Si)],Ww=(e,t)=>{const s=t.previousSelector(e).orThunk(()=>{const n=t.selectors;return be(e.element,n.cell)});s.each(n=>{t.focusManager.set(e,n)})},$w=(e,t,n)=>rn(e.element).bind(s=>n.execute(e,t,s)),Mw=(e,t)=>a(e,e=>Ue(e,t.selectors.cell)),Fc=(e,t)=>(n,s,o)=>{const i=o.cycles?e:t;return cn(s,o.selectors.row).bind(e=>{const t=Ue(e,o.selectors.cell);return g8(t,s).bind(t=>{const s=Ue(n,o.selectors.row);return g8(s,e).bind(e=>{const n=Mw(s,o);return i(n,e,t).map(e=>e.cell)})})})},gf=Fc(nO,Qw),vf=Fc(sO,Xw),Sw=Fc(Jw,Gw),Aw=Fc(Zw,Yw),kw=n([S(C(ic),Eu(gf,vf)),S(C(ac),Cu(gf,vf)),S(C(mi),l8(Sw)),S(C(ui),d8(Aw)),S(C(dt.concat(Nn)),$w)]),Ew=n([S(C(dt),Jo)]);wf=Js(Uw,un.init,kw,Ew,()=>e.some(Ww));const Cw=[s("selector"),t("execute",Si),t("moveOnTab",!1)],xf=(e,t,n)=>n.focusManager.get(e).bind(s=>n.execute(e,t,s)),xw=(e,t)=>{be(e.element,t.selector).each(n=>{t.focusManager.set(e,n)})},Ef=(e,t,n)=>_c(e,n.selector,t,-1),kf=(e,t,n)=>_c(e,n.selector,t,+1),Ow=(t,n,s,o)=>s.moveOnTab?fc(Ef)(t,n,s,o):e.none(),ww=(t,n,s,o)=>s.moveOnTab?fc(kf)(t,n,s,o):e.none(),_w=n([S(C(mi),fc(Ef)),S(C(ui),fc(kf)),S(bn([ii,C(Ts)]),Ow),S(bn([_i,C(Ts)]),ww),S(C(Nn),xf),S(C(dt),xf)]),yw=n([S(C(dt),Jo)]);Tf=Js(Cw,un.init,_w,yw,()=>e.some(xw));const jw=[rt("onSpace"),rt("onEnter"),rt("onShiftEnter"),rt("onLeft"),rt("onRight"),rt("onTab"),rt("onShiftTab"),rt("onUp"),rt("onDown"),rt("onEscape"),t("stopSpaceKeyup",!1),D("focusIn")],bw=(e,t,n)=>[S(C(dt),n.onSpace),S(bn([_i,C(Nn)]),n.onEnter),S(bn([ii,C(Nn)]),n.onShiftEnter),S(bn([ii,C(Ts)]),n.onShiftTab),S(bn([_i,C(Ts)]),n.onTab),S(C(mi),n.onUp),S(C(ui),n.onDown),S(C(ic),n.onLeft),S(C(ac),n.onRight),S(C(dt),n.onSpace)],vw=(e,t,n)=>[...n.stopSpaceKeyup?[S(C(dt),Jo)]:[],S(C(sc),n.onEscape)];Lf=Js(jw,un.init,bw,vw,e=>e.focusIn);const gw=Um.schema(),pw=Km.schema(),fw=G8.schema(),mw=R8.schema(),hw=wf.schema(),uw=e8.schema(),dw=Tf.schema(),lw=Lf.schema();Uf=Object.freeze({__proto__:null,acyclic:gw,cyclic:pw,flow:fw,flatgrid:mw,matrix:hw,execution:uw,menu:dw,special:lw});const cw=e=>Vt(e,"setGridSize"),u=Em({branchKey:"mode",branches:Uf,name:"keying",active:{events:(e,t)=>{const n=e.handler;return n.toEvents(e,t)}},apis:{focusIn:(e,t,n)=>{t.sendFocusIn(t).fold(()=>{e.getSystem().triggerFocus(e.element,e.element)},s=>{s(e,t,n)})},setGridSize:(e,t,n,s,o)=>{cw(n)?n.setGridSize(s,o):console.error("Layout does not support setGridSize")}},state:s8}),Yf=(e,t)=>{Yu(()=>{Fk(e,t,()=>a(t,e.getSystem().build))},e.element)},Gf=(e,t)=>{Yu(()=>{Mk(e,t,()=>fD(e.element,t,e.getSystem().buildOrPatch))},e.element)},rw=(e,t,n,s)=>{f4(t);const o=E7(e.element,n,s,e.getSystem().buildOrPatch);J0(e,o),e.syncComponents()},eu=(e,t,n)=>{const s=e.getSystem().build(n);a2(e,s,t)},aw=(e,t,n,s)=>{Yn(t),eu(e,(e,t)=>pB(e,t,n),s)},tw=(e,t,n,s)=>{const o=t.reuseDom?Gf:Yf;return o(e,s)},J_=(e,t,n,s)=>{eu(e,Jt,s)},Q_=(e,t,n,s)=>{eu(e,gB,s)},I_=(e,t,n,s)=>{const o=Bc(e),i=se(o,e=>Y(s.element,e.element));i.each(Yn)},Bc=(e)=>e.components(),o6=(t,n,s,o,i)=>{const a=Bc(t);return e.from(a[o]).map(e=>(i.fold(()=>Yn(e),s=>{const i=n.reuseDom?rw:aw;i(t,e,o,s)}),e))},R_=(e,t,n,s,o)=>{const i=Bc(e);return Zo(i,s).bind(s=>o6(e,t,n,s,o))};a6=Object.freeze({__proto__:null,append:J_,prepend:Q_,remove:I_,replaceAt:o6,replaceBy:R_,set:tw,contents:Bc});const j=xe({fields:[ht("reuseDom",!0)],name:"replacing",apis:a6}),L_=(e,t)=>{const o=$(t);return xe({fields:[s("enabled")],name:e,active:{events:n(o)}})},O=(e,t)=>{const s=L_(e,t);return{key:e,value:{config:{},me:s,configAsRaw:n({}),initialConfig:{},state:un}}},d6=(e,t)=>{t.ignore||(es(e.element),t.onFocus(e))},N_=(e,t)=>{t.ignore||QF(e.element)},z_=e=>om(e.element);m6=Object.freeze({__proto__:null,focus:d6,blur:N_,isFocused:z_});const T_=(e,t)=>{const n=t.ignore?{}:{attributes:{tabindex:"-1"}};return sn(n)},S_=e=>$([o(ps(),(t,n)=>{d6(t,e),n.stop()})].concat(e.stopMousedown?[o(Kt(),(e,t)=>{t.event.prevent()})]:[]));g6=Object.freeze({__proto__:null,exhibit:T_,events:S_}),v6=[E("onFocus"),t("stopMousedown",!1),t("ignore",!1)];const b=xe({fields:v6,name:"focusing",active:g6,apis:m6}),A_=e=>{const t=()=>{const t=g(e),n=()=>t.get(),s=e=>t.set(e),o=()=>t.set(e),i=()=>t.get();return{get:n,set:s,clear:o,readState:i}};return{init:t}},k_=(e,t,n)=>{const s=t.aria;s.update(e,s,n.get())},C_=(e,t,n)=>{t.toggleClass.each(t=>{n.get()?me(e.element,t):ae(e.element,t)})},Sa=(e,t,n,s)=>{const o=n.get();n.set(s),C_(e,t,n),k_(e,t,n),o!==s&&t.onToggled(e,s)},O6=(e,t,n)=>{Sa(e,t,n,!n.get())},O_=(e,t,n)=>{Sa(e,t,n,!0)},w_=(e,t,n)=>{Sa(e,t,n,!1)},__=(e,t,n)=>n.get(),k6=(e,t,n)=>{Sa(e,t,n,t.selected)};A6=Object.freeze({__proto__:null,onLoad:k6,toggle:O6,isOn:__,on:O_,off:w_,set:Sa});const y_=()=>sn({}),j_=(e,t)=>{const n=gT(e,t,O6),s=Au(e,t,k6);return $(Fe([e.toggleOnExecute?[n]:[],[s]]))};F6=Object.freeze({__proto__:null,exhibit:y_,events:j_});const g_=(e,t,n)=>{w(e.element,"aria-pressed",n),t.syncWithExpanded&&N6(e,t,n)},p_=(e,t,n)=>{w(e.element,"aria-selected",n)},f_=(e,t,n)=>{w(e.element,"aria-checked",n)},N6=(e,t,n)=>{w(e.element,"aria-expanded",n)};L6=[t("selected",!1),D("toggleClass"),t("toggleOnExecute",!0),E("onToggled"),Rt("aria",{mode:"none"},yt("mode",{pressed:[t("syncWithExpanded",!1),W("update",g_)],checked:[W("update",f_)],expanded:[W("update",N6)],selected:[W("update",p_)],none:[W("update",l)]}))];const A=xe({fields:L6,name:"toggling",active:F6,apis:A6,state:A_(!1)}),P6=()=>{const e=(e,t)=>{t.stop(),mo(e)};return[o(ua(),e),o(Di(),e),Hs(ds()),Hs(Kt())]},Jc=e=>{const t=e=>Jn((t,n)=>{e(t),n.stop()});return $(Fe([e.map(t).toArray(),P6()]))},I6="alloy.item-hover",B6="alloy.item-focus",V6="alloy.item-toggled",$6=e=>{(rn(e.element).isNone()||b.isFocused(e))&&(b.isFocused(e)||b.focus(e),p(e,I6,{item:e}))},W6=e=>{p(e,B6,{item:e})},m_=(e,t)=>{p(e,V6,{item:e,state:t})},K6=n(I6),h_=n(B6),u_=n(V6),d_=e=>e.toggling.map(e=>e.exclusive?"menuitemradio":"menuitemcheckbox").getOr("menuitem"),l_=e=>({aria:{mode:"checked"},...f7(e,(e,t)=>t!=="exclusive"),onToggled:(t,n)=>{Mt(e.onToggled)&&e.onToggled(t,n),m_(t,n)}}),c_=e=>({dom:e.dom,domModification:{...e.domModification,attributes:{role:d_(e),...e.domModification.attributes,"aria-haspopup":e.hasSubmenu,...e.hasSubmenu?{"aria-expanded":!1}:{}}},behaviours:$t.augment(e.itemBehaviours,[e.toggling.fold(A.revoke,e=>A.config(l_(e))),b.config({ignore:e.ignoreFocus,stopMousedown:e.ignoreFocus,onFocus:e=>{W6(e)}}),u.config({mode:"execution"}),r.config({store:{mode:"memory",initialValue:e.data}}),O("item-type-events",[...P6(),o(_s(),$6),o(Ni(),b.focus)])]),components:e.components,eventOrder:e.eventOrder}),r_=[s("data"),s("components"),s("dom"),t("hasSubmenu",!1),D("toggling"),$t.field("itemBehaviours",[A,b,u,r]),t("ignoreFocus",!1),t("domModification",{}),W("builder",c_),t("eventOrder",{})],a_=e=>({dom:e.dom,components:e.components,events:$([QL(Ni())])}),n_=[s("dom"),s("components"),W("builder",a_)],Hd=n("item-widget"),Pd=n([Pe({name:"widget",overrides:e=>({behaviours:i([r.config({store:{mode:"manual",getValue:t=>e.data,setValue:l}})])})})]),t_=t=>{const i=v1(Hd(),t,Pd()),a=g1(Hd(),t,i.internals()),n=e=>H(e,t,"widget").map(e=>(u.focusIn(e),e)),s=(n,s)=>Ho(s.event.target)?e.none():(()=>t.autofocus?(s.setSource(n.element),e.none()):e.none())();return{dom:t.dom,components:a,domModification:t.domModification,events:$([Jn((e,t)=>{n(e).each(e=>{t.stop()})}),o(_s(),$6),o(Ni(),(e)=>{t.autofocus?n(e):b.focus(e)})]),behaviours:$t.augment(t.widgetBehaviours,[r.config({store:{mode:"memory",initialValue:t.data}}),b.config({ignore:t.ignoreFocus,onFocus:e=>{W6(e)}}),u.config({mode:"special",focusIn:t.autofocus?e=>{n(e)}:eT(),onLeft:s,onRight:s,onEscape:(n,s)=>!b.isFocused(n)&&!t.autofocus?(b.focus(n),e.some(!0)):t.autofocus?(s.setSource(n.element),e.none()):e.none()})])}},e_=[s("uid"),s("data"),s("components"),s("dom"),t("autofocus",!1),t("ignoreFocus",!1),$t.field("widgetBehaviours",[r,b,u]),t("domModification",{}),d1(Pd()),W("builder",t_)],Jy=yt("type",{widget:e_,item:r_,separator:n_}),Zy=(e,t)=>({mode:"flatgrid",selector:"."+e.markers.item,initSize:{numColumns:t.initSize.numColumns,numRows:t.initSize.numRows},focusManager:e.focusManager}),Xy=(e,t)=>({mode:"matrix",selectors:{row:t.rowSelector,cell:"."+e.markers.item},previousSelector:t.previousSelector,focusManager:e.focusManager}),Uy=(e,t)=>({mode:"menu",selector:"."+e.markers.item,moveOnTab:t.moveOnTab,focusManager:e.focusManager}),Wy=n([qr({factory:{sketch:e=>{const t=Je("menu.spec item",Jy,e);return t.builder(t)}},name:"items",unit:"item",defaults:(e,t)=>R(t,"uid")?t:{...t,uid:xo("item")},overrides:(e,t)=>({type:t.type,ignoreFocus:e.fakeFocus,domModification:{classes:[e.markers.item]}})})]),Py=n([s("value"),s("items"),s("dom"),s("components"),t("eventOrder",{}),ve("menuBehaviours",[F,r,x,u]),Rt("movement",{mode:"menu",moveOnTab:!0},yt("mode",{grid:[kp(),W("config",Zy)],matrix:[W("config",Xy),s("rowSelector"),t("previousSelector",e.none)],menu:[t("moveOnTab",!0),W("config",Uy)]})),zT(),t("fakeFocus",!1),t("focusManager",Nu()),E("onHighlight"),E("onDehighlight")]),up=n("alloy.menu-focus"),Dy=(e,t)=>{const n=Ue(e.element,'[role="menuitemradio"][aria-checked="true"]');h(n,n=>{Y(n,t.element)||e.getSystem().getByDom(n).each(e=>{A.off(e)})})},zy=(t,n)=>({uid:t.uid,dom:t.dom,markers:t.markers,behaviours:we(t.menuBehaviours,[F.config({highlightClass:t.markers.selectedItem,itemClass:t.markers.item,onHighlight:t.onHighlight,onDehighlight:t.onDehighlight}),r.config({store:{mode:"memory",initialValue:t.value}}),x.config({find:e.some}),u.config(t.movement.config(t,t.movement))]),events:$([o(h_(),(e,t)=>{const n=t.event;e.getSystem().getByDom(n.target).each(n=>{F.highlight(e,n),t.stop(),p(e,up(),{menu:e,item:n})})}),o(K6(),(e,t)=>{const n=t.event.item;F.highlight(e,n)}),o(u_(),(e,t)=>{const{item:n,state:s}=t.event;s&&De(n.element,"role")==="menuitemradio"&&Dy(e,n)})]),components:n,eventOrder:t.eventOrder,domModification:{attributes:{role:"menu"}}}),Bs=We({name:"Menu",configFields:Py(),partFields:Wy(),factory:zy}),Ty=e=>O7(e,(e,t)=>({k:e,v:t})),gp=(t,n,s,o)=>f(s,o).bind(o=>f(t,o).bind(o=>{const i=gp(t,n,s,o);return e.some([o].concat(i))})).getOr([]),Sy=(e,t)=>{const n={};Ie(e,(e,t)=>{h(e,e=>{n[e]=t})});const o=t,s=Ty(t),i=_e(s,(e,t)=>[t].concat(gp(n,o,s,t)));return _e(n,e=>f(i,e).getOr([e]))},xy=()=>{const o=g({}),t=g({}),n=g({}),s=K(),a=g({}),l=()=>{o.set({}),t.set({}),n.set({}),s.clear()},y=()=>s.get().isNone(),j=(e,n)=>{t.set({...t.get(),[e]:{type:"prepared",menu:n}})},b=(e,i,r,c)=>{s.set(e),o.set(r),t.set(i),a.set(c);const l=Sy(c,r);n.set(l)},d=e=>Dl(o.get(),(t)=>t===e),u=(e,t,n)=>i(e).bind(s=>d(e).bind(e=>t(e).map(e=>({triggeredMenu:s,triggeringItem:e,triggeringPath:n})))),h=(t,o)=>{const a=q(r(t).toArray(),e=>i(e).isSome());return f(n.get(),t).bind(t=>{const n=Li(a.concat(t)),i=le(n,(t,i)=>u(t,o,n.slice(0,i+1)).fold(()=>hn(s.get(),t)?[]:[e.none()],t=>[e.some(t)]));return $V(i)})},m=e=>f(o.get(),e).map(t=>{const s=f(n.get(),e).getOr([]);return[t].concat(s)}),p=t=>f(n.get(),t).bind(t=>t.length>1?e.some(t.slice(1)):e.none()),v=e=>f(n.get(),e),i=e=>c(e).bind(jp),c=e=>f(t.get(),e),r=e=>f(o.get(),e),_=e=>{const t=a.get();return uo(de(t),e)},w=()=>s.get().bind(i),O=()=>t.get();return{setMenuBuilt:j,setContents:b,expand:m,refresh:v,collapse:p,lookupMenu:c,lookupItem:r,otherMenus:_,getPrimary:w,getMenus:O,clear:l,isClear:y,getTriggeringPath:h}},jp=t=>t.type==="prepared"?e.some(t.menu):e.none(),yp={init:xy,extractPreparedMenu:jp},_p=d("tiered-menu-item-highlight"),wp=d("tiered-menu-item-dehighlight");(function(e){e[e.HighlightMenuAndItem=0]="HighlightMenuAndItem",e[e.HighlightJustMenu=1]="HighlightJustMenu",e[e.HighlightNone=2]="HighlightNone"})(Ge||(Ge={}));const wy=(t)=>{const k=K(),R=(e,n,s)=>_e(s,(s,o)=>{const i=()=>Bs.sketch({...s,value:o,markers:t.markers,fakeFocus:t.fakeFocus,onHighlight:(e,t)=>{const n={menuComp:e,itemComp:t};p(e,_p,n)},onDehighlight:(e,t)=>{const n={menuComp:e,itemComp:t};p(e,wp,n)},focusManager:t.fakeFocus?mx():Nu()});return o===n?{type:"prepared",menu:e.getSystem().build(i())}:{type:"notbuilt",nbMenu:i}}),s=yp.init(),T=e=>{const n=R(e,t.data.primary,t.data.menus),o=N();return s.setContents(t.data.primary,n,t.data.expansions,o),s.getPrimary()},i=e=>r.getValue(e).value,M=(t,n,s)=>En(n,t=>{if(!t.getSystem().isConnected())return e.none();const n=F.getCandidates(t);return se(n,e=>i(e)===s)}),N=e=>_e(t.data.menus,(e)=>le(e.items,e=>e.type==="separator"?[]:[e.data.value])),_=F.highlight,y=(e,n)=>{_(e,n),F.getHighlighted(n).orThunk(()=>F.getFirst(n)).each(s=>{t.fakeFocus?F.highlight(n,s):Mu(e,s.element,Ni())})},E=(t,n)=>po(a(n,n=>t.lookupMenu(n).bind(t=>t.type==="prepared"?e.some(t.menu):e.none()))),O=(e,n,s)=>{const o=E(n,n.otherMenus(s));h(o,n=>{On(n.element,[t.markers.backgroundMenu]),t.stayInDom||j.remove(e,n)})},H=e=>k.get().getOrThunk(()=>{const n={},s=Ue(e.element,`.${t.markers.item}`),o=q(s,e=>De(e,"aria-haspopup")==="true");return h(o,t=>{e.getSystem().getByDom(t).each(e=>{const t=i(e);n[t]=e})}),k.set(n),n}),m=(e,t)=>{const n=H(e);Ie(n,(e,n)=>{const s=Oe(t,n);w(e.element,"aria-expanded",s)})},b=(n,s,o)=>e.from(o[0]).bind(i=>s.lookupMenu(i).bind(i=>{if(i.type==="notbuilt")return e.none();const a=i.menu,r=E(s,o.slice(1));return h(r,e=>{me(e.element,t.markers.backgroundMenu)}),Xt(a.element)||j.append(n,tn(a)),On(a.element,[t.markers.backgroundMenu]),y(n,a),O(n,s,o),e.some(a)}));let c;(function(e){e[e.HighlightSubmenu=0]="HighlightSubmenu",e[e.HighlightParent=1]="HighlightParent"})(c||(c={}));const L=(e,t,n)=>{if(n.type==="notbuilt"){const o=e.getSystem().build(n.nbMenu());return s.setMenuBuilt(t,o),o}return n.menu},g=(n,o,a=c.HighlightSubmenu)=>{if(o.hasConfigured(v)&&v.isDisabled(o))return e.some(o);const r=i(o);return s.expand(r).bind(i=>(m(n,i),e.from(i[0]).bind(r=>s.lookupMenu(r).bind(l=>{const d=L(n,r,l);return Xt(d.element)||j.append(n,tn(d)),t.onOpenSubmenu(n,o,d,Li(i)),a===c.HighlightSubmenu?(F.highlightFirst(d),b(n,s,i)):(F.dehighlightAll(d),e.some(o))}))))},d=(e,n)=>{const o=i(n);return s.collapse(o).bind(o=>(m(e,o),b(e,s,o).map(s=>(t.onCollapseMenu(e,n,s),s))))},z=(e,t)=>{const n=i(t);return s.refresh(n).bind(t=>(m(e,t),b(e,s,t)))},D=(t,n)=>Ho(n.element)?e.none():g(t,n,c.HighlightSubmenu),A=(t,n)=>Ho(n.element)?e.none():d(t,n),S=(e,n)=>d(e,n).orThunk(()=>t.onEscape(e,n).map(()=>e)),f=e=>(n,s)=>cn(s.getSource(),`.${t.markers.item}`).bind(t=>n.getSystem().getByDom(t).toOptional().bind(t=>e(n,t).map(ye))),P=$([o(up(),(e,t)=>{const n=t.event.item;s.lookupItem(i(n)).each(()=>{const n=t.event.menu;F.highlight(e,n);const o=i(t.event.item);s.refresh(o).each(t=>O(e,s,t))})}),Jn((e,n)=>{const s=n.event.target;e.getSystem().getByDom(s).each(n=>{const s=i(n);s.indexOf("collapse-item")===0&&d(e,n),g(e,n,c.HighlightSubmenu).fold(()=>{t.onExecute(e,n)},l)})}),J((e)=>{T(e).each(n=>{j.append(e,tn(n)),t.onOpenMenu(e,n),t.highlightOnOpen===Ge.HighlightMenuAndItem?y(e,n):t.highlightOnOpen===Ge.HighlightJustMenu&&_(e,n)})}),o(_p,(e,n)=>{t.onHighlightItem(e,n.event.menuComp,n.event.itemComp)}),o(wp,(e,n)=>{t.onDehighlightItem(e,n.event.menuComp,n.event.itemComp)}),...t.navigateOnHover?[o(K6(),(e,n)=>{const s=n.event.item;z(e,s),g(e,s,c.HighlightParent),t.onHover(e,s)})]:[]]),C=e=>F.getHighlighted(e).bind(F.getHighlighted),I=e=>{C(e).each(t=>{d(e,t)})},B=e=>{s.getPrimary().each(t=>{y(e,t)})},V=t=>e.from(t.components()[0]).filter(e=>De(e.element,"role")==="menu"),W=e=>{const n=s.getPrimary().bind(t=>C(e).bind(t=>{const n=i(t),o=Nl(s.getMenus()),r=po(a(o,yp.extractPreparedMenu));return s.getTriggeringPath(n,t=>M(e,r,t))}).map(e=>({primary:t,triggeringPath:e})));n.fold(()=>{V(e).each(n=>{t.onRepositionMenu(e,n,[])})},({primary:n,triggeringPath:s})=>{t.onRepositionMenu(e,n,s)})},U={collapseMenu:I,highlightPrimary:B,repositionMenus:W};return{uid:t.uid,dom:t.dom,markers:t.markers,behaviours:we(t.tmenuBehaviours,[u.config({mode:"special",onRight:f(D),onLeft:f(A),onEscape:f(S),focusIn:(e)=>{s.getPrimary().each(t=>{Mu(e,t.element,Ni())})}}),F.config({highlightClass:t.markers.selectedMenu,itemClass:t.markers.menu}),x.config({find:e=>F.getHighlighted(e)}),j.config({})]),eventOrder:t.eventOrder,apis:U,events:P}},_y=n("collapse-item"),yy=(e,t,n)=>({primary:e,menus:t,expansions:n}),py=(e,t)=>({primary:e,menus:eo(e,t),expansions:{}}),fy=e=>({value:d(_y()),meta:{text:e}}),Qs=gt({name:"TieredMenu",configFields:[Td("onExecute"),Td("onEscape"),Vs("onOpenMenu"),Vs("onOpenSubmenu"),E("onRepositionMenu"),E("onCollapseMenu"),t("highlightOnOpen",Ge.HighlightMenuAndItem),ys("data",[s("primary"),s("menus"),s("expansions")]),t("fakeFocus",!1),E("onHighlightItem"),E("onDehighlightItem"),E("onHover"),hc(),s("dom"),t("navigateOnHover",!0),t("stayInDom",!1),ve("tmenuBehaviours",[u,F,x,j]),t("eventOrder",{})],apis:{collapseMenu:(e,t)=>{e.collapseMenu(t)},highlightPrimary:(e,t)=>{e.highlightPrimary(t)},repositionMenus:(e,t)=>{e.repositionMenus(t)}},factory:wy,extraApis:{tieredData:yy,singleData:py,collapseItem:fy}}),uy=(t,n,s,o,i)=>{const a=()=>t.lazySink(n),c=o.type==="horizontal"?{layouts:{onLtr:()=>_u(),onRtl:()=>wu()}}:{},l=e=>e.length===2,r=e=>l(e)?c:{};return Qs.sketch({dom:{tag:"div"},data:o.data,markers:o.menu.markers,highlightOnOpen:o.menu.highlightOnOpen,fakeFocus:o.menu.fakeFocus,onEscape:()=>(k.close(n),t.onEscape.map(e=>e(n)),e.some(!0)),onExecute:()=>e.some(!0),onOpenMenu:(e,t)=>{Ke.positionWithinBounds(a().getOrDie(),t,s,i())},onOpenSubmenu:(e,t,n,s)=>{const o=a().getOrDie();Ke.position(o,n,{anchor:{type:"submenu",item:t,...r(s)}})},onRepositionMenu:(e,t,n)=>{const o=a().getOrDie();Ke.positionWithinBounds(o,t,s,i()),h(n,e=>{const t=r(e.triggeringPath);Ke.position(o,e.triggeredMenu,{anchor:{type:"submenu",item:e.triggeringItem,...t}})})}})},ry=(t,n)=>{const c=(e,n)=>{const s=t.getRelated(e);return s.exists(e=>Zs(e,n))},l=(e,t)=>{k.setContent(e,t)},d=(t,n,o)=>{s(t,n,o,e.none())},s=(e,t,n,s)=>{o(e,t,n,()=>s.map(e=>at(e)))},o=(n,s,o,i)=>{const a=t.lazySink(n).getOrDie();k.openWhileCloaked(n,s,()=>Ke.positionWithinBounds(a,n,o,i())),r.setValue(n,e.some({mode:"position",config:o,getBounds:i}))},u=(t,n,s)=>{i(t,n,s,e.none)},i=(n,s,o,i)=>{const a=uy(t,n,s,o,i);k.open(n,a),r.setValue(n,e.some({mode:"menu",menu:a}))},h=t=>{k.isOpen(t)&&(r.setValue(t,e.none()),k.close(t))},m=e=>k.getState(e),a=e=>{k.isOpen(e)&&r.getValue(e).each(n=>{switch(n.mode){case"menu":k.getState(e).each(Qs.repositionMenus);break;case"position":const s=t.lazySink(e).getOrDie();Ke.positionWithinBounds(s,e,n.config,n.getBounds());break}})},f={setContent:l,showAt:d,showWithin:s,showWithinBounds:o,showMenuAt:u,showMenuWithinBounds:i,hide:h,getContent:m,reposition:a,isOpen:k.isOpen};return{uid:t.uid,dom:t.dom,behaviours:we(t.inlineBehaviours,[k.config({isPartOf:(e,t,n)=>Zs(t,n)||c(e,n),getAttachPoint:e=>t.lazySink(e).getOrDie(),onOpen:e=>{t.onShow(e)},onClose:e=>{t.onHide(e)}}),r.config({store:{mode:"memory",initialValue:e.none()}}),It.config({channels:{...Z1({isExtraPart:n.isExtraPart,...t.fireDismissalEventInstead.map(e=>({fireEventInstead:{event:e.event}})).getOr({})}),...Q1({...t.fireRepositionEventInstead.map(e=>({fireEventInstead:{event:e.event}})).getOr({}),doReposition:a})}})]),eventOrder:t.eventOrder,apis:f}},te=gt({name:"InlineView",configFields:[s("lazySink"),E("onShow"),E("onHide"),Qa("onEscape"),ve("inlineBehaviours",[k,r,It]),vt("fireDismissalEventInstead",[t("event",di())]),vt("fireRepositionEventInstead",[t("event",Yh())]),t("getRelated",e.none),t("isExtraPart",U),t("eventOrder",e.none)],factory:ry,apis:{showAt:(e,t,n,s)=>{e.showAt(t,n,s)},showWithin:(e,t,n,s,o)=>{e.showWithin(t,n,s,o)},showWithinBounds:(e,t,n,s,o)=>{e.showWithinBounds(t,n,s,o)},showMenuAt:(e,t,n,s)=>{e.showMenuAt(t,n,s)},showMenuWithinBounds:(e,t,n,s,o)=>{e.showMenuWithinBounds(t,n,s,o)},hide:(e,t)=>{e.hide(t)},isOpen:(e,t)=>e.isOpen(t),getContent:(e,t)=>e.getContent(t),setContent:(e,t,n)=>{e.setContent(t,n)},reposition:(e,t)=>{e.reposition(t)}}});Ai=tinymce.util.Tools.resolve("tinymce.util.Delay");const ty=e=>{const n=Jc(e.action),s=e.dom.tag,t=t=>f(e.dom,"attributes").bind(e=>f(e,t)),o=()=>{if(s==="button"){const e=t("type").getOr("button"),n=t("role").map(e=>({role:e})).getOr({});return{type:e,...n}}const e=t("role").getOr("button");return{role:e}};return{uid:e.uid,dom:e.dom,components:e.components,events:n,behaviours:$t.augment(e.buttonBehaviours,[b.config({}),u.config({mode:"execution",useSpace:!0,useEnter:!0})]),domModification:{attributes:o()},eventOrder:e.eventOrder}},nt=gt({name:"Button",factory:ty,configFields:[t("uid",void 0),s("dom"),t("components",[]),$t.field("buttonBehaviours",[b,u]),D("action"),D("role"),t("eventOrder",{})]}),V=e=>{const t=TC(e)&&Vt(e,"uid")?e.uid:xo("memento"),n=e=>e.getSystem().getByUid(t).getOrDie(),s=e=>e.getSystem().getByUid(t).toOptional(),o=()=>({...e,uid:t});return{get:n,getOpt:s,asSpec:o}};Ft=tinymce.util.Tools.resolve("tinymce.util.I18n");const Qj={indent:!0,outdent:!0,"table-insert-column-after":!0,"table-insert-column-before":!0,"paste-column-after":!0,"paste-column-before":!0,"unordered-list":!0,"list-bull-circle":!0,"list-bull-default":!0,"list-bull-square":!0},Hp="temporary-placeholder",kd=e=>()=>f(e,Hp).getOr("!not found!"),xd=(e,t)=>{const n=e.toLowerCase();if(Ft.isRtl()){const e=NV(n,"-rtl");return R(t,e)?e:n}return n},Vp=(e,t)=>f(t,xd(e,t)),$p=(e,t)=>{const n=t();return Vp(e,n).getOrThunk(kd(n))},Xj=(e,t,n)=>{const s=t();return Vp(e,s).or(n).getOrThunk(kd(s))},Gj=e=>!!Ft.isRtl()&&R(Qj,e),_d=()=>O("add-focusable",[J(e=>{xz(e.element,"svg").each(e=>w(e,"focusable","false"))})]),qp=(e,t,n,s)=>{var o,a;const r=Gj(t)?["tox-icon--flip"]:[],c=f(n,xd(t,n)).or(s).getOrThunk(kd(n));return{dom:{tag:e.tag,attributes:(o=e.attributes)!==null&&o!==void 0?o:{},classes:e.classes.concat(r),innerHtml:c},behaviours:i([...(a=e.behaviours)!==null&&a!==void 0?a:[],_d()])}},fn=(t,n,s,o=e.none())=>qp(n,t,s(),o),Yj=(t,n,s)=>{const o=s(),i=se(t,e=>R(o,xd(e,o)));return qp(n,i.getOr(Hp),o,e.none())},qj={success:"checkmark",error:"warning",err:"error",warning:"warning",warn:"warning",info:"info"},Uj=t=>{const n=V({dom:{tag:"p",innerHtml:t.translationProvider(t.text)},behaviours:i([j.config({})])}),s=e=>({dom:{tag:"div",classes:["tox-bar"],styles:{width:`${e}%`}}}),a=e=>({dom:{tag:"div",classes:["tox-text"],innerHtml:`${e}%`}}),r=V({dom:{tag:"div",classes:t.progress?["tox-progress-bar","tox-progress-indicator"]:["tox-progress-bar"]},components:[{dom:{tag:"div",classes:["tox-bar-container"]},components:[s(0)]},a(0)],behaviours:i([j.config({})])}),l=(e,t)=>{e.getSystem().isConnected()&&r.getOpt(e).each(e=>{j.set(e,[{dom:{tag:"div",classes:["tox-bar-container"]},components:[s(t)]},a(t)])})},d=(e,t)=>{if(e.getSystem().isConnected()){const s=n.get(e);j.set(s,[je(t)])}},u={updateProgress:l,updateText:d},h=Fe([t.icon.toArray(),t.level.toArray(),t.level.bind(t=>e.from(qj[t])).toArray()]),c=V(nt.sketch({dom:{tag:"button",classes:["tox-notification__dismiss","tox-button","tox-button--naked","tox-button--icon"]},components:[fn("close",{tag:"div",classes:["tox-icon"],attributes:{"aria-label":t.translationProvider("Close")}},t.iconProvider)],action:e=>{t.onAction(e)}})),m=Yj(h,{tag:"div",classes:["tox-notification__icon"]},t.iconProvider),f={dom:{tag:"div",classes:["tox-notification__body"]},components:[n.asSpec()],behaviours:i([j.config({})])},p=[m,f];return{uid:t.uid,dom:{tag:"div",attributes:{role:"alert"},classes:t.level.map(e=>["tox-notification","tox-notification--in",`tox-notification--${e}`]).getOr(["tox-notification","tox-notification--in"])},behaviours:i([b.config({}),O("notification-events",[o(Cs(),e=>{c.getOpt(e).each(b.focus)})])]),components:p.concat(t.progress?[r.asSpec()]:[]).concat(t.closeButton?[c.asSpec()]:[]),apis:u}},fd=gt({name:"Notification",factory:Uj,configFields:[D("level"),s("progress"),D("icon"),s("onAction"),s("text"),s("iconProvider"),s("translationProvider"),ht("closeButton",!0)],apis:{updateProgress:(e,t,n)=>{e.updateProgress(t,n)},updateText:(e,t,n)=>{e.updateText(t,n)}}});Jp=(t,n,s)=>{const o=n.backstage.shared,i=()=>{const n=at(c.fromDom(t.getContentAreaContainer())),s=Sn(),o=Nt(s.x,n.x,n.right),i=Nt(s.y,n.y,n.bottom),a=Math.max(n.right,s.right),r=Math.max(n.bottom,s.bottom);return e.some(Be(o,i,a-o,r-i))},a=(n,a)=>{const d=()=>{a(),te.hide(l)},r=Ye(fd.sketch({text:n.text,level:Oe(["success","error","warning","warn","info"],n.type)?n.type:void 0,progress:n.progressBar===!0,icon:n.icon,closeButton:n.closeButton,onAction:d,iconProvider:o.providers.icons,translationProvider:o.providers.translate})),l=Ye(te.sketch({dom:{tag:"div",classes:["tox-notifications-container"]},lazySink:o.getSink,fireDismissalEventInstead:{},...o.header.isPositionedAtTop()?{}:{fireRepositionEventInstead:{}}}));s.add(l),gs(n.timeout)&&n.timeout>0&&Ai.setEditorTimeout(t,()=>{d()},n.timeout);const h=()=>{const s=tn(r),a={maxHeightFunction:Ea()},n=t.notificationManager.getNotifications();if(n[0]===u){const e={...o.anchors.banner(),overrides:a};te.showWithinBounds(l,s,{anchor:e},i)}else sv(n,u).each(t=>{const o=n[t-1].getEl(),r={type:"node",root:Un(),node:e.some(c.fromDom(o)),overrides:a,layouts:{onRtl:()=>[Ce],onLtr:()=>[Ce]}};te.showWithinBounds(l,s,{anchor:r},i)})},u={close:d,reposition:h,text:e=>{fd.updateText(r,e)},settings:n,getEl:()=>r.element.dom,progressBar:{value:e=>{fd.updateProgress(r,e)}}};return u},r=e=>{e.close()},l=e=>e.settings;return{open:a,close:r,getArgs:l}},Do=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),tg=tinymce.util.Tools.resolve("tinymce.EditorManager"),_o=tinymce.util.Tools.resolve("tinymce.Env"),function(e){e.default="wrap",e.floating="floating",e.sliding="sliding",e.scrolling="scrolling"}(zt||(zt={})),function(e){e.auto="auto",e.top="top",e.bottom="bottom"}(xa||(xa={}));const I=e=>t=>t.options.get(e),za=t=>n=>e.from(t(n)),rg=e=>{const n=_o.deviceType.isPhone(),i=_o.deviceType.isTablet()||n,t=e.options.register,s=e=>L(e)||e===!1,o=e=>L(e)||gs(e);t("skin",{processor:e=>L(e)||e===!1,default:"oxide"}),t("skin_url",{processor:"string"}),t("height",{processor:o,default:Math.max(e.getElement().offsetHeight,400)}),t("width",{processor:o,default:Do.DOM.getStyle(e.getElement(),"width")}),t("min_height",{processor:"number",default:100}),t("min_width",{processor:"number"}),t("max_height",{processor:"number"}),t("max_width",{processor:"number"}),t("style_formats",{processor:"object[]"}),t("style_formats_merge",{processor:"boolean",default:!1}),t("style_formats_autohide",{processor:"boolean",default:!1}),t("line_height_formats",{processor:"string",default:"1 1.1 1.2 1.3 1.4 1.5 2"}),t("font_family_formats",{processor:"string",default:"Andale Mono=andale mono,monospace;Arial=arial,helvetica,sans-serif;Arial Black=arial black,sans-serif;Book Antiqua=book antiqua,palatino,serif;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier,monospace;Georgia=georgia,palatino,serif;Helvetica=helvetica,arial,sans-serif;Impact=impact,sans-serif;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco,monospace;Times New Roman=times new roman,times,serif;Trebuchet MS=trebuchet ms,geneva,sans-serif;Verdana=verdana,geneva,sans-serif;Webdings=webdings;Wingdings=wingdings,zapf dingbats"}),t("font_size_formats",{processor:"string",default:"8pt 10pt 12pt 14pt 18pt 24pt 36pt"}),t("block_formats",{processor:"string",default:"Paragraph=p;Heading 1=h1;Heading 2=h2;Heading 3=h3;Heading 4=h4;Heading 5=h5;Heading 6=h6;Preformatted=pre"}),t("content_langs",{processor:"object[]"}),t("removed_menuitems",{processor:"string",default:""}),t("menubar",{processor:e=>L(e)||ts(e),default:!n}),t("menu",{processor:"object",default:{}}),t("toolbar",{processor:e=>ts(e)||L(e)||bs(e)?{value:e,valid:!0}:{valid:!1,message:"Must be a boolean, string or array."},default:!0}),gl(9,e=>{t("toolbar"+(e+1),{processor:"string"})}),t("toolbar_mode",{processor:"string",default:i?"scrolling":"floating"}),t("toolbar_groups",{processor:"object",default:{}}),t("toolbar_location",{processor:"string",default:xa.auto}),t("toolbar_persist",{processor:"boolean",default:!1}),t("toolbar_sticky",{processor:"boolean",default:e.inline}),t("toolbar_sticky_offset",{processor:"number",default:0}),t("fixed_toolbar_container",{processor:"string",default:""}),t("fixed_toolbar_container_target",{processor:"object"}),t("file_picker_callback",{processor:"function"}),t("file_picker_validator_handler",{processor:"function"}),t("file_picker_types",{processor:"string"}),t("typeahead_urls",{processor:"boolean",default:!0}),t("anchor_top",{processor:s,default:"#top"}),t("anchor_bottom",{processor:s,default:"#bottom"}),t("draggable_modal",{processor:"boolean",default:!1}),t("statusbar",{processor:"boolean",default:!0}),t("elementpath",{processor:"boolean",default:!0}),t("branding",{processor:"boolean",default:!0}),t("promotion",{processor:"boolean",default:!0}),t("resize",{processor:e=>e==="both"||ts(e),default:!_o.deviceType.isTouch()}),t("sidebar_show",{processor:"string"})},cg=I("readonly"),hd=I("height"),ud=I("width"),dd=za(I("min_width")),ld=za(I("min_height")),Kr=za(I("max_width")),cd=za(I("max_height")),pg=za(I("style_formats")),gg=I("style_formats_merge"),vg=I("style_formats_autohide"),bg=I("content_langs"),jg=I("removed_menuitems"),Eo=I("toolbar_mode"),_g=I("toolbar_groups"),rd=I("toolbar_location"),$j=I("fixed_toolbar_container"),Ij=I("fixed_toolbar_container_target"),Cg=I("toolbar_persist"),Eg=I("toolbar_sticky_offset"),kg=I("menubar"),Mr=I("toolbar"),Sg=I("file_picker_callback"),Mg=I("file_picker_validator_handler"),Fg=I("file_picker_types"),Tg=I("typeahead_urls"),zg=I("anchor_top"),Dg=I("anchor_bottom"),Ng=I("draggable_modal"),Lg=I("statusbar"),Rg=I("elementpath"),Pg=I("branding"),Hg=I("resize"),Ig=I("paste_as_text"),Bg=I("sidebar_show"),Vg=I("promotion"),sd=e=>e.options.get("skin")===!1,Sr=e=>e.options.get("menubar")!==!1,Ug=e=>{const t=e.options.get("skin_url");if(sd(e))return t;if(t)return e.documentBaseURI.toAbsolute(t);const skin=e.options.get("skin");return tg.baseURL+"/skins/ui/"+skin},Kg=e=>e.options.get("line_height_formats").split(" "),Cr=e=>{const t=Mr(e),n=L(t),s=bs(t)&&t.length>0;return!Ji(e)&&(s||n||t===!0)},nd=e=>{const n=gl(9,t=>e.options.get("toolbar"+(t+1))),t=q(n,L);return Ti(t.length>0,t)},Ji=e=>nd(e).fold(()=>{const t=Mr(e);return Hi(t,L)&&t.length>0},ye),td=e=>rd(e)===xa.bottom,Qg=t=>{var n;if(!t.inline)return e.none();const s=(n=$j(t))!==null&&n!==void 0?n:"";if(s.length>0)return be(Un(),s);const o=Ij(t);return en(o)?e.some(c.fromDom(o)):e.none()},Bi=e=>e.inline&&Qg(e).isSome(),ed=e=>{const t=Qg(e);return t.getOrThunk(()=>Kc(Pt(c.fromDom(e.getElement()))))},Jl=e=>e.inline&&!Sr(e)&&!Cr(e)&&!Ji(e),zi=e=>{const t=e.options.get("toolbar_sticky");return(t||e.inline)&&!Bi(e)&&!Jl(e)},n5=e=>{const t=e.options.get("menu");return _e(t,e=>({...e,items:e.items}))};s5=Object.freeze({__proto__:null,get ToolbarMode(){return zt},get ToolbarLocation(){return xa},register:rg,getSkinUrl:Ug,isReadOnly:cg,isSkinDisabled:sd,getHeightOption:hd,getWidthOption:ud,getMinWidthOption:dd,getMinHeightOption:ld,getMaxWidthOption:Kr,getMaxHeightOption:cd,getUserStyleFormats:pg,shouldMergeStyleFormats:gg,shouldAutoHideStyleFormats:vg,getLineHeightFormats:Kg,getContentLanguages:bg,getRemovedMenuItems:jg,isMenubarEnabled:Sr,isMultipleToolbars:Ji,isToolbarEnabled:Cr,isToolbarPersist:Cg,getMultipleToolbarsOption:nd,getUiContainer:ed,useFixedContainer:Bi,getToolbarMode:Eo,isDraggableModal:Ng,isDistractionFree:Jl,isStickyToolbar:zi,getStickyToolbarOffset:Eg,getToolbarLocation:rd,isToolbarLocationBottom:td,getToolbarGroups:_g,getMenus:n5,getMenubar:kg,getToolbar:Mr,getFilePickerCallback:Sg,getFilePickerTypes:Fg,useTypeaheadUrls:Tg,getAnchorTop:zg,getAnchorBottom:Dg,getFilePickerValidatorHandler:Mg,useStatusBar:Lg,useElementPath:Rg,promotionEnabled:Vg,useBranding:Pg,getResize:Hg,getPasteAsText:Ig,getSidebarShow:Bg});const o5="[data-mce-autocompleter]",i5=e=>cn(e,o5),Hj=e=>be(e,o5),Pj=(e,t)=>{const s=(e,t)=>{p(e,_a(),{raw:t})},n=()=>e.getMenu().bind(F.getHighlighted);t.on("keydown",t=>{const o=t.which;if(!e.isActive())return;e.isMenuOpen()?o===13?(n().each(mo),t.preventDefault()):o===40?(n().fold(()=>{e.getMenu().each(F.highlightFirst)},e=>{s(e,t)}),t.preventDefault(),t.stopImmediatePropagation()):(o===37||o===38||o===39)&&n().each(e=>{s(e,t),t.preventDefault(),t.stopImmediatePropagation()}):(o===13||o===38||o===40)&&e.cancelIfNecessary()}),t.on("NodeChange",t=>{e.isActive()&&!e.isProcessingAction()&&i5(c.fromDom(t.element)).isNone()&&e.cancelIfNecessary()})},Rj={setup:Pj};(function(e){e[e.CLOSE_ON_EXECUTE=0]="CLOSE_ON_EXECUTE",e[e.BUBBLE_TO_SANDBOX=1]="BUBBLE_TO_SANDBOX"})(Ql||(Ql={})),Yt=Ql;const Gl="tox-menu-nav__js",wr="tox-collection__item",Yl="tox-swatch",Dj={normal:Gl,color:Yl},p5="tox-collection__item--enabled",Mj="tox-collection__group-heading",v5="tox-collection__item-icon",Ul="tox-collection__item-label",Sj="tox-collection__item-accessory",y5="tox-collection__item-caret",Aj="tox-collection__item-checkmark",Ci="tox-collection__item--active",O5="tox-collection__item-container",Ej="tox-collection__item-container--column",C5="tox-collection__item-container--row",Cj="tox-collection__item-container--align-right",vj="tox-collection__item-container--align-left",cj="tox-collection__item-container--valign-top",sj="tox-collection__item-container--valign-middle",nj="tox-collection__item-container--valign-bottom",F5=e=>f(Dj,e).getOr(Gl),Zb=e=>e==="color"?"tox-swatches":"tox-menu",$l=e=>({backgroundMenu:"tox-background-menu",selectedMenu:"tox-selected-menu",selectedItem:"tox-collection__item--active",hasIcons:"tox-menu--has-icons",menu:Zb(e),tieredMenu:"tox-tiered-menu"}),so=e=>{const t=$l(e);return{backgroundMenu:t.backgroundMenu,selectedMenu:t.selectedMenu,menu:t.menu,selectedItem:t.selectedItem,item:F5(e)}},Xb=(e,t,n)=>{const s=$l(n);return{tag:"div",classes:Fe([[s.menu,`tox-menu-${t}-column`],e?[s.hasIcons]:[]])}},Yb=[Bs.parts.items({})],lr=(e,t,n)=>{const s=$l(n),o={tag:"div",classes:Fe([[s.tieredMenu]])};return{dom:o,markers:so(n)}},P5=n([D("data"),t("inputAttributes",{}),t("inputStyles",{}),t("tag","input"),t("inputClasses",[]),E("onSetValue"),t("styles",{}),t("eventOrder",{}),ve("inputBehaviours",[r,b]),t("selectOnFocus",!0)]),H5=e=>i([b.config({onFocus:e.selectOnFocus?e=>{const t=e.element,n=Fn(t);t.dom.setSelectionRange(0,n.length)}:l})]),qb=e=>({...H5(e),...we(e.inputBehaviours,[r.config({store:{mode:"manual",...e.data.map(e=>({initialValue:e})).getOr({}),getValue:e=>Fn(e.element),setValue:(e,t)=>{const n=Fn(e.element);n!==t&&Is(e.element,t)}},onSetValue:e.onSetValue})])}),B5=e=>({tag:e.tag,attributes:{type:"text",...e.inputAttributes},styles:e.inputStyles,classes:e.inputClasses}),Kb=(e)=>({uid:e.uid,dom:B5(e),components:[],behaviours:qb(e),eventOrder:e.eventOrder}),ni=gt({name:"Input",configFields:P5(),factory:Kb}),W5=d("refetch-trigger-event"),U5=d("redirect-menu-item-interaction"),K5="tox-menu__searcher",cr=e=>be(e.element,`.${K5}`).bind(t=>e.getSystem().getByDom(t).toOptional()),Y5=cr,Ub=(e,t)=>{r.setValue(e,t.fetchPattern),e.element.dom.selectionStart=t.selectionStart,e.element.dom.selectionEnd=t.selectionEnd},X5=e=>{const t=r.getValue(e),n=e.element.dom.selectionStart,s=e.element.dom.selectionEnd;return{fetchPattern:t,selectionStart:n,selectionEnd:s}},Wb=(e,t)=>{ut(t.element,"id").each(t=>w(e.element,"aria-activedescendant",t))},$b=t=>{const s=(t,n)=>(n.cut(),e.none()),n=(t,n)=>{const s={interactionEvent:n.event,eventType:n.event.raw.type};return p(t,U5,s),e.some(!0)},a="searcher-events";return{dom:{tag:"div",classes:[wr]},components:[ni.sketch({inputClasses:[K5,"tox-textfield"],inputAttributes:{...t.placeholder.map(e=>({placeholder:t.i18n(e)})).getOr({}),type:"search","aria-autocomplete":"list"},inputBehaviours:i([O(a,[o(oo(),e=>{T(e,W5)}),o(_a(),(e,t)=>{t.event.raw.key==="Escape"&&t.stop()})]),u.config({mode:"special",onLeft:s,onRight:s,onSpace:s,onEnter:n,onEscape:n,onUp:n,onDown:n})]),eventOrder:{keydown:[a,u.name()]}})]}},ir="tox-collection--results__js",e7=e=>{var t;return e.dom?{...e,dom:{...e.dom,attributes:{...(t=e.dom.attributes)!==null&&t!==void 0?t:{},id:d("aria-item-search-result-id"),"aria-selected":"false"}}}:e},Il=(e,t)=>n=>{const s=K7(n,t);return a(s,t=>({dom:e,components:t}))},Vb=e=>({dom:{tag:"div",classes:["tox-menu","tox-swatches-menu"]},components:[{dom:{tag:"div",classes:["tox-swatches"]},components:[Bs.parts.items({preprocess:e!=="auto"?Il({tag:"div",classes:["tox-swatches__row"]},e):z})]}]}),Bb=e=>({dom:{tag:"div",classes:["tox-menu","tox-collection","tox-collection--toolbar","tox-collection--toolbar-lg"]},components:[Bs.parts.items({preprocess:Il({tag:"div",classes:["tox-collection__group"]},e)})]}),o7=(e,t)=>{const s=[];let n=[];return h(e,(e,o)=>{t(e,o)?(n.length>0&&s.push(n),n=[],(R(e.dom,"innerHtml")||e.components&&e.components.length>0)&&n.push(e)):n.push(e)}),n.length>0&&s.push(n),a(s,e=>({dom:{tag:"div",classes:["tox-collection__group"]},components:e}))},Ll=(e,t,n)=>Bs.parts.items({preprocess:s=>{const o=a(s,n);return e!=="auto"&&e>1?Il({tag:"div",classes:["tox-collection__group"]},e)(o):o7(o,(e,n)=>t[n].type==="separator")}}),a7=(e,t)=>({dom:{tag:"div",classes:["tox-menu","tox-collection"].concat(e===1?["tox-collection--list"]:["tox-collection--grid"])},components:[Ll(e,t,z)]}),Rb=(e,t)=>{const s=d("aria-controls-search-results");return{dom:{tag:"div",classes:["tox-menu","tox-collection",ir].concat(e===1?["tox-collection--list"]:["tox-collection--grid"]),attributes:{id:s}},components:[Ll(e,t,e7)]}},Db=(e,t,n)=>{const s=d("aria-controls-search-results");return{dom:{tag:"div",classes:["tox-menu","tox-collection"].concat(e===1?["tox-collection--list"]:["tox-collection--grid"])},components:[$b({i18n:Ft.translate,placeholder:n.placeholder}),{dom:{tag:"div",classes:[...e===1?["tox-collection--list"]:["tox-collection--grid"],ir],attributes:{id:s}},components:[Ll(e,t,e7)]}]}},zb=(e)=>({dom:{tag:"div",classes:["tox-collection","tox-collection--horizontal"]},components:[Bs.parts.items({preprocess:t=>o7(t,(t,n)=>e[n].type==="separator")})]}),nr=e=>vn(e,e=>"icon"in e&&e.icon!==void 0),In=t=>(console.error(oi(t)),console.log(t),e.none()),Tb=(e,t,n)=>{const i=zb(n);return{value:e,dom:i.dom,components:i.components,items:n}},zl=(e,t,n,s,o)=>{const i=()=>o.menuType!=="searchable"?a7(s,n):o.searchMode.searchMode==="search-with-field"?Db(s,n,o.searchMode):Rb(s,n);if(o.menuType==="color"){const t=Vb(s);return{value:e,dom:t.dom,components:t.components,items:n}}if(o.menuType==="normal"&&s==="auto"){const t=a7(s,n);return{value:e,dom:t.dom,components:t.components,items:n}}if(o.menuType==="normal"||o.menuType==="searchable"){const t=i();return{value:e,dom:t.dom,components:t.components,items:n}}if(o.menuType==="listpreview"&&s!=="auto"){const t=Bb(s);return{value:e,dom:t.dom,components:t.components,items:n}}return{value:e,dom:Xb(t,s,o.menuType),components:Yb,items:n}},ne=he("type"),Tl=he("name"),Fl=he("label"),us=he("text"),Mb=he("title"),j7=he("icon"),ea=he("value"),Sb=Ht("fetch"),kb=Ht("getSubmenuItems"),Co=Ht("onAction"),Eb=Ht("onItemAction"),Ys=fe("onSetup",()=>l),Cb=ct("name"),Io=ct("text"),jn=ct("icon"),Ba=ct("tooltip"),xl=ct("label"),Ob=ct("shortcut"),_b=Qa("select"),er=ht("active",!1),yb=ht("borderless",!1),Gt=ht("enabled",!0),Er=ht("primary",!1),R7=e=>t("columns",e),_l=t("meta",{}),yl=fe("onAction",l),lo=e=>qn("type",e),bl=e=>Me("name","name",$r(()=>d(`${e}-name`)),Ae),jb=e=>Me("value","value",$r(()=>d(`${e}-value`)),yn()),$7=m([ne,Io]),vb=e=>X("separatormenuitem",$7,e),pb=m([lo("autocompleteitem"),er,Gt,_l,ea,Io,jn]),fb=e=>X("Autocompleter.Separator",$7,e),cb=e=>X("Autocompleter.Item",pb,e),ha=[Gt,Ba,jn,Io,Ys],ob=m([ne,Co].concat(ha)),X7=e=>X("toolbarbutton",ob,e),fl=[er].concat(ha),sb=m(fl.concat([ne,Co])),J7=e=>X("ToggleButton",sb,e),ev=[fe("predicate",U),Kn("scope","node",["node","editor"]),Kn("position","selection",["node","selection","line"])],nb=ha.concat([lo("contextformbutton"),Er,Co,Xe("original",z)]),tb=fl.concat([lo("contextformbutton"),Er,Co,Xe("original",z)]),eb=ha.concat([lo("contextformbutton")]),J9=fl.concat([lo("contextformtogglebutton")]),Z9=yt("type",{contextformbutton:nb,contextformtogglebutton:tb}),Q9=m([lo("contextform"),fe("initValue",n("")),xl,xt("commands",Z9),is("launch",yt("type",{contextformbutton:eb,contextformtogglebutton:J9}))].concat(ev)),Y9=e=>X("ContextForm",Q9,e),q9=m([lo("contexttoolbar"),he("items")].concat(ev)),K9=e=>X("ContextToolbar",q9,e),U9=[ne,he("src"),ct("alt"),Xa("classes",[],Ae)],W9=m(U9),H9=[ne,us,Cb,Xa("classes",["tox-collection__item-label"],Ae)],P9=m(H9),fv=z2(()=>fr("type",{cardimage:W9,cardtext:P9,cardcontainer:R9})),R9=m([ne,qn("direction","horizontal"),qn("align","left"),qn("valign","middle"),xt("items",fv)]),zo=[Gt,Io,Ob,jb("menuitem"),_l],L9=m([ne,xl,xt("items",fv),Ys,yl].concat(zo)),N9=e=>X("cardmenuitem",L9,e),T9=m([ne,er,jn].concat(zo)),M9=e=>X("choicemenuitem",T9,e),_v=[ne,he("fancytype"),yl],A9=[t("initData",{})].concat(_v),k9=[O4("initData",{},[ht("allowCustomColors",!0),qn("storageKey","default"),Q4("colors",yn())])].concat(_v),C9=yt("fancytype",{inserttable:A9,colorswatch:k9}),j9=e=>X("fancymenuitem",C9,e),g9=m([ne,Ys,yl,jn].concat(zo)),p9=e=>X("menuitem",g9,e),f9=m([ne,kb,Ys,jn].concat(zo)),h9=e=>X("nestedmenuitem",f9,e),u9=m([ne,jn,er,Ys,Co].concat(zo)),d9=e=>X("togglemenuitem",u9,e),al=(t,n,s)=>{const o=Ue(t.element,"."+s);if(o.length>0){const t=Zo(o,e=>{const t=e.dom.getBoundingClientRect().top,s=o[0].dom.getBoundingClientRect().top;return Math.abs(t-s)>n}).getOr(o.length);return e.some({numColumns:t,numRows:Math.ceil(o.length/t)})}return e.none()},zv=(e,t)=>i([O(e,t)]),r9=e=>zv(d("unnamed-events"),e),ta={namedEvents:zv,unnamedEvents:r9},Lv=d("tooltip.exclusive"),va=d("tooltip.show"),ba=d("tooltip.hide"),Hv=(e)=>{e.getSystem().broadcastOn([Lv],{})},a9=(e,t,n,s)=>{n.getTooltip().each(e=>{e.getSystem().isConnected()&&j.set(e,s)})};Bv=Object.freeze({__proto__:null,hideAllExclusive:Hv,setComponents:a9});const i9=(e,t)=>{const n=n=>{t.getTooltip().each(s=>{Yn(s),e.onHide(n,s),t.clearTooltip()}),t.clearTimer()},s=n=>{if(!t.isShowing()){Hv(n);const a=e.lazySink(n).getOrDie(),s=n.getSystem().build({dom:e.tooltipDom,components:e.tooltipComponents,events:$(e.mode==="normal"?[o(_s(),e=>{T(n,va)}),o(A1(),e=>{T(n,ba)})]:[]),behaviours:i([j.config({})])});t.setTooltip(s),Us(a,s),e.onShow(n,s),Ke.position(a,s,{anchor:e.anchor(n)})}};return $(Fe([[o(va,n=>{t.resetTimer(()=>{s(n)},e.delay)}),o(ba,s=>{t.resetTimer(()=>{n(s)},e.delay)}),o(ao(),(e,t)=>{const s=t;s.universal||Oe(s.channels,Lv)&&n(e)}),Hn(e=>{n(e)})],e.mode==="normal"?[o(Cs(),e=>{T(e,va)}),o(_1(),e=>{T(e,ba)}),o(_s(),e=>{T(e,va)}),o(A1(),e=>{T(e,ba)})]:[o(Fm(),(e)=>{T(e,va)}),o(Du(),e=>{T(e,ba)})]]))};$v=Object.freeze({__proto__:null,events:i9}),Wv=[s("lazySink"),s("tooltipDom"),t("exclusive",!0),t("tooltipComponents",[]),t("delay",300),Kn("mode","normal",["normal","follow-highlight"]),t("anchor",e=>({type:"hotspot",hotspot:e,layouts:{onLtr:n([Ce,pt,Ne,Qe,Le,tt]),onRtl:n([Ce,pt,Ne,Qe,Le,tt])}})),E("onHide"),E("onShow")];const o9=()=>{const t=K(),e=K(),s=()=>{t.on(clearTimeout)},o=(e,n)=>{s(),t.set(setTimeout(e,n))},i=n("not-implemented");return jt({getTooltip:e.get,isShowing:e.isSet,setTooltip:e.set,clearTooltip:e.clear,clearTimer:s,resetTimer:o,readState:i})};Kv=Object.freeze({__proto__:null,init:o9});const qv=xe({fields:Wv,name:"tooltipping",active:$v,state:Kv,apis:Bv}),Jv=e=>e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),Gv="silver.readonly",Zv=m([lP("readonly")]),qa=(e,t)=>{const s=e.mainUi.outerContainer,o=s.element,n=[e.mainUi.mothership,...e.uiMotherships];t&&h(n,e=>{e.broadcastOn([Es()],{target:o})}),h(n,e=>{e.broadcastOn([Gv],{readonly:t})})},Xv=(e,t)=>{e.on("init",()=>{e.mode.isReadOnly()&&qa(t,!0)}),e.on("SwitchMode",()=>qa(t,e.mode.isReadOnly())),cg(e)&&e.mode.set("readonly")},re=()=>It.config({channels:{[Gv]:{schema:Zv,onReceive:(e,t)=>{v.set(e,t.readonly)}}}}),e9=e=>v.config({disabled:e,disableClass:"tox-collection__item--state-disabled"}),t9=e=>v.config({disabled:e}),n9=e=>v.config({disabled:e,disableClass:"tox-tbtn--disabled"}),s9=e=>v.config({disabled:e,disableClass:"tox-tbtn--disabled",useNative:!1}),on={item:e9,button:t9,splitButton:n9,toolbarButton:s9},Xc=(e,t)=>{const n=e.getApi(t);return e=>{e(n)}},Ca=(e,t)=>J(n=>{const s=Xc(e,n);s(n=>{const s=e.onSetup(n);Mt(s)&&t.set(s)})}),ki=(e,t)=>Hn(n=>Xc(e,n)(t.get())),c9=(e,t)=>Jn((n,s)=>{Xc(e,n)(e.onAction),!e.triggersSubmenu&&t===Yt.CLOSE_ON_EXECUTE&&(n.getSystem().isConnected()&&T(n,dr()),s.stop())}),l9={[bt()]:["disabling","alloy.base.behaviour","toggling","item-events"]},fi=po,ri=(e,t,n,s)=>{const o=g(l);return{type:"item",dom:t.dom,components:fi(t.optComponents),data:e.data,eventOrder:l9,hasSubmenu:e.triggersSubmenu,itemBehaviours:i([O("item-events",[c9(e,n),Ca(e,o),ki(e,o)]),on.item(()=>!e.enabled||s.isDisabled()),re(),j.config({})].concat(e.itemBehaviours))}},Ao=e=>({value:e.value,meta:{text:e.text.getOr(""),...e.meta}}),m9=e=>{const t=_o.os.isMacOS()||_o.os.isiOS(),o={alt:"⌥",ctrl:"⌃",shift:"⇧",meta:"⌘",access:"⌃⌥"},i={meta:"Ctrl",access:"Shift+Alt"},n=t?o:i,r=e.split("+"),s=a(r,e=>{const t=e.toLowerCase().trim();return R(n,t)?n[t]:e});return t?s.join(""):s.join("+")},ll=(e,t,n=[v5])=>fn(e,{tag:"div",classes:n},t),kv=e=>({dom:{tag:"div",classes:[Ul]},components:[je(Ft.translate(e))]}),Ev=(e,t)=>({dom:{tag:"div",classes:t,innerHtml:e}}),v9=(e,t)=>({dom:{tag:"div",classes:[Ul]},components:[{dom:{tag:e.tag,styles:e.styles},components:[je(Ft.translate(t))]}]}),b9=e=>({dom:{tag:"div",classes:[Sj]},components:[je(m9(e))]}),Cv=e=>ll("checkmark",e,[Aj]),y9=e=>ll("chevron-right",e,[y5]),_9=e=>ll("chevron-down",e,[y5]),w9=(e,t)=>{const n=e.direction==="vertical"?Ej:C5,s=e.align==="left"?vj:Cj,o=()=>{switch(e.valign){case"top":return cj;case"middle":return sj;case"bottom":return nj}};return{dom:{tag:"div",classes:[O5,n,s,o()]},components:t}},O9=(e,t,n)=>({dom:{tag:"img",classes:t,attributes:{src:e,alt:n.getOr("")}}}),x9=(e,t,n)=>{const o="custom",i="remove",a=e.ariaLabel,s=e.value,r=e.iconContent.map(e=>Xj(e,t.icons,n)),c=()=>{const c=Yl,n=r.getOr(""),l=a.map(e=>({title:t.translate(e)})).getOr({}),e={tag:"div",attributes:l,classes:[c]};return s===o?{...e,tag:"button",classes:[...e.classes,"tox-swatches__picker-btn"],innerHtml:n}:s===i?{...e,classes:[...e.classes,"tox-swatch--remove"],innerHtml:n}:en(s)?{...e,attributes:{...e.attributes,"data-mce-color":s},styles:{"background-color":s},innerHtml:n}:e};return{dom:c(),optComponents:[]}},xv=e=>{const t=e.map(e=>({attributes:{title:Ft.translate(e)}})).getOr({});return{tag:"div",classes:[Gl,wr],...t}},E9=(t,n,s,o)=>{const i={tag:"div",classes:[v5]},a=e=>fn(e,i,n.icons,o),r=()=>e.some({dom:i}),c=s?t.iconContent.map(a).orThunk(r):e.none(),l=t.checkMark,d=e.from(t.meta).fold(()=>kv,e=>R(e,"style")?Tt(v9,e.style):kv),u=t.htmlContent.fold(()=>t.textContent.map(d),t=>e.some(Ev(t,[Ul]))),h={dom:xv(t.ariaLabel),optComponents:[c,u,t.shortcutContent.map(b9),l,t.caret]};return h},Aa=(t,n,s,o=e.none())=>t.presets==="color"?x9(t,n,o):E9(t,n,s,o),wv=(e,t)=>f(e,"tooltipWorker").map(e=>[qv.config({lazySink:t.getSink,tooltipDom:{tag:"div",classes:["tox-tooltip-worker-container"]},tooltipComponents:[],anchor:e=>({type:"submenu",item:e,overrides:{maxHeightFunction:Ea}}),mode:"follow-highlight",onShow:(t)=>{e(e=>{qv.setComponents(t,[w5({element:c.fromDom(e)})])})}})]).getOr([]),S9=e=>Do.DOM.encode(e),yv=(e,t)=>{const s=Ft.translate(e),n=S9(s);if(t.length>0){const e=new RegExp(Jv(t),"gi");return n.replace(e,e=>`<span class="tox-autocompleter-highlight">${e}</span>`)}return n},F9=(t,s,o,i,a,r,c,d=!0)=>{const u=Aa({presets:i,textContent:e.none(),htmlContent:o?t.text.map(e=>yv(e,s)):e.none(),ariaLabel:t.text,iconContent:t.icon,shortcutContent:e.none(),checkMark:e.none(),caret:e.none(),value:t.value},c.providers,d,t.icon);return ri({data:Ao(t),enabled:t.enabled,getApi:n({}),onAction:e=>a(t.value,t.meta),onSetup:n(l),triggersSubmenu:!1,itemBehaviours:wv(t.meta,c)},u,r,c.providers)},jv=(t,n)=>a(t,t=>{switch(t.type){case"cardcontainer":return w9(t,jv(t.items,n));case"cardimage":return O9(t.src,t.classes,t.alt);case"cardtext":const s=t.name.exists(e=>Oe(n.cardText.highlightOn,e)),o=s?e.from(n.cardText.matchText).getOr(""):"";return Ev(yv(t.text,o),t.classes)}}),z9=(t,n,s,o)=>{const i=e=>({isEnabled:()=>!v.isDisabled(e),setEnabled:t=>{v.set(e,!t),h(Ue(e.element,"*"),n=>{e.getSystem().getByDom(n).each(e=>{e.hasConfigured(v)&&v.set(e,!t)})})}}),a={dom:xv(t.label),optComponents:[e.some({dom:{tag:"div",classes:[O5,C5]},components:jv(t.items,o)})]};return ri({data:Ao({text:e.none(),...t}),enabled:t.enabled,getApi:i,onAction:t.onAction,onSetup:t.onSetup,triggersSubmenu:!1,itemBehaviours:e.from(o.itemBehaviours).getOr([])},a,n,s.providers)},D9=(t,n,s,o,i,a,r,c=!0)=>{const d=e=>({setActive:t=>{A.set(e,t)},isActive:()=>A.isOn(e),isEnabled:()=>!v.isDisabled(e),setEnabled:t=>v.set(e,!t)}),u=Aa({presets:s,textContent:n?t.text:e.none(),htmlContent:e.none(),ariaLabel:t.text,iconContent:t.icon,shortcutContent:n?t.shortcut:e.none(),checkMark:n?e.some(Cv(r.icons)):e.none(),caret:e.none(),value:t.value},r,c);return Q(ri({data:Ao(t),enabled:t.enabled,getApi:d,onAction:e=>o(t.value),onSetup:e=>(e.setActive(i),l),triggersSubmenu:!1,itemBehaviours:[]},u,a,r),{toggling:{toggleClass:p5,toggleOnExecute:!1,selected:t.active,exclusive:!0}})},bv=O1(Hd(),Pd()),vv=e=>({value:e}),pv=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,mv=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,hv=e=>pv.test(e)||mv.test(e),I9=e=>LV(e,"#").toUpperCase(),B9=t=>hv(t)?e.some({value:I9(t)}):e.none(),V9=e=>{const t=e.value.replace(pv,(e,t,n,s)=>t+t+n+n+s+s);return{value:t}},$9=e=>{const n=V9(e),t=mv.exec(n.value);return t===null?["FFFFFF","FF","FF","FF"]:t},dl=e=>{const t=e.toString(16);return(t.length===1?"0"+t:t).toUpperCase()},Oa=e=>{const t=dl(e.red)+dl(e.green)+dl(e.blue);return vv(t)},lv=Math.min,cv=Math.max,Lr=Math.round,G9=/^\s*rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)\s*$/i,X9=/^\s*rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d?(?:\.\d+)?)\s*\)\s*$/i,js=(e,t,n,s)=>({red:e,green:t,blue:n,alpha:s}),ml=e=>{const t=parseInt(e,10);return t.toString()===e&&t>=0&&t<=255},ov=e=>{let t,n,s;const d=(e.hue||0)%360;let r=e.saturation/100,a=e.value/100;if(r=cv(0,lv(r,1)),a=cv(0,lv(a,1)),r===0)return t=n=s=Lr(255*a),js(t,n,s,1);const l=d/60,o=a*r,i=o*(1-Math.abs(l%2-1)),c=a-o;switch(Math.floor(l)){case 0:t=o,n=i,s=0;break;case 1:t=i,n=o,s=0;break;case 2:t=0,n=o,s=i;break;case 3:t=0,n=i,s=o;break;case 4:t=i,n=0,s=o;break;case 5:t=o,n=0,s=i;break;default:t=n=s=0}return t=Lr(255*(t+c)),n=Lr(255*(n+c)),s=Lr(255*(s+c)),js(t,n,s,1)},ja=e=>{const t=$9(e),n=parseInt(t[1],16),s=parseInt(t[2],16),o=parseInt(t[3],16);return js(n,s,o,1)},nv=(e,t,n,s)=>{const o=parseInt(e,10),i=parseInt(t,10),a=parseInt(n,10),r=parseFloat(s);return js(o,i,a,r)},tv=t=>{if(t==="transparent")return e.some(js(0,0,0,0));const s=G9.exec(t);if(s!==null)return e.some(nv(s[1],s[2],s[3],"1"));const n=X9.exec(t);return n!==null?e.some(nv(n[1],n[2],n[3],n[4])):e.none()},Z7=e=>`rgba(${e.red},${e.green},${e.blue},${e.alpha})`,G7=js(255,0,0,1),ib=e=>{e.dispatch("SkinLoaded")},ab=(e,t)=>{e.dispatch("SkinLoadError",t)},rb=e=>{e.dispatch("ResizeEditor")},vl=(e,t)=>{e.dispatch("ResizeContent",t)},lb=(e,t)=>{e.dispatch("ScrollContent",t)},db=(e,t)=>{e.dispatch("TextColorChange",t)},ub=(e,t)=>{e.dispatch("AfterProgressState",{state:t})},hb=(e,t)=>e.dispatch("ResolveName",{name:t.nodeName.toLowerCase(),target:t}),mb=(e,t)=>{e.dispatch("ToggleToolbarDrawer",{state:t})};xs=tinymce.util.Tools.resolve("tinymce.util.LocalStorage");const U7={},gb=(e,t=10)=>{const s=xs.getItem(e),o=L(s)?JSON.parse(s):[],i=e=>{const n=t-e.length;return n<0?e.slice(0,t):e},n=i(o),a=s=>{sv(n,s).each(r),n.unshift(s),n.length>t&&n.pop(),xs.setItem(e,JSON.stringify(n))},r=e=>{n.splice(e,1)},c=()=>n.slice(0);return{add:a,state:c}},W7=e=>f(U7,e).getOrThunk(()=>{const t=`tinymce-custom-colors-${e}`,s=xs.getItem(t);if(xc(s)){const e=xs.getItem("tinymce-custom-colors");xs.setItem(t,en(e)?e:"[]")}const n=gb(t,10);return U7[e]=n,n}),bb=e=>a(W7(e).state(),e=>({type:"choiceitem",text:e,icon:"checkmark",value:e})),V7=(e,t)=>{W7(e).add(t)},Gi=(e,t,n)=>({hue:e,saturation:t,value:n}),Ol=e=>{let i=0,c=0,a=0;const n=e.red/255,r=e.green/255,s=e.blue/255,t=Math.min(n,Math.min(r,s)),o=Math.max(n,Math.max(r,s));if(t===o)return a=t,Gi(0,0,a*100);const l=n===t?r-s:s===t?n-r:s-n;return i=n===t?3:s===t?1:5,i=60*(i-l/(o-t)),c=(o-t)/o,a=o,Gi(Math.round(i),Math.round(c*100),Math.round(a*100))},wb=e=>Ol(ja(e)),F7=e=>Oa(ov(e)),xb=e=>B9(e).orThunk(()=>tv(e).map(Oa)).getOrThunk(()=>{const t=document.createElement("canvas");t.height=1,t.width=1;const n=t.getContext("2d");n.clearRect(0,0,t.width,t.height),n.fillStyle="#FFFFFF",n.fillStyle=e,n.fillRect(0,0,1,1);const s=n.getImageData(0,0,1,1).data,o=s[0],i=s[1],a=s[2],r=s[3];return Oa(js(o,i,a,r))}),El="forecolor",kl="hilitecolor",Al=e=>Math.max(5,Math.ceil(Math.sqrt(e))),Ab=e=>{const t=[];for(let n=0;n<e.length;n+=2)t.push({text:e[n+1],value:"#"+xb(e[n]).value,icon:"checkmark",type:"choiceitem"});return t},Zn=e=>t=>t.options.get(e),Ml="#000000",Fb=e=>{const t=e.options.register,n=e=>Hi(e,L)?{value:Ab(e),valid:!0}:{valid:!1,message:"Must be an array of strings."};t("color_map",{processor:n,default:["#BFEDD2","Light Green","#FBEEB8","Light Yellow","#F8CAC6","Light Red","#ECCAFA","Light Purple","#C2E0F4","Light Blue","#2DC26B","Green","#F1C40F","Yellow","#E03E2D","Red","#B96AD9","Purple","#3598DB","Blue","#169179","Dark Turquoise","#E67E23","Orange","#BA372A","Dark Red","#843FA1","Dark Purple","#236FA1","Dark Blue","#ECF0F1","Light Gray","#CED4D9","Medium Gray","#95A5A6","Gray","#7E8C8D","Dark Gray","#34495E","Navy Blue","#000000","Black","#ffffff","White"]}),t("color_map_background",{processor:n}),t("color_map_foreground",{processor:n}),t("color_cols",{processor:"number",default:Al($i(e,"default").length)}),t("color_cols_foreground",{processor:"number",default:Al($i(e,El).length)}),t("color_cols_background",{processor:"number",default:Al($i(e,kl).length)}),t("custom_colors",{processor:"boolean",default:!0}),t("color_default_foreground",{processor:"string",default:Ml}),t("color_default_background",{processor:"string",default:Ml})},h7=(e,t)=>t===El?Zn("color_cols_foreground")(e):t===kl?Zn("color_cols_background")(e):Zn("color_cols")(e),l7=Zn("custom_colors"),$i=(e,t)=>t===El&&e.options.isSet("color_map_foreground")?Zn("color_map_foreground")(e):t===kl&&e.options.isSet("color_map_background")?Zn("color_map_background")(e):Zn("color_map")(e),Nb=Zn("color_default_foreground"),Lb=Zn("color_default_background"),r7=(e,t)=>{const n=ft(c.fromDom(e.selection.getStart()),t==="hilitecolor"?"background-color":"color");return tv(n).map(e=>"#"+Oa(e).value)},Pb=(e,t,n)=>{e.undoManager.transact(()=>{e.focus(),e.formatter.apply(t,{value:n}),e.nodeChanged()})},Hb=(e,t)=>{e.undoManager.transact(()=>{e.focus(),e.formatter.remove(t,{value:null},void 0,!0),e.nodeChanged()})},Ib=e=>{e.addCommand("mceApplyTextcolor",(t,n)=>{Pb(e,t,n)}),e.addCommand("mceRemoveTextcolor",t=>{Hb(e,t)})},s7=e=>{const t="choiceitem",n={type:t,text:"Remove color",icon:"color-swatch-remove-color",value:"remove"},s={type:t,text:"Custom color",icon:"color-picker",value:"custom"};return e?[n,s]:[n]},Rl=(e,t,n,s)=>{if(n==="custom"){const n=L5(e);n(n=>{n.each(n=>{V7(t,n),e.execCommand("mceApplyTextcolor",t,n),s(n)})},r7(e,t).getOr(Ml))}else n==="remove"?(s(""),e.execCommand("mceRemoveTextcolor",t)):(s(n),e.execCommand("mceApplyTextcolor",t,n))},Z5=(e,t,n)=>e.concat(bb(t).concat(s7(n))),Q5=(e,t,n)=>s=>{s(Z5(e,t,n))},G5=(e,t,n)=>{const s=t==="forecolor"?"tox-icon-text-color__color":"tox-icon-highlight-bg-color__color";e.setIconFill(s,n)},V5=(e,t,n,s,o)=>{e.ui.registry.addSplitButton(t,{tooltip:s,presets:"color",icon:t==="forecolor"?"text-color":"highlight-bg-color",select:t=>{const s=r7(e,n);return hn(s,t.toUpperCase())},columns:h7(e,n),fetch:Q5($i(e,n),n,l7(e)),onAction:t=>{Rl(e,n,o.get(),l)},onItemAction:(s,i)=>{Rl(e,n,i,n=>{o.set(n),db(e,{name:t,color:n})})},onSetup:n=>{G5(n,t,o.get());const s=e=>{e.name===t&&G5(n,e.name,e.color)};return e.on("TextColorChange",s),()=>{e.off("TextColorChange",s)}}})},I5=(e,t,n,s)=>{e.ui.registry.addNestedMenuItem(t,{text:s,icon:t==="forecolor"?"text-color":"highlight-bg-color",getSubmenuItems:()=>[{type:"fancymenuitem",fancytype:"colorswatch",initData:{storageKey:n},onAction:t=>{Rl(e,n,t.value,l)}}]})},L5=t=>(n,s)=>{let o=!1;const i=s=>{const a=s.getData(),i=a.colorpicker;o?(n(e.from(i)),s.close()):t.windowManager.alert(t.translate(["Invalid hex color code: {0}",i]))},a=(e,t)=>{t.name==="hex-valid"&&(o=t.value)},r={colorpicker:s};t.windowManager.open({title:"Color Picker",size:"normal",body:{type:"panel",items:[{type:"colorpicker",name:"colorpicker",label:"Color"}]},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:r,onAction:a,onSubmit:i,onClose:l,onCancel:()=>{n(e.none())}})},Gb=e=>{Ib(e);const t=Nb(e),n=Lb(e),s=g(t),o=g(n);V5(e,"forecolor","forecolor","Text color",s),V5(e,"backcolor","hilitecolor","Background color",o),I5(e,"forecolor","forecolor","Text color"),I5(e,"backcolor","hilitecolor","Background color")},Bl=(e,t,n,s,o,i,a,r)=>{const c=nr(t),l=o!=="color"?"normal":"color",d=Qb(t,n,s,l,i,a,r),u={menuType:o};return zl(e,c,d,s,u)},Qb=(t,n,s,o,i,r,c)=>po(a(t,a=>a.type==="choiceitem"?M9(a).fold(In,a=>e.some(D9(a,s===1,o,n,r(a.value),i,c,nr(t)))):e.none())),mr=(t,n)=>{const s=so(n);if(t===1)return{mode:"menu",moveOnTab:!0};if(t==="auto")return{mode:"grid",selector:"."+s.item,initSize:{numColumns:1,numRows:1}};const o=n==="color"?"tox-swatches__row":"tox-collection__group";return{mode:"matrix",rowSelector:"."+o,previousSelector:t=>n==="color"?be(t.element,"[aria-checked=true]"):e.none()}},Jb=(e,t)=>e===1?{mode:"menu",moveOnTab:!1,selector:".tox-collection__item"}:e==="auto"?{mode:"flatgrid",selector:".tox-collection__item",initSize:{numColumns:1,numRows:1}}:{mode:"matrix",selectors:{row:t==="color"?".tox-swatches__row":".tox-collection__group",cell:t==="color"?`.${Yl}`:`.${wr}`}},ej=(e,t)=>{const o=tj(e,t),s=t.colorinput.getColorCols(e.initData.storageKey),n="color",i=Bl(d("menu-value"),o,t=>{e.onAction({value:t})},s,n,Yt.CLOSE_ON_EXECUTE,U,t.shared.providers),a={...i,markers:so(n),movement:mr(s,n)};return{type:"widget",data:{value:d("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[bv.widget(Bs.sketch(a))]}},tj=(e,t)=>{const n=e.initData.allowCustomColors&&t.colorinput.hasCustomColors();return e.initData.colors.fold(()=>Z5(t.colorinput.getColors(e.initData.storageKey),e.initData.storageKey,n),e=>e.concat(s7(n)))},M5=d("cell-over"),S5=d("cell-execute"),oj=(e,t,n)=>{const r=n=>p(n,M5,{row:e,col:t}),s=n=>p(n,S5,{row:e,col:t}),a=(e,t)=>{t.stop(),s(e)};return Ye({dom:{tag:"div",attributes:{role:"button",["aria-labelledby"]:n}},behaviours:i([O("insert-table-picker-cell",[o(_s(),b.focus),o(bt(),s),o(ua(),a),o(Di(),a)]),A.config({toggleClass:"tox-insert-table-picker__selected",toggleOnExecute:!1}),b.config({onFocus:r})])})},ij=(e,t,n)=>{const s=[];for(let o=0;o<t;o++){const i=[];for(let t=0;t<n;t++)i.push(oj(o,t,e));s.push(i)}return s},aj=(e,t,n,s,o)=>{for(let i=0;i<s;i++)for(let s=0;s<o;s++)A.set(e[i][s],i<=t&&s<=n)},rj=e=>le(e,e=>a(e,tn)),A5=(e,t)=>je(`${t}x${e}`),lj=e=>{const t=10,n=10,o=d("size-label"),a=ij(o,t,n),r=A5(0,0),s=V({dom:{tag:"span",classes:["tox-insert-table-picker__label"],attributes:{id:o}},components:[r],behaviours:i([j.config({})])});return{type:"widget",data:{value:d("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[bv.widget({dom:{tag:"div",classes:["tox-insert-table-picker"]},components:rj(a).concat(s.asSpec()),behaviours:i([O("insert-table-picker",[J(e=>{j.set(s.get(e),[r])}),Xd(M5,(e,o,i)=>{const{row:r,col:c}=i.event;aj(a,r,c,t,n),j.set(s.get(e),[A5(r+1,c+1)])}),Xd(S5,(t,n,s)=>{const{row:o,col:i}=s.event;e.onAction({numRows:o+1,numColumns:i+1}),T(t,dr())})]),u.config({initSize:{numRows:t,numColumns:n},mode:"flatgrid",selector:'[role="button"]'})])})]}},dj={inserttable:lj,colorswatch:ej},uj=(e,t)=>f(dj,e.fancytype).map(n=>n(e,t)),hj=(t,n,s,o=!0,i=!1)=>{const a=i?_9(s.icons):y9(s.icons),r=e=>({isEnabled:()=>!v.isDisabled(e),setEnabled:t=>v.set(e,!t)}),c=Aa({presets:"normal",iconContent:t.icon,textContent:t.text,htmlContent:e.none(),ariaLabel:t.text,caret:e.some(a),checkMark:e.none(),shortcutContent:t.shortcut},s,o);return ri({data:Ao(t),getApi:r,enabled:t.enabled,onAction:l,onSetup:t.onSetup,triggersSubmenu:!0,itemBehaviours:[]},c,n,s)},mj=(t,n,s,o=!0)=>{const i=e=>({isEnabled:()=>!v.isDisabled(e),setEnabled:t=>v.set(e,!t)}),a=Aa({presets:"normal",iconContent:t.icon,textContent:t.text,htmlContent:e.none(),ariaLabel:t.text,caret:e.none(),checkMark:e.none(),shortcutContent:t.shortcut},s,o);return ri({data:Ao(t),getApi:i,enabled:t.enabled,onAction:t.onAction,onSetup:t.onSetup,triggersSubmenu:!1,itemBehaviours:[]},a,n,s)},fj=e=>({type:"separator",dom:{tag:"div",classes:[wr,Mj]},components:e.text.map(je).toArray()}),pj=(t,n,s,o=!0)=>{const i=e=>({setActive:t=>{A.set(e,t)},isActive:()=>A.isOn(e),isEnabled:()=>!v.isDisabled(e),setEnabled:t=>v.set(e,!t)}),a=Aa({iconContent:t.icon,textContent:t.text,htmlContent:e.none(),ariaLabel:t.text,checkMark:e.some(Cv(s.icons)),caret:e.none(),shortcutContent:t.shortcut,presets:"normal",meta:t.meta},s,o);return Q(ri({data:Ao(t),enabled:t.enabled,getApi:i,onAction:t.onAction,onSetup:t.onSetup,triggersSubmenu:!1,itemBehaviours:[]},a,n,s),{toggling:{toggleClass:p5,toggleOnExecute:!1,selected:t.active}})},gj=F9,k5=fj,bj=mj,jj=hj,yj=pj,_j=uj,wj=z9,Oj=(e,t,n,s)=>n.getOrCreate(e,t,s),xj=(e,t,n,s)=>n.getExisting(e,t,s);E5=Object.freeze({__proto__:null,getCoupled:Oj,getExistingCoupled:xj}),x5=[Ot("others",n2(_.value,yn()))];const kj=()=>{const t={},s=(e,n)=>{const s=de(e.others);if(s.length===0)throw new Error("Cannot find any known coupled components");return f(t,n)},o=(e,n,o)=>s(n,o).getOrThunk(()=>{const i=f(n.others,o).getOrDie("No information found for coupled component: "+o),a=i(e),s=e.getSystem().build(a);return t[o]=s,s}),i=(t,n,o)=>s(n,o).orThunk(()=>(f(n.others,o).getOrDie("No information found for coupled component: "+o),e.none())),a=n({});return jt({readState:a,getExisting:i,getOrCreate:o})};_5=Object.freeze({__proto__:null,init:kj});const G=xe({fields:x5,name:"coupling",apis:E5,state:_5}),Kl=t=>{let n=e.none(),s=[];const r=e=>Kl(t=>{i(n=>{t(e(n))})}),i=e=>{o()?a(e):s.push(e)},c=t=>{o()||(n=e.some(t),l(s),s=[])},o=()=>n.isSome(),l=e=>{h(e,a)},a=e=>{n.each(t=>{setTimeout(()=>{e(t)},0)})};return t(c),{get:i,map:r,isReady:o}},Fj=e=>Kl(t=>{t(e)}),Tj={nu:Kl,pure:Fj},zj=e=>{setTimeout(()=>{throw e},0)},ci=e=>{const t=t=>{e().then(t,zj)},n=t=>ci(()=>e().then(t)),s=t=>ci(()=>e().then(e=>t(e).toPromise())),o=t=>ci(()=>e().then(()=>t.toPromise())),i=()=>Tj.nu(t),a=()=>{let t=null;return ci(()=>(t===null&&(t=e()),t))},r=e;return{map:n,bind:s,anonBind:o,toLazy:i,toCached:a,toPromise:r,get:t}},Nj=e=>ci(()=>new Promise(e)),Lj=e=>ci(()=>Promise.resolve(e)),ke={nu:Nj,pure:Lj},r5=n("sink"),a5=n(Dt({name:r5(),overrides:n({dom:{tag:"div"},behaviours:i([Ke.config({useFixed:ye})]),events:$([Hs(_a()),Hs(Kt()),Hs(ua())])})})),xg=(e,t)=>{const n=e.getHotspot(t).getOr(t),s="hotspot",o=e.getAnchorOverrides();return e.layouts.fold(()=>({type:s,hotspot:n,overrides:o}),e=>({type:s,hotspot:n,overrides:o,layouts:e}))},Bj=(e,t,n)=>{const s=e.fetch;return s(n).map(t)},Vj=(t,n,s,o,i,a,r)=>{const l=Bj(t,n,o),c=Xp(o,t);return l.map(t=>t.bind(t=>e.from(Qs.sketch({...a.menu(),uid:xo(""),data:t,highlightOnOpen:r,onOpenMenu:(e,t)=>{const n=c().getOrDie();Ke.position(n,t,{anchor:s}),k.decloak(i)},onOpenSubmenu:(e,t,n)=>{const s=c().getOrDie();Ke.position(s,n,{anchor:{type:"submenu",item:t}}),k.decloak(i)},onRepositionMenu:(e,t,n)=>{const o=c().getOrDie();Ke.position(o,t,{anchor:s}),h(n,e=>{Ke.position(o,e.triggeredMenu,{anchor:{type:"submenu",item:e.triggeringItem}})})},onEscape:()=>(b.focus(o),k.close(i),e.some(!0))}))))},Ur=(e,t,n,s,o,i,a)=>{const r=xg(e,n),c=Vj(e,t,r,n,s,o,a);return c.map(e=>(e.fold(()=>{k.isOpen(s)&&k.close(s)},e=>{k.cloak(s),k.open(s,e),i(s)}),s))},Wj=(e,t,n,s)=>(k.close(s),ke.pure(s)),gd=(e,t,n,s,o,i)=>{const a=G.getCoupled(n,"sandbox"),r=k.isOpen(a),c=r?Wj:Ur;return c(e,t,n,a,s,o,i)},Kj=(e,t,n)=>{const s=x.getCurrent(t).getOr(t),o=et(e.element);n?y(s.element,"min-width",o+"px"):ZB(s.element,o)},Xp=(e,t)=>e.getSystem().getByUid(t.uid+"-"+r5()).map(e=>()=>_.value(e)).getOrThunk(()=>t.lazySink.fold(()=>()=>_.error(new Error("No internal sink is specified, nor could an external sink be found")),t=>()=>t(e))),Gp=e=>{k.getState(e).each(e=>{Qs.repositionMenus(e)})},Od=(e,t,n)=>{const s=fg(),o=(o,i)=>{const a=xg(e,t);s.link(t.element),e.matchWidth&&Kj(a.hotspot,i,e.useMinWidth),e.onOpen(a,o,i),n!==void 0&&n.onOpen!==void 0&&n.onOpen(o,i)},i=(e,o)=>{s.unlink(t.element),n!==void 0&&n.onClose!==void 0&&n.onClose(e,o)},a=Xp(t,e);return{dom:{tag:"div",classes:e.sandboxClasses,attributes:{id:s.id,role:"listbox"}},behaviours:$t.augment(e.sandboxBehaviours,[r.config({store:{mode:"memory",initialValue:t}}),k.config({onOpen:o,onClose:i,isPartOf:(e,n,s)=>Zs(n,s)||Zs(t,s),getAttachPoint:()=>a().getOrDie()}),x.config({find:e=>k.getState(e).bind(e=>x.getCurrent(e))}),It.config({channels:{...Z1({isExtraPart:U}),...Q1({doReposition:Gp})}})])}},Wp=e=>{const t=G.getCoupled(e,"sandbox");Gp(t)},Ad=()=>[t("sandboxClasses",[]),$t.field("sandboxBehaviours",[x,It,k,r])],Zj=n([s("dom"),s("fetch"),E("onOpen"),rt("onExecute"),t("getHotspot",e.some),t("getAnchorOverrides",n({})),Ns(),ve("dropdownBehaviours",[A,G,u,b]),s("toggleClass"),t("eventOrder",{}),D("lazySink"),t("matchWidth",!1),t("useMinWidth",!1),D("role")].concat(Ad())),Jj=n([Wt({schema:[hc(),t("fakeFocus",!1)],name:"menu",defaults:e=>({onExecute:e.onExecute})}),a5()]),ey=(t,n,s,o)=>{const c=e=>f(t.dom,"attributes").bind(t=>f(t,e)),a=e=>{k.getState(e).each(e=>{Qs.highlightPrimary(e)})},i=(e,n,s)=>gd(t,z,e,o,n,s),d=e=>{const t=a;i(e,t,Ge.HighlightMenuAndItem).get(l)},h={expand:e=>{A.isOn(e)||i(e,l,Ge.HighlightNone).get(l)},open:e=>{A.isOn(e)||i(e,l,Ge.HighlightMenuAndItem).get(l)},refetch:e=>{const n=G.getExistingCoupled(e,"sandbox");return n.fold(()=>i(e,l,Ge.HighlightMenuAndItem).map(l),n=>Ur(t,z,e,n,o,l,Ge.HighlightMenuAndItem).map(l))},isOpen:A.isOn,close:e=>{A.isOn(e)&&i(e,l,Ge.HighlightMenuAndItem).get(l)},repositionMenus:e=>{A.isOn(e)&&Wp(e)}},r=(t)=>(mo(t),e.some(!0));return{uid:t.uid,dom:t.dom,components:n,behaviours:we(t.dropdownBehaviours,[A.config({toggleClass:t.toggleClass,aria:{mode:"expanded"}}),G.config({others:{sandbox:e=>Od(t,e,{onOpen:()=>A.on(e),onClose:()=>A.off(e)})}}),u.config({mode:"special",onSpace:r,onEnter:r,onDown:(t)=>{if(kt.isOpen(t)){const e=G.getCoupled(t,"sandbox");a(e)}else kt.open(t);return e.some(!0)},onEscape:(t)=>kt.isOpen(t)?(kt.close(t),e.some(!0)):e.none()}),b.config({})]),events:Jc(e.some(d)),eventOrder:{...t.eventOrder,[bt()]:["disabling","toggling","alloy.base.behaviour"]},apis:h,domModification:{attributes:{"aria-haspopup":"true",...t.role.fold(()=>({}),e=>({role:e})),...t.dom.tag==="button"?{type:c("type").getOr("button")}:{}}}}},kt=We({name:"Dropdown",configFields:Zj(),partFields:Jj(),factory:ey,apis:{open:(e,t)=>e.open(t),refetch:(e,t)=>e.refetch(t),expand:(e,t)=>e.expand(t),close:(e,t)=>e.close(t),isOpen:(e,t)=>e.isOpen(t),repositionMenus:(e,t)=>e.repositionMenus(t)}}),ny=e=>{switch(e.searchMode){case"no-search":return{menuType:"normal"};default:return{menuType:"searchable",searchMode:e}}},sy=e=>{const t=r.getValue(e),n=cr(e).map(X5);kt.refetch(t).get(()=>{const e=G.getCoupled(t,"sandbox");n.each(t=>cr(e).each(e=>Ub(e,t)))})},oy=(e,t)=>{iy(e).each(n=>{uR(e,n.element,t.event.eventType,t.event.interactionEvent)})},iy=e=>k.getState(e).bind(F.getHighlighted).bind(F.getHighlighted),ay=t=>mt(t.element,ir)?e.some(t.element):be(t.element,"."+ir),Fp=(e,t,n)=>{Y5(e).each(e=>{Wb(e,n);const s=ay(t);s.each(t=>{ut(t,"id").each(t=>w(e.element,"aria-controls",t))})}),w(n.element,"aria-selected","true")},cy=(e,t,n)=>{w(n.element,"aria-selected","false")},ly=e=>{Y5(e).each(e=>b.focus(e))},dy=e=>{const t=G.getExistingCoupled(e,"sandbox");return t.bind(cr).map(X5).map(e=>e.fetchPattern).getOr("")};(function(e){e[e.ContentFocus=0]="ContentFocus",e[e.UiFocus=1]="UiFocus"})(Zr||(Zr={}));const hy=(t,n,s,o,i)=>{const a=s.shared.providers,r=t=>i?{...t,shortcut:e.none(),icon:t.text.isSome()?e.none():t.icon}:t;switch(t.type){case"menuitem":return p9(t).fold(In,t=>e.some(bj(r(t),n,a,o)));case"nestedmenuitem":return h9(t).fold(In,t=>e.some(jj(r(t),n,a,o,i)));case"togglemenuitem":return d9(t).fold(In,t=>e.some(yj(r(t),n,a,o)));case"separator":return vb(t).fold(In,t=>e.some(k5(t)));case"fancymenuitem":return j9(t).fold(In,e=>_j(e,s));default:return console.error("Unknown item in general menu",t),e.none()}},my=(t,n,s,o,i,r,c)=>{const l=o===1,d=!l||nr(t);return po(a(t,t=>{switch(t.type){case"separator":return fb(t).fold(In,t=>e.some(k5(t)));case"cardmenuitem":return N9(t).fold(In,t=>e.some(wj({...t,onAction:e=>{t.onAction(e),s(t.value,t.meta)}},i,r,{itemBehaviours:wv(t.meta,r),cardText:{matchText:n,highlightOn:c}})));case"autocompleteitem":default:return cb(t).fold(In,t=>e.some(gj(t,n,l,"normal",s,i,r,d)))}}))},Ap=(e,t,n,s,o,i)=>{const r=nr(t),c=po(a(t,e=>{const i=e=>o?!R(e,"text"):r,t=e=>hy(e,n,s,i(e),o);return t(e.type==="nestedmenuitem"&&e.getSubmenuItems().length<=0?{...e,enabled:!1}:e)})),l=ny(i),d=o?Tb:zl;return d(e,r,c,1,l)},Nd=e=>Qs.singleData(e.value,e),gy=(e,t,n,s)=>{const o=mr(t,s),i=so(s);return{data:Nd({...e,movement:o,menuBehaviours:ta.unnamedEvents(t!=="auto"?[]:[J((e)=>{al(e,4,i.item).each(({numColumns:t,numRows:n})=>{u.setGridSize(e,n,t)})})])}),menu:{markers:so(s),fakeFocus:n===Zr.ContentFocus}}},vy=(e,t)=>i5(c.fromDom(t.startContainer)).map(t=>{const n=e.createRng();return n.selectNode(t.dom),n}),by=(t,n)=>{const s=g(!1),r=g(!1),a=Ye(te.sketch({dom:{tag:"div",classes:["tox-autocompleter"]},components:[],fireDismissalEventInstead:{},inlineBehaviours:i([O("dismissAutocompleter",[o(di(),()=>d())])]),lazySink:n.getSink})),u=()=>te.isOpen(a),f=r.get,l=()=>{u()&&te.hide(a)},h=()=>te.getContent(a).bind(e=>Pa(e.components(),0)),d=()=>t.execCommand("mceAutocompleterClose"),p=o=>{const i=En(o,t=>e.from(t.columns)).getOr(1);return le(o,e=>{const o=e.items;return my(o,e.matchText,(n,o)=>{const i=t.selection.getRng();vy(t.dom,i).each(i=>{const a={hide:()=>d(),reload:e=>{l(),t.execCommand("mceAutocompleterReload",!1,{fetchOptions:e})}};s.set(!0),e.onAction(a,i,n,o),s.set(!1)})},i,Yt.BUBBLE_TO_SANDBOX,n,e.highlightOn)})},v=(n,s)=>{Hj(c.fromDom(t.getBody())).each(o=>{const i=En(n,t=>e.from(t.columns)).getOr(1);te.showMenuAt(a,{anchor:{type:"node",root:c.fromDom(t.getBody()),node:e.from(o)}},gy(zl("autocompleter-value",!0,s,i,{menuType:"normal"}),i,Zr.ContentFocus,"normal"))}),h().each(F.highlightFirst)},m=e=>{const t=p(e);t.length>0?v(e,t):l()};t.on("AutocompleterStart",({lookupData:e})=>{r.set(!0),s.set(!1),m(e)}),t.on("AutocompleterUpdate",({lookupData:e})=>m(e)),t.on("AutocompleterEnd",()=>{l(),r.set(!1),s.set(!1)});const b={cancelIfNecessary:d,isMenuOpen:u,isActive:f,isProcessingAction:s.get,getMenu:h};Rj.setup(b,t)},jy={register:by},vi=(e,t,n)=>cn(e,t,n).isSome(),Cp=(e,t)=>{let n=null;const s=(...s)=>{n=setTimeout(()=>{e.apply(null,s),n=null},t)},o=()=>{n!==null&&(clearTimeout(n),n=null)};return{cancel:o,schedule:s}},xp=5,Oy=400,bp=t=>{const n=t.raw;return n.touches===void 0||n.touches.length!==1?e.none():e.some(n.touches[0])},Cy=(e,t)=>{const n=Math.abs(e.clientX-t.x),s=Math.abs(e.clientY-t.y);return n>xp||s>xp},Ey=t=>{const n=K(),o=g(!1),s=Cp(e=>{t.triggerEvent(vR(),e),o.set(!0)},Oy),i=t=>(bp(t).each(e=>{s.cancel();const i={x:e.clientX,y:e.clientY,target:t.target};s.schedule(t),o.set(!1),n.set(i)}),e.none()),a=t=>(s.cancel(),bp(t).each(e=>{n.on(t=>{Cy(e,t)&&n.clear()})}),e.none()),r=e=>{s.cancel();const i=t=>Y(t.target,e.target);return n.get().filter(i).map(n=>o.get()?(e.prevent(),!1):t.triggerEvent(Di(),e))},c=Po([{key:ds(),value:i},{key:Na(),value:a},{key:Ki(),value:r}]),l=(e,t)=>f(c,t).bind(t=>t(e));return{fireIfReady:l}},ky=e=>{const t=e.raw;return t.which===Cx[0]&&!Oe(["input","textarea"],Wn(e.target))&&!vi(e.target,'[contenteditable="true"]')},Ay=(e,t)=>{const n={stopBackspace:!0,...t},r=["touchstart","touchmove","touchend","touchcancel","gesturestart","mousedown","mouseup","mouseover","mousemove","mouseout","click"],s=Ey(n),c=a(r.concat(["selectstart","input","contextmenu","change","transitionend","transitioncancel","drag","dragstart","dragend","dragenter","dragleave","dragover","drop","keyup"]),t=>qe(e,t,e=>{s.fireIfReady(e,t).each(t=>{t&&e.kill()});const o=n.triggerEvent(t,e);o&&e.kill()})),o=K(),l=qe(e,"paste",e=>{s.fireIfReady(e,"paste").each(t=>{t&&e.kill()});const t=n.triggerEvent("paste",e);t&&e.kill(),o.set(setTimeout(()=>{n.triggerEvent(y1(),e)},0))}),d=qe(e,"keydown",e=>{const t=n.triggerEvent("keydown",e);t?e.kill():n.stopBackspace&&ky(e)&&e.prevent()}),u=qe(e,"focusin",e=>{const t=n.triggerEvent("focusin",e);t&&e.kill()}),i=K(),m=qe(e,"focusout",e=>{const t=n.triggerEvent("focusout",e);t&&e.kill(),i.set(setTimeout(()=>{n.triggerEvent(_1(),e)},0))}),f=()=>{h(c,e=>{e.unbind()}),d.unbind(),u.unbind(),m.unbind(),l.unbind(),o.on(clearTimeout),i.on(clearTimeout)};return{unbind:f}},vp=(e,t)=>{const n=f(e,"target").getOr(t);return g(n)},My=(e,t)=>{const n=g(!1),s=g(!1),o=()=>{n.set(!0)},i=()=>{s.set(!0)};return{stop:o,cut:i,isStopped:n.get,isCut:s.get,event:e,setSource:t.set,getSource:t.get}},Fy=e=>{const t=g(!1),n=()=>{t.set(!0)};return{stop:n,cut:l,isStopped:t.get,isCut:U,event:e,setSource:rl("Cannot set source of a broadcasted event"),getSource:rl("Cannot get source of a broadcasted event")}},Vi=Lt.generate([{stopped:[]},{resume:["element"]},{complete:[]}]),mp=(e,t,n,s,o,i)=>{const r=e(t,s),a=My(n,o);return r.fold(()=>(i.logEventNoHandlers(t,s),Vi.complete()),e=>{const n=e.descHandler,s=jl(n);return s(a),a.isStopped()?(i.logEventStopped(t,e.element,n.purpose),Vi.stopped()):a.isCut()?(i.logEventCut(t,e.element,n.purpose),Vi.complete()):Rn(e.element).fold(()=>(i.logNoParent(t,e.element,n.purpose),Vi.complete()),s=>(i.logEventResponse(t,e.element,n.purpose),Vi.resume(s)))})},hp=(e,t,n,s,o,i)=>mp(e,t,n,s,o,i).fold(ye,s=>hp(e,t,n,s,o,i),U),Ny=(e,t,n,s,o)=>{const i=vp(n,s);return mp(e,t,n,s,i,o)},Ly=(e,t)=>{const s=Fy(t);return h(e,e=>{const t=e.descHandler,n=jl(t);n(s)}),s.isStopped()},Ry=(e,t,n,s)=>dp(e,t,n,n.target,s),dp=(e,t,n,s,o)=>{const i=vp(n,s);return hp(e,t,n,s,i,o)},Hy=(e,t)=>({element:e,descHandler:t}),Iy=(e,t)=>({id:e,descHandler:t}),By=()=>{const e={},t=(t,n,s)=>{Ie(s,(s,o)=>{const i=e[o]!==void 0?e[o]:{};i[n]=pN(s,t),e[o]=i})},n=(e,t)=>Ui(t).bind(t=>f(e,t)).map(e=>Hy(t,e)),s=t=>f(e,t).map(e=>tr(e,(e,t)=>Iy(t,e))).getOr([]),o=(t,s,o)=>f(e,s).bind(e=>q1(o,t=>n(e,t),t)),i=t=>{Ie(e,(e)=>{R(e,t)&&delete e[t]})};return{registerId:t,unregisterId:i,filterByType:s,find:o}},Vy=()=>{const t=By(),e={},s=e=>{const t=e.element;return Ui(t).getOrThunk(()=>eL("uid-",e.element))},o=(t,s)=>{const o=e[s];if(o===t)n(t);else throw new Error('The tagId "'+s+'" is already used by: '+Ls(o.element)+`
Cannot use it for: `+Ls(t.element)+`
The conflicting element is`+(Xt(o.element)?" ":" not ")+"already in the DOM")},i=n=>{const i=s(n);Vt(e,i)&&o(n,i);const a=[n];t.registerId(a,i,n.events),e[i]=n},n=n=>{Ui(n.element).each(n=>{delete e[n],t.unregisterId(n)})},a=e=>t.filterByType(e),r=(e,n,s)=>t.find(e,n,s),c=t=>f(e,t);return{find:r,filter:a,register:i,unregister:n,getById:c}},$y=e=>{const{attributes:t,...n}=e.dom;return{uid:e.uid,dom:{tag:"div",attributes:{role:"presentation",...t},...n},components:e.components,behaviours:Ar(e.containerBehaviours),events:e.events,domModification:e.domModification,eventOrder:e.eventOrder}},_n=gt({name:"Container",factory:$y,configFields:[t("components",[]),ve("containerBehaviours",[]),t("events",{}),t("domModification",{}),t("eventOrder",{})]}),cp=e=>{const v=t=>Rn(e.element).fold(ye,e=>Y(t,e)),t=Vy(),i=(e,n)=>t.find(v,e,n),j=Ay(e.element,{triggerEvent:(e,t)=>jd(e,t.target,n=>Ry(i,e,t,n))}),r={debugInfo:n("real"),triggerEvent:(e,t,n)=>{jd(e,t,s=>dp(i,e,n,t,s))},triggerFocus:(e,t)=>{Ui(e).fold(()=>{es(e)},n=>{jd(ps(),e,n=>(Ny(i,ps(),{originator:t,kill:l,prevent:l,target:e},e,n),!1))})},triggerEscape:(e,t)=>{r.triggerEvent("keydown",e.element,t.event)},getByUid:e=>a(e),getByDom:e=>g(e),build:Ye,buildOrPatch:ql,addToGui:e=>{d(e)},removeFromGui:e=>{c(e)},addToWorld:e=>{s(e)},removeFromWorld:e=>{o(e)},broadcast:e=>{m(e)},broadcastOn:(e,t)=>{f(e,t)},broadcastEvent:(e,t)=>{p(e,t)},isConnected:ye},s=e=>{e.connect(r),ro(e.element)||(t.register(e),h(e.components(),s),r.triggerEvent(hr(),e.element,{target:e.element}))},o=e=>{ro(e.element)||(h(e.components(),o),t.unregister(e)),e.disconnect()},d=t=>{Us(e,t)},c=e=>{Yn(e)},b=()=>{j.unbind(),Bn(e.element)},u=e=>{const n=t.filter(ao());h(n,t=>{const n=t.descHandler,s=jl(n);s(e)})},m=e=>{u({universal:!0,data:e})},f=(e,t)=>{u({universal:!1,channels:e,data:t})},p=(e,n)=>{const s=t.filter(e);return Ly(s,n)},a=e=>t.getById(e).fold(()=>_.error(new Error('Could not find component with uid: "'+e+'" in system.')),_.value),g=e=>{const t=Ui(e).getOr("not found");return a(t)};return s(e),{root:e,element:e.element,destroy:b,add:d,remove:c,getByUid:a,getByDom:g,addToWorld:s,removeFromWorld:o,broadcast:m,broadcastOn:f,broadcastEvent:p}},Ky=(e,t)=>({dom:{tag:"div",classes:["tox-bar","tox-form__controls-h-stack"]},components:a(e.items,t.interpreter)}),qy=n([t("prefix","form-field"),ve("fieldBehaviours",[x,r])]),Yy=n([Dt({schema:[s("dom")],name:"label"}),Dt({factory:{sketch:e=>({uid:e.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:e.text}})},schema:[s("text")],name:"aria-descriptor"}),Pe({factory:{sketch:e=>{const t=qR(e,["factory"]);return e.factory.sketch(t)}},schema:[s("factory")],name:"field"})]),Gy=(e,t)=>{const o=we(e.fieldBehaviours,[x.config({find:t=>H(t,e,"field")}),r.config({store:{mode:"manual",getValue:e=>x.getCurrent(e).bind(r.getValue),setValue:(e,t)=>{x.getCurrent(e).each(e=>{r.setValue(e,t)})}}})]),i=$([J((t)=>{const s=uh(t,e,["label","field","aria-descriptor"]);s.field().each(t=>{const n=d(e.prefix);s.label().each(e=>{w(e.element,"for",n),w(t.element,"id",n)}),s["aria-descriptor"]().each(n=>{const s=d(e.prefix);w(n.element,"id",s),w(t.element,"aria-describedby",s)})})})]),a={getField:t=>H(t,e,"field"),getLabel:t=>H(t,e,"label")};return{uid:e.uid,dom:e.dom,components:t,behaviours:o,events:i,apis:a}},M=We({name:"FormField",configFields:qy(),partFields:Yy(),factory:Gy,apis:{getField:(e,t)=>e.getField(t),getLabel:(e,t)=>e.getLabel(t)}}),Qy=(e,t)=>sn({attributes:Po([{key:t.tabAttr,value:"true"}])});ap=Object.freeze({__proto__:null,exhibit:Qy}),ip=[t("tabAttr","data-alloy-tabstop")];const ee=xe({fields:ip,name:"tabstopping",active:ap});sp=tinymce.util.Tools.resolve("tinymce.html.Entities");const ga=(e,t,n,s)=>{const o=o_(e,t,n,s);return M.sketch(o)},s_=(e,t)=>ga(e,t,[],[]),o_=(e,t,n,s)=>({dom:J6(n),components:e.toArray().concat([t]),fieldBehaviours:i(s)}),i_=()=>J6([]),J6=e=>({tag:"div",classes:["tox-form__group"].concat(e)}),ks=(e,t)=>M.parts.label({dom:{tag:"label",classes:["tox-label"]},components:[je(t.translate(e))]}),lt=d("form-component-change"),Fa=d("form-close"),yo=d("form-cancel"),ss=d("form-action"),Da=d("form-submit"),Kd=d("form-block"),qd=d("form-unblock"),z6=d("form-tabchange"),T6=d("form-resize"),v_=(e,t,n)=>{const d=e.label.map(e=>ks(e,t)),s=e=>(t,n)=>{cn(n.event.target,"[data-collection-item-value]").each(s=>{e(t,n,s,De(s,"data-collection-item-value"))})},h=(n,s)=>{const o=a(s,n=>{const s=Ft.translate(n.text),i=e.columns===1?`<div class="tox-collection__item-label">${s}</div>`:"",a=`<div class="tox-collection__item-icon">${n.icon}</div>`,r={_:" "," - ":" ","-":" "},o=s.replace(/_| - |-/g,e=>r[e]),c=t.isDisabled()?" tox-collection__item--state-disabled":"";return`<div class="tox-collection__item${c}" tabindex="-1" data-collection-item-value="${sp.encodeAllRaw(n.value)}" title="${o}" aria-label="${o}">${a}${i}</div>`}),i=e.columns!=="auto"&&e.columns>1?K7(o,e.columns):[o],r=a(i,e=>`<div class="tox-collection__group">${e.join("")}</div>`);ai(n.element,r.join(""))},c=s((n,s,o,i)=>{s.stop(),t.isDisabled()||p(n,ss,{name:e.name,value:i})}),m=[o(_s(),s((e,t,n)=>{es(n)})),o(ua(),c),o(Di(),c),o(Cs(),s((e,t,n)=>{be(e.element,"."+Ci).each(e=>{ae(e,Ci)}),me(n,Ci)})),o(CR(),s(e=>{be(e.element,"."+Ci).each(e=>{ae(e,Ci)})})),Jn(s((t,n,s,o)=>{p(t,ss,{name:e.name,value:o})}))],l=(e,t)=>a(Ue(e.element,".tox-collection__item"),t),f=M.parts.field({dom:{tag:"div",classes:["tox-collection"].concat(e.columns!==1?["tox-collection--grid"]:["tox-collection--list"])},components:[],factory:{sketch:z},behaviours:i([v.config({disabled:t.isDisabled,onDisabled:e=>{l(e,e=>{me(e,"tox-collection__item--state-disabled"),w(e,"aria-disabled",!0)})},onEnabled:e=>{l(e,e=>{ae(e,"tox-collection__item--state-disabled"),pe(e,"aria-disabled")})}}),re(),j.config({}),r.config({store:{mode:"memory",initialValue:n.getOr([])},onSetValue:(t,n)=>{h(t,n),e.columns==="auto"&&al(t,5,"tox-collection__item").each(({numRows:e,numColumns:n})=>{u.setGridSize(t,e,n)}),T(t,T6)}}),ee.config({}),u.config(Jb(e.columns,"normal")),O("collection-events",m)]),eventOrder:{[bt()]:["disabling","alloy.base.behaviour","collection-events"]}}),g=["tox-form__group--collection"];return ga(d,f,g,[])},b_=["input","textarea"],M6=e=>{const t=Wn(e);return Oe(b_,t)},S6=(e,t)=>{const n=t.getRoot(e).getOr(e.element);ae(n,t.invalidClass),t.notify.each(t=>{M6(e.element)&&w(e.element,"aria-invalid",!1),t.getContainer(e).each(e=>{ai(e,t.validHtml)}),t.onValid(e)})},E6=(e,t,n,s)=>{const o=t.getRoot(e).getOr(e.element);me(o,t.invalidClass),t.notify.each(t=>{M6(e.element)&&w(e.element,"aria-invalid",!0),t.getContainer(e).each(e=>{ai(e,s)}),t.onInvalid(e,s)})},C6=(e,t)=>t.validator.fold(()=>ke.pure(_.value(!0)),t=>t.validate(e)),Yd=(e,t,n)=>(t.notify.each(t=>{t.onValidate(e)}),C6(e,t).map(s=>e.getSystem().isConnected()?s.fold(s=>(E6(e,t,n,s),_.error(s)),n=>(S6(e,t),_.value(n))):_.error("No longer in system"))),x_=(e,t)=>{const n=t.getRoot(e).getOr(e.element);return mt(n,t.invalidClass)};_6=Object.freeze({__proto__:null,markValid:S6,markInvalid:E6,query:C6,run:Yd,isInvalid:x_});const E_=(e,t)=>e.validator.map(n=>$([o(n.onEvent,n=>{Yd(n,e,t).get(z)})].concat(n.validateOnLoad?[J(n=>{Yd(n,e,t).get(l)})]:[]))).getOr({});y6=Object.freeze({__proto__:null,events:E_}),j6=[s("invalidClass"),t("getRoot",e.none),vt("notify",[t("aria","alert"),t("getContainer",e.none),t("validHtml",""),E("onValid"),E("onInvalid"),E("onValidate")]),vt("validator",[s("validate"),t("onEvent","input"),t("validateOnLoad",!0)])];const zn=xe({fields:j6,name:"invalidating",active:y6,apis:_6,extra:{validation:e=>t=>{const n=r.getValue(t);return ke.pure(e(n))}}}),M_=()=>sn({styles:{"-webkit-user-select":"none","user-select":"none","-ms-user-select":"none","-moz-user-select":"-moz-none"},attributes:{unselectable:"on"}}),F_=()=>$([hf(_R(),ye)]);f6=Object.freeze({__proto__:null,events:F_,exhibit:M_});const ya=xe({fields:[],name:"unselecting",active:f6}),D_=(t,n)=>kt.sketch({dom:t.dom,components:t.components,toggleClass:"mce-active",dropdownBehaviours:i([on.button(n.providers.isDisabled),re(),ya.config({}),ee.config({})]),layouts:t.layouts,sandboxClasses:["tox-dialog__popups"],lazySink:n.getSink,fetch:s=>ke.nu(e=>t.fetch(e)).map(o=>e.from(Nd(Q(Bl(d("menu-value"),o,e=>{t.onItemAction(s,e)},t.columns,t.presets,Yt.CLOSE_ON_EXECUTE,U,n.providers),{movement:mr(t.columns,t.presets)})))),parts:{menu:lr(!1,1,t.presets)}}),u6=d("color-input-change"),c6=d("color-swatch-change"),i6=d("color-picker-cancel"),P_=(e,t,n,s)=>{const u=M.parts.field({factory:ni,inputClasses:["tox-textfield"],data:s,onSetValue:e=>zn.run(e).get(l),inputBehaviours:i([v.config({disabled:t.providers.isDisabled}),re(),ee.config({}),zn.config({invalidClass:"tox-textbox-field-invalid",getRoot:e=>Ii(e.element),notify:{onValid:e=>{const t=r.getValue(e);p(e,u6,{color:t})}},validator:{validateOnLoad:!1,validate:e=>{const t=r.getValue(e);if(t.length===0)return ke.pure(_.value(!0));const n=c.fromTag("span");y(n,"background-color",t);const s=Re(n,"background-color").fold(()=>_.error("blah"),e=>_.value(t));return ke.pure(s)}}})]),selectOnFocus:!1}),h=e.label.map(e=>ks(e,t.providers)),a=(e,t)=>{p(e,c6,{value:t})},m=(t,s)=>{d.getOpt(t).each(t=>{s==="custom"?n.colorPicker(n=>{n.fold(()=>T(t,i6),n=>{a(t,n),V7(e.storageKey,n)})},"#ffffff"):s==="remove"?a(t,""):a(t,s)})},d=V(D_({dom:{tag:"span",attributes:{"aria-label":t.providers.translate("Color swatch")}},layouts:{onRtl:()=>[Le,Ne,Ce],onLtr:()=>[Ne,Le,Ce]},components:[],fetch:Q5(n.getColors(e.storageKey),e.storageKey,n.hasCustomColors()),columns:n.getColorCols(e.storageKey),presets:"color",onItemAction:m},t));return M.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:h.toArray().concat([{dom:{tag:"div",classes:["tox-color-input"]},components:[u,d.asSpec()]}]),fieldBehaviours:i([O("form-field-events",[o(u6,(t,n)=>{d.getOpt(t).each(e=>{y(e.element,"background-color",n.event.color)}),p(t,lt,{name:e.name})}),o(c6,(e,t)=>{M.getField(e).each(n=>{r.setValue(n,t.event.value),x.getCurrent(e).each(b.focus)})}),o(i6,(e)=>{M.getField(e).each(t=>{x.getCurrent(e).each(b.focus)})})])])})},H_=Dt({schema:[s("dom")],name:"label"}),ms=e=>Dt({name:""+e+"-edge",overrides:t=>{const n=t.model.manager.edgeActions[e];return n.fold(()=>({}),e=>({events:$([lu(ds(),(t,n,s)=>e(t,s),[t]),lu(Kt(),(t,n,s)=>e(t,s),[t]),lu(Ha(),(t,n,s)=>{s.mouseIsDown.get()&&e(t,s)},[t])])}))}}),B_=ms("top-left"),V_=ms("top"),$_=ms("top-right"),W_=ms("right"),U_=ms("bottom-right"),K_=ms("bottom"),q_=ms("bottom-left"),Y_=ms("left"),G_=Pe({name:"thumb",defaults:n({dom:{styles:{position:"absolute"}}}),overrides:e=>({events:$([Mo(ds(),e,"spectrum"),Mo(Na(),e,"spectrum"),Mo(Ki(),e,"spectrum"),Mo(Kt(),e,"spectrum"),Mo(Ha(),e,"spectrum"),Mo(x1(),e,"spectrum")])})}),X_=Pe({schema:[Xe("mouseIsDown",()=>g(!1))],name:"spectrum",overrides:e=>{const s=e.model,t=s.manager,n=(n,s)=>t.getValueFromEvent(s).map(s=>t.setValueFrom(n,e,s));return{behaviours:i([u.config({mode:"special",onLeft:n=>t.onLeft(n,e),onRight:n=>t.onRight(n,e),onUp:n=>t.onUp(n,e),onDown:n=>t.onDown(n,e)}),b.config({})]),events:$([o(ds(),n),o(Na(),n),o(Kt(),n),o(Ha(),(t,s)=>{e.mouseIsDown.get()&&n(t,s)})])}}});t6=[H_,Y_,W_,V_,K_,B_,$_,q_,U_,G_,X_];const Z_="slider.change.value",ma=n(Z_),ew=e=>e.type.indexOf("touch")!==-1,Zd=t=>{const n=t.event.raw;if(ew(n)){const t=n;return t.touches!==void 0&&t.touches.length===1?e.some(t.touches[0]).map(e=>Z(e.clientX,e.clientY)):e.none()}const s=n;return s.clientX!==void 0?e.some(s).map(e=>Z(e.clientX,e.clientY)):e.none()},nw="top",sw="right",ow="bottom",iw="left",Ws=e=>e.model.minX,Ks=e=>e.model.minY,Hc=e=>e.model.minX-1,Pc=e=>e.model.minY-1,Gs=e=>e.model.maxX,Xs=e=>e.model.maxY,Lc=e=>e.model.maxX+1,Nc=e=>e.model.maxY+1,Hf=(e,t,n)=>t(e)-n(e),au=e=>Hf(e,Gs,Ws),cu=e=>Hf(e,Xs,Ks),Nf=e=>au(e)/2,Df=e=>cu(e)/2,Go=e=>e.stepSize,Ff=e=>e.snapToGrid,Mf=e=>e.snapStart,Sf=e=>e.rounded,Tc=(e,t)=>e[t+"-edge"]!==void 0,Cf=e=>Tc(e,iw),Of=e=>Tc(e,sw),_f=e=>Tc(e,nw),yf=e=>Tc(e,ow),ns=e=>e.model.value.get(),vs=(e,t)=>({x:e,y:t}),Ut=(e,t)=>{p(e,ma(),{value:t})},Fw=(e,t)=>{Ut(e,vs(Hc(t),Pc(t)))},Tw=(e,t)=>{Ut(e,Pc(t))},zw=(e,t)=>{Ut(e,vs(Nf(t),Pc(t)))},Dw=(e,t)=>{Ut(e,vs(Lc(t),Pc(t)))},Nw=(e,t)=>{Ut(e,Lc(t))},Lw=(e,t)=>{Ut(e,vs(Lc(t),Df(t)))},Rw=(e,t)=>{Ut(e,vs(Lc(t),Nc(t)))},Pw=(e,t)=>{Ut(e,Nc(t))},Hw=(e,t)=>{Ut(e,vs(Nf(t),Nc(t)))},Iw=(e,t)=>{Ut(e,vs(Hc(t),Nc(t)))},Bw=(e,t)=>{Ut(e,Hc(t))},Vw=(e,t)=>{Ut(e,vs(Hc(t),Df(t)))},du=(e,t,n,s)=>e<t?e:e>n?n:e===t?t-1:Math.max(t,e-s),hu=(e,t,n,s)=>e>n?e:e<t?t:e===n?n+1:Math.min(n,e+s),uf=(e,t,n)=>Math.max(t,Math.min(n,e)),Kw=(e,t,n,s,o)=>o.fold(()=>{const o=e-t,i=Math.round(o/s)*s;return uf(t+i,t-1,n+1)},t=>{const o=(e-t)%s,i=Math.round(o/s),a=Math.floor((e-t)/s),r=Math.floor((n-t)/s),c=Math.min(r,a+i),l=t+c*s;return Math.max(t,l)}),qw=(e,t,n)=>Math.min(n,Math.max(e,t))-t,df=e=>{const{min:t,max:s,range:v,value:o,step:p,snap:f,snapStart:h,rounded:u,hasMinEdge:l,hasMaxEdge:d,minBound:c,maxBound:r,screenRange:m}=e,a=l?t-1:t,i=d?s+1:s;if(o<c)return a;if(o>r)return i;const g=qw(o,c,r),n=uf(g/m*v+t,a,i);return f&&n>=t&&n<=s?Kw(n,t,s,p,h):u?Math.round(n):n},lf=e=>{const{min:n,max:s,range:o,value:t,hasMinEdge:i,hasMaxEdge:a,maxBound:r,maxOffset:c,centerMinEdge:l,centerMaxEdge:d}=e;return t<n?i?0:l:t>s?a?r:d:(t-n)/o*c},mu="top",rf="right",af="bottom",fu="left",eO="width",tO="height",An=e=>e.element.dom.getBoundingClientRect(),Qt=(e,t)=>e[t],Oc=e=>{const t=An(e);return Qt(t,fu)},q8=e=>{const t=An(e);return Qt(t,rf)},wc=e=>{const t=An(e);return Qt(t,mu)},V8=e=>{const t=An(e);return Qt(t,af)},I8=e=>{const t=An(e);return Qt(t,eO)},H8=e=>{const t=An(e);return Qt(t,tO)},L8=(e,t,n)=>(e+t)/2-n,N8=(e,t)=>{const n=An(e),s=An(t),o=Qt(n,fu),i=Qt(n,rf),a=Qt(s,fu);return L8(o,i,a)},D8=(e,t)=>{const n=An(e),s=An(t),o=Qt(n,mu),i=Qt(n,af),a=Qt(s,mu);return L8(o,i,a)},jc=(e,t)=>{p(e,ma(),{value:t})},bu=(e,t,n)=>{const s={min:Ws(t),max:Gs(t),range:au(t),value:n,step:Go(t),snap:Ff(t),snapStart:Mf(t),rounded:Sf(t),hasMinEdge:Cf(t),hasMaxEdge:Of(t),minBound:Oc(e),maxBound:q8(e),screenRange:I8(e)};return df(s)},pO=(e,t,n)=>{const s=bu(e,t,n),o=s;return jc(e,o),s},gO=(e,t)=>{const n=Ws(t);jc(e,n)},vO=(e,t)=>{const n=Gs(t);jc(e,n)},bO=(t,n,s)=>{const i=t>0?hu:du,o=i(ns(s),Ws(s),Gs(s),Go(s));return jc(n,o),e.some(o)},k8=e=>(t,n)=>bO(e,t,n).map(ye),yO=e=>{const t=Zd(e);return t.map(e=>e.left)},_O=(t,n,s,o,i)=>{const a=0,r=I8(t),c=o.bind(n=>e.some(N8(n,t))).getOr(a),l=i.bind(n=>e.some(N8(n,t))).getOr(r),d={min:Ws(n),max:Gs(n),range:au(n),value:s,hasMinEdge:Cf(n),hasMaxEdge:Of(n),minBound:Oc(t),minOffset:a,maxBound:q8(t),maxOffset:r,centerMinEdge:c,centerMaxEdge:l};return lf(d)},ju=(e,t,n,s,o,i)=>{const a=_O(t,i,n,s,o);return Oc(t)-Oc(e)+a},OO=(e,t,n,s)=>{const o=ns(n),i=ju(e,s.getSpectrum(e),o,s.getLeftEdge(e),s.getRightEdge(e),n),a=et(t.element)/2;y(t.element,"left",i-a+"px")},xO=k8(-1),CO=k8(1),EO=e.none,kO=e.none,AO={"top-left":e.none(),top:e.none(),"top-right":e.none(),right:e.some(Nw),"bottom-right":e.none(),bottom:e.none(),"bottom-left":e.none(),left:e.some(Bw)};C8=Object.freeze({__proto__:null,setValueFrom:pO,setToMin:gO,setToMax:vO,findValueOfOffset:bu,getValueFromEvent:yO,findPositionOfValue:ju,setPositionFromValue:OO,onLeft:xO,onRight:CO,onUp:EO,onDown:kO,edgeActions:AO});const vc=(e,t)=>{p(e,ma(),{value:t})},yu=(e,t,n)=>{const s={min:Ks(t),max:Xs(t),range:cu(t),value:n,step:Go(t),snap:Ff(t),snapStart:Mf(t),rounded:Sf(t),hasMinEdge:_f(t),hasMaxEdge:yf(t),minBound:wc(e),maxBound:V8(e),screenRange:H8(e)};return df(s)},TO=(e,t,n)=>{const s=yu(e,t,n),o=s;return vc(e,o),s},zO=(e,t)=>{const n=Ks(t);vc(e,n)},DO=(e,t)=>{const n=Xs(t);vc(e,n)},NO=(t,n,s)=>{const i=t>0?hu:du,o=i(ns(s),Ks(s),Xs(s),Go(s));return vc(n,o),e.some(o)},w8=e=>(t,n)=>NO(e,t,n).map(ye),RO=e=>{const t=Zd(e);return t.map(e=>e.top)},PO=(t,n,s,o,i)=>{const a=0,r=H8(t),c=o.bind(n=>e.some(D8(n,t))).getOr(a),l=i.bind(n=>e.some(D8(n,t))).getOr(r),d={min:Ks(n),max:Xs(n),range:cu(n),value:s,hasMinEdge:_f(n),hasMaxEdge:yf(n),minBound:wc(t),minOffset:a,maxBound:V8(t),maxOffset:r,centerMinEdge:c,centerMaxEdge:l};return lf(d)},Ou=(e,t,n,s,o,i)=>{const a=PO(t,i,n,s,o);return wc(t)-wc(e)+a},IO=(e,t,n,s)=>{const o=ns(n),i=Ou(e,s.getSpectrum(e),o,s.getTopEdge(e),s.getBottomEdge(e),n),a=Ve(t.element)/2;y(t.element,"top",i-a+"px")},BO=e.none,VO=e.none,$O=w8(-1),WO=w8(1),UO={"top-left":e.none(),top:e.some(Tw),"top-right":e.none(),right:e.none(),"bottom-right":e.none(),bottom:e.some(Pw),"bottom-left":e.none(),left:e.none()};y8=Object.freeze({__proto__:null,setValueFrom:TO,setToMin:zO,setToMax:DO,findValueOfOffset:yu,getValueFromEvent:RO,findPositionOfValue:Ou,setPositionFromValue:IO,onLeft:BO,onRight:VO,onUp:$O,onDown:WO,edgeActions:UO});const gc=(e,t)=>{p(e,ma(),{value:t})},pc=(e,t)=>({x:e,y:t}),GO=(e,t,n)=>{const o=bu(e,t,n.left),i=yu(e,t,n.top),s=pc(o,i);return gc(e,s),s},XO=(t,n,s,o)=>{const i=t>0?hu:du,a=n?ns(o).x:i(ns(o).x,Ws(o),Gs(o),Go(o)),r=n?i(ns(o).y,Ks(o),Xs(o),Go(o)):ns(o).y;return gc(s,pc(a,r)),e.some(a)},uc=(e,t)=>(n,s)=>XO(e,t,n,s).map(ye),ZO=(e,t)=>{const n=Ws(t),s=Ks(t);gc(e,pc(n,s))},JO=(e,t)=>{const n=Gs(t),s=Xs(t);gc(e,pc(n,s))},ex=e=>Zd(e),tx=(e,t,n,s)=>{const o=ns(n),i=ju(e,s.getSpectrum(e),o.x,s.getLeftEdge(e),s.getRightEdge(e),n),a=Ou(e,s.getSpectrum(e),o.y,s.getTopEdge(e),s.getBottomEdge(e),n),r=et(t.element)/2,c=Ve(t.element)/2;y(t.element,"left",i-r+"px"),y(t.element,"top",a-c+"px")},nx=uc(-1,!1),sx=uc(1,!1),ox=uc(-1,!0),ix=uc(1,!0),ax={"top-left":e.some(Fw),top:e.some(zw),"top-right":e.some(Dw),right:e.some(Lw),"bottom-right":e.some(Rw),bottom:e.some(Hw),"bottom-left":e.some(Iw),left:e.some(Vw)};Jm=Object.freeze({__proto__:null,setValueFrom:GO,setToMin:ZO,setToMax:JO,getValueFromEvent:ex,setPositionFromValue:tx,onLeft:nx,onRight:sx,onUp:ox,onDown:ix,edgeActions:ax});const cx=[t("stepSize",1),t("onChange",l),t("onChoose",l),t("onInit",l),t("onDragStart",l),t("onDragEnd",l),t("snapToGrid",!1),t("rounded",!0),D("snapStart"),Ot("model",yt("mode",{x:[t("minX",0),t("maxX",100),Xe("value",e=>g(e.mode.minX)),s("getInitialValue"),W("manager",C8)],y:[t("minY",0),t("maxY",100),Xe("value",e=>g(e.mode.minY)),s("getInitialValue"),W("manager",y8)],xy:[t("minX",0),t("maxX",100),t("minY",0),t("maxY",100),Xe("value",e=>g({x:e.mode.minX,y:e.mode.minY})),s("getInitialValue"),W("manager",Jm)]})),ve("sliderBehaviours",[u,r]),Xe("mouseIsDown",()=>g(!1))],lx=(t,n)=>{const c=e=>Ln(e,t,"thumb"),m=e=>Ln(e,t,"spectrum"),O=e=>H(e,t,"left-edge"),w=e=>H(e,t,"right-edge"),v=e=>H(e,t,"top-edge"),_=e=>H(e,t,"bottom-edge"),a=t.model,d=a.manager,h=(e,n)=>{d.setPositionFromValue(e,n,t,{getLeftEdge:O,getRightEdge:w,getTopEdge:v,getBottomEdge:_,getSpectrum:m})},l=(e,t)=>{a.value.set(t);const n=c(e);h(e,n)},b=(n,s)=>{l(n,s);const o=c(n);return t.onChange(n,o,s),e.some(!0)},j=e=>{d.setToMin(e,t)},y=e=>{d.setToMax(e,t)},g=e=>{const n=()=>{H(e,t,"thumb").each(n=>{const s=a.value.get();t.onChoose(e,n,s)})},s=t.mouseIsDown.get();t.mouseIsDown.set(!1),s&&n()},p=(e,n)=>{n.stop(),t.mouseIsDown.set(!0),t.onDragStart(e,c(e))},f=(e,n)=>{n.stop(),t.onDragEnd(e,c(e)),g(e)};return{uid:t.uid,dom:t.dom,components:n,behaviours:we(t.sliderBehaviours,[u.config({mode:"special",focusIn:e=>H(e,t,"spectrum").map(u.focusIn).map(ye)}),r.config({store:{mode:"manual",getValue:e=>a.value.get(),setValue:l}}),It.config({channels:{[e4()]:{onReceive:g}}})]),events:$([o(ma(),(e,t)=>{b(e,t.event.value)}),J((e)=>{const o=a.getInitialValue();a.value.set(o);const s=c(e);h(e,s);const i=m(e);t.onInit(e,s,i,a.value.get())}),o(ds(),p),o(Ki(),f),o(Kt(),p),o(x1(),f)]),apis:{resetToMin:j,resetToMax:y,setValue:l,refresh:h},domModification:{styles:{position:"relative"}}}},Zt=We({name:"Slider",configFields:cx,partFields:t6,factory:lx,apis:{setValue:(e,t,n)=>{e.setValue(t,n)},resetToMin:(e,t)=>{e.resetToMin(t)},resetToMax:(e,t)=>{e.resetToMax(t)},refresh:(e,t)=>{e.refresh(t)}}}),Fu=d("rgb-hex-update"),qm=d("slider-update"),Bm=d("palette-update"),fx=(e,t)=>{const s=Zt.parts.spectrum({dom:{tag:"div",classes:[t("hue-slider-spectrum")],attributes:{role:"presentation"}}}),o=Zt.parts.thumb({dom:{tag:"div",classes:[t("hue-slider-thumb")],attributes:{role:"presentation"}}});return Zt.sketch({dom:{tag:"div",classes:[t("hue-slider")],attributes:{role:"presentation"}},rounded:!1,model:{mode:"y",getInitialValue:n(0)},components:[s,o],sliderBehaviours:i([b.config({})]),onChange:(e,t,n)=>{p(e,qm,{value:n})}})},Pm="form",gx=[ve("formBehaviours",[r])],Nm=e=>"<alloy.field."+e+">",bx=e=>{const t=(()=>{const e=[],t=(t,n)=>(e.push(t),b1(Pm,Nm(t),n));return{field:t,record:n(e)}})(),s=e(t),o=t.record(),i=a(o,e=>Pe({name:e,pname:Nm(e)}));return r1(Pm,gx,i,yx,s)},jx=(e,t)=>e.fold(()=>_.error(t),_.value),yx=(e,t)=>({uid:e.uid,dom:e.dom,components:t,behaviours:we(e.formBehaviours,[r.config({store:{mode:"manual",getValue:t=>{const n=hh(t,e);return _e(n,(e,t)=>e().bind(e=>{const n=x.getCurrent(e);return jx(n,new Error(`Cannot find a current component to extract the value from for form part '${t}': `+Ls(e.element)))}).map(r.getValue))},setValue:(t,n)=>{Ie(n,(n,s)=>{H(t,e,s).each(e=>{x.getCurrent(e).each(e=>{r.setValue(e,n)})})})}}})]),apis:{getField:(t,n)=>H(t,e,n).bind(x.getCurrent)}}),li={getField:Mc((e,t,n)=>e.getField(t,n)),sketch:bx},Mm=d("valid-input"),Sm=d("invalid-input"),Am=d("validating-input"),Iu="colorcustom.rgb.",Ex=(t,n,s,a)=>{const m=(e,s)=>zn.config({invalidClass:n("invalid"),notify:{onValidate:t=>{p(t,Am,{type:e})},onValid:t=>{p(t,Mm,{type:e,value:r.getValue(t)})},onInvalid:t=>{p(t,Sm,{type:e,value:r.getValue(t)})}},validator:{validate:e=>{const n=r.getValue(e),o=s(n)?_.value(!0):_.error(t("aria.input.invalid"));return ke.pure(o)},validateOnLoad:!1}}),c=(e,s,o,a,r)=>{const c=t(Iu+"range"),d=M.parts.label({dom:{tag:"label",attributes:{"aria-label":a}},components:[je(o)]}),u=M.parts.field({data:r,factory:ni,inputAttributes:{type:"text",...s==="hex"?{"aria-live":"polite"}:{}},inputClasses:[n("textfield")],inputBehaviours:i([m(s,e),ee.config({})]),onSetValue:e=>{if(zn.isInvalid(e)){const t=zn.run(e);t.get(l)}}}),h=[d,u],f=s!=="hex"?[M.parts["aria-descriptor"]({text:c})]:[],p=h.concat(f);return{dom:{tag:"div",attributes:{role:"presentation"}},components:p}},f=(e,t)=>{const n=Oa(t);return li.getField(e,"hex").each(t=>{b.isFocused(t)||r.setValue(e,{hex:n.value})}),n},u=(e,t)=>{const n=t.red,s=t.green,o=t.blue;r.setValue(e,{red:n,green:s,blue:o})},h=V({dom:{tag:"div",classes:[n("rgba-preview")],styles:{"background-color":"white"},attributes:{role:"presentation"}}}),d=(e,t)=>{h.getOpt(e).each(e=>{y(e.element,"background-color","#"+t.value)})},v=()=>{const j={red:g(e.some(255)),green:g(e.some(255)),blue:g(e.some(255)),hex:g(e.some("ffffff"))},T=(e,t)=>{const n=ja(t);u(e,n),y(n)},v=e=>j[e].get(),l=(e,t)=>{j[e].set(t)},E=()=>v("red").bind(e=>v("green").bind(t=>v("blue").map(n=>js(e,t,n,1)))),y=t=>{const n=t.red,s=t.green,o=t.blue;l("red",e.some(n)),l("green",e.some(s)),l("blue",e.some(o))},_=(t,n)=>{const s=n.event;s.type!=="hex"?l(s.type,e.none()):a(t)},F=(t,n)=>{s(t);const o=vv(n);l("hex",e.some(n));const i=ja(o);u(t,i),y(i),p(t,Fu,{hex:o}),d(t,o)},S=(t,n,s)=>{const o=parseInt(s,10);l(n,e.some(o)),E().each(e=>{const n=f(t,e);p(t,Fu,{hex:n}),d(t,n)})},A=e=>e.type==="hex",k=(e,t)=>{const n=t.event;A(n)?F(e,n.value):S(e,n.type,n.value)},m=e=>({label:t(Iu+e+".label"),description:t(Iu+e+".description")}),C=m("red"),x=m("green"),w=m("blue"),b=m("hex");return Q(li.sketch(e=>({dom:{tag:"form",classes:[n("rgb-form")],attributes:{"aria-label":t("aria.color.picker")}},components:[e.field("red",M.sketch(c(ml,"red",C.label,C.description,255))),e.field("green",M.sketch(c(ml,"green",x.label,x.description,255))),e.field("blue",M.sketch(c(ml,"blue",w.label,w.description,255))),e.field("hex",M.sketch(c(hv,"hex",b.label,b.description,"ffffff"))),h.asSpec()],formBehaviours:i([zn.config({invalidClass:n("form-invalid")}),O("rgb-form-events",[o(Mm,k),o(Sm,_),o(Am,_)])])})),{apis:{updateHex:(e,t)=>{r.setValue(e,{hex:t.value}),T(e,t),d(e,t)}}})},j=gt({factory:v,name:"RgbForm",configFields:[],apis:{updateHex:(e,t,n)=>{e.updateHex(t,n)}},extraApis:{}});return j},kx=(t,s)=>{const a=Zt.parts.spectrum({dom:{tag:"canvas",attributes:{role:"presentation"},classes:[s("sv-palette-spectrum")]}}),r=Zt.parts.thumb({dom:{tag:"div",attributes:{role:"presentation"},classes:[s("sv-palette-thumb")],innerHtml:`<div class=${s("sv-palette-inner-thumb")} role="presentation"></div>`}}),o=(e,t)=>{const{width:s,height:o}=e,n=e.getContext("2d");if(n===null)return;n.fillStyle=t,n.fillRect(0,0,s,o);const i=n.createLinearGradient(0,0,s,0);i.addColorStop(0,"rgba(255,255,255,1)"),i.addColorStop(1,"rgba(255,255,255,0)"),n.fillStyle=i,n.fillRect(0,0,s,o);const a=n.createLinearGradient(0,0,0,o);a.addColorStop(0,"rgba(0,0,0,0)"),a.addColorStop(1,"rgba(0,0,0,1)"),n.fillStyle=a,n.fillRect(0,0,s,o)},c=(e,t)=>{const n=e.components()[0].element.dom,s=Gi(t,100,100),i=ov(s);o(n,Z7(i))},l=(e,t)=>{const n=Ol(ja(t));Zt.setValue(e,{x:n.saturation,y:100-n.value})},d=t=>{const c=n({x:0,y:0}),l=(e,t,n)=>{p(e,Bm,{value:n})},d=(e,t,n)=>{o(n.element.dom,Z7(G7))},u=i([x.config({find:e.some}),b.config({})]);return Zt.sketch({dom:{tag:"div",attributes:{role:"presentation"},classes:[s("sv-palette")]},model:{mode:"xy",getInitialValue:c},rounded:!1,components:[a,r],onChange:l,onInit:d,sliderBehaviours:u})},u=gt({factory:d,name:"SaturationBrightnessPalette",configFields:[],apis:{setHue:(e,t,n)=>{c(t,n)},setThumb:(e,t,n)=>{l(t,n)}},extraApis:{}});return u},Ax=(e,n)=>{const a=t=>{const f=Ex(e,n,t.onValidHex,t.onInvalidHex),r=kx(e,n),_=e=>(100-e)/100*360,v=e=>100-e/360*100,s={paletteRgba:g(G7),paletteHue:g(0)},m=V(fx(e,n)),a=V(r.sketch({})),l=V(f.sketch({})),d=(e,t,n)=>{a.getOpt(e).each(e=>{r.setHue(e,n)})},p=(e,t)=>{l.getOpt(e).each(e=>{f.updateHex(e,t)})},b=(e,t,n)=>{m.getOpt(e).each(e=>{Zt.setValue(e,v(n))})},j=(e,t)=>{a.getOpt(e).each(e=>{r.setThumb(e,t)})},y=(e,t)=>{const n=ja(e);s.paletteRgba.set(n),s.paletteHue.set(t)},c=(e,t,n,s)=>{y(t,n),h(s,s=>{s(e,t,n)})},w=()=>{const e=[p];return(t,n)=>{const o=n.event.value,i=s.paletteHue.get(),a=Gi(i,o.x,100-o.y),r=F7(a);c(t,r,i,e)}},C=()=>{const e=[d,p];return(t,n)=>{const o=_(n.event.value),a=s.paletteRgba.get(),i=Ol(a),r=Gi(o,i.saturation,i.value),l=F7(r);c(t,l,o,e)}},E=()=>{const e=[d,b,j];return(t,n)=>{const s=n.event.hex,o=wb(s);c(t,s,o.hue,e)}};return{uid:t.uid,dom:t.dom,components:[a.asSpec(),m.asSpec(),l.asSpec()],behaviours:i([O("colour-picker-events",[o(Fu,E()),o(Bm,w()),o(qm,C())]),x.config({find:e=>l.getOpt(e)}),u.config({mode:"acyclic"})])}},r=gt({name:"ColourPicker",configFields:[s("dom"),t("onValidHex",l),t("onInvalidHex",l)],factory:a});return r},Sx=()=>x.config({find:e.some}),Mx=e=>x.config({find:e.getOpt}),Fx=e=>x.config({find:t=>wo(t.element,e).bind(e=>t.getSystem().getByDom(e).toOptional())}),nn={self:Sx,memento:Mx,childAt:Fx},zx=m([t("preprocess",z),t("postprocess",z)]),Dx=(e,t)=>{const n=Je("RepresentingConfigs.memento processors",zx,t);return r.config({store:{mode:"manual",getValue:t=>{const s=e.get(t),o=r.getValue(s);return n.postprocess(o)},setValue:(t,s)=>{const o=n.preprocess(s),i=e.get(t);r.setValue(i,o)}}})},mm=(e,t,n)=>r.config({store:{mode:"manual",...e.map(e=>({initialValue:e})).getOr({}),getValue:t,setValue:n}}),Vu=(e,t,n)=>mm(e,e=>t(e.element),(e,t)=>n(e.element,t)),Rx=e=>Vu(e,Fn,Is),Px=e=>Vu(e,Id,ai),Hx=e=>r.config({store:{mode:"memory",initialValue:e}}),Ct={memento:Dx,withElement:Vu,withComp:mm,domValue:Rx,domHtml:Px,memory:Hx},Bx={"colorcustom.rgb.red.label":"R","colorcustom.rgb.red.description":"Red component","colorcustom.rgb.green.label":"G","colorcustom.rgb.green.description":"Green component","colorcustom.rgb.blue.label":"B","colorcustom.rgb.blue.description":"Blue component","colorcustom.rgb.hex.label":"#","colorcustom.rgb.hex.description":"Hex color code","colorcustom.rgb.range":"Range 0 to 255","aria.color.picker":"Color Picker","aria.input.invalid":"Invalid input"},Vx=e=>t=>e.translate(Bx[t]),$x=(t,n,s)=>{const a=e=>"tox-"+e,c=Ax(Vx(n),a),l=e=>{p(e,ss,{name:"hex-valid",value:!0})},d=e=>{p(e,ss,{name:"hex-valid",value:!1})},o=V(c.sketch({dom:{tag:"div",classes:[a("color-picker-container")],attributes:{role:"presentation"}},onValidHex:l,onInvalidHex:d}));return{dom:{tag:"div"},components:[o.asSpec()],behaviours:i([Ct.withComp(s,e=>{const t=o.get(e),n=x.getCurrent(t),s=n.bind(e=>{const t=r.getValue(e);return t.hex});return s.map(e=>"#"+e).getOr("")},(t,n)=>{const s=/^#([a-fA-F0-9]{3}(?:[a-fA-F0-9]{3})?)/,i=e.from(s.exec(n)).bind(e=>Pa(e,1)),a=o.get(t),c=x.getCurrent(a);c.fold(()=>{console.log("Can not find form")},e=>{r.setValue(e,{hex:i.getOr("")}),li.getField(e,"hex").each(e=>{T(e,oo())})})}),nn.self()])}};am=tinymce.util.Tools.resolve("tinymce.Resource");const Ux=e=>R(e,"init"),Kx=t=>{const s=K(),o=V({dom:{tag:t.tag}}),n=K();return{dom:{tag:"div",classes:["tox-custom-editor"]},behaviours:i([O("custom-editor-events",[J(e=>{o.getOpt(e).each(e=>{(Ux(t)?t.init(e.element.dom):am.load(t.scriptId,t.scriptUrl).then(n=>n(e.element.dom,t.settings))).then(e=>{n.on(t=>{e.setValue(t)}),n.clear(),s.set(e)})})})]),Ct.withComp(e.none(),()=>s.get().fold(()=>n.get().getOr(""),e=>e.getValue()),(e,t)=>{s.get().fold(()=>n.set(t),e=>e.setValue(t))}),nn.self()]),components:[o.asSpec()]}};As=tinymce.util.Tools.resolve("tinymce.util.Tools");const Yx=(e,t)=>{const n=As.explode(t.getOption("images_file_types")),s=e=>vn(n,t=>_r(e.name.toLowerCase(),`.${t.toLowerCase()}`));return q(qV(e),s)},Gx=(e,t,n)=>{const s=(e,t)=>{t.stop()},a=e=>(t,n)=>{h(e,e=>{e(t,n)})},d=(e,t)=>{var n;if(!v.isDisabled(e)){const s=t.event.raw;c(e,(n=s.dataTransfer)===null||n===void 0?void 0:n.files)}},u=(e,t)=>{const n=t.event.raw.target;c(e,n.files)},c=(n,s)=>{s&&(r.setValue(n,Yx(s,t)),p(n,lt,{name:e.name}))},l=V({dom:{tag:"input",attributes:{type:"file",accept:"image/*"},styles:{display:"none"}},behaviours:i([O("input-file-events",[Hs(ua()),Hs(Di())])])}),m=e=>({uid:e.uid,dom:{tag:"div",classes:["tox-dropzone-container"]},behaviours:i([Ct.memory(n.getOr([])),nn.self(),v.config({}),A.config({toggleClass:"dragenter",toggleOnExecute:!1}),O("dropzone-events",[o("dragenter",a([s,A.toggle])),o("dragleave",a([s,A.toggle])),o("dragover",s),o("drop",a([s,d])),o(pa(),u)])]),components:[{dom:{tag:"div",classes:["tox-dropzone"],styles:{}},components:[{dom:{tag:"p"},components:[je(t.translate("Drop an image here"))]},nt.sketch({dom:{tag:"button",styles:{position:"relative"},classes:["tox-button","tox-button--secondary"]},components:[je(t.translate("Browse for an image")),l.asSpec()],action:e=>{const t=l.get(e);t.element.dom.click()},buttonBehaviours:i([ee.config({}),on.button(t.isDisabled),re()])})]}]}),f=e.label.map(e=>ks(e,t)),g=M.parts.field({factory:{sketch:m}});return ga(f,g,["tox-form__group--stretched"],[])},Xx=(e,t)=>({dom:{tag:"div",classes:["tox-form__grid",`tox-form__grid--${e.columns}col`]},components:a(e.items,t.interpreter)}),Uu=d("alloy-fake-before-tabstop"),qu=d("alloy-fake-after-tabstop"),tm=e=>({dom:{tag:"div",styles:{width:"1px",height:"1px",outline:"none"},attributes:{tabindex:"0"},classes:e},behaviours:i([b.config({ignore:!0}),ee.config({})])}),em=e=>({dom:{tag:"div",classes:["tox-navobj"]},components:[tm([Uu]),e,tm([qu])],behaviours:i([nn.childAt(1)])}),Gh=(e,t)=>{p(e,_a(),{raw:{which:9,shiftKey:t}})},nC=(e,t)=>{const n=t.element;mt(n,Uu)?Gh(e,!0):mt(n,qu)&&Gh(e,!1)},na=e=>vi(e,["."+Uu,"."+qu].join(","),U),oC=e=>{const t=g(e.getOr(""));return{getValue:e=>t.get(),setValue:(e,n)=>{t.get()!==n&&w(e.element,"srcdoc",n),t.set(n)}}},iC=(e,t,n)=>{const a=e.sandboxed,r=e.transparent,s="tox-dialog__iframe",c={...e.label.map(e=>({title:e})).getOr({}),...n.map(e=>({srcdoc:e})).getOr({}),...a?{sandbox:"allow-scripts allow-same-origin"}:{}},o=oC(n),l=e.label.map(e=>ks(e,t)),d=e=>em({uid:e.uid,dom:{tag:"iframe",attributes:c,classes:r?[s]:[s,`${s}--opaque`]},behaviours:i([ee.config({}),b.config({}),Ct.withComp(n,o.getValue,o.setValue)])}),u=M.parts.field({factory:{sketch:d}});return ga(l,u,["tox-form__group--stretched"],[])},aC=e=>new Promise((t,n)=>{const s=()=>{o(),t(e)},i=[qe(e,"load",s),qe(e,"error",()=>{o(),n("Unable to load data from image: "+e.dom.src)})],o=()=>h(i,e=>e.unbind());e.dom.complete&&s()}),rC=(e,t,n,s,o)=>{const i=n*o,a=s*o,r=Math.max(0,e/2-i/2),c=Math.max(0,t/2-a/2);return{left:r.toString()+"px",top:c.toString()+"px",width:i.toString()+"px",height:a.toString()+"px"}},cC=(e,t,n)=>{const s=et(e),o=Ve(e);return Math.min(s/t,o/n,1)},lC=(t,n)=>{const s=g(n.getOr({url:""})),o=V({dom:{tag:"img",classes:["tox-imagepreview__image"],attributes:n.map(e=>({src:e.url})).getOr({})}}),a=V({dom:{tag:"div",classes:["tox-imagepreview__container"],attributes:{role:"presentation"}},components:[o.asSpec()]}),c=(e,t)=>{const n={url:t.url};t.zoom.each(e=>n.zoom=e),t.cachedWidth.each(e=>n.cachedWidth=e),t.cachedHeight.each(e=>n.cachedHeight=e),s.set(n);const i=()=>{const{cachedWidth:t,cachedHeight:s,zoom:o}=n;if(!ls(t)&&!ls(s)){if(ls(o)){const o=cC(e.element,t,s);n.zoom=o}const i=rC(et(e.element),Ve(e.element),t,s,n.zoom);a.getOpt(e).each(e=>{ko(e.element,i)})}};o.getOpt(e).each(s=>{const o=s.element;t.url!==De(o,"src")&&(w(o,"src",t.url),ae(e.element,"tox-imagepreview__loaded")),i(),aC(o).then(t=>{e.getSystem().isConnected()&&(me(e.element,"tox-imagepreview__loaded"),n.cachedWidth=t.dom.naturalWidth,n.cachedHeight=t.dom.naturalHeight,i())})})},r={};t.height.each(e=>r.height=e);const l=n.map(t=>({url:t.url,zoom:e.from(t.zoom),cachedWidth:e.from(t.cachedWidth),cachedHeight:e.from(t.cachedHeight)}));return{dom:{tag:"div",classes:["tox-imagepreview"],styles:r,attributes:{role:"presentation"}},components:[a.asSpec()],behaviours:i([nn.self(),Ct.withComp(l,()=>s.get(),c)])}},dC=(t,n)=>{const s={dom:{tag:"label",classes:["tox-label"]},components:[je(n.providers.translate(t.label))]},o=a(t.items,n.interpreter);return{dom:{tag:"div",classes:["tox-form__group"]},components:[s,...o],behaviours:i([nn.self(),j.config({}),Ct.domHtml(e.none()),u.config({mode:"acyclic"})])}},Kh=d("toolbar.button.execute"),hC=e=>Jn((t)=>{Xc(e,t)(n=>{p(t,Kh,{buttonApi:n}),e.onAction(n)})}),Vh={[bt()]:["disabling","alloy.base.behaviour","toggling","toolbar-button-events"]},Bh=(e,t,n)=>fn(e,{tag:"span",classes:["tox-icon","tox-tbtn__icon-wrap"],behaviours:n},t),Gr=(e,t)=>Bh(e,t,[]),Hh=(e,t)=>Bh(e,t,[j.config({})]),e1=(e,t,n)=>({dom:{tag:"span",classes:[`${t}__select-label`]},components:[je(n.translate(e))],behaviours:i([j.config({})])}),Uo=d("update-menu-text"),Dh=d("update-menu-icon"),s1=(t,n,s)=>{const c=g(l),d=t.text.map(e=>V(e1(e,n,s.providers))),h=t.icon.map(e=>V(Hh(e,s.providers.icons))),m=(t,n)=>{const s=r.getValue(t);return b.focus(s),p(s,"keydown",{raw:n.event.raw}),kt.close(s),e.some(!0)},f=t.role.fold(()=>({}),e=>({role:e})),v=t.tooltip.fold(()=>({}),e=>{const t=s.providers.translate(e);return{title:t,"aria-label":t}}),y=fn("chevron-down",{tag:"div",classes:[`${n}__select-chevron`]},s.providers.icons),_=V(kt.sketch({...t.uid?{uid:t.uid}:{},...f,dom:{tag:"button",classes:[n,`${n}--select`].concat(a(t.classes,e=>`${n}--${e}`)),attributes:{...v}},components:fi([h.map(e=>e.asSpec()),d.map(e=>e.asSpec()),e.some(y)]),matchWidth:!0,useMinWidth:!0,onOpen:(e,n,s)=>{t.searchable&&ly(s)},dropdownBehaviours:i([...t.dropdownBehaviours,on.button(()=>t.disabled||s.providers.isDisabled()),re(),ya.config({}),j.config({}),O("dropdown-events",[Ca(t,c),ki(t,c)]),O("menubutton-update-display-text",[o(Uo,(e,t)=>{d.bind(t=>t.getOpt(e)).each(e=>{j.set(e,[je(s.providers.translate(t.event.text))])})}),o(Dh,(e,t)=>{h.bind(t=>t.getOpt(e)).each(e=>{j.set(e,[Hh(t.event.icon,s.providers.icons)])})})])]),eventOrder:Q(Vh,{mousedown:["focusing","alloy.base.behaviour","item-type-events","normal-dropdown-events"]}),sandboxBehaviours:i([u.config({mode:"special",onLeft:m,onRight:m}),O("dropdown-sandbox-events",[o(W5,(e,t)=>{sy(e),t.stop()}),o(U5,(e,t)=>{oy(e,t),t.stop()})])]),lazySink:s.getSink,toggleClass:`${n}--active`,parts:{menu:{...lr(!1,t.columns,t.presets),fakeFocus:t.searchable,onHighlightItem:Fp,onCollapseMenu:(e,t,n)=>{F.getHighlighted(n).each(t=>{Fp(e,n,t)})},onDehighlightItem:cy}},fetch:e=>ke.nu(Tt(t.fetch,e))}));return _.asSpec()},_C=e=>L(e),Mh=e=>e.type==="separator",OC=e=>R(e,"getSubmenuItems"),xC={type:"separator"},CC=(e,t)=>{const n=He(e,(e,n)=>_C(n)?n===""?e:n==="|"?e.length>0&&!Mh(e[e.length-1])?e.concat([xC]):e:R(t,n.toLowerCase())?e.concat([t[n.toLowerCase()]]):e:e.concat([n]),[]);return n.length>0&&Mh(n[n.length-1])&&n.pop(),n},EC=(e,t)=>{const s=e.getSubmenuItems(),n=Eh(s,t),o=Q(n.menus,{[e.value]:n.items}),i=Q(n.expansions,{[e.value]:e.value});return{item:e,menus:o,expansions:i}},kC=e=>{const t=f(e,"value").getOrThunk(()=>d("generated-menu-item"));return Q({value:t},e)},Eh=(e,t)=>{const n=CC(L(e)?e.split(" "):e,t);return qo(n,(e,n)=>{if(OC(n)){const o=kC(n),s=EC(o,t);return{menus:Q(e.menus,s.menus),items:[s.item,...e.items],expansions:Q(e.expansions,s.expansions)}}return{...e,items:[n,...e.items]}},{menus:{},expansions:{},items:[]})},SC=e=>e.search.fold(()=>({searchMode:"no-search"}),e=>({searchMode:"search-with-field",placeholder:e.placeholder})),MC=e=>e.search.fold(()=>({searchMode:"no-search"}),e=>({searchMode:"search-with-results"})),Ro=(t,n,s,o)=>{const a=d("primary-menu"),i=Eh(t,s.shared.providers.menuItems());if(i.items.length===0)return e.none();const r=SC(o),c=Ap(a,i.items,n,s,o.isHorizontalMenu,r),l=MC(o),u=_e(i.menus,(e,t)=>Ap(t,e,n,s,!1,l)),h=Q(u,eo(a,c));return e.from(Qs.tieredData(a,h,i.expansions))},a1=e=>!R(e,"items"),wh="data-value",yh=(e,t,n,s)=>a(n,n=>a1(n)?{type:"togglemenuitem",text:n.text,value:n.value,active:n.value===s,onAction:()=>{r.setValue(e,n.value),p(e,lt,{name:t}),b.focus(e)}}:{type:"nestedmenuitem",text:n.text,getSubmenuItems:()=>yh(e,t,n.items,s)}),c1=(e,t)=>En(e,e=>a1(e)?Ti(e.value===t,e):c1(e.items,t)),LC=(t,s,o)=>{const c=s.shared.providers,a=o.bind(e=>c1(t.items,e)).orThunk(()=>os(t.items).filter(a1)),d=t.label.map(e=>ks(e,c)),u=M.parts.field({dom:{},factory:{sketch:o=>s1({uid:o.uid,text:a.map(e=>e.text),icon:e.none(),tooltip:t.label,role:e.none(),fetch:(n,o)=>{const i=yh(n,t.name,t.items,r.getValue(n));o(Ro(i,Yt.CLOSE_ON_EXECUTE,s,{isHorizontalMenu:!1,search:e.none()}))},onSetup:n(l),getApi:n({}),columns:1,presets:"normal",classes:[],dropdownBehaviours:[ee.config({}),Ct.withComp(a.map(e=>e.value),e=>De(e.element,wh),(e,n)=>{c1(t.items,n).each(t=>{w(e.element,wh,t.value),p(e,Uo,{text:t.text})})})]},"tox-listbox",s.shared)}}),h={dom:{tag:"div",classes:["tox-listboxfield"]},components:[u]};return M.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:Fe([d.toArray(),[h]]),fieldBehaviours:i([v.config({disabled:n(!t.enabled),onDisabled:e=>{M.getField(e).each(v.disable)},onEnabled:e=>{M.getField(e).each(v.enable)}})])})},RC=(e,t)=>({dom:{tag:"div",classes:e.classes},components:a(e.items,t.shared.interpreter)}),PC=(e)=>{const n=a(e.options,e=>({dom:{tag:"option",value:e.value,innerHtml:e.text}})),s=e.data.map(e=>eo("initialValue",e)).getOr({});return{uid:e.uid,dom:{tag:"select",classes:e.selectClasses,attributes:e.selectAttributes},components:n,behaviours:we(e.selectBehaviours,[b.config({}),r.config({store:{mode:"manual",getValue:e=>Fn(e.element),setValue:(t,n)=>{const s=se(e.options,e=>e.value===n);s.isSome()&&Is(t.element,n)},...s}})])}},HC=gt({name:"HtmlSelect",configFields:[s("options"),ve("selectBehaviours",[b,r]),t("selectClasses",[]),t("selectAttributes",{}),D("data")],factory:PC}),IC=(t,n,s)=>{const r=a(t.items,e=>({text:n.translate(e.text),value:e.value})),c=t.label.map(e=>ks(e,n)),l=M.parts.field({dom:{},...s.map(e=>({data:e})).getOr({}),selectAttributes:{size:t.size},options:r,factory:HC,selectBehaviours:i([v.config({disabled:()=>!t.enabled||n.isDisabled()}),ee.config({}),O("selectbox-change",[o(pa(),(e)=>{p(e,lt,{name:t.name})})])])}),d=t.size>1?e.none():e.some(fn("chevron-down",{tag:"div",classes:["tox-selectfield__icon-js"]},n.icons)),u={dom:{tag:"div",classes:["tox-selectfield"]},components:Fe([[l],d.toArray()])};return M.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:Fe([c.toArray(),[u]]),fieldBehaviours:i([v.config({disabled:()=>!t.enabled||n.isDisabled(),onDisabled:e=>{M.getField(e).each(v.disable)},onEnabled:e=>{M.getField(e).each(v.enable)}}),re()])})},BC=n([t("field1Name","field1"),t("field2Name","field2"),Vs("onLockedChange"),go(["lockClass"]),t("locked",!1),$t.field("coupledFieldBehaviours",[x,r])]),VC=(e,t,n)=>H(e,t,n).bind(x.getCurrent),sh=(e,t)=>Pe({factory:M,name:e,overrides:e=>({fieldBehaviours:i([O("coupled-input-behaviour",[o(oo(),n=>{VC(n,e,t).each(t=>{H(n,e,"lock").each(s=>{A.isOn(s)&&e.onLockedChange(n,t,s)})})})])])})}),WC=n([sh("field1","field2"),sh("field2","field1"),Pe({factory:nt,schema:[s("dom")],name:"lock",overrides:e=>({buttonBehaviours:i([A.config({selected:e.locked,toggleClass:e.markers.lockClass,aria:{mode:"pressed"}})])})})]),UC=(t,n)=>({uid:t.uid,dom:t.dom,components:n,behaviours:$t.augment(t.coupledFieldBehaviours,[x.config({find:e.some}),r.config({store:{mode:"manual",getValue:e=>{const n=u1(e,t,["field1","field2"]);return{[t.field1Name]:r.getValue(n.field1()),[t.field2Name]:r.getValue(n.field2())}},setValue:(e,n)=>{const s=u1(e,t,["field1","field2"]);Vt(n,t.field1Name)&&r.setValue(s.field1(),n[t.field1Name]),Vt(n,t.field2Name)&&r.setValue(s.field2(),n[t.field2Name])}}})]),apis:{getField1:e=>H(e,t,"field1"),getField2:e=>H(e,t,"field2"),getLock:e=>H(e,t,"lock")}}),_t=We({name:"FormCoupledInputs",configFields:BC(),partFields:WC(),factory:UC,apis:{getField1:(e,t)=>e.getField1(t),getField2:(e,t)=>e.getField2(t),getLock:(e,t)=>e.getLock(t)}}),qC=e=>{const n={"":0,px:0,pt:1,mm:1,pc:2,ex:2,em:2,ch:2,rem:2,cm:3,in:4,"%":4},s=e=>e in n?n[e]:1;let t=e.value.toFixed(s(e.unit));return t.indexOf(".")!==-1&&(t=t.replace(/\.?0*$/,"")),t+e.unit},M1=e=>{const n=/^\s*(\d+(?:\.\d+)?)\s*(|cm|mm|in|px|pt|pc|em|ex|ch|rem|vw|vh|vmin|vmax|%)\s*$/,t=n.exec(e);if(t!==null){const e=parseFloat(t[1]),n=t[2];return _.value({value:e,unit:n})}return _.error(e)},$3=(t,n)=>{const s={"":96,px:96,pt:72,cm:2.54,pc:12,mm:25.4,in:1},o=e=>R(s,e);return t.unit===n?e.some(t.value):o(t.unit)&&o(n)?s[t.unit]===s[n]?e.some(t.value):e.some(t.value/s[t.unit]*s[n]):e.none()},F1=t=>e.none(),QC=(e,t)=>n=>$3(n,t).map(n=>({value:n*e,unit:t})),ZC=(e,t)=>{const n=M1(e).toOptional(),s=M1(t).toOptional();return rr(n,s,(e,t)=>$3(e,t.unit).map(e=>t.value/e).map(e=>QC(e,t.unit)).getOr(F1)).getOr(F1)},JC=(e,t)=>{let a=F1;const c=d("ratio-event"),l=e=>fn(e,{tag:"span",classes:["tox-icon","tox-lock-icon__"+e]},t.icons),h=_t.parts.lock({dom:{tag:"button",classes:["tox-lock","tox-button","tox-button--naked","tox-button--icon"],attributes:{title:t.translate(e.label.getOr("Constrain proportions"))}},components:[l("lock"),l("unlock")],buttonBehaviours:i([v.config({disabled:()=>!e.enabled||t.isDisabled()}),re(),ee.config({})])}),n=e=>({dom:{tag:"div",classes:["tox-form__group"]},components:e}),u=n=>M.parts.field({factory:ni,inputClasses:["tox-textfield"],inputBehaviours:i([v.config({disabled:()=>!e.enabled||t.isDisabled()}),re(),ee.config({}),O("size-input-events",[o(Cs(),(e)=>{p(e,c,{isField1:n})}),o(pa(),(t)=>{p(t,lt,{name:e.name})})])]),selectOnFocus:!1}),s=e=>({dom:{tag:"label",classes:["tox-label"]},components:[je(t.translate(e))]}),m=_t.parts.field1(n([M.parts.label(s("Width")),u(!0)])),f=_t.parts.field2(n([M.parts.label(s("Height")),u(!1)]));return _t.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:[{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:[m,f,n([s(XS),h])]}],field1Name:"width",field2Name:"height",locked:!0,markers:{lockClass:"tox-locked"},onLockedChange:(e,t)=>{M1(r.getValue(e)).each(e=>{a(e).each(e=>{r.setValue(t,qC(e))})})},coupledFieldBehaviours:i([v.config({disabled:()=>!e.enabled||t.isDisabled(),onDisabled:e=>{_t.getField1(e).bind(M.getField).each(v.disable),_t.getField2(e).bind(M.getField).each(v.disable),_t.getLock(e).each(v.disable)},onEnabled:e=>{_t.getField1(e).bind(M.getField).each(v.enable),_t.getField2(e).bind(M.getField).each(v.enable),_t.getLock(e).each(v.enable)}}),re(),O("size-input-events2",[o(c,(e,t)=>{const n=t.event.isField1,s=n?_t.getField1(e):_t.getField2(e),o=n?_t.getField2(e):_t.getField1(e),i=s.map(r.getValue).getOr(""),c=o.map(r.getValue).getOr("");a=ZC(i,c)})])])})},eE=(e,t,s)=>{const o=Zt.parts.label({dom:{tag:"label",classes:["tox-label"]},components:[je(t.translate(e.label))]}),a=Zt.parts.spectrum({dom:{tag:"div",classes:["tox-slider__rail"],attributes:{role:"presentation"}}}),r=Zt.parts.thumb({dom:{tag:"div",classes:["tox-slider__handle"],attributes:{role:"presentation"}}});return Zt.sketch({dom:{tag:"div",classes:["tox-slider"],attributes:{role:"presentation"}},model:{mode:"x",minX:e.min,maxX:e.max,getInitialValue:n(s.getOrThunk(()=>(Math.abs(e.max)-Math.abs(e.min))/2))},components:[o,a,r],sliderBehaviours:i([nn.self(),b.config({})]),onChoose:(t,n,s)=>{p(t,lt,{name:e.name,value:s})}})},tE=(e,t)=>{const n=e=>({dom:{tag:"th",innerHtml:t.translate(e)}}),s=e=>({dom:{tag:"thead"},components:[{dom:{tag:"tr"},components:a(e,n)}]}),o=e=>({dom:{tag:"td",innerHtml:t.translate(e)}}),r=e=>({dom:{tag:"tr"},components:a(e,o)}),c=e=>({dom:{tag:"tbody"},components:a(e,r)});return{dom:{tag:"table",classes:["tox-dialog__table"]},components:[s(e.header),c(e.cells)],behaviours:i([ee.config({}),b.config({})])}},B3=(t,s)=>{const a=t.label.map(e=>ks(e,s)),c=[v.config({disabled:()=>t.disabled||s.isDisabled()}),re(),u.config({mode:"execution",useEnter:t.multiline!==!0,useControlEnter:t.multiline===!0,execute:t=>(T(t,Da),e.some(!0))}),O("textfield-change",[o(oo(),(e)=>{p(e,lt,{name:t.name})}),o(y1(),(e)=>{p(e,lt,{name:t.name})})]),ee.config({})],l=t.validation.map(e=>zn.config({getRoot:e=>Ii(e.element),invalidClass:"tox-invalid",validator:{validate:t=>{const n=r.getValue(t),s=e.validator(n);return ke.pure(s===!0?_.value(n):_.error(s))},validateOnLoad:e.validateOnLoad}})).toArray(),d=t.placeholder.fold(n({}),e=>({placeholder:s.translate(e)})),h=t.inputMode.fold(n({}),e=>({inputmode:e})),m={...d,...h},f=M.parts.field({tag:t.multiline===!0?"textarea":"input",...t.data.map(e=>({data:e})).getOr({}),inputAttributes:m,inputClasses:[t.classname],inputBehaviours:i(Fe([c,l])),selectOnFocus:!1,factory:ni}),g=t.flex?["tox-form__group--stretched"]:[],b=g.concat(t.maximized?["tox-form-group--maximize"]:[]),j=[v.config({disabled:()=>t.disabled||s.isDisabled(),onDisabled:e=>{M.getField(e).each(v.disable)},onEnabled:e=>{M.getField(e).each(v.enable)}}),re()];return ga(a,f,b,j)},sE=(t,n,s)=>B3({name:t.name,multiline:!1,label:t.label,inputMode:t.inputMode,placeholder:t.placeholder,flex:!1,disabled:!t.enabled,classname:"tox-textfield",validation:e.none(),maximized:t.maximized,data:s},n),oE=(t,n,s)=>B3({name:t.name,multiline:!0,label:t.label,inputMode:e.none(),placeholder:t.placeholder,flex:!0,disabled:!t.enabled,classname:"tox-textarea",validation:e.none(),maximized:t.maximized,data:s},n),iE=(e,t)=>{const n=e.stream.streams,s=n.setup(e,t);return $([o(e.event,s),Hn(()=>t.cancel())].concat(e.cancelEvent.map(e=>[o(e,()=>t.cancel())]).getOr([])))};I3=Object.freeze({__proto__:null,events:iE});const rE=(e,t)=>{let n=null;const s=()=>{zc(n)||(clearTimeout(n),n=null)},o=(...s)=>{zc(n)&&(n=setTimeout(()=>{n=null,e.apply(null,s)},t))};return{cancel:s,throttle:o}},R3=(e,t)=>{let n=null;const s=()=>{zc(n)||(clearTimeout(n),n=null)},o=(...o)=>{s(),n=setTimeout(()=>{n=null,e.apply(null,o)},t)};return{cancel:s,throttle:o}},M3=e=>{const t=g(null),n=()=>({timer:t.get()!==null?"set":"unset"}),s=e=>{t.set(e)},o=()=>{const e=t.get();e!==null&&e.cancel()};return jt({readState:n,setTimer:s,cancel:o})},dE=e=>e.stream.streams.state(e);A3=Object.freeze({__proto__:null,throttle:M3,init:dE});const hE=(e,t)=>{const n=e.stream,s=R3(e.onStream,n.delay);return t.setTimer(s),(e,t)=>{s.throttle(e,t),n.stopEvent&&t.stop()}};k3=[Ot("stream",yt("mode",{throttle:[s("delay"),t("stopEvent",!0),W("streams",{setup:hE,state:M3})]})),t("event","input"),D("cancelEvent"),Vs("onStream")];const R1=xe({fields:k3,name:"streaming",active:I3,state:A3}),zr=(e,t,n)=>{const s=r.getValue(n);r.setValue(t,s),h3(t)},O3=(e,t)=>{const n=e.element,s=Fn(n),o=n.dom;De(n,"type")!=="number"&&t(o,s)},h3=e=>{O3(e,(e,t)=>e.setSelectionRange(t.length,t.length))},bE=(e,t)=>{O3(e,(e,n)=>e.setSelectionRange(t,n.length))},jE=(t,n,s)=>{if(t.selectsOver){const i=r.getValue(n),o=t.getDisplayText(i),a=r.getValue(s),c=t.getDisplayText(a);return c.indexOf(o)===0?e.some(()=>{zr(t,n,s),bE(n,o.length)}):e.none()}return e.none()},$1=n("alloy.typeahead.itemexecute"),_E=(t,n,s,i)=>{const h=(e,n,s)=>{t.previewing.set(!1);const o=G.getCoupled(e,"sandbox");if(k.isOpen(o))x.getCurrent(o).each(e=>{F.getHighlighted(e).fold(()=>{s(e)},()=>{cf(o,e.element,"keydown",n)})});else{const n=e=>{x.getCurrent(e).each(s)};Ur(t,c(e),e,o,i,n,Ge.HighlightMenuAndItem).get(l)}},f=H5(t),c=e=>t=>t.map(t=>{const n=Nl(t.menus),s=le(n,e=>q(e.items,e=>e.type==="item")),o=r.getState(e);return o.update(a(s,e=>e.data)),t}),d=e=>x.getCurrent(e),m="typeaheadevents",g=[b.config({}),r.config({onSetValue:t.onSetValue,store:{mode:"dataset",getDataKey:e=>Fn(e.element),getFallbackEntry:e=>({value:e,meta:{}}),setValue:(e,n)=>{Is(e.element,t.model.getDisplayText(n))},...t.initialData.map(e=>eo("initialValue",e)).getOr({})}}),R1.config({stream:{mode:"throttle",delay:t.responseTime,stopEvent:!1},onStream:(n)=>{const o=G.getCoupled(n,"sandbox"),a=b.isFocused(n);if(a&&Fn(n.element).length>=t.minChars){const s=d(o).bind(e=>F.getHighlighted(e).map(r.getValue));t.previewing.set(!0);const a=n=>{d(o).each(n=>{s.fold(()=>{t.model.selectsOver&&F.highlightFirst(n)},t=>{F.highlightBy(n,e=>{const n=r.getValue(e);return n.value===t.value}),F.getHighlighted(n).orThunk(()=>(F.highlightFirst(n),e.none()))})})};Ur(t,c(n),n,o,i,a,Ge.HighlightJustMenu).get(l)}},cancelEvent:m1()}),u.config({mode:"special",onDown:(t,n)=>(h(t,n,F.highlightFirst),e.some(!0)),onEscape:t=>{const n=G.getCoupled(t,"sandbox");return k.isOpen(n)?(k.close(n),e.some(!0)):e.none()},onUp:(t,n)=>(h(t,n,F.highlightLast),e.some(!0)),onEnter:n=>{const s=G.getCoupled(n,"sandbox"),o=k.isOpen(s);if(o&&!t.previewing.get())return d(s).bind(e=>F.getHighlighted(e)).map(e=>(p(n,$1(),{item:e}),!0));const i=r.getValue(n);return T(n,m1()),t.onExecute(s,n,i),o&&k.close(s),e.some(!0)}}),A.config({toggleClass:t.markers.openClass,aria:{mode:"expanded"}}),G.config({others:{sandbox:e=>Od(t,e,{onOpen:()=>A.on(e),onClose:()=>A.off(e)})}}),O(m,[J(n=>{t.lazyTypeaheadComp.set(e.some(n))}),Hn(n=>{t.lazyTypeaheadComp.set(e.none())}),Jn(e=>{const n=l;gd(t,c(e),e,i,n,Ge.HighlightMenuAndItem).get(l)}),o($1(),(e,n)=>{const s=G.getCoupled(e,"sandbox");zr(t.model,e,n.event.item),T(e,m1()),t.onItemExecute(e,s,n.event.item,r.getValue(e)),k.close(s),h3(e)})].concat(t.dismissOnBlur?[o(_1(),e=>{const t=G.getCoupled(e,"sandbox");rn(t.element).isNone()&&k.close(t)})]:[]))],v={[hi()]:[r.name(),R1.name(),m],...t.eventOrder};return{uid:t.uid,dom:B5(Q(t,{inputAttributes:{role:"combobox","aria-autocomplete":"list","aria-haspopup":"true"}})),behaviours:{...f,...we(t.typeaheadBehaviours,g)},eventOrder:v}},wE=n([D("lazySink"),s("fetch"),t("minChars",5),t("responseTime",1e3),E("onOpen"),t("getHotspot",e.some),t("getAnchorOverrides",n({})),t("layouts",e.none()),t("eventOrder",{}),O4("model",{},[t("getDisplayText",e=>e.meta!==void 0&&e.meta.text!==void 0?e.meta.text:e.value),t("selectsOver",!0),t("populateFromBrowse",!0)]),E("onSetValue"),rt("onExecute"),E("onItemExecute"),t("inputClasses",[]),t("inputAttributes",{}),t("inputStyles",{}),t("matchWidth",!0),t("useMinWidth",!1),t("dismissOnBlur",!0),go(["openClass"]),D("initialData"),ve("typeaheadBehaviours",[b,r,R1,u,A,G]),Xe("lazyTypeaheadComp",()=>g(e.none)),Xe("previewing",()=>g(!0))].concat(P5()).concat(Ad())),OE=n([Wt({schema:[hc()],name:"menu",overrides:e=>({fakeFocus:!0,onHighlightItem:(t,n,s)=>{e.previewing.get()?e.lazyTypeaheadComp.get().each(t=>{jE(e.model,t,s).fold(()=>{e.model.selectsOver?(F.dehighlight(n,s),e.previewing.set(!0)):e.previewing.set(!1)},t=>{t(),e.previewing.set(!1)})}):e.lazyTypeaheadComp.get().each(t=>{e.model.populateFromBrowse&&zr(e.model,t,s)})},onExecute:(t,n)=>e.lazyTypeaheadComp.get().map(e=>(p(e,$1(),{item:n}),!0)),onHover:(t,n)=>{e.previewing.set(!1),e.lazyTypeaheadComp.get().each(t=>{e.model.populateFromBrowse&&zr(e.model,t,n)})}})})]),xE=We({name:"Typeahead",configFields:wE(),partFields:OE(),factory:_E}),Bt=e=>{const t=()=>Bt(e.toCached()),n=t=>Bt(e.bind(e=>e.fold(e=>ke.pure(_.error(e)),e=>t(e)))),s=t=>Bt(e.map(e=>e.bind(t))),o=t=>Bt(e.map(e=>e.map(t))),i=t=>Bt(e.map(e=>e.mapError(t))),a=(t,n)=>e.map(e=>e.fold(t,n)),r=(t,n)=>Bt(ke.nu(s=>{let o=!1;const i=setTimeout(()=>{o=!0,s(_.error(n()))},t);e.get(e=>{o||(clearTimeout(i),s(e))})}));return{...e,toCached:t,bindFuture:n,bindResult:s,mapResult:o,mapError:i,foldResult:a,withTimeout:r}},l3=e=>Bt(ke.nu(e)),r3=e=>Bt(ke.pure(_.value(e))),AE=e=>Bt(ke.pure(_.error(e))),SE=e=>Bt(ke.pure(e)),ME=e=>Bt(e.map(_.value)),FE=e=>l3(t=>{e.then(e=>{t(_.value(e))},e=>{t(_.error(e))})}),TE={nu:l3,wrap:Bt,pure:r3,value:r3,error:AE,fromResult:SE,fromFuture:ME,fromPromise:FE},zE=e=>({isEnabled:()=>!v.isDisabled(e),setEnabled:t=>v.set(e,!t),setActive:t=>{const n=e.element;t?(me(n,"tox-tbtn--enabled"),w(n,"aria-pressed",!0)):(ae(n,"tox-tbtn--enabled"),pe(n,"aria-pressed"))},isActive:()=>mt(e.element,"tox-tbtn--enabled")}),U1=(e,t,n,s)=>s1({text:e.text,icon:e.icon,tooltip:e.tooltip,searchable:e.search.isSome(),role:s,fetch:(t,s)=>{const o={pattern:e.search.isSome()?dy(t):""};e.fetch(t=>{s(Ro(t,Yt.CLOSE_ON_EXECUTE,n,{isHorizontalMenu:!1,search:e.search}))},o)},onSetup:e.onSetup,getApi:zE,columns:1,presets:"normal",classes:[],dropdownBehaviours:[ee.config({})]},t,n.shared),NE=(e,t,n)=>{const s=e=>s=>{const o=!s.isActive();s.setActive(o),e.storage.set(o),n.shared.getSink().each(n=>{t().getOpt(n).each(t=>{es(t.element),p(t,ss,{name:e.name,value:e.storage.get()})})})},o=e=>t=>{t.setActive(e.storage.get())};return t=>{t(a(e,e=>{const t=e.text.fold(()=>({}),e=>({text:e}));return{type:e.type,active:!1,...t,onAction:s(e),onSetup:o(e)}}))}},i3=(e,t,n=[],s,o,a)=>{const r=t.fold(()=>({}),e=>({action:e})),c={buttonBehaviours:i([on.button(()=>!e.enabled||a.isDisabled()),re(),ee.config({}),O("button press",[mf("click"),mf("mousedown")])].concat(n)),eventOrder:{click:["button press","alloy.base.behaviour"],mousedown:["button press","alloy.base.behaviour"]},...r},l=Q(c,{dom:s});return Q(l,{components:o})},RE=(e,t,n,s=[])=>{const o=e.tooltip.map(e=>({"aria-label":n.translate(e),title:n.translate(e)})).getOr({}),i={tag:"button",classes:["tox-tbtn"],attributes:o},a=e.icon.map(e=>Gr(e,n.icons)),r=fi([a]);return i3(e,t,s,i,r,n)},PE=e=>{switch(e){case"primary":return["tox-button"];case"toolbar":return["tox-tbtn"];case"secondary":default:return["tox-button","tox-button--secondary"]}},s3=(e,t,n,s=[],o=[])=>{const i=n.translate(e.text),a=e.icon.map(e=>Gr(e,n.icons)),r=[a.getOrThunk(()=>je(i))],c=e.buttonType.getOr(!e.primary&&!e.borderless?"secondary":"primary"),l=PE(c),d=[...l,...a.isSome()?["tox-button--icon"]:[],...e.borderless?["tox-button--naked"]:[],...o],u={tag:"button",classes:d,attributes:{title:i}};return i3(e,t,s,u,r,n)},K1=(t,n,s,o=[],i=[])=>{const a=s3(t,e.some(n),s,o,i);return nt.sketch(a)},t3=(e,t)=>n=>{t==="custom"?p(n,ss,{name:e,value:{}}):t==="submit"?T(n,Da):t==="cancel"?T(n,yo):console.error("Unknown button type: ",t)},VE=(e,t)=>t==="menu",$E=(e,t)=>t==="custom"||t==="cancel"||t==="submit",xr=(t,n,s)=>{if(VE(t,n)){const o=()=>n,i=t,a={...t,type:"menubutton",search:e.none(),onSetup:e=>(e.setEnabled(t.enabled),l),fetch:NE(i.items,o,s)},n=V(U1(a,"tox-tbtn",s,e.none()));return n.asSpec()}if($E(t,n)){const e=t3(t.name,n),o={...t,borderless:!1};return K1(o,e,s.shared.providers,[])}throw console.error("Unknown footer button type: ",n),new Error("Unknown footer button type")},UE=(t,n)=>{const s=t3(t.name,"custom");return s_(e.none(),M.parts.field({factory:nt,...s3(t,e.some(s),n,[Ct.memory(""),nn.self()])}))},KE={type:"separator"},qE=e=>({type:"menuitem",value:e.url,text:e.title,meta:{attach:e.attach},onAction:l}),Y1=(e,t)=>({type:"menuitem",value:t,text:e,meta:{attach:void 0},onAction:l}),GE=e=>a(e,qE),XE=(e,t)=>q(t,t=>t.type===e),q2=(e,t)=>GE(XE(e,t)),ZE=e=>q2("header",e.targets),JE=e=>q2("anchor",e.targets),ek=t=>e.from(t.anchorTop).map(e=>Y1("<top>",e)).toArray(),tk=t=>e.from(t.anchorBottom).map(e=>Y1("<bottom>",e)).toArray(),nk=e=>a(e,e=>Y1(e,e)),sk=e=>He(e,(e,t)=>{const n=e.length===0||t.length===0;return n?e.concat(t):e.concat(KE,t)},[]),G1=(e,t)=>{const n=e.toLowerCase();return q(t,e=>{var t;const s=e.meta!==void 0&&e.meta.text!==void 0?e.meta.text:e.text,o=(t=e.value)!==null&&t!==void 0?t:"";return st(s.toLowerCase(),n)||st(o.toLowerCase(),n)})},ik=(e,t,n)=>{const s=r.getValue(t),o=s.meta.text!==void 0?s.meta.text:s.value,i=n.getLinkInformation();return i.fold(()=>[],t=>{const s=G1(o,nk(n.getHistory(e)));return e==="file"?sk([s,G1(o,ZE(t)),G1(o,Fe([ek(t),JE(t),tk(t)]))]):s})},W2=d("aria-invalid"),rk=(t,n,s,a)=>{const c=n.shared.providers,u=e=>{const n=r.getValue(e);s.addToHistory(n.value,t.filetype)},k={...a.map(e=>({initialData:e})).getOr({}),dismissOnBlur:!0,inputClasses:["tox-textfield"],sandboxClasses:["tox-dialog__popups"],inputAttributes:{"aria-errormessage":W2,type:"url"},minChars:0,responseTime:0,fetch:o=>{const i=ik(t.filetype,o,s),a=Ro(i,Yt.BUBBLE_TO_SANDBOX,n,{isHorizontalMenu:!1,search:e.none()});return ke.pure(a)},getHotspot:e=>b.getOpt(e),onSetValue:(e)=>{e.hasConfigured(zn)&&zn.run(e).get(l)},typeaheadBehaviours:i([...s.getValidationHandler().map(e=>zn.config({getRoot:e=>Ii(e.element),invalidClass:"tox-control-wrap--status-invalid",notify:{onInvalid:(e,t)=>{f.getOpt(e).each(e=>{w(e.element,"title",c.translate(t))})}},validator:{validate:n=>{const s=r.getValue(n);return TE.nu(n=>{e({type:t.filetype,url:s.value},e=>{if(e.status==="invalid"){const t=_.error(e.message);n(t)}else{const t=_.value(e.message);n(t)}})})},validateOnLoad:!1}})).toArray(),v.config({disabled:()=>!t.enabled||c.isDisabled()}),ee.config({}),O("urlinput-events",[o(oo(),e=>{const n=Fn(e.element),s=n.trim();s!==n&&Is(e.element,s),t.filetype==="file"&&p(e,lt,{name:t.name})}),o(pa(),e=>{p(e,lt,{name:t.name}),u(e)}),o(y1(),e=>{p(e,lt,{name:t.name}),u(e)})])]),eventOrder:{[oo()]:["streaming","urlinput-events","invalidating"]},model:{getDisplayText:e=>e.value,selectsOver:!1,populateFromBrowse:!1},markers:{openClass:"tox-textfield--popup-open"},lazySink:n.shared.getSink,parts:{menu:lr(!1,1,"normal")},onExecute:(e,t)=>{p(t,Da,{})},onItemExecute:(e)=>{u(e),p(e,lt,{name:t.name})}},E=M.parts.field({...k,factory:xE}),j=t.label.map(e=>ks(e,c)),y=(e,t,n=e,s=e)=>fn(n,{tag:"div",classes:["tox-icon","tox-control-wrap__status-icon-"+e],attributes:{title:c.translate(s),"aria-live":"polite",...t.fold(()=>({}),e=>({id:e}))}},c.icons),f=V(y("invalid",e.some(W2),"warning")),C=V({dom:{tag:"div",classes:["tox-control-wrap__status-icon-wrap"]},components:[f.asSpec()]}),g=s.getUrlPicker(t.filetype),m=d("browser.url.event"),b=V({dom:{tag:"div",classes:["tox-control-wrap"]},components:[E,C.asSpec()],behaviours:i([v.config({disabled:()=>!t.enabled||c.isDisabled()})])}),h=V(K1({name:t.name,icon:e.some("browse"),text:t.label.getOr(""),enabled:t.enabled,primary:!1,buttonType:e.none(),borderless:!0},e=>T(e,m),c,[],["tox-browse-url"])),A=()=>({dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:Fe([[b.asSpec()],g.map(()=>h.asSpec()).toArray()])}),S=e=>{x.getCurrent(e).each(n=>{const s=r.getValue(n),o={fieldname:t.name,...s};g.each(s=>{s(o).get(s=>{r.setValue(n,s),p(e,lt,{name:t.name})})})})};return M.sketch({dom:i_(),components:j.toArray().concat([A()]),fieldBehaviours:i([v.config({disabled:()=>!t.enabled||c.isDisabled(),onDisabled:e=>{M.getField(e).each(v.disable),h.getOpt(e).each(v.disable)},onEnabled:e=>{M.getField(e).each(v.enable),h.getOpt(e).each(v.enable)}}),re(),O("url-input-events",[o(m,S)])])})},ck=(e,t)=>_n.sketch({dom:{tag:"div",attributes:{role:"alert"},classes:["tox-notification","tox-notification--in",`tox-notification--${e.level}`]},components:[{dom:{tag:"div",classes:["tox-notification__icon"]},components:[nt.sketch({dom:{tag:"button",classes:["tox-button","tox-button--naked","tox-button--icon"],innerHtml:$p(e.icon,t.icons),attributes:{title:t.translate(e.iconTooltip)}},action:t=>{p(t,ss,{name:"alert-banner",value:e.url})},buttonBehaviours:i([_d()])})]},{dom:{tag:"div",classes:["tox-notification__body"],innerHtml:t.translate(e.text)}}]}),lk=(e,t)=>{e.dom.checked=t},dk=e=>e.dom.checked,uk=(t,n,s)=>{const a=t=>(t.element.dom.click(),e.some(!0)),c=M.parts.field({factory:{sketch:z},dom:{tag:"input",classes:["tox-checkbox__input"],attributes:{type:"checkbox"}},behaviours:i([nn.self(),v.config({disabled:()=>!t.enabled||n.isDisabled()}),ee.config({}),b.config({}),Ct.withElement(s,dk,lk),u.config({mode:"special",onEnter:a,onSpace:a,stopSpaceKeyup:!0}),O("checkbox-events",[o(pa(),(e)=>{p(e,lt,{name:t.name})})])])}),l=M.parts.label({dom:{tag:"span",classes:["tox-checkbox__label"]},components:[je(n.translate(t.label))],behaviours:i([ya.config({})])}),r=e=>{const t=e==="checked"?"selected":"unselected";return fn(t,{tag:"span",classes:["tox-icon","tox-checkbox-icon__"+e]},n.icons)},d=V({dom:{tag:"div",classes:["tox-checkbox__icons"]},components:[r("checked"),r("unchecked")]});return M.sketch({dom:{tag:"label",classes:["tox-checkbox"]},components:[c,d.asSpec(),l],fieldBehaviours:i([v.config({disabled:()=>!t.enabled||n.isDisabled(),disableClass:"tox-checkbox--disabled",onDisabled:e=>{M.getField(e).each(v.disable)},onEnabled:e=>{M.getField(e).each(v.enable)}}),re()])})},hk=e=>e.presets==="presentation"?_n.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:e.html}}):_n.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:e.html,attributes:{role:"document"}},containerBehaviours:i([ee.config({}),b.config({})])}),ue=t=>(n,s,o,i)=>f(s,"name").fold(()=>t(s,i,e.none()),e=>n.field(e,t(s,i,f(o,e)))),fk=e=>(t,n,s,o)=>{const i=Q(n,{source:"dynamic"});return ue(e)(t,i,s,o)},pk={bar:ue((e,t)=>Ky(e,t.shared)),collection:ue((e,t,n)=>v_(e,t.shared.providers,n)),alertbanner:ue((e,t)=>ck(e,t.shared.providers)),input:ue((e,t,n)=>sE(e,t.shared.providers,n)),textarea:ue((e,t,n)=>oE(e,t.shared.providers,n)),label:ue((e,t)=>dC(e,t.shared)),iframe:fk((e,t,n)=>iC(e,t.shared.providers,n)),button:ue((e,t)=>UE(e,t.shared.providers)),checkbox:ue((e,t,n)=>uk(e,t.shared.providers,n)),colorinput:ue((e,t,n)=>P_(e,t.shared,t.colorinput,n)),colorpicker:ue((e,t,n)=>$x(e,t.shared.providers,n)),dropzone:ue((e,t,n)=>Gx(e,t.shared.providers,n)),grid:ue((e,t)=>Xx(e,t.shared)),listbox:ue((e,t,n)=>LC(e,t,n)),selectbox:ue((e,t,n)=>IC(e,t.shared.providers,n)),sizeinput:ue((e,t)=>JC(e,t.shared.providers)),slider:ue((e,t,n)=>eE(e,t.shared.providers,n)),urlinput:ue((e,t,n)=>rk(e,t,t.urlinput,n)),customeditor:ue(Kx),htmlpanel:ue(hk),imagepreview:ue((e,t,n)=>lC(e,n)),table:ue((e,t)=>tE(e,t.shared.providers)),panel:ue((e,t)=>RC(e,t))},gk={field:(e,t)=>t,record:n([])},H2=(e,t,n,s)=>{const o=Q(s,{shared:{interpreter:t=>J1(e,t,n,o)}});return J1(e,t,n,o)},J1=(e,t,n,s)=>f(pk,t.type).fold(()=>(console.error(`Unknown factory type "${t.type}", defaulting to container: `,t),t),o=>o(e,t,n,s)),F2=(e,t,n)=>J1(gk,e,t,n),Fs="layout-inset",s4=e=>e.x,O2=(e,t)=>e.x+e.width/2-t.width/2,i4=(e,t)=>e.x+e.width-t.width,a4=e=>e.y,r4=(e,t)=>e.y+e.height-t.height,v2=(e,t)=>e.y+e.height/2-t.height/2,yr=(e,t,n)=>Te(i4(e,t),r4(e,t),n.insetSouthwest(),Wd(),"southwest",Ee(e,{right:0,bottom:3}),Fs),jr=(e,t,n)=>Te(s4(e),r4(e,t),n.insetSoutheast(),$d(),"southeast",Ee(e,{left:1,bottom:3}),Fs),gi=(e,t,n)=>Te(i4(e,t),a4(e),n.insetNorthwest(),Vd(),"northwest",Ee(e,{right:0,top:2}),Fs),ji=(e,t,n)=>Te(s4(e),a4(e),n.insetNortheast(),Xr(),"northeast",Ee(e,{left:1,top:2}),Fs),Pn=(e,t,n)=>Te(O2(e,t),a4(e),n.insetNorth(),q6(),"north",Ee(e,{top:2}),Fs),Oi=(e,t,n)=>Te(O2(e,t),r4(e,t),n.insetSouth(),U6(),"south",Ee(e,{bottom:3}),Fs),q0=(e,t,n)=>Te(i4(e,t),v2(e,t),n.insetEast(),x6(),"east",Ee(e,{right:0}),Fs),U0=(e,t,n)=>Te(s4(e),v2(e,t),n.insetWest(),D6(),"west",Ee(e,{left:1}),Fs),Nk=e=>{switch(e){case"north":return Pn;case"northeast":return ji;case"northwest":return gi;case"south":return Oi;case"southeast":return jr;case"southwest":return yr;case"east":return q0;case"west":return U0}},W0=(e,t,n,s,o)=>{const i=fh(s).map(Nk).getOr(Pn);return i(e,t,n,s,o)},Rk=e=>{switch(e){case"north":return Oi;case"northeast":return jr;case"northwest":return yr;case"south":return Pn;case"southeast":return ji;case"southwest":return gi;case"east":return U0;case"west":return q0}},Pk=(e,t,n,s,o)=>{const i=fh(s).map(Rk).getOr(Pn);return i(e,t,n,s,o)},B0={valignCentre:[],alignCentre:[],alignLeft:[],alignRight:[],right:[],left:[],bottom:[],top:[]},Ik=(t,n,s)=>{const o=12,i={maxHeightFunction:Ea()},a=()=>({type:"node",root:Kc(Pt(t())),node:e.from(t()),bubble:To(o,o,B0),layouts:{onRtl:()=>[ji],onLtr:()=>[gi]},overrides:i}),r=()=>({type:"hotspot",hotspot:n(),bubble:To(-o,o,B0),layouts:{onRtl:()=>[Ne],onLtr:()=>[Le]},overrides:i});return()=>s()?a():r()},Bk=(t,n,s)=>{const o=()=>({type:"node",root:Kc(Pt(t())),node:e.from(t()),layouts:{onRtl:()=>[Pn],onLtr:()=>[Pn]}}),i=()=>({type:"hotspot",hotspot:n(),layouts:{onRtl:()=>[Ce],onLtr:()=>[Ce]}});return()=>s()?o():i()},Vk=(t,n)=>()=>({type:"selection",root:n(),getSelection:()=>{const n=t.selection.getRng();return e.some(la.range(c.fromDom(n.startContainer),n.startOffset,c.fromDom(n.endContainer),n.endOffset))}}),$k=e=>t=>({type:"node",root:e(),node:t}),Wk=(e,t,n)=>{const a=Bi(e),s=()=>c.fromDom(e.getBody()),o=()=>c.fromDom(e.getContentAreaContainer()),i=()=>a||!n();return{inlineDialog:Ik(o,t,i),banner:Bk(o,t,i),cursor:Vk(e,s),node:$k(s)}},Uk=e=>(t,n)=>{const s=L5(e);s(t,n)},Kk=e=>()=>l7(e),qk=e=>t=>$i(e,t),Yk=e=>t=>h7(e,t),Gk=e=>({colorPicker:Uk(e),hasCustomColors:Kk(e),getColors:qk(e),getColorCols:Yk(e)}),Xk=e=>()=>Ng(e),Qk=e=>({isDraggableModal:Xk(e)}),Zk=e=>{const t=g(td(e)?"bottom":"top");return{isPositionedAtTop:()=>t.get()==="top",getDockingMode:t.get,setDockingMode:t.set}},I0=e=>Vt(e,"items"),H0=e=>Vt(e,"format"),P0=[{title:"Headings",items:[{title:"Heading 1",format:"h1"},{title:"Heading 2",format:"h2"},{title:"Heading 3",format:"h3"},{title:"Heading 4",format:"h4"},{title:"Heading 5",format:"h5"},{title:"Heading 6",format:"h6"}]},{title:"Inline",items:[{title:"Bold",format:"bold"},{title:"Italic",format:"italic"},{title:"Underline",format:"underline"},{title:"Strikethrough",format:"strikethrough"},{title:"Superscript",format:"superscript"},{title:"Subscript",format:"subscript"},{title:"Code",format:"code"}]},{title:"Blocks",items:[{title:"Paragraph",format:"p"},{title:"Blockquote",format:"blockquote"},{title:"Div",format:"div"},{title:"Pre",format:"pre"}]},{title:"Align",items:[{title:"Left",format:"alignleft"},{title:"Center",format:"aligncenter"},{title:"Right",format:"alignright"},{title:"Justify",format:"alignjustify"}]}],nA=e=>R(e,"items"),sA=e=>R(e,"block"),oA=e=>R(e,"inline"),iA=e=>R(e,"selector"),R0=e=>He(e,(e,t)=>{if(nA(t)){const n=R0(t.items);return{customFormats:e.customFormats.concat(n.customFormats),formats:e.formats.concat([{title:t.title,items:n.formats}])}}if(oA(t)||sA(t)||iA(t)){const s=L(t.name)?t.name:t.title.toLowerCase(),n=`custom-${s}`;return{customFormats:e.customFormats.concat([{name:n,format:t}]),formats:e.formats.concat([{title:t.title,format:n,icon:t.icon}])}}return{...e,formats:e.formats.concat(t)}},{customFormats:[],formats:[]}),rA=(e,t)=>{const n=R0(t),s=t=>{h(t,t=>{e.formatter.has(t.name)||e.formatter.register(t.name,t.format)})};return e.formatter?s(n.customFormats):e.on("init",()=>{s(n.customFormats)}),n.formats},L0=e=>pg(e).map(t=>{const n=rA(e,t);return gg(e)?P0.concat(n):n}).getOr(P0),lA=e=>{const t=de(e);return t.length===1&&Oe(t,"title")},N0=(e,t,n)=>({...e,type:"formatter",isSelected:t(e.format),getStylePreview:n(e.format)}),T0=(e,t,s,o)=>{const r=e=>N0(e,s,o),c=e=>{const t=i(e.items);return{...e,type:"submenu",getStyleItems:n(t)}},l=t=>{const i=L(t.name)?t.name:d(t.title),n=`custom-${i}`,a={...t,type:"formatter",format:n,isSelected:s(n),getStylePreview:o(n)};return e.formatter.register(i,a),a},i=e=>a(e,e=>I0(e)?c(e):H0(e)?r(e):lA(e)?{...e,type:"separator"}:l(e));return i(t)},hA=t=>{const n=e=>()=>t.formatter.match(e),s=n=>()=>{const s=t.formatter.get(n);return s!==void 0?e.some({tag:s.length>0?s[0].inline||s[0].block||"div":"div",styles:t.dom.parseStyle(t.formatter.getCssText(n))}):e.none()},o=g([]),i=g([]),a=g(!1);t.on("PreInit",e=>{const i=L0(t),a=T0(t,i,n,s);o.set(a)}),t.on("addStyleModifications",e=>{const o=T0(t,e.items,n,s);i.set(o),a.set(e.replace)});const r=()=>{const e=a.get()?[]:o.get(),t=i.get();return e.concat(t)};return{getData:r}},mA=e=>en(e)&&e.nodeType===1,fA=As.trim,j0=e=>t=>{if(mA(t)){if(t.contentEditable===e)return!0;if(t.getAttribute("data-mce-contenteditable")===e)return!0}return!1},gA=j0("true"),vA=j0("false"),g0=(e,t,n,s,o)=>({type:e,title:t,url:n,level:s,attach:o}),jA=e=>{let t=e;for(;t=t.parentNode;){const e=t.contentEditable;if(e&&e!=="inherit")return gA(t)}return!1},yA=(e,t)=>a(Ue(c.fromDom(t),e),e=>e.dom),f0=e=>e.innerText||e.textContent,wA=e=>e.id?e.id:d("h"),OA=e=>e&&e.nodeName==="A"&&(e.id||e.name)!==void 0,xA=e=>OA(e)&&h0(e),m0=e=>e&&/^(H[1-6])$/.test(e.nodeName),h0=e=>jA(e)&&!vA(e),kA=e=>m0(e)&&h0(e),AA=e=>m0(e)?parseInt(e.nodeName.substr(1),10):0,SA=e=>{var t;const n=wA(e),s=()=>{e.id=n};return g0("header",(t=f0(e))!==null&&t!==void 0?t:"","#"+n,AA(e),s)},MA=e=>{const t=e.id||e.name,n=f0(e);return g0("anchor",n||"#"+t,"#"+t,0,l)},FA=e=>a(q(e,kA),SA),TA=e=>a(q(e,xA),MA),zA=e=>{const t=yA("h1,h2,h3,h4,h5,h6,a:not([href])",e);return t},DA=e=>fA(e.title).length>0,NA=e=>{const t=zA(e);return q(FA(t).concat(TA(t)),DA)},LA={find:NA},sr="tinymce-url-history",l0=5,c0=e=>L(e)&&/^https?/.test(e),IA=e=>bs(e)&&e.length<=l0&&si(e,c0),a0=e=>Os(e)&&Dl(e,e=>!IA(e)).isNone(),i0=()=>{const t=xs.getItem(sr);if(t===null)return{};let e;try{e=JSON.parse(t)}catch(e){if(e instanceof SyntaxError)return console.log("Local storage "+sr+" was not valid JSON",e),{};throw e}return a0(e)?e:(console.log("Local storage "+sr+" was not valid format",e),{})},$A=e=>{if(!a0(e))throw new Error(`Bad format for history:
`+JSON.stringify(e));xs.setItem(sr,JSON.stringify(e))},WA=e=>{const t=i0();return f(t,e).getOr([])},UA=(e,t)=>{if(!c0(e))return;const n=i0(),s=f(n,t).getOr([]),o=q(s,t=>t!==e);n[t]=[e].concat(o).slice(0,l0),$A(n)},o0=e=>!!e,qA=e=>_e(As.makeMap(e,/[, ]/),o0),y4=t=>e.from(Sg(t)),GA=t=>{const n=e.from(Fg(t)).filter(o0).map(qA);return y4(t).fold(U,e=>n.fold(ye,e=>de(e).length>0&&e))},XA=(t,n)=>{const s=GA(t);return ts(s)?s?y4(t):e.none():s[n]?y4(t):e.none()},QA=(t,n)=>XA(t,n).map(s=>o=>ke.nu(i=>{const a=(e,t)=>{if(!L(e))throw new Error("Expected value to be string");if(t!==void 0&&!Os(t))throw new Error("Expected meta to be a object");const n={value:e,meta:t};i(n)},r={filetype:n,fieldname:o.fieldname,...e.from(o.meta).getOr({})};s.call(t,a,o.value,r)})),e0=t=>e.from(t).filter(L).getOrUndefined(),JA=t=>Tg(t)?e.some({targets:LA.find(t.getBody()),anchorTop:e0(zg(t)),anchorBottom:e0(Dg(t))}):e.none(),eS=t=>e.from(Mg(t)),tS=e=>({getHistory:WA,addToHistory:UA,getLinkInformation:()=>JA(e),getValidationHandler:()=>eS(e),getUrlPicker:t=>QA(e,t)}),nS=(e,t,n)=>{const o=g(!1),i=Zk(t),c={icons:()=>t.ui.registry.getAll().icons,menuItems:()=>t.ui.registry.getAll().menuItems,translate:Ft.translate,isDisabled:()=>t.mode.isReadOnly()||!t.ui.isEnabled(),getOption:t.options.get},l=tS(t),d=hA(t),u=Gk(t),h=Qk(t),m=()=>o.get(),f=e=>o.set(e),s={shared:{providers:c,anchors:Wk(t,n,i.isPositionedAtTop),header:i},urlinput:l,styles:d,colorinput:u,dialog:h,isContextMenuOpen:m,setContextMenuState:f},a={...s,shared:{...s.shared,interpreter:e=>F2(e,{},a),getSink:e.popup}},r={...s,shared:{...s.shared,interpreter:e=>F2(e,{},r),getSink:e.dialog}};return{popup:a,dialog:r}},sS=(e,t,n)=>{const i=(e,s)=>{h([t,...n],t=>{t.broadcastEvent(e,s)})},s=(e,s)=>{h([t,...n],t=>{t.broadcastOn([e],s)})},l=e=>s(Es(),{target:e.target}),o=Hu(),v=qe(o,"touchstart",l),_=qe(o,"touchmove",e=>i(gR(),e)),y=qe(o,"touchend",e=>i(hR(),e)),j=qe(o,"mousedown",l),b=qe(o,"mouseup",e=>{e.raw.button===0&&s(e4(),{target:e.target})}),a=e=>s(Es(),{target:c.fromDom(e.target)}),p=e=>{e.button===0&&s(e4(),{target:c.fromDom(e.target)})},g=()=>{h(e.editorManager.get(),t=>{e!==t&&t.dispatch("DismissPopups",{relatedTarget:e})})},r=e=>i(Xu(),eh(e)),f=e=>{s(ei(),{}),i(gr(),eh(e))},m=()=>s(ei(),{}),u=t=>{t.state&&s(Es(),{target:c.fromDom(e.getContainer())})},d=e=>{s(Es(),{target:c.fromDom(e.relatedTarget.getContainer())})};e.on("PostRender",()=>{e.on("click",a),e.on("tap",a),e.on("mouseup",p),e.on("mousedown",g),e.on("ScrollWindow",r),e.on("ResizeWindow",f),e.on("ResizeEditor",m),e.on("AfterProgressState",u),e.on("DismissPopups",d)}),e.on("remove",()=>{e.off("click",a),e.off("tap",a),e.off("mouseup",p),e.off("mousedown",g),e.off("ScrollWindow",r),e.off("ResizeWindow",f),e.off("ResizeEditor",m),e.off("AfterProgressState",u),e.off("DismissPopups",d),j.unbind(),v.unbind(),_.unbind(),y.unbind(),b.unbind()}),e.on("detach",()=>{h([t,...n],Ak),h([t,...n],e=>e.destroy())})},ge=vh,Tn=J3,aS=n([t("shell",!1),s("makeItem"),t("setupItem",l),$t.field("listBehaviours",[j])]),rS=()=>({behaviours:i([j.config({})])}),cS=Dt({name:"items",overrides:rS}),lS=n([cS]),dS=n("CustomList"),uS=(t,n)=>{const a=(e,n)=>{r(e).fold(()=>{throw console.error("Custom List was defined to not be a shell, but no item container was specified in components"),new Error("Custom List was defined to not be a shell, but no item container was specified in components")},s=>{const o=j.contents(s),i=n.length,a=i-o.length,r=a>0?gl(a,()=>t.makeItem()):[],c=o.slice(i);h(c,e=>j.remove(s,e)),h(r,e=>j.append(s,e));const l=j.contents(s);h(l,(s,o)=>{t.setupItem(e,s,n[o],o)})})},i=t.shell?{behaviours:[j.config({})],components:[]}:{behaviours:[],components:n},r=n=>t.shell?e.some(n):H(n,t,"items");return{uid:t.uid,dom:t.dom,components:i.components,behaviours:we(t.listBehaviours,i.behaviours),apis:{setItems:a}}},G4=We({name:dS(),configFields:aS(),partFields:lS(),factory:uS,apis:{setItems:(e,t,n)=>{e.setItems(t,n)}}}),Ko=n([s("dom"),t("shell",!0),ve("toolbarBehaviours",[j])]),fS=()=>({behaviours:i([j.config({})])}),pS=n([Dt({name:"groups",overrides:fS})]),gS=(t,n)=>{const a=(e,t)=>{r(e).fold(()=>{throw console.error("Toolbar was defined to not be a shell, but no groups container was specified in components"),new Error("Toolbar was defined to not be a shell, but no groups container was specified in components")},e=>{j.set(e,t)})},r=n=>t.shell?e.some(n):H(n,t,"groups"),i=t.shell?{behaviours:[j.config({})],components:[]}:{behaviours:[],components:n};return{uid:t.uid,dom:t.dom,components:i.components,behaviours:we(t.toolbarBehaviours,i.behaviours),apis:{setGroups:a},domModification:{attributes:{role:"group"}}}},gn=We({name:"Toolbar",configFields:Ko(),partFields:pS(),factory:gS,apis:{setGroups:(e,t,n)=>{e.setGroups(t,n)}}}),bS=l,jS=U,V4=n([]);B4=Object.freeze({__proto__:null,setup:bS,isDocked:jS,getBehaviours:V4});const I4=t=>{const n=hn(Re(t,"position"),"fixed"),s=n?e.none():Op(t);return s.orThunk(()=>{const e=c.fromTag("span");return Rn(t).bind(t=>{Jt(t,e);const n=Op(e);return Bn(e),n})})},H4=e=>I4(e).map(zs).getOrThunk(()=>Z(0,0)),x4=Lt.generate([{static:[]},{absolute:["positionCss"]},{fixed:["positionCss"]}]),CS=(e,t)=>{const n=e.element;me(n,t.transitionClass),ae(n,t.fadeOutClass),me(n,t.fadeInClass),t.onShow(e)},ES=(e,t)=>{const n=e.element;me(n,t.transitionClass),ae(n,t.fadeInClass),me(n,t.fadeOutClass),t.onHide(e)},kS=(e,t)=>e.y<t.bottom&&e.bottom>t.y,AS=(e,t)=>e.y>=t.y,SS=(e,t)=>e.bottom<=t.bottom,R4=(e,t,n)=>si(e,e=>{switch(e){case"bottom":return SS(t,n);case"top":return AS(t,n)}}),L4=(e,t)=>t.getInitialPos().map(t=>Be(t.bounds.x,t.bounds.y,et(e),Ve(e))),TS=(e,t,n)=>{n.setInitialPos({style:w6(e),position:ft(e,"position")||"static",bounds:t})},D4=(t,n,s)=>s.getInitialPos().bind(o=>{switch(s.clearInitialPos(),o.position){case"static":return e.some(x4.static());case"absolute":const s=I4(t).map(at).getOrThunk(()=>at(Un()));return e.some(x4.absolute(wn("absolute",f(o.style,"left").map(e=>n.x-s.x),f(o.style,"top").map(e=>n.y-s.y),f(o.style,"right").map(e=>s.right-n.right),f(o.style,"bottom").map(e=>s.bottom-n.bottom))));default:return e.none()}}),DS=(e,t,n)=>L4(e,n).filter(e=>R4(n.getModes(),e,t)).bind(t=>D4(e,t,n)),NS=(t,n,s)=>{const o=at(t);if(R4(s.getModes(),o,n))return e.none();TS(t,o,s);const i=Sn(),r=o.x-i.x,c=n.y-i.y,l=i.bottom-n.bottom,a=o.y<=n.y;return e.some(x4.fixed(wn("fixed",e.some(r),a?e.some(c):e.none(),e.none(),a?e.none():e.some(l))))},LS=(e,t,n)=>{const s=e.element,o=hn(Re(s,"position"),"fixed");return o?DS(s,t,n):NS(s,t,n)},RS=(e,t)=>{const n=e.element;return L4(n,t).bind(e=>D4(n,e,t))},z4=(e,t,n)=>{n.setDocked(!1),h(["left","right","top","bottom","position"],t=>B(e.element,t)),t.onUndocked(e)},E4=(e,t,n,s)=>{const o=s.position==="fixed";n.setDocked(o),Wh(e.element,s);const i=o?t.onDocked:t.onUndocked;i(e)},F4=(e,t,n,s,o=!1)=>{t.contextual.each(t=>{t.lazyContext(e).each(i=>{const a=kS(i,s);if(a!==n.isVisible())if(n.setVisible(a),o&&!a)qs(e.element,[t.fadeOutClass]),t.onHide(e);else{const n=a?CS:ES;n(e,t)}})})},BS=(e,t,n)=>{const s=t.lazyViewport(e),o=n.isDocked();o&&F4(e,t,n,s),LS(e,s,n).each(o=>{o.fold(()=>z4(e,t,n),s=>E4(e,t,n,s),o=>{F4(e,t,n,s,!0),E4(e,t,n,o)})})},VS=(e,t,n)=>{const s=e.element;n.setDocked(!1),RS(e,n).each(s=>{s.fold(()=>z4(e,t,n),s=>E4(e,t,n,s),l)}),n.setVisible(!0),t.contextual.each(t=>{On(s,[t.fadeInClass,t.fadeOutClass,t.transitionClass]),t.onShow(e)}),tl(e,t,n)},tl=(e,t,n)=>{e.getSystem().isConnected()&&BS(e,t,n)},ff=(e,t,n)=>{n.isDocked()&&VS(e,t,n)},US=(e,t,n)=>n.isDocked(),KS=(e,t,n,s)=>n.setModes(s),qS=(e,t,n)=>n.getModes();T4=Object.freeze({__proto__:null,refresh:tl,reset:ff,isDocked:US,getModes:qS,setModes:KS});const GS=(e,t)=>$([So(Xi(),(n,s)=>{e.contextual.each(e=>{if(mt(n.element,e.transitionClass)){On(n.element,[e.transitionClass,e.fadeInClass]);const s=t.isVisible()?e.onShown:e.onHidden;s(n)}s.stop()})}),o(Xu(),(n)=>{tl(n,e,t)}),o(gr(),(n)=>{ff(n,e,t)})]);N4=Object.freeze({__proto__:null,events:GS}),P4=[vt("contextual",[he("fadeInClass"),he("fadeOutClass"),he("transitionClass"),Ht("lazyContext"),E("onShow"),E("onShown"),E("onHide"),E("onHidden")]),fe("lazyViewport",Sn),Xa("modes",["top","bottom"],Ae),E("onDocked"),E("onUndocked")];const ZS=e=>{const t=g(!1),n=g(!0),s=K(),o=g(e.modes),i=()=>`docked:  ${t.get()}, visible: ${n.get()}, modes: ${o.get().join(",")}`;return jt({isDocked:t.get,setDocked:t.set,getInitialPos:s.get,setInitialPos:s.set,clearInitialPos:s.clear,isVisible:n.get,setVisible:n.set,getModes:o.get,setModes:o.set,readState:i})};U4=Object.freeze({__proto__:null,init:ZS});const $e=xe({fields:P4,name:"docking",active:N4,apis:T4,state:U4}),v4=n(d("toolbar-height-change")),Dn={fadeInClass:"tox-editor-dock-fadein",fadeOutClass:"tox-editor-dock-fadeout",transitionClass:"tox-editor-dock-transition"},e2="tox-tinymce--toolbar-sticky-on",u2="tox-tinymce--toolbar-sticky-off",iM=(e,t)=>{const o=an(t),p=bi(t),d=p.dom.innerHeight,n=Cn(o),l=c.fromDom(e.elm),h=Ps(l),r=Ve(l),s=h.y,m=s+r,f=zs(t),a=Ve(t),i=f.top,u=i+a,g=Math.abs(i-n.top)<2,v=Math.abs(u-(n.top+d))<2;if(g&&s<u)km(n.left,s-a,o);else if(v&&m>i){const e=s-d+r+a;km(n.left,e,o)}},u4=(e,t)=>Oe($e.getModes(e),t),c4=e=>{const n=e=>to(e)+(parseInt(ft(e,"margin-top"),10)||0)+(parseInt(ft(e,"margin-bottom"),10)||0),t=e.element;Ii(t).each(s=>{const o="padding-"+$e.getModes(e)[0];if($e.isDocked(e)){const e=et(s);y(t,"width",e+"px"),y(s,o,n(t)+"px")}else B(t,"width"),B(s,o)})},_2=(e,t)=>{t?(ae(e,Dn.fadeOutClass),qs(e,[Dn.transitionClass,Dn.fadeInClass])):(ae(e,Dn.fadeInClass),qs(e,[Dn.fadeOutClass,Dn.transitionClass]))},C2=(e,t)=>{const n=c.fromDom(e.getContainer());t?(me(n,e2),ae(n,u2)):(me(n,u2),ae(n,e2))},dM=(e,t)=>{const n=an(t);cs(n).filter(e=>!Y(t,e)).filter(t=>Y(t,c.fromDom(n.dom.body))||tc(e,t)).each(()=>es(t))},uM=(e,t)=>rn(e).orThunk(()=>t().toOptional().bind(e=>rn(e.element))),hM=(e,t,n)=>{e.inline||(t.header.isPositionedAtTop()||e.on("ResizeEditor",()=>{n().each($e.reset)}),e.on("ResizeWindow ResizeEditor",()=>{n().each(c4)}),e.on("SkinLoaded",()=>{n().each(e=>{$e.isDocked(e)?$e.reset(e):$e.refresh(e)})}),e.on("FullscreenStateChanged",()=>{n().each($e.reset)})),e.on("AfterScrollIntoView",e=>{n().each(t=>{$e.refresh(t);const n=t.element;m8(n)&&iM(e,n)})}),e.on("PostRender",()=>{C2(e,!1)})},mM=e=>e().map($e.isDocked).getOr(!1),fM=()=>[It.config({channels:{[v4()]:{onReceive:c4}}})],L2=(t,n)=>{const s=K(),i=n.getSink,o=e=>{i().each(t=>e(t.element))},a=e=>{t.inline||c4(e),C2(t,$e.isDocked(e)),e.getSystem().broadcastOn([ei()],{}),i().each(e=>e.getSystem().broadcastOn([ei()],{}))},r=t.inline?[]:fM();return[b.config({}),$e.config({contextual:{lazyContext:n=>{const o=to(n.element),i=t.inline?t.getContentAreaContainer():t.getContainer(),s=at(c.fromDom(i)),a=s.height-o,r=s.y+(u4(n,"top")?0:o);return e.some(Be(s.x,r,s.width,a))},onShow:()=>{o(e=>_2(e,!0))},onShown:e=>{o(e=>On(e,[Dn.transitionClass,Dn.fadeInClass])),s.get().each(t=>{dM(e.element,t),s.clear()})},onHide:e=>{uM(e.element,i).fold(s.clear,s.set),o(e=>_2(e,!1))},onHidden:()=>{o(e=>On(e,[Dn.transitionClass]))},...Dn},lazyViewport:e=>{const n=Sn(),s=Eg(t),o=n.y+(u4(e,"top")?s:0),i=n.height-(u4(e,"bottom")?s:0);return Be(n.x,o,n.width,i)},modes:[n.header.getDockingMode()],onDocked:a,onUndocked:a}),...r]};U2=Object.freeze({__proto__:null,setup:hM,isDocked:mM,getBehaviours:L2});const vM=e=>{const t=e.editor,n=e.sticky?L2:V4;return{uid:e.uid,dom:e.dom,components:e.components,behaviours:i(n(t,e.sharedBackstage))}},bM=m([ne,Ot("items",t4([d4([Tl,xt("items",Ae)]),Ae]))].concat(ha)),jM=e=>X("GroupToolbarButton",bM,e),yM=[ct("text"),ct("tooltip"),ct("icon"),Rt("search",!1,t4([pi,m([ct("placeholder")])],t=>ts(t)?t?e.some({placeholder:e.none()}):e.none():e.some(t))),Ht("fetch"),fe("onSetup",()=>l)],_M=m([ne,...yM]),X2=e=>X("menubutton",_M,e),OM=m([ne,Ba,jn,Io,_b,Sb,Ys,Kn("presets","normal",["normal","color","listpreview"]),R7(1),Co,Eb]),xM=e=>X("SplitButton",OM,e),CM=(t,n)=>{const s=(t,s)=>{const o=a(s,t=>{const s={type:"menubutton",text:t.text,fetch:e=>{e(t.getItems())}},o=X2(s).mapError(e=>oi(e)).getOrDie();return U1(o,"tox-mbtn",n.backstage,e.some("menuitem"))});j.set(t,o)},r={focus:u.focusIn,setMenus:s};return{uid:t.uid,dom:t.dom,components:[],behaviours:i([j.config({}),O("menubar-events",[J(e=>{t.onSetup(e)}),o(_s(),(e,t)=>{be(e.element,".tox-mbtn--active").each(n=>{cn(t.event.target,".tox-mbtn").each(t=>{Y(n,t)||e.getSystem().getByDom(n).each(n=>{e.getSystem().getByDom(t).each(e=>{kt.expand(e),kt.close(n),b.focus(e)})})})})}),o(sm(),(e,t)=>{t.event.prevFocus.bind(t=>e.getSystem().getByDom(t).toOptional()).each(n=>{t.event.newFocus.bind(t=>e.getSystem().getByDom(t).toOptional()).each(e=>{kt.isOpen(n)&&(kt.expand(e),kt.close(n))})})})]),u.config({mode:"flow",selector:".tox-mbtn",onEscape:n=>(t.onEscape(n),e.some(!0))}),ee.config({})]),apis:r,domModification:{attributes:{role:"menubar"}}}};$a=gt({factory:CM,name:"silver.Menubar",configFields:[s("dom"),s("uid"),s("onEscape"),s("backstage"),t("onSetup",l)],apis:{focus:(e,t)=>{e.focus(t)},setMenus:(e,t,n)=>{e.setMenus(t,n)}}});const kM="⚡️Upgrade",AM="https://www.tiny.cloud/tinymce-self-hosted-premium-features/?utm_source=TinyMCE&utm_medium=SPAP&utm_campaign=SPAP&utm_id=editorreferral",SM=e=>({uid:e.uid,dom:e.dom,components:[{dom:{tag:"a",attributes:{href:AM,rel:"noopener",target:"_blank","aria-hidden":"true"},classes:["tox-promotion-link"],innerHtml:kM}}]}),Ma=(e,t)=>t.getAnimationRoot.fold(()=>e.element,t=>t(e)),Qn=e=>e.dimension.property,jo=(e,t)=>e.dimension.getDimension(t),Ra=(e,t)=>{const n=Ma(e,t);On(n,[t.shrinkingClass,t.growingClass])},H1=(e,t)=>{ae(e.element,t.openClass),me(e.element,t.closedClass),y(e.element,Qn(t),"0px"),wa(e.element)},P1=(e,t)=>{ae(e.element,t.closedClass),me(e.element,t.openClass),B(e.element,Qn(t))},E3=(e,t,n)=>{n.setCollapsed(),y(e.element,Qn(t),jo(t,e.element)),Ra(e,t),H1(e,t),t.onStartShrink(e),t.onShrunk(e)},RM=(e,t,n,s)=>{const i=s.getOrThunk(()=>jo(t,e.element));n.setCollapsed(),y(e.element,Qn(t),i),wa(e.element);const o=Ma(e,t);ae(o,t.growingClass),me(o,t.shrinkingClass),H1(e,t),t.onStartShrink(e)},z3=(t,n,s)=>{const o=jo(n,t.element),i=o==="0px"?E3:RM;i(t,n,s,e.some(o))},D3=(e,t,n)=>{const s=Ma(e,t),o=mt(s,t.shrinkingClass),i=jo(t,e.element);P1(e,t);const a=jo(t,e.element),r=()=>{y(e.element,Qn(t),i),wa(e.element)},c=()=>{H1(e,t)},l=o?r:c;l(),ae(s,t.shrinkingClass),me(s,t.growingClass),P1(e,t),y(e.element,Qn(t),a),n.setExpanded(),t.onStartGrow(e)},IM=(e,t,n)=>{if(n.isExpanded()){B(e.element,Qn(t));const n=jo(t,e.element);y(e.element,Qn(t),n)}},BM=(e,t,n)=>{n.isExpanded()||D3(e,t,n)},VM=(e,t,n)=>{n.isExpanded()&&z3(e,t,n)},$M=(e,t,n)=>{n.isExpanded()&&E3(e,t,n)},WM=(e,t,n)=>n.isExpanded(),UM=(e,t,n)=>n.isCollapsed(),L3=(e,t)=>{const s=Ma(e,t);return mt(s,t.growingClass)===!0},P3=(e,t)=>{const s=Ma(e,t);return mt(s,t.shrinkingClass)===!0},YM=(e,t)=>L3(e,t)||P3(e,t),GM=(e,t,n)=>{const s=n.isExpanded()?z3:D3;s(e,t,n)},XM=(e,t,n)=>{n.isExpanded()||(P1(e,t),y(e.element,Qn(t),jo(t,e.element)),Ra(e,t),n.setExpanded(),t.onStartGrow(e),t.onGrown(e))};H3=Object.freeze({__proto__:null,refresh:IM,grow:BM,shrink:VM,immediateShrink:$M,hasGrown:WM,hasShrunk:UM,isGrowing:L3,isShrinking:P3,isTransitioning:YM,toggleGrow:GM,disableTransitions:Ra,immediateGrow:XM});const ZM=(e,t)=>{const s=t.expanded;return sn(s?{classes:[t.openClass],styles:{}}:{classes:[t.closedClass],styles:eo(t.dimension.property,"0px")})},JM=(e,t)=>$([So(Xi(),(n,s)=>{const o=s.event.raw;if(o.propertyName===e.dimension.property){Ra(n,e),t.isExpanded()&&B(n.element,e.dimension.property);const s=t.isExpanded()?e.onGrown:e.onShrunk;s(n)}})]);V3=Object.freeze({__proto__:null,exhibit:ZM,events:JM}),K3=[s("closedClass"),s("openClass"),s("shrinkingClass"),s("growingClass"),D("getAnimationRoot"),E("onShrunk"),E("onStartShrink"),E("onGrown"),E("onStartGrow"),t("expanded",!1),Ot("dimension",yt("property",{width:[W("property","width"),W("getDimension",e=>et(e)+"px")],height:[W("property","height"),W("getDimension",e=>Ve(e)+"px")]}))];const nF=e=>{const t=g(e.expanded),n=()=>"expanded: "+t.get();return jt({isExpanded:()=>t.get()===!0,isCollapsed:()=>t.get()===!1,setCollapsed:Tt(t.set,!1),setExpanded:Tt(t.set,!0),readState:n})};Q3=Object.freeze({__proto__:null,init:nF});const qt=xe({fields:K3,name:"sliding",active:V3,apis:H3,state:Q3}),oh="container",aF=[ve("slotBehaviours",[])],rh=e=>"<alloy.field."+e+">",cF=e=>{const t=(()=>{const e=[],t=(t,n)=>(e.push(t),b1(oh,rh(t),n));return{slot:t,record:n(e)}})(),s=e(t),o=t.record(),i=a(o,e=>Pe({name:e,pname:rh(e)}));return r1(oh,aF,i,lF,s)},lF=(e,t)=>{const i=t=>mh(e),d=(t,n)=>H(t,e,n),s=(t,n)=>(s,o)=>H(s,e,o).map(e=>t(e,o)).getOr(n),c=e=>(t,n)=>{h(n,n=>e(t,n))},n=(e)=>De(e.element,"aria-hidden")!=="true",r=(e,t)=>{if(!n(e)){const n=e.element;B(n,"display"),pe(n,"aria-hidden"),p(e,Ku(),{name:t,visible:!0})}},a=(e,t)=>{if(n(e)){const n=e.element;y(n,"display","none"),w(n,"aria-hidden","true"),p(e,Ku(),{name:t,visible:!1})}},l=s(n,!1),o=s(a),u=c(o),m=e=>u(e,i()),f=s(r),g={getSlotNames:i,getSlot:d,isShowing:l,hideSlot:o,hideAllSlots:m,showSlot:f};return{uid:e.uid,dom:e.dom,components:t,behaviours:Ar(e.slotBehaviours),apis:g}},dF=_e({getSlotNames:(e,t)=>e.getSlotNames(t),getSlot:(e,t,n)=>e.getSlot(t,n),isShowing:(e,t,n)=>e.isShowing(t,n),hideSlot:(e,t,n)=>e.hideSlot(t,n),hideAllSlots:(e,t)=>e.hideAllSlots(t),showSlot:(e,t,n)=>e.showSlot(t,n)},e=>Mc(e)),ze={...dF,...{sketch:cF}},hF=m([jn,Ba,fe("onShow",l),fe("onHide",l),Ys]),mF=e=>X("sidebar",hF,e),fF=t=>{const{sidebars:n}=t.ui.registry.getAll();h(de(n),s=>{const i=n[s],o=()=>hn(e.from(t.queryCommandValue("ToggleSidebar")),s);t.ui.registry.addToggleButton(s,{icon:i.icon,tooltip:i.tooltip,onAction:e=>{t.execCommand("ToggleSidebar",!1,s),e.setActive(o())},onSetup:e=>{e.setActive(o());const n=()=>e.setActive(o());return t.on("ToggleSidebar",n),()=>{t.off("ToggleSidebar",n)}}})})},pF=e=>({element:()=>e.element.dom}),gF=(e,t)=>{const n=a(de(t),e=>{const s=t[e],n=pn(mF(s));return{name:e,getApi:pF,onSetup:n.onSetup,onShow:n.onShow,onHide:n.onHide}});return a(n,t=>{const s=g(l);return e.slot(t.name,{dom:{tag:"div",classes:["tox-sidebar__pane"]},behaviours:ta.unnamedEvents([Ca(t,s),ki(t,s),o(Ku(),(e,t)=>{const s=t.event,o=se(n,e=>e.name===s.name);o.each(t=>{const n=s.visible?t.onShow:t.onHide;n(t.getApi(e))})})])})})},vF=e=>ze.sketch(t=>({dom:{tag:"div",classes:["tox-sidebar__pane-container"]},components:gF(t,e),slotBehaviours:ta.unnamedEvents([J(e=>ze.hideAllSlots(e))])})),bF=(e,t,n)=>{const s=x.getCurrent(e);s.each(e=>{j.set(e,[vF(t)]);const s=n?.toLowerCase();L(s)&&R(t,s)&&x.getCurrent(e).each(t=>{ze.showSlot(t,s),qt.immediateGrow(e),B(e.element,"width")})})},jF=(e,t)=>{const n=x.getCurrent(e);n.each(e=>{const n=x.getCurrent(e);n.each(n=>{qt.hasGrown(e)?ze.isShowing(n,t)?qt.shrink(e):(ze.hideAllSlots(n),ze.showSlot(n,t)):(ze.hideAllSlots(n),ze.showSlot(n,t),qt.grow(e))})})},yF=t=>{const n=x.getCurrent(t);return n.bind(t=>{const n=qt.isGrowing(t)||qt.hasGrown(t);if(n){const e=x.getCurrent(t);return e.bind(e=>se(ze.getSlotNames(e),t=>ze.isShowing(e,t)))}return e.none()})},p1=d("FixSizeEvent"),f1=d("AutoSizeEvent"),OF=e=>({uid:e.uid,dom:{tag:"div",classes:["tox-sidebar"],attributes:{role:"complementary"}},components:[{dom:{tag:"div",classes:["tox-sidebar__slider"]},components:[],behaviours:i([ee.config({}),b.config({}),qt.config({dimension:{property:"width"},closedClass:"tox-sidebar--sliding-closed",openClass:"tox-sidebar--sliding-open",shrinkingClass:"tox-sidebar--sliding-shrinking",growingClass:"tox-sidebar--sliding-growing",onShrunk:e=>{const t=x.getCurrent(e);t.each(ze.hideAllSlots),T(e,f1)},onGrown:e=>{T(e,f1)},onStartGrow:e=>{p(e,p1,{width:Re(e.element,"width").getOr("")})},onStartShrink:e=>{p(e,p1,{width:et(e.element)+"px"})}}),j.config({}),x.config({find:e=>{const t=j.contents(e);return os(t)}})])}],behaviours:i([nn.childAt(0),O("sidebar-sliding-events",[o(p1,(e,t)=>{y(e.element,"width",t.event.width)}),o(f1,(e)=>{B(e.element,"width")})])])}),xF=(t,n,s,o)=>{w(t.element,"aria-busy",!0);const a=n.getRoot(t).getOr(t),c=i([u.config({mode:"special",onTab:()=>e.some(!0),onShiftTab:()=>e.some(!0)}),b.config({})]),l=o(a,c),r=a.getSystem().build(l);j.append(a,tn(r)),r.hasConfigured(u)&&n.focus&&u.focusIn(r),s.isBlocked()||n.onBlock(t),s.blockWith(()=>j.remove(a,r))},CF=(e,t,n)=>{pe(e.element,"aria-busy"),n.isBlocked()&&t.onUnblock(e),n.clear()};dh=Object.freeze({__proto__:null,block:xF,unblock:CF}),gh=[fe("getRoot",e.none),ht("focus",!0),E("onBlock"),E("onUnblock")];const AF=()=>{const e=oF(),t=t=>{e.set({destroy:t})};return jt({readState:e.isSet,blockWith:t,clear:e.clear,isBlocked:e.isSet})};bh=Object.freeze({__proto__:null,init:AF});const Xn=xe({fields:gh,name:"blocking",apis:dh,state:bh}),FF=e=>{const t=e.dom.attributes!==void 0?e.dom.attributes:[];return He(t,(e,t)=>t.name==="class"?e:{...e,[t.name]:t.value},{})},TF=e=>Array.prototype.slice.call(e.dom.classList,0),Ds=e=>{const t=c.fromHtml(e),n=kn(t),s=FF(t),o=TF(t),i=n.length===0?{}:{innerHtml:Id(t)};return{tag:Wn(t),classes:o,attributes:s,...i}},DF=e=>()=>({dom:{tag:"div",attributes:{"aria-label":e.translate("Loading..."),tabindex:"0"},classes:["tox-throbber__busy-spinner"]},components:[{dom:Ds('<div class="tox-spinner"><div></div><div></div><div></div></div>')}]}),Sh=e=>x.getCurrent(e).each(e=>es(e.element)),LF=(t,n)=>{const s="tabindex",o=`data-mce-${s}`;e.from(t.iframeElement).map(c.fromDom).each(e=>{n?(ut(e,s).each(t=>w(e,o,t)),w(e,s,-1)):(pe(e,s),ut(e,o).each(t=>{w(e,s,t),pe(e,o)}))})},RF=(e,t,n,s)=>{const o=t.element;if(LF(e,n),n)Xn.block(t,DF(s)),B(o,"display"),pe(o,"aria-hidden"),e.hasFocus()&&Sh(t);else{const n=x.getCurrent(t).exists(e=>om(e.element));Xn.unblock(t),y(o,"display","none"),w(o,"aria-hidden","true"),n&&e.focus()}},PF=e=>({uid:e.uid,dom:{tag:"div",attributes:{"aria-hidden":"true"},classes:["tox-throbber"],styles:{display:"none"}},behaviours:i([j.config({}),Xn.config({focus:!1}),x.config({find:e=>os(e.components())})]),components:[]}),HF=e=>e.type==="focusin",IF=t=>{if(HF(t)){const n=t.composed?os(t.composedPath()):e.from(t.target);return n.map(c.fromDom).filter(At).exists(e=>mt(e,"mce-pastebin"))}return!1},BF=(e,t,n)=>{const s=g(!1),o=K(),i=n=>{s.get()&&!IF(n)&&(n.preventDefault(),Sh(t()),e.editorManager.setActive(e))};e.inline||e.on("PreInit",()=>{e.dom.bind(e.getWin(),"focusin",i),e.on("BeforeExecCommand",e=>{e.command.toLowerCase()==="mcefocus"&&e.value!==!0&&i(e)})});const a=o=>{o!==s.get()&&(s.set(o),RF(e,t(),o,n.providers),ub(e,o))};e.on("ProgressState",t=>{if(o.on(clearTimeout),gs(t.time)){const n=Ai.setEditorTimeout(e,()=>a(t.state),t.time);o.set(n)}else a(t.state),o.clear()})},VF=(e,t)=>{const s={len:0,list:[]},o=He(e,(e,s)=>{const o=t(s,e.len);return o.fold(n(e),t=>({len:t.finish,list:e.list.concat([t])}))},s);return o.list},o1=(e,t,n)=>({within:e,extra:t,withinWidth:n}),Lh=(t,n,s)=>{const i=VF(t,(t,n)=>{const o=s(t);return e.some({element:t,start:n,finish:n+o,width:o})}),o=q(i,e=>e.finish<=n),a=qo(o,(e,t)=>e+t.width,0),r=i.slice(o.length);return{within:o,extra:r,withinWidth:a}},pr=e=>a(e,e=>e.element),KF=(e,t,n)=>{const s=pr(e.concat(t));return o1(s,[],n)},qF=(e,t,n,s)=>{const o=pr(e).concat([n]);return o1(o,pr(t),s)},YF=(e,t,n)=>o1(pr(e),[],n),GF=(t,n,s)=>{const o=Lh(n,t,s);return o.extra.length===0?e.some(o):e.none()},XF=(e,t,n,s)=>{const i=GF(e,t,n).getOrThunk(()=>Lh(t,e-n(s),n)),a=i.within,o=i.extra,r=i.withinWidth;return o.length===1&&o[0].width<=n(s)?KF(a,o,r):o.length>=1?qF(a,o,s,r):YF(a,o,r)},rm=(e,t)=>{const n=a(t,e=>tn(e));gn.setGroups(e,n)},ZF=e=>En(e,e=>rn(e.element).bind(t=>e.getSystem().getByDom(t).toOptional())),bm=(e,t,n)=>{const a=t.builtGroups.get();if(a.length===0)return;const s=Ln(e,t,"primary"),o=G.getCoupled(e,"overflowGroup");y(s.element,"visibility","hidden");const r=a.concat([o]),c=ZF(r);n([]),rm(s,r);const l=et(s.element),i=XF(l,t.builtGroups.get(),e=>et(e.element),o);i.extra.length===0?(j.remove(s,o),n([])):(rm(s,i.within),n(i.extra)),B(s.element,"visibility"),wa(s.element),c.each(b.focus)},Om=n([ve("splitToolbarBehaviours",[G]),Xe("builtGroups",()=>g([]))]),tT=n([go(["overflowToggledClass"]),Qa("getOverflowBounds"),s("lazySink"),Xe("overflowGroups",()=>g([])),E("onOpened"),E("onClosed")].concat(Om())),nT=n([Pe({factory:gn,schema:Ko(),name:"primary"}),Wt({schema:Ko(),name:"overflow"}),Wt({name:"overflow-button"}),Wt({name:"overflow-group"})]),Ru=n((e,t)=>{QB(e,Math.floor(t))}),oT=n([go(["toggledClass"]),s("lazySink"),Ht("fetch"),Qa("getBounds"),vt("fireDismissalEventInstead",[t("event",di())]),Ns(),E("onToggled")]),iT=n([Wt({name:"button",overrides:e=>({dom:{attributes:{"aria-haspopup":"true"}},buttonBehaviours:i([A.config({toggleClass:e.markers.toggledClass,aria:{mode:"expanded"},toggleOnExecute:!1,onToggled:e.onToggled})])})}),Wt({factory:gn,schema:Ko(),name:"toolbar",overrides:t=>({toolbarBehaviours:i([u.config({mode:"cyclic",onEscape:n=>(H(n,t,"button").each(b.focus),e.none())})])})})]),Im=(e,t)=>{const n=G.getCoupled(e,"toolbarSandbox");k.isOpen(n)?k.close(n):k.open(n,t.toolbar())},Tu=(e,t,n,s)=>{const o=n.getBounds.map(e=>e()),i=n.lazySink(e).getOrDie();Ke.positionWithinBounds(i,t,{anchor:{type:"hotspot",hotspot:e,layouts:s,overrides:{maxWidthFunction:Ru()}}},o)},Xm=(e,t,n,s,o)=>{gn.setGroups(t,o),Tu(e,t,n,s),A.on(e)},lT=(t,n,s)=>{const o=fg(),a=(e,i)=>{s.fetch().get(e=>{Xm(t,i,s,n.layouts,e),o.link(t.element),u.focusIn(i)})},r=()=>{A.off(t),b.focus(t),o.unlink(t.element)};return{dom:{tag:"div",attributes:{id:o.id}},behaviours:i([u.config({mode:"special",onEscape:t=>(k.close(t),e.some(!0))}),k.config({onOpen:a,onClose:r,isPartOf:(e,n,s)=>Zs(n,s)||Zs(t,s),getAttachPoint:()=>s.lazySink(t).getOrDie()}),It.config({channels:{...Z1({isExtraPart:U,...s.fireDismissalEventInstead.map(e=>({fireEventInstead:{event:e.event}})).getOr({})}),...Q1({doReposition:()=>{k.getState(G.getCoupled(t,"toolbarSandbox")).each(e=>{Tu(t,e,s,n.layouts)})}})}})])}},dT=(e,t,n,s)=>({...nt.sketch({...s.button(),action:e=>{Im(e,s)},buttonBehaviours:$t.augment({dump:s.button().buttonBehaviours},[G.config({others:{toolbarSandbox:t=>lT(t,n,e)}})])}),apis:{setGroups:(t,s)=>{k.getState(G.getCoupled(t,"toolbarSandbox")).each(o=>{Xm(t,o,e,n.layouts,s)})},reposition:t=>{k.getState(G.getCoupled(t,"toolbarSandbox")).each(s=>{Tu(t,s,e,n.layouts)})},toggle:e=>{Im(e,s)},getToolbar:e=>k.getState(G.getCoupled(e,"toolbarSandbox")),isOpen:e=>k.isOpen(G.getCoupled(e,"toolbarSandbox"))}}),fo=We({name:"FloatingToolbarButton",factory:dT,configFields:oT(),partFields:iT(),apis:{setGroups:(e,t,n)=>{e.setGroups(t,n)},reposition:(e,t)=>{e.reposition(t)},toggle:(e,t)=>{e.toggle(t)},getToolbar:(e,t)=>e.getToolbar(t),isOpen:(e,t)=>e.isOpen(t)}}),hT=n([s("items"),go(["itemSelector"]),ve("tgroupBehaviours",[u])]),mT=n([qr({name:"items",unit:"item"})]),fT=(e,t)=>({uid:e.uid,dom:e.dom,components:t,behaviours:we(e.tgroupBehaviours,[u.config({mode:"flow",selector:e.markers.itemSelector})]),domModification:{attributes:{role:"toolbar"}}}),Fr=We({name:"ToolbarGroup",configFields:hT(),partFields:mT(),factory:fT}),Zm=e=>a(e,e=>tn(e)),r8=(e,t,n)=>{bm(e,n,s=>{n.overflowGroups.set(s),t.getOpt(e).each(e=>{fo.setGroups(e,Zm(s))})})},bT=(e,t,n,s)=>{const o=V(fo.sketch({fetch:()=>ke.nu(t=>{t(Zm(e.overflowGroups.get()))}),layouts:{onLtr:()=>[Le,Ne],onRtl:()=>[Ne,Le],onBottomLtr:()=>[tt,Qe],onBottomRtl:()=>[Qe,tt]},getBounds:n.getOverflowBounds,lazySink:e.lazySink,fireDismissalEventInstead:{},markers:{toggledClass:e.markers.overflowToggledClass},parts:{button:s["overflow-button"](),toolbar:s.overflow()},onToggled:(t,n)=>e[n?"onOpened":"onClosed"](t)}));return{uid:e.uid,dom:e.dom,components:t,behaviours:we(e.splitToolbarBehaviours,[G.config({others:{overflowGroup:()=>Fr.sketch({...s["overflow-group"](),items:[o.asSpec()]})}})]),apis:{setGroups:(t,n)=>{e.builtGroups.set(a(n,t.getSystem().build)),r8(t,o,e)},refresh:t=>r8(t,o,e),toggle:e=>{o.getOpt(e).each(e=>{fo.toggle(e)})},isOpen:e=>o.getOpt(e).map(fo.isOpen).getOr(!1),reposition:e=>{o.getOpt(e).each(e=>{fo.reposition(e)})},getOverflow:e=>o.getOpt(e).bind(fo.getToolbar)},domModification:{attributes:{role:"group"}}}},_8=We({name:"SplitFloatingToolbar",configFields:tT(),partFields:nT(),factory:bT,apis:{setGroups:(e,t,n)=>{e.setGroups(t,n)},refresh:(e,t)=>{e.refresh(t)},reposition:(e,t)=>{e.reposition(t)},toggle:(e,t)=>{e.toggle(t)},isOpen:(e,t)=>e.isOpen(t),getOverflow:(e,t)=>e.getOverflow(t)}}),yT=n([go(["closedClass","openClass","shrinkingClass","growingClass","overflowToggledClass"]),E("onOpened"),E("onClosed")].concat(Om())),_T=n([Pe({factory:gn,schema:Ko(),name:"primary"}),Pe({factory:gn,schema:Ko(),name:"overflow",overrides:t=>({toolbarBehaviours:i([qt.config({dimension:{property:"height"},closedClass:t.markers.closedClass,openClass:t.markers.openClass,shrinkingClass:t.markers.shrinkingClass,growingClass:t.markers.growingClass,onShrunk:e=>{H(e,t,"overflow-button").each(e=>{A.off(e),b.focus(e)}),t.onClosed(e)},onGrown:e=>{u.focusIn(e),t.onOpened(e)},onStartGrow:e=>{H(e,t,"overflow-button").each(A.on)}}),u.config({mode:"acyclic",onEscape:n=>(H(n,t,"overflow-button").each(b.focus),e.some(!0))})])})}),Wt({name:"overflow-button",overrides:e=>({buttonBehaviours:i([A.config({toggleClass:e.markers.overflowToggledClass,aria:{mode:"pressed"},toggleOnExecute:!1})])})}),Wt({name:"overflow-group"})]),wT=(e,t)=>H(e,t,"overflow").map(qt.hasGrown).getOr(!1),Rf=(e,t)=>{H(e,t,"overflow-button").bind(()=>H(e,t,"overflow")).each(n=>{ru(e,t),qt.toggleGrow(n)})},ru=(e,t)=>{H(e,t,"overflow").each(n=>{bm(e,t,e=>{const t=a(e,e=>tn(e));gn.setGroups(n,t)}),H(e,t,"overflow-button").each(e=>{qt.hasGrown(n)&&A.on(e)}),qt.refresh(n)})},CT=(e,t,n,s)=>{const i="alloy.toolbar.toggle",r=(t,n)=>{const s=a(n,t.getSystem().build);e.builtGroups.set(s)};return{uid:e.uid,dom:e.dom,components:t,behaviours:we(e.splitToolbarBehaviours,[G.config({others:{overflowGroup:e=>Fr.sketch({...s["overflow-group"](),items:[nt.sketch({...s["overflow-button"](),action:t=>{T(e,i)}})]})}}),O("toolbar-toggle-events",[o(i,t=>{Rf(t,e)})])]),apis:{setGroups:(t,n)=>{r(t,n),ru(t,e)},refresh:t=>ru(t,e),toggle:t=>Rf(t,e),isOpen:t=>wT(t,e)},domModification:{attributes:{role:"group"}}}},Jd=We({name:"SplitSlidingToolbar",configFields:yT(),partFields:_T(),factory:CT,apis:{setGroups:(e,t,n)=>{e.setGroups(t,n)},refresh:(e,t)=>{e.refresh(t)},toggle:(e,t)=>{e.toggle(t)},isOpen:(e,t)=>e.isOpen(t)}}),r6=e=>{const t=e.title.fold(()=>({}),e=>({attributes:{title:e}}));return{dom:{tag:"div",classes:["tox-toolbar__group"],...t},components:[Fr.parts.items({})],items:e.items,markers:{itemSelector:"*:not(.tox-split-button) > .tox-tbtn:not([disabled]), .tox-split-button:not([disabled]), .tox-toolbar-nav-js:not([disabled])"},tgroupBehaviours:i([ee.config({}),b.config({})])}},Jr=e=>Fr.sketch(r6(e)),tp=(e,t)=>{const n=J(t=>{const n=a(e.initGroups,Jr);gn.setGroups(t,n)});return i([on.toolbarButton(e.providers.isDisabled),re(),u.config({mode:t,onEscape:e.onEscape,selector:".tox-toolbar__group"}),O("toolbar-events",[n])])},np=t=>{const n=t.cyclicKeying?"cyclic":"acyclic";return{uid:t.uid,dom:{tag:"div",classes:["tox-toolbar-overlord"]},parts:{"overflow-group":r6({title:e.none(),items:[]}),"overflow-button":RE({name:"more",icon:e.some("more-drawer"),enabled:!0,tooltip:e.some("More..."),primary:!1,buttonType:e.none(),borderless:!1},e.none(),t.providers)},splitToolbarBehaviours:tp(t,n)}},FT=e=>{const t=np(e),n=4,s=_8.parts.primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}});return _8.sketch({...t,lazySink:e.getSink,getOverflowBounds:()=>{const t=e.moreDrawerData.lazyHeader().element,s=Ps(t),o=Ld(t),i=Ps(o),a=Math.max(o.dom.scrollHeight,i.height);return Be(s.x+n,i.y,s.width-n*2,a)},parts:{...t.parts,overflow:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:e.attributes}}},components:[s],markers:{overflowToggledClass:"tox-tbtn--enabled"},onOpened:t=>e.onToggled(t,!0),onClosed:t=>e.onToggled(t,!1)})},TT=e=>{const t=Jd.parts.primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}}),n=Jd.parts.overflow({dom:{tag:"div",classes:["tox-toolbar__overflow"]}}),s=np(e);return Jd.sketch({...s,components:[t,n],markers:{openClass:"tox-toolbar__overflow--open",closedClass:"tox-toolbar__overflow--closed",growingClass:"tox-toolbar__overflow--growing",shrinkingClass:"tox-toolbar__overflow--shrinking",overflowToggledClass:"tox-tbtn--enabled"},onOpened:t=>{t.getSystem().broadcastOn([v4()],{type:"opened"}),e.onToggled(t,!0)},onClosed:t=>{t.getSystem().broadcastOn([v4()],{type:"closed"}),e.onToggled(t,!1)}})},mc=e=>{const t=e.cyclicKeying?"cyclic":"acyclic";return gn.sketch({uid:e.uid,dom:{tag:"div",classes:["tox-toolbar"].concat(e.type===zt.scrolling?["tox-toolbar--scrolling"]:[])},components:[gn.parts.groups({})],toolbarBehaviours:tp(e,t)})},DT=[Pi("type",["button"]),us,Kn("buttonType","secondary",["primary","secondary"]),Ht("onAction")],NT=yt("type",{button:DT}),LT=m([Xa("buttons",[],NT),Ht("onShow"),Ht("onHide")]),RT=e=>X("view",LT,e),PT=(t,n)=>K1({text:t.text,enabled:!0,primary:!1,name:"name",icon:e.none(),borderless:!1,buttonType:e.some(t.buttonType)},e=>{t.onAction()},n),HT=e=>{const t=a(e.buttons,t=>PT(t,e.providers));return{uid:e.uid,dom:{tag:"div",classes:["tox-view__header"]},components:[_n.sketch({dom:{tag:"div",classes:["tox-view__header-start"]},components:[]}),_n.sketch({dom:{tag:"div",classes:["tox-view__header-end"]},components:t})]}},IT=e=>({uid:e.uid,dom:{tag:"div",classes:["tox-view__pane"]}}),BT=(e,t)=>{const o={getPane:t=>ge.getPart(t,e,"pane"),getOnShow:t=>e.viewConfig.onShow,getOnHide:t=>e.viewConfig.onHide};return{uid:e.uid,dom:e.dom,components:t,apis:o}};bo=We({name:"silver.View",configFields:[s("viewConfig")],partFields:[Dt({factory:{sketch:HT},schema:[s("buttons"),s("providers")],name:"header"}),Dt({factory:{sketch:IT},schema:[],name:"pane"})],factory:BT,apis:{getPane:(e,t)=>e.getPane(t),getOnShow:(e,t)=>e.getOnShow(t),getOnHide:(e,t)=>e.getOnHide(t)}});const $T=(e,t,n)=>tr(t,(t,s)=>{const o=pn(RT(t));return e.slot(s,bo.sketch({dom:{tag:"div",classes:["tox-view"]},viewConfig:o,components:[...o.buttons.length>0?[bo.parts.header({buttons:o.buttons,providers:n})]:[],bo.parts.pane({})]}))}),WT=(e,t)=>ze.sketch(n=>({dom:{tag:"div",classes:["tox-view-wrap__slot-container"]},components:$T(n,e,t),slotBehaviours:ta.unnamedEvents([J(e=>ze.hideAllSlots(e))])})),Up=e=>se(ze.getSlotNames(e),t=>ze.isShowing(e,t)),KT=e=>{const t=e.element;y(t,"display","none"),w(t,"aria-hidden","true")},qT=e=>{const t=e.element;B(t,"display"),pe(t,"aria-hidden")},YT=e=>({getContainer:n(e)}),Yp=(e,t,n)=>{ze.getSlot(e,t).each(e=>{bo.getPane(e).each(t=>{const s=n(e);s(YT(t.element.dom))})})},XT=(e,t)=>Yp(e,t,bo.getOnShow),QT=(e,t)=>Yp(e,t,bo.getOnHide),ZT=(e,t)=>{const n=(e,n)=>{j.set(e,[WT(n,t.backstage.shared.providers)])},s=e=>x.getCurrent(e).bind(Up),o=(e,t,n,s)=>x.getCurrent(e).exists(o=>{const i=Up(o),r=i.exists(e=>s===e),a=ze.getSlot(o,s).isSome();return a&&(ze.hideAllSlots(o),r?(KT(e),t()):(n(),qT(e),ze.showSlot(o,s),XT(o,s)),i.each(e=>QT(o,e))),a}),a={setViews:n,whichView:s,toggleView:o};return{uid:e.uid,dom:{tag:"div",classes:["tox-view-wrap"],attributes:{"aria-hidden":"true"},styles:{display:"none"}},components:[],behaviours:i([j.config({}),x.config({find:e=>{const t=j.contents(e);return os(t)}})]),apis:a}};Wi=gt({factory:ZT,name:"silver.ViewWrapper",configFields:[s("backstage")],apis:{setViews:(e,t,n)=>e.setViews(t,n),toggleView:(e,t,n,s,o)=>e.toggleView(t,n,s,o),whichView:(e,t)=>e.whichView(t)}});const ez=(t,n)=>{let i=!1;const o={getSocket:e=>ge.getPart(e,t,"socket"),setSidebar:(e,n,s)=>{ge.getPart(e,t,"sidebar").each(e=>bF(e,n,s))},toggleSidebar:(e,n)=>{ge.getPart(e,t,"sidebar").each(e=>jF(e,n))},whichSidebar:e=>ge.getPart(e,t,"sidebar").bind(yF).getOrNull(),getHeader:e=>ge.getPart(e,t,"header"),getToolbar:e=>ge.getPart(e,t,"toolbar"),setToolbar:(e,n)=>{ge.getPart(e,t,"toolbar").each(e=>{const t=a(n,Jr);e.getApis().setGroups(e,t)})},setToolbars:(e,n)=>{ge.getPart(e,t,"multiple-toolbar").each(e=>{const t=a(n,e=>a(e,Jr));G4.setItems(e,t)})},refreshToolbar:e=>{const n=ge.getPart(e,t,"toolbar");n.each(e=>e.getApis().refresh(e))},toggleToolbarDrawer:e=>{ge.getPart(e,t,"toolbar").each(e=>{HV(e.getApis().toggle,t=>t(e))})},isToolbarDrawerToggled:n=>ge.getPart(n,t,"toolbar").bind(t=>e.from(t.getApis().isOpen).map(e=>e(t))).getOr(!1),getThrobber:e=>ge.getPart(e,t,"throbber"),focusToolbar:e=>{const n=ge.getPart(e,t,"toolbar").orThunk(()=>ge.getPart(e,t,"multiple-toolbar"));n.each(e=>{u.focusIn(e)})},setMenubar:(e,n)=>{ge.getPart(e,t,"menubar").each(e=>{$a.setMenus(e,n)})},focusMenubar:e=>{ge.getPart(e,t,"menubar").each(e=>{$a.focus(e)})},setViews:(e,n)=>{ge.getPart(e,t,"viewWrapper").each(e=>{Wi.setViews(e,n)})},toggleView:(e,n)=>ge.getPart(e,t,"viewWrapper").exists(t=>Wi.toggleView(t,()=>o.showMainView(e),()=>o.hideMainView(e),n)),whichView:e=>ge.getPart(e,t,"viewWrapper").bind(Wi.whichView).getOrNull(),hideMainView:e=>{i=o.isToolbarDrawerToggled(e),i&&o.toggleToolbarDrawer(e),ge.getPart(e,t,"editorContainer").each(e=>{const t=e.element;y(t,"display","none"),w(t,"aria-hidden","true")})},showMainView:e=>{i&&o.toggleToolbarDrawer(e),ge.getPart(e,t,"editorContainer").each(e=>{const t=e.element;B(t,"display"),pe(t,"aria-hidden")})}};return{uid:t.uid,dom:t.dom,components:n,apis:o,behaviours:t.behaviours}},tz=Tn.optional({factory:$a,name:"menubar",schema:[s("backstage")]}),nz=e=>e.type===zt.sliding?TT:e.type===zt.floating?FT:mc,sz=Tn.optional({factory:{sketch:t=>G4.sketch({uid:t.uid,dom:t.dom,listBehaviours:i([u.config({mode:"acyclic",selector:".tox-toolbar"})]),makeItem:()=>mc({type:t.type,uid:d("multiple-toolbar-item"),cyclicKeying:!1,initGroups:[],providers:t.providers,onEscape:()=>(t.onEscape(),e.some(!0))}),setupItem:(e,t,n)=>{gn.setGroups(t,n)},shell:!0})},name:"multiple-toolbar",schema:[s("dom"),s("onEscape")]}),oz=Tn.optional({factory:{sketch:t=>{const n=nz(t),s={type:t.type,uid:t.uid,onEscape:()=>(t.onEscape(),e.some(!0)),onToggled:(e,n)=>t.onToolbarToggled(n),cyclicKeying:!1,initGroups:[],getSink:t.getSink,providers:t.providers,moreDrawerData:{lazyToolbar:t.lazyToolbar,lazyMoreButton:t.lazyMoreButton,lazyHeader:t.lazyHeader},attributes:t.attributes};return n(s)}},name:"toolbar",schema:[s("dom"),s("onEscape"),s("getSink")]}),iz=Tn.optional({factory:{sketch:vM},name:"header",schema:[s("dom")]}),az=Tn.optional({factory:{sketch:SM},name:"promotion",schema:[s("dom")]}),rz=Tn.optional({name:"socket",schema:[s("dom")]}),cz=Tn.optional({factory:{sketch:OF},name:"sidebar",schema:[s("dom")]}),lz=Tn.optional({factory:{sketch:PF},name:"throbber",schema:[s("dom")]}),dz=Tn.optional({factory:Wi,name:"viewWrapper",schema:[s("backstage")]}),uz=e=>({uid:e.uid,dom:{tag:"div",classes:["tox-editor-container"]},components:e.components}),hz=Tn.optional({factory:{sketch:uz},name:"editorContainer",schema:[]});P=We({name:"OuterContainer",factory:ez,configFields:[s("dom"),s("behaviours")],partFields:[iz,tz,oz,sz,rz,cz,az,lz,dz,hz],apis:{getSocket:(e,t)=>e.getSocket(t),setSidebar:(e,t,n,s)=>{e.setSidebar(t,n,s)},toggleSidebar:(e,t,n)=>{e.toggleSidebar(t,n)},whichSidebar:(e,t)=>e.whichSidebar(t),getHeader:(e,t)=>e.getHeader(t),getToolbar:(e,t)=>e.getToolbar(t),setToolbar:(e,t,n)=>{e.setToolbar(t,n)},setToolbars:(e,t,n)=>{e.setToolbars(t,n)},refreshToolbar:(e,t)=>e.refreshToolbar(t),toggleToolbarDrawer:(e,t)=>{e.toggleToolbarDrawer(t)},isToolbarDrawerToggled:(e,t)=>e.isToolbarDrawerToggled(t),getThrobber:(e,t)=>e.getThrobber(t),setMenubar:(e,t,n)=>{e.setMenubar(t,n)},focusMenubar:(e,t)=>{e.focusMenubar(t)},focusToolbar:(e,t)=>{e.focusToolbar(t)},setViews:(e,t,n)=>{e.setViews(t,n)},toggleView:(e,t,n)=>e.toggleView(t,n),whichView:(e,t)=>e.whichView(t)}});const fz="file edit view insert format tools table help",Qp={file:{title:"File",items:"newdocument restoredraft | preview | export print | deleteallconversations"},edit:{title:"Edit",items:"undo redo | cut copy paste pastetext | selectall | searchreplace"},view:{title:"View",items:"code | visualaid visualchars visualblocks | spellchecker | preview fullscreen | showcomments"},insert:{title:"Insert",items:"image link media addcomment pageembed template codesample inserttable | charmap emoticons hr | pagebreak nonbreaking anchor tableofcontents footnotes | mergetags | insertdatetime"},format:{title:"Format",items:"bold italic underline strikethrough superscript subscript codeformat | styles blocks fontfamily fontsize align lineheight | forecolor backcolor | language | removeformat"},tools:{title:"Tools",items:"spellchecker spellcheckerlanguage | autocorrect capitalization | a11ycheck code wordcount"},table:{title:"Table",items:"inserttable | cell row column | advtablesort | tableprops deletetable"},help:{title:"Help",items:"help"}},gz=(e,t,n)=>{const s=jg(n).split(/[ ,]/);return{text:e.title,getItems:()=>le(e.items,e=>{const n=e.toLowerCase();return n.trim().length===0?[]:vn(s,e=>e===n)?[]:n==="separator"||n==="|"?[{type:"separator"}]:t.menuItems[n]?[t.menuItems[n]]:[]})}},pd=e=>e.split(" "),Zp=(e,t)=>{const n={...Qp,...t.menus},s=de(t.menus).length>0,o=pd(t.menubar===void 0||t.menubar===!0?fz:t.menubar===!1?"":t.menubar),i=q(o,e=>{const n=R(Qp,e);return s?n||f(t.menus,e).exists(e=>R(e,"items")):n}),r=a(i,s=>{const o=n[s];return gz({title:o.title,items:pd(o.items)},t,e)});return q(r,e=>{const t=e=>L(e)||e.type!=="separator";return e.getItems().length>0&&vn(e.getItems(),t)})},hg=e=>{const t=()=>{e._skinLoaded=!0,ib(e)};return()=>{e.initialized?t():e.on("init",t)}},yz=(e,t)=>()=>ab(e,{message:t}),wg=(e,t,n)=>(e.on("remove",()=>n.unload(t)),n.load(t)),wz=(e,t)=>{const n=t+"/skin.min.css";return wg(e,n,e.ui.styleSheetLoader)},Oz=(e,t)=>{const n=rV(c.fromDom(e.getElement()));if(n){const n=t+"/skin.shadowdom.min.css";return wg(e,n,Do.DOM.styleSheetLoader)}return Promise.resolve()},$g=(e,t)=>{const n=Ug(t);n&&t.contentCSS.push(n+(e?"/content.inline":"/content")+".min.css"),!sd(t)&&L(n)?Promise.all([wz(t,n),Oz(t,n)]).then(hg(t),yz(t,"Skin could not be loaded")):hg(t)()},Cz=Tt($g,!1),Ez=Tt($g,!0),kc=(e,t)=>n=>{const o=Qo(),s=()=>{n.setActive(e.formatter.match(t));const s=e.formatter.formatChanged(t,n.setActive);o.set(s)};return e.initialized?s():e.once("init",s),()=>{e.off("init",s),o.clear()}},Ac=(e,t,n)=>s=>{const i=()=>n(s),o=()=>{n(s),e.on(t,i)};return e.initialized?o():e.once("init",o),()=>{e.off("init",o),e.off(t,i)}},g5=e=>t=>()=>{e.undoManager.transact(()=>{e.focus(),e.execCommand("mceToggleFormat",!1,t.format)})},Et=(e,t)=>()=>e.execCommand(t),Fz=(t,n,s)=>{const i=(t,i,a,r)=>{const c=n.shared.providers.translate(t.title);if(t.type==="separator")return e.some({type:"separator",text:c});if(t.type==="submenu"){const n=le(t.getStyleItems(),e=>o(e,i,r));return i===0&&n.length<=0?e.none():e.some({type:"nestedmenuitem",text:c,enabled:n.length>0,getSubmenuItems:()=>le(t.getStyleItems(),e=>o(e,i,r))})}else return e.some({type:"togglemenuitem",text:c,icon:t.icon,active:t.isSelected(r),enabled:!a,onAction:s.onAction(t),...t.getStylePreview().fold(()=>({}),e=>({meta:{style:e}}))})},o=(e,t,n)=>{const o=e.type==="formatter"&&s.isInvalid(e);return t===0?o?[]:i(e,t,!1,n).toArray():i(e,t,o,n).toArray()},a=e=>{const t=s.getCurrentValue(),n=s.shouldHide?0:1;return le(e,e=>o(e,n,t))},r=(t,n)=>(s,o)=>{const i=n(),r=a(i),c=Ro(r,Yt.CLOSE_ON_EXECUTE,t,{isHorizontalMenu:!1,search:e.none()});o(c)};return{validateItems:a,getFetch:r}},Wo=(e,t,n)=>{const s=n.dataset,o=s.type==="basic"?()=>a(s.data,e=>N0(e,n.isSelectedFor,n.getPreviewFor)):s.getData;return{items:Fz(e,t,n),getStyleItems:o}},oa=(t,s,o)=>{const{items:i,getStyleItems:a}=Wo(t,s,o),r=e=>({getComponent:n(e)}),c=Ac(t,"NodeChange",e=>{const t=e.getComponent();o.updateText(t)});return s1({text:o.icon.isSome()?e.none():o.text,icon:o.icon,tooltip:e.from(o.tooltip),role:e.none(),fetch:i.getFetch(s,a),onSetup:c,getApi:r,columns:1,presets:"normal",classes:o.icon.isSome()?[]:["bespoke"],dropdownBehaviours:[]},"tox-tbtn",s.shared)},Dz=e=>a(e,e=>{let n=e,s=e;const t=e.split("=");return t.length>1&&(n=t[0],s=t[1]),{title:n,format:s}}),Nz=e=>({type:"basic",data:e});(function(e){e[e.SemiColon=0]="SemiColon",e[e.Space=1]="Space"})(Vo||(Vo={}));const Rz=(e,t)=>t===Vo.SemiColon?e.replace(/;$/,"").split(";"):e.split(" "),Hl=(e,t,n)=>{const s=e.options.get(t),o=Dz(Rz(s,n));return{type:"basic",data:o}},Pl=[{title:"Left",icon:"align-left",format:"alignleft",command:"JustifyLeft"},{title:"Center",icon:"align-center",format:"aligncenter",command:"JustifyCenter"},{title:"Right",icon:"align-right",format:"alignright",command:"JustifyRight"},{title:"Justify",icon:"align-justify",format:"alignjustify",command:"JustifyFull"}],n7=t=>{const s=()=>se(Pl,e=>t.formatter.match(e.format)),o=e=>()=>t.formatter.match(e),i=t=>e.none,a=e=>{const t=s(),o=t.fold(n("left"),e=>e.title.toLowerCase());p(e,Dh,{icon:`align-${o}`})},r=Nz(Pl),c=e=>()=>se(Pl,t=>t.format===e.format).each(e=>t.execCommand(e.command));return{tooltip:"Align",text:e.none(),icon:e.some("align-left"),isSelectedFor:o,getCurrentValue:e.none,getPreviewFor:i,onAction:c,updateText:a,dataset:r,shouldHide:!1,isInvalid:e=>!t.formatter.canApply(e.format)}},Bz=(e,t)=>oa(e,t,n7(e)),Vz=(e,t)=>{const n=Wo(e,t,n7(e));e.ui.registry.addNestedMenuItem("align",{text:t.shared.providers.translate("Align"),getSubmenuItems:()=>n.items.validateItems(n.getStyleItems())})},i7=(t,n)=>{const s=n(),o=a(s,e=>e.format);return e.from(t.formatter.closest(o)).bind(e=>se(s,t=>t.format===e)).orThunk(()=>Ti(t.formatter.match("p"),{title:"Paragraph",format:"p"}))},d7=t=>{const s="Paragraph",i=e=>()=>t.formatter.match(e),a=n=>()=>{const s=t.formatter.get(n);return s?e.some({tag:s.length>0?s[0].inline||s[0].block||"div":"div",styles:t.dom.parseStyle(t.formatter.getCssText(n))}):e.none()},r=e=>{const i=i7(t,()=>o.data),a=i.fold(n(s),e=>e.title);p(e,Uo,{text:a})},o=Hl(t,"block_formats",Vo.SemiColon);return{tooltip:"Blocks",text:e.some(s),icon:e.none(),isSelectedFor:i,getCurrentValue:e.none,getPreviewFor:a,onAction:g5(t),updateText:r,dataset:o,shouldHide:!1,isInvalid:e=>!t.formatter.canApply(e.format)}},Uz=(e,t)=>oa(e,t,d7(e)),Kz=(e,t)=>{const n=Wo(e,t,d7(e));e.ui.registry.addNestedMenuItem("blocks",{text:"Blocks",getSubmenuItems:()=>n.items.validateItems(n.getStyleItems())})},qz=["-apple-system","Segoe UI","Roboto","Helvetica Neue","sans-serif"],u7=e=>{const t=e.split(/\s*,\s*/);return a(t,e=>e.replace(/^['"]+|['"]+$/g,""))},Gz=e=>{const t=()=>{const t=u7(e.toLowerCase());return si(qz,e=>t.indexOf(e.toLowerCase())>-1)};return e.indexOf("-apple-system")===0&&t()},m7=t=>{const s="System Font",o=()=>{const o=e=>e?u7(e)[0]:"",n=t.queryCommandValue("FontName"),a=i.data,e=n?n.toLowerCase():"",r=se(a,t=>{const n=t.format;return n.toLowerCase()===e||o(n).toLowerCase()===o(e).toLowerCase()}).orThunk(()=>Ti(Gz(e),{title:s,format:e}));return{matchOpt:r,font:n}},a=e=>t=>t.exists(t=>t.format===e),r=()=>{const{matchOpt:e}=o();return e},c=t=>()=>e.some({tag:"div",styles:t.indexOf("dings")===-1?{"font-family":t}:{}}),l=e=>()=>{t.undoManager.transact(()=>{t.focus(),t.execCommand("FontName",!1,e.format)})},d=e=>{const{matchOpt:t,font:s}=o(),i=t.fold(n(s),e=>e.title);p(e,Uo,{text:i})},i=Hl(t,"font_family_formats",Vo.SemiColon);return{tooltip:"Fonts",text:e.some(s),icon:e.none(),isSelectedFor:a,getCurrentValue:r,getPreviewFor:c,onAction:l,updateText:d,dataset:i,shouldHide:!1,isInvalid:U}},Qz=(e,t)=>oa(e,t,m7(e)),Zz=(e,t)=>{const n=Wo(e,t,m7(e));e.ui.registry.addNestedMenuItem("fontfamily",{text:t.shared.providers.translate("Fonts"),getSubmenuItems:()=>n.items.validateItems(n.getStyleItems())})},Jz={"8pt":"1","10pt":"2","12pt":"3","14pt":"4","18pt":"5","24pt":"6","36pt":"7"},eD={"xx-small":"7pt","x-small":"8pt",small:"10pt",medium:"12pt",large:"14pt","x-large":"18pt","xx-large":"24pt"},tD=(e,t)=>{const n=Math.pow(10,t);return Math.round(e*n)/n},nD=(e,t)=>/[0-9.]+px$/.test(e)?tD(parseInt(e,10)*72/96,t||0)+"pt":f(eD,e).getOr(e),sD=e=>f(Jz,e).getOr(""),p7=t=>{const s=()=>{let s=e.none();const i=o.data,n=t.queryCommandValue("FontSize");if(n)for(let e=3;s.isNone()&&e>=0;e--){const t=nD(n,e),o=sD(t);s=se(i,e=>e.format===n||e.format===t||e.format===o)}return{matchOpt:s,size:n}},i=e=>t=>t.exists(t=>t.format===e),a=()=>{const{matchOpt:e}=s();return e},r=n(e.none),c=e=>()=>{t.undoManager.transact(()=>{t.focus(),t.execCommand("FontSize",!1,e.format)})},l=e=>{const{matchOpt:t,size:o}=s(),i=t.fold(n(o),e=>e.title);p(e,Uo,{text:i})},o=Hl(t,"font_size_formats",Vo.Space);return{tooltip:"Font sizes",text:e.some("12pt"),icon:e.none(),isSelectedFor:i,getPreviewFor:r,getCurrentValue:a,onAction:c,updateText:l,dataset:o,shouldHide:!1,isInvalid:U}},iD=(e,t)=>oa(e,t,p7(e)),aD=(e,t)=>{const n=Wo(e,t,p7(e));e.ui.registry.addNestedMenuItem("fontsize",{text:"Font sizes",getSubmenuItems:()=>n.items.validateItems(n.getStyleItems())})},g7=(t,s)=>{const o="Paragraph",i=e=>()=>t.formatter.match(e),a=n=>()=>{const s=t.formatter.get(n);return s!==void 0?e.some({tag:s.length>0?s[0].inline||s[0].block||"div":"div",styles:t.dom.parseStyle(t.formatter.getCssText(n))}):e.none()},r=e=>{const s=e=>I0(e)?le(e.items,s):H0(e)?[{title:e.title,format:e.format}]:[],i=le(L0(t),s),a=i7(t,n(i)),r=a.fold(n(o),e=>e.title);p(e,Uo,{text:r})};return{tooltip:"Formats",text:e.some(o),icon:e.none(),isSelectedFor:i,getCurrentValue:e.none,getPreviewFor:a,onAction:g5(t),updateText:r,shouldHide:vg(t),isInvalid:e=>!t.formatter.canApply(e.format),dataset:s}},cD=(e,t)=>{const n={type:"advanced",...t.styles};return oa(e,t,g7(e,n))},lD=(e,t)=>{const s={type:"advanced",...t.styles},n=Wo(e,t,g7(e,s));e.ui.registry.addNestedMenuItem("styles",{text:"Formats",getSubmenuItems:()=>n.items.validateItems(n.getStyleItems())})},dD=(e,t)=>{const n=(n,s)=>{e.updateState.each(e=>{const o=e(n,s);t.set(o)}),e.renderComponents.each(o=>{const i=o(s,t.get()),a=e.reuseDom?Gf:Yf;a(n,i)})};return $([o(ao(),(t,s)=>{const o=s;if(!o.universal){const s=e.channel;Oe(o.channels,s)&&n(t,o.data)}}),J((t)=>{e.initialData.each(e=>{n(t,e)})})])};b7=Object.freeze({__proto__:null,events:dD});const hD=(e,t,n)=>n;w7=Object.freeze({__proto__:null,getState:hD}),x7=[s("channel"),D("renderComponents"),D("updateState"),D("initialData"),ht("reuseDom",!0)];const pD=()=>{const t=g(e.none()),n=()=>t.set(e.none()),s=()=>t.get().getOr("none");return{readState:s,get:t.get,set:t.set,clear:n}};T7=Object.freeze({__proto__:null,init:pD});const it=xe({fields:x7,name:"reflecting",active:b7,apis:w7,state:T7}),bD=n([s("toggleClass"),s("fetch"),Vs("onExecute"),t("getHotspot",e.some),t("getAnchorOverrides",n({})),Ns(),Vs("onItemExecute"),D("lazySink"),s("dom"),E("onOpen"),ve("splitDropdownBehaviours",[G,u,b]),t("matchWidth",!1),t("useMinWidth",!1),t("eventOrder",{}),D("role")].concat(Ad())),jD=Pe({factory:nt,schema:[s("dom")],name:"arrow",defaults:()=>({buttonBehaviours:i([b.revoke()])}),overrides:e=>({dom:{tag:"span",attributes:{role:"presentation"}},action:t=>{t.getSystem().getByUid(e.uid).each(mo)},buttonBehaviours:i([A.config({toggleOnExecute:!1,toggleClass:e.toggleClass})])})}),yD=Pe({factory:nt,schema:[s("dom")],name:"button",defaults:()=>({buttonBehaviours:i([b.revoke()])}),overrides:e=>({dom:{tag:"span",attributes:{role:"presentation"}},action:t=>{t.getSystem().getByUid(e.uid).each(n=>{e.onExecute(n,t)})}})}),_D=n([jD,yD,Dt({factory:{sketch:e=>({uid:e.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:e.text}})},schema:[s("text")],name:"aria-descriptor"}),Wt({schema:[hc()],name:"menu",defaults:e=>({onExecute:(t,n)=>{t.getSystem().getByUid(e.uid).each(s=>{e.onItemExecute(s,t,n)})}})}),a5()]),wD=(t,n,s,o)=>{const r=e=>{x.getCurrent(e).each(e=>{F.highlightFirst(e),u.focusIn(e)})},i=e=>{const n=r;gd(t,z,e,o,n,Ge.HighlightMenuAndItem).get(l)},c=t=>(i(t),e.some(!0)),a=n=>{const s=Ln(n,t,"button");return mo(s),e.some(!0)},h={...$([J((e)=>{const s=H(e,t,"aria-descriptor");s.each(t=>{const n=d("aria");w(t.element,"id",n),w(e.element,"aria-describedby",n)})})]),...Jc(e.some(i))},m={repositionMenus:e=>{A.isOn(e)&&Wp(e)}};return{uid:t.uid,dom:t.dom,components:n,apis:m,eventOrder:{...t.eventOrder,[bt()]:["disabling","toggling","alloy.base.behaviour"]},events:h,behaviours:we(t.splitDropdownBehaviours,[G.config({others:{sandbox:e=>{const n=Ln(e,t,"arrow"),s={onOpen:()=>{A.on(n),A.on(e)},onClose:()=>{A.off(n),A.off(e)}};return Od(t,e,s)}}}),u.config({mode:"special",onSpace:a,onEnter:a,onDown:c}),b.config({}),A.config({toggleOnExecute:!1,aria:{mode:"expanded"}})]),domModification:{attributes:{role:t.role.getOr("button"),"aria-haspopup":!0}}}},Wc=We({name:"SplitDropdown",configFields:bD(),partFields:_D(),factory:wD,apis:{repositionMenus:(e,t)=>e.repositionMenus(t)}}),xD=e=>({isEnabled:()=>!v.isDisabled(e),setEnabled:t=>v.set(e,!t)}),CD=e=>({setActive:t=>{A.set(e,t)},isActive:()=>A.isOn(e),isEnabled:()=>!v.isDisabled(e),setEnabled:t=>v.set(e,!t)}),B7=(e,t)=>e.map(e=>({"aria-label":t.translate(e),title:t.translate(e)})).getOr({}),iv=d("focus-button"),ul=(e,t,n,s,a,r)=>({dom:{tag:"button",classes:["tox-tbtn"].concat(t.isSome()?["tox-tbtn--select"]:[]),attributes:B7(n,r)},components:fi([e.map(e=>Gr(e,r.icons)),t.map(e=>e1(e,"tox-tbtn",r))]),eventOrder:{[Kt()]:["focusing","alloy.base.behaviour","common-button-display-events"]},buttonBehaviours:i([on.toolbarButton(r.isDisabled),re(),O("common-button-display-events",[o(Kt(),(e,t)=>{t.event.prevent(),T(e,iv)})])].concat(s.map(n=>it.config({channel:n,initialData:{icon:e,text:t},renderComponents:(e)=>fi([e.icon.map(e=>Gr(e,r.icons)),e.text.map(e=>e1(e,"tox-tbtn",r))])})).toArray()).concat(a.getOr([])))}),SD=(t,n,s,o)=>{const i=n.shared;return fo.sketch({lazySink:i.getSink,fetch:()=>ke.nu(e=>{e(a(s(t.items),Jr))}),markers:{toggledClass:"tox-tbtn--enabled"},parts:{button:ul(t.icon,t.text,t.tooltip,e.none(),e.none(),i.providers),toolbar:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:o}}}})},uv=(t,n,s)=>{const o=g(l),a=ul(t.icon,t.text,t.tooltip,e.none(),e.none(),s);return nt.sketch({dom:a.dom,components:a.components,eventOrder:Vh,buttonBehaviours:i([O("toolbar-button-events",[hC({onAction:t.onAction,getApi:n.getApi}),Ca(n,o),ki(n,o)]),on.toolbarButton(()=>!t.enabled||s.isDisabled()),re()].concat(n.toolbarButtonBehaviours))})},FD=(e,t)=>Sv(e,t,[]),Sv=(e,t,n)=>uv(e,{toolbarButtonBehaviours:n.length>0?[O("toolbarButtonWith",n)]:[],getApi:xD,onSetup:e.onSetup},t),zD=(e,t)=>Tv(e,t,[]),Tv=(e,t,n)=>uv(e,{toolbarButtonBehaviours:[j.config({}),A.config({toggleClass:"tox-tbtn--enabled",aria:{mode:"pressed"},toggleOnExecute:!1})].concat(n.length>0?[O("toolbarToggleButtonWith",n)]:[]),getApi:CD,onSetup:e.onSetup},t),ND=(t,n,s)=>o=>ke.nu(e=>n.fetch(e)).map(i=>e.from(Nd(Q(Bl(d("menu-value"),i,e=>{n.onItemAction(t(o),e)},n.columns,n.presets,Yt.CLOSE_ON_EXECUTE,n.select.getOr(U),s),{movement:mr(n.columns,n.presets),menuBehaviours:ta.unnamedEvents(n.columns!=="auto"?[]:[J((e)=>{al(e,4,F5(n.presets)).each(({numRows:t,numColumns:n})=>{u.setGridSize(e,t,n)})})])})))),LD=(t,n)=>{const c=d("channel-update-split-dropdown-display"),s=e=>({isEnabled:()=>!v.isDisabled(e),setEnabled:t=>v.set(e,!t),setIconFill:(t,n)=>{be(e.element,'svg path[id="'+t+'"], rect[id="'+t+'"]').each(e=>{w(e,"fill",n)})},setActive:t=>{w(e.element,"aria-pressed",t),be(e.element,"span").each(n=>{e.getSystem().getByDom(n).each(e=>A.set(e,t))})},isActive:()=>be(e.element,"span").exists(t=>e.getSystem().getByDom(t).exists(A.isOn))}),a=g(l),r={getApi:s,onSetup:t.onSetup};return Wc.sketch({dom:{tag:"div",classes:["tox-split-button"],attributes:{"aria-pressed":!1,...B7(t.tooltip,n.providers)}},onExecute:e=>{t.onAction(s(e))},onItemExecute:()=>{},splitDropdownBehaviours:i([on.splitButton(n.providers.isDisabled),re(),O("split-dropdown-events",[o(iv,b.focus),Ca(r,a),ki(r,a)]),ya.config({})]),eventOrder:{[no()]:["alloy.base.behaviour","split-dropdown-events"]},toggleClass:"tox-tbtn--enabled",lazySink:n.getSink,fetch:ND(s,t,n.providers),parts:{menu:lr(!1,t.columns,t.presets)},components:[Wc.parts.button(ul(t.icon,t.text,e.none(),e.some(c),e.some([A.config({toggleClass:"tox-tbtn--enabled",toggleOnExecute:!1})]),n.providers)),Wc.parts.arrow({dom:{tag:"button",classes:["tox-tbtn","tox-split-button__chevron"],innerHtml:$p("chevron-down",n.providers.icons)},buttonBehaviours:i([on.splitButton(n.providers.isDisabled),re(),_d()])}),Wc.parts["aria-descriptor"]({text:n.providers.translate("To open the popup, press Shift+Enter")})]})},RD=[{name:"history",items:["undo","redo"]},{name:"styles",items:["styles"]},{name:"formatting",items:["bold","italic"]},{name:"alignment",items:["alignleft","aligncenter","alignright","alignjustify"]},{name:"indentation",items:["outdent","indent"]},{name:"permanent pen",items:["permanentpen"]},{name:"comments",items:["addcomment"]}],Ta=(e,t)=>(n,s,o)=>{const i=e(n).mapError(e=>oi(e)).getOrDie();return t(i,s,o)},HD={button:Ta(X7,(e,t)=>FD(e,t.shared.providers)),togglebutton:Ta(J7,(e,t)=>zD(e,t.shared.providers)),menubutton:Ta(X2,(t,n)=>U1(t,"tox-tbtn",n,e.none())),splitbutton:Ta(xM,(e,t)=>LD(e,t.shared)),grouptoolbarbutton:Ta(jM,(t,n,s)=>{const o=s.ui.registry.getAll().buttons,i=t=>nc(s,{buttons:o,toolbar:t,allowToolbarGroups:!1},n,e.none()),a={[n4]:n.shared.header.isPositionedAtTop()?rs.TopToBottom:rs.BottomToTop};switch(Eo(s)){case zt.floating:return SD(t,n,i,a);default:throw new Error("Toolbar groups are only supported when using floating toolbar mode")}})},ID=(t,n,s)=>f(HD,t.type).fold(()=>(console.error("skipping button defined by",t),e.none()),o=>e.some(o(t,n,s))),Iv={styles:cD,fontsize:iD,fontfamily:Qz,blocks:Uz,align:Bz},VD=e=>{const t=a(RD,t=>{const n=q(t.items,t=>R(e,t)||R(Iv,t));return{name:t.name,items:n}});return q(t,e=>e.items.length>0)},$D=e=>{const t=e.split("|");return a(t,e=>({items:e.trim().split(" ")}))},WD=e=>Hi(e,e=>R(e,"name")&&R(e,"items")),UD=e=>{const t=e.toolbar,n=e.buttons;return t===!1?[]:t===void 0||t===!0?VD(n):L(t)?$D(t):WD(t)?t:(console.error("Toolbar type should be string, string[], boolean or ToolbarGroup[]"),[])},KD=(t,n,s,o,i,a)=>f(n,s.toLowerCase()).orThunk(()=>a.bind(e=>En(e,e=>f(n,e+s.toLowerCase())))).fold(()=>f(Iv,s.toLowerCase()).map(e=>e(t,i)),n=>n.type==="grouptoolbarbutton"&&!o?(console.warn(`Ignoring the '${s}' toolbar button. Group toolbar buttons are only supported when using floating toolbar mode and cannot be nested.`),e.none()):ID(n,i,t)),nc=(t,n,s,o)=>{const i=UD(n),r=a(i,i=>{const a=le(i.items,e=>e.trim().length===0?[]:KD(t,n.buttons,e,n.allowToolbarGroups,s,o).toArray());return{title:e.from(t.translate(i.name)),items:a}});return q(r,e=>e.items.length>0)},Qh=(t,n,s,o)=>{const i=n.mainUi.outerContainer,a=s.toolbar,r=s.buttons;if(Hi(a,L)){const n=a.map(n=>{const i={toolbar:n,buttons:r,allowToolbarGroups:s.allowToolbarGroups};return nc(t,i,o,e.none())});P.setToolbars(i,n)}else P.setToolbar(i,nc(t,s,o,e.none()))},Vv=ho(),XD=Vv.os.isiOS()&&Vv.os.version.major<=12,QD=(e,t)=>{const{uiMotherships:o}=t,s=e.dom;let n=e.getWin();const i=e.getDoc().documentElement,a=g(Z(n.innerWidth,n.innerHeight)),r=g(Z(i.offsetWidth,i.offsetHeight)),l=()=>{const t=a.get();(t.left!==n.innerWidth||t.top!==n.innerHeight)&&(a.set(Z(n.innerWidth,n.innerHeight)),vl(e))},d=()=>{const t=e.getDoc().documentElement,n=r.get();(n.left!==t.offsetWidth||n.top!==t.offsetHeight)&&(r.set(Z(t.offsetWidth,t.offsetHeight)),vl(e))},u=t=>{lb(e,t)};s.bind(n,"resize",l),s.bind(n,"scroll",u);const m=th(c.fromDom(e.getBody()),"load",d);e.on("hide",()=>{h(o,e=>{y(e.element,"display","none")})}),e.on("show",()=>{h(o,e=>{B(e.element,"display")})}),e.on("NodeChange",d),e.on("remove",()=>{m.unbind(),s.unbind(n,"resize",l),s.unbind(n,"scroll",u),n=null})},ZD=(e,t)=>{m4(e,t.dialogUi.mothership)},JD=(e,t,n,s,o)=>{const{mainUi:a,uiMotherships:m}=t,r=g(0),i=a.outerContainer;Cz(e);const d=c.fromDom(o.targetNode),f=Kc(Pt(d));Sk(d,a.mothership),ZD(f,t),e.on("PostRender",()=>{P.setSidebar(i,n.sidebar,Bg(e)),Qh(e,t,n,s),r.set(e.getWin().innerWidth),P.setMenubar(i,Zp(e,n)),P.setViews(i,n.views),QD(e,t)});const l=P.getSocket(i).getOrDie("Could not find expected socket element");if(XD){ko(l.element,{overflow:"scroll","-webkit-overflow-scrolling":"touch"});const t=rE(()=>{e.dispatch("ScrollContent")},20),n=qe(l.element,"scroll",t.throttle);e.on("remove",n.unbind)}Xv(e,t),e.addCommand("ToggleSidebar",(t,n)=>{P.toggleSidebar(i,n),e.dispatch("ToggleSidebar")}),e.addQueryValueHandler("ToggleSidebar",()=>{var e;return(e=P.whichSidebar(i))!==null&&e!==void 0?e:""}),e.addCommand("ToggleView",(t,n)=>{if(P.toggleView(i,n)){const t=i.element;a.mothership.broadcastOn([Es()],{target:t}),h(m,e=>{e.broadcastOn([Es()],{target:t})}),zc(P.whichView(i))&&(e.focus(),e.nodeChanged())}}),e.addQueryValueHandler("ToggleView",()=>{var e;return(e=P.whichView(i))!==null&&e!==void 0?e:""});const u=Eo(e),p=()=>{P.refreshToolbar(t.mainUi.outerContainer)};(u===zt.sliding||u===zt.floating)&&e.on("ResizeWindow ResizeEditor ResizeContent",()=>{const t=e.getWin().innerWidth;t!==r.get()&&(p(),r.set(t))});const b={setEnabled:e=>{qa(t,!e)},isEnabled:()=>!v.isDisabled(i)};return{iframeContainer:l.element.dom,editorContainer:i.element.dom,api:b}};Dv=Object.freeze({__proto__:null,render:JD});const cl=t=>{const n=/^[0-9.]+(|px)$/i;return n.test(""+t)?e.some(parseInt(""+t,10)):e.none()},hl=e=>gs(e)?e+"px":e,Gc=(e,t,n)=>{const s=t.filter(t=>e<t),o=n.filter(t=>e>t);return s.or(o).getOr(e)},oN=e=>{const t=hd(e),n=ld(e),s=cd(e);return cl(t).map(e=>Gc(e,n,s))},iN=e=>{const t=oN(e);return t.getOr(hd(e))},Q7=e=>{const t=ud(e),n=dd(e),s=Kr(e);return cl(t).map(e=>Gc(e,n,s))},rN=e=>{const t=Q7(e);return t.getOr(ud(e))},{ToolbarLocation:pl,ToolbarMode:Y7}=s5,dN=(e,t,s,o,i)=>{const{mainUi:a,uiMotherships:u}=s,j=Do.DOM,l=Bi(e),x=zi(e),C=Kr(e).or(Q7(e)),r=o.shared.header,f=r.isPositionedAtTop,p=Eo(e),v=p===Y7.sliding||p===Y7.floating,m=g(!1),c=()=>m.get()&&!e.removed,_=e=>v?e.fold(n(0),e=>e.components().length>1?Ve(e.components()[1].element):0):0,S=n=>{switch(rd(e)){case pl.auto:const i=P.getToolbar(a.outerContainer),r=_(i),e=Ve(n.element)-r,s=at(t),c=s.y>e;if(c)return"top";const o=Ld(t),l=Math.max(o.dom.scrollHeight,Ve(o)),d=s.bottom<l-e;if(d)return"bottom";const winBounds=Sn(),isRoomAtBottomViewport=winBounds.bottom<s.bottom-e;return isRoomAtBottomViewport?"bottom":"top";case pl.bottom:return"bottom";case pl.top:default:return"top"}},A=e=>{i.on(t=>{$e.setModes(t,[e]),r.setDockingMode(e);const n=f()?rs.TopToBottom:rs.BottomToTop;w(t.element,n4,n)})},k=()=>{i.on(e=>{const n=C.getOrThunk(()=>{const e=cl(ft(Un(),"margin-left")).getOr(0);return et(Un())-zs(t).left+e});y(e.element,"max-width",n+"px")})},E=()=>{i.on(e=>{const s=P.getToolbar(a.outerContainer),o=_(s),n=at(t),i=f()?Math.max(n.y-Ve(e.element)+o,0):n.bottom;ko(a.outerContainer.element,{position:"absolute",top:Math.round(i)+"px",left:Math.round(n.x)+"px"})})},b=()=>{h(u,e=>{e.broadcastOn([ei()],{})})},d=(e=!1)=>{if(!c())return;if(l||k(),v&&P.refreshToolbar(a.outerContainer),l||E(),x){const t=e?$e.reset:$e.refresh;i.on(t)}b()},O=(e=!0)=>{if(l||!x||!c())return;i.on(t=>{const s=r.getDockingMode(),n=S(t);n!==s&&(A(n),e&&d(!0))})},M=()=>{m.set(!0),y(a.outerContainer.element,"display","flex"),j.addClass(e.getBody(),"mce-edit-focus"),h(u,e=>{B(e.element,"display")}),O(!1),d()},F=()=>{m.set(!1),y(a.outerContainer.element,"display","none"),j.removeClass(e.getBody(),"mce-edit-focus"),h(u,e=>{y(e.element,"display","none")})};return{isVisible:c,isPositionedAtTop:f,show:M,hide:F,update:d,updateMode:O,repositionPopups:b}},q7=(e,t)=>{const n=at(e);return{pos:t?n.y:n.bottom,bounds:n}},hN=(e,t,n,s)=>{const o=g(q7(t,n.isPositionedAtTop())),i=s=>{const{pos:a,bounds:i}=q7(t,n.isPositionedAtTop()),{pos:l,bounds:r}=o.get(),c=i.height!==r.height||i.width!==r.width;o.set({pos:a,bounds:i}),c&&vl(e,s),n.isVisible()&&(l!==a?n.update(!0):c&&(n.updateMode(),n.repositionPopups()))};s||(e.on("activate",n.show),e.on("deactivate",n.hide)),e.on("SkinLoaded ResizeWindow",()=>n.update(!0)),e.on("NodeChange keydown",e=>{requestAnimationFrame(()=>i(e))}),e.on("ScrollWindow",()=>n.updateMode());const a=Qo();a.set(th(c.fromDom(e.getBody()),"load",e=>i(e.raw))),e.on("remove",()=>{a.clear()})},mN=(e,t)=>{m4(e,t.dialogUi.mothership)},fN=(e,t,n,s,o)=>{const{mainUi:a}=t,l=K(),u=c.fromDom(o.targetNode),i=dN(e,u,t,s,l),d=Cg(e);Ez(e);const r=()=>{if(l.isSet()){i.show();return}l.set(P.getHeader(a.outerContainer).getOrDie());const o=ed(e);m4(o,a.mothership),mN(o,t),Qh(e,t,n,s),P.setMenubar(a.outerContainer,Zp(e,n)),i.show(),hN(e,u,i,d),e.nodeChanged()};e.on("show",r),e.on("hide",i.hide),d||(e.on("focus",r),e.on("blur",i.hide)),e.on("init",()=>{(e.hasFocus()||d)&&r()}),Xv(e,t);const h={show:r,hide:i.hide,setEnabled:e=>{qa(t,!e)},isEnabled:()=>!v.isDisabled(a.outerContainer)};return{editorContainer:a.outerContainer.element.dom,api:h}};H7=Object.freeze({__proto__:null,render:fN});const gN=()=>{const e=K(),n=K(),t=K(),s=t=>{e.set(t)},o=(e,n)=>()=>t.get().bind(e=>n(e.outerContainer)).getOrDie(`Could not find ${e} element in OuterContainer`);return{dialogUi:e,popupUi:n,mainUi:t,getUiMotherships:()=>[...e.get().map(e=>e.mothership).toArray()],setupDialogUi:s,lazyGetInOuterOrDie:o}},vN="contexttoolbar-show",P7="contexttoolbar-hide",jN=e=>({hide:()=>T(e,dr()),getValue:()=>r.getValue(e)}),N7=(e,t)=>o(Kh,(n,s)=>{const o=e.get(n),i=jN(o);t.onAction(i,s.event.buttonApi)}),_N=(e,t,n)=>{const{primary:i,...s}=t.original,o=pn(X7({...s,type:"button",onAction:l}));return Sv(o,n,[N7(e,t)])},wN=(e,t,n)=>{const{primary:i,...s}=t.original,o=pn(J7({...s,type:"togglebutton",onAction:l}));return Tv(o,n,[N7(e,t)])},ON=e=>e.type==="contextformtogglebutton",xN=(e,t,n)=>ON(t)?wN(e,t,n):_N(e,t,n),CN=(t,n,s)=>{const o=a(n,e=>V(xN(t,e,s))),i=()=>a(o,e=>e.asSpec()),r=t=>En(n,(n,s)=>n.primary?e.from(o[s]).bind(e=>e.getOpt(t)).filter(ra(v.isDisabled)):e.none());return{asSpecs:i,findPrimary:r}},t7=(t,n)=>{const a=t.label.fold(()=>({}),e=>({"aria-label":e})),s=V(ni.sketch({inputClasses:["tox-toolbar-textfield","tox-toolbar-nav-js"],data:t.initValue(),inputAttributes:a,selectOnFocus:!0,inputBehaviours:i([u.config({mode:"special",onEnter:e=>o.findPrimary(e).map(e=>(mo(e),!0)),onLeft:(t,n)=>(n.cut(),e.none()),onRight:(t,n)=>(n.cut(),e.none())})])})),o=CN(s,t.commands,n);return[{title:e.none(),items:[s.asSpec()]},{title:e.none(),items:o.asSpecs()}]},kN=(t,n,s)=>mc({type:t,uid:d("context-toolbar"),initGroups:t7(n,s),onEscape:e.none,cyclicKeying:!0,providers:s}),AN={renderContextForm:kN,buildInitGroups:t7},N5=(e,t,n)=>t.bottom-e.y>=n&&e.bottom-t.y>=n,MN=t=>{const n=t.getBoundingClientRect();if(n.height<=0&&n.width<=0){const s=lp(c.fromDom(t.startContainer),t.startOffset).element,o=ro(s)?Rn(s):e.some(s);return o.filter(At).map(e=>e.dom.getBoundingClientRect()).getOr(n)}return n},Vl=e=>{const s=e.selection.getRng(),t=MN(s);if(e.inline){const e=Cn();return Be(e.left+t.left,e.top+t.top,t.width,t.height)}const n=Ps(c.fromDom(e.getBody()));return Be(n.x+t.left,n.y+t.top,t.width,t.height)},TN=(e,t)=>t.filter(e=>Xt(e)&&pV(e)).map(Ps).getOrThunk(()=>Vl(e)),zN=(e,t,n)=>{const s=Math.max(e.x+n,t.x),o=Math.min(e.right-n,t.right);return{x:s,width:o-s}},DN=(e,t,n,s,o,i)=>{const r=c.fromDom(e.getContainer()),u=be(r,".tox-editor-header").getOr(r),a=at(u),h=a.y>=t.bottom,l=s&&!h;if(e.inline&&l)return{y:Math.max(a.bottom+i,n.y),bottom:n.bottom};if(e.inline&&!l)return{y:n.y,bottom:Math.min(a.y-i,n.bottom)};const d=o==="line"?at(r):t;return l?{y:Math.max(a.bottom+i,n.y),bottom:Math.min(d.bottom-i,n.bottom)}:{y:Math.max(d.y+i,n.y),bottom:Math.min(a.y-i,n.bottom)}},b5=(e,t,n,s=0)=>{const o=xm(window),i=at(c.fromDom(e.getContentAreaContainer())),d=Sr(e)||Cr(e)||Ji(e),{x:a,width:r}=zN(i,o,s);if(e.inline&&!d)return Be(a,o.y,r,o.height);const u=t.header.isPositionedAtTop(),{y:l,bottom:h}=DN(e,i,o,u,n,s);return Be(a,l,r,h-l)},Dc=12,m5={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"],inset:["tox-pop--inset"]},e5={maxHeightFunction:Ea(),maxWidthFunction:Ru()},HN=(e,t)=>{const n=e.selection.getRng(),s=lp(c.fromDom(n.startContainer),n.startOffset);return n.startContainer===n.endContainer&&n.startOffset===n.endOffset-1&&Y(s.element,t)},IN=(e,t,n)=>{const s=Re(e,"position");y(e,"position",t);const o=n(e);return s.each(t=>y(e,"position",t)),o},Yg=e=>e==="node",VN=(e,t,n,s,o)=>{const i=Vl(e),a=s.lastElement().exists(e=>Y(n,e));if(HN(e,n))return a?W0:Pn;if(a)return IN(t,s.getMode(),()=>{const e=N5(i,at(t),-20);return e&&!s.isReposition()?Pk:W0});const r=s.getMode()==="fixed"?o.y+Cn().top:o.y,c=Ve(t)+Dc;return r+c<=i.y?Pn:Oi},$N=(e,t,n,s)=>{const i=t=>(s,o,i,a,r)=>{const c=VN(e,a,t,n,r),l={...s,y:r.y,height:r.height};return{...c(l,o,i,a,r),alwaysFit:!0}},o=e=>Yg(s)?[i(e)]:[],a={onLtr:e=>[pt,Ce,Qe,Ne,tt,Le].concat(o(e)),onRtl:e=>[pt,Ce,tt,Le,Qe,Ne].concat(o(e))},r={onLtr:e=>[Ce,Ne,Le,Qe,tt,pt].concat(o(e)),onRtl:e=>[Ce,Le,Ne,tt,Qe,pt].concat(o(e))};return t?r:a},WN=(e,t,n,s)=>t==="line"?{bubble:To(Dc,0,m5),layouts:{onLtr:()=>[pu],onRtl:()=>[gu]},overrides:e5}:{bubble:To(0,Dc,m5,1/Dc),layouts:$N(e,n,s,t),overrides:e5},ad=(e,t)=>{const n=q(t,t=>t.predicate(e.dom)),{pass:s,fail:o}=L7(n,e=>e.type==="contexttoolbar");return{contextToolbars:s,contextForms:o}},KN=e=>{if(e.length<=1)return e;const s=t=>vn(e,e=>e.position===t),t=t=>q(e,e=>e.position===t),n=s("selection"),o=s("node");if(n||o){if(o&&n){const e=t("node"),n=a(t("selection"),e=>({...e,position:"node"}));return e.concat(n)}return t(n?"selection":"node")}else return t("line")},qN=e=>{if(e.length<=1)return e;const t=t=>se(e,e=>e.position===t),n=t("selection").orThunk(()=>t("node")).orThunk(()=>t("line")).map(e=>e.position);return n.fold(()=>[],t=>q(e,e=>e.position===t))},YN=(t,n,s)=>{const o=ad(t,n);if(o.contextForms.length>0)return e.some({elem:t,toolbars:[o.contextForms[0]]});const i=ad(t,s);if(i.contextForms.length>0)return e.some({elem:t,toolbars:[i.contextForms[0]]});if(o.contextToolbars.length>0||i.contextToolbars.length>0){const n=KN(o.contextToolbars.concat(i.contextToolbars));return e.some({elem:t,toolbars:n})}return e.none()},GN=(t,n,s)=>t(n)?e.none():B2(n,t=>{if(At(t)){const{contextToolbars:i,contextForms:n}=ad(t,s.inNodeScope),o=n.length>0?n:qN(i);return o.length>0?e.some({elem:t,toolbars:o}):e.none()}return e.none()},t),XN=(t,n)=>{const o=c.fromDom(n.getBody()),i=e=>Y(e,o),a=e=>!i(e)&&!tc(o,e),s=c.fromDom(n.selection.getNode());return a(s)?e.none():YN(s,t.inNodeScope,t.inEditorScope).orThunk(()=>GN(i,s,t))},QN=(e,t)=>{const i={},n=[],s=[],a={},o={},r=(e,r)=>{const c=pn(Y9(r));i[e]=c,c.launch.map(n=>{a["form:"+e+""]={...r.launch,type:n.type==="contextformtogglebutton"?"togglebutton":"button",onAction:()=>{t(c)}}}),c.scope==="editor"?s.push(c):n.push(c),o[e]=c},c=(e,t)=>{K9(t).each(i=>{t.scope==="editor"?s.push(i):n.push(i),o[e]=i})},l=de(e);return h(l,t=>{const n=e[t];n.type==="contextform"?r(t,n):n.type==="contexttoolbar"&&c(t,n)}),{forms:i,inNodeScope:n,inEditorScope:s,lookupTable:o,formNavigators:a}},ug=d("forward-slide"),lg=d("backward-slide"),bd=d("change-slide-event"),Cd="tox-pop--resizing",nL=t=>{const n=g([]);return te.sketch({dom:{tag:"div",classes:["tox-pop"]},fireDismissalEventInstead:{event:"doNotDismissYet"},onShow:e=>{n.set([]),te.getContent(e).each(e=>{B(e.element,"visibility")}),ae(e.element,Cd),B(e.element,"width")},inlineBehaviours:i([O("context-toolbar-events",[So(Xi(),(e,t)=>{t.event.raw.propertyName==="width"&&(ae(e.element,Cd),B(e.element,"width"))}),o(bd,(e,t)=>{const n=e.element;B(n,"width");const s=et(n);te.setContent(e,t.event.contents),me(n,Cd);const o=et(n);y(n,"width",s+"px"),te.getContent(e).each(e=>{t.event.focus.bind(e=>(es(e),rn(n))).orThunk(()=>(u.focusIn(e),cs(Pt(n))))}),setTimeout(()=>{y(e.element,"width",o+"px")},0)}),o(ug,(t,s)=>{te.getContent(t).each(e=>{n.set(n.get().concat([{bar:e,focus:cs(Pt(t.element))}]))}),p(t,bd,{contents:s.event.forwardContents,focus:e.none()})}),o(lg,(e)=>{Cl(n.get()).each(t=>{n.set(n.get().slice(0,n.get().length-1)),p(e,bd,{contents:tn(t.bar),focus:t.focus})})})]),u.config({mode:"special",onEscape:s=>Cl(n.get()).fold(()=>t.onEscape(),t=>(T(s,lg),e.some(!0)))})]),lazySink:()=>_.value(t.sink)})},Ed="tox-pop--transition",oL=(t,n,s,o)=>{const w=o.backstage,m=w.shared,S=ho().deviceType.isTouch,h=K(),v=K(),b=K(),r=Ye(nL({sink:s,onEscape:()=>(t.focus(),e.some(!0))})),E=()=>{const e=b.get().getOr("node"),n=Yg(e)?1:0;return b5(t,m,e,n)},x=()=>!t.removed&&!(S()&&w.isContextMenuOpen()),M=e=>hn(rr(e,h.get(),Y),!0),_=()=>{if(x()){const e=E(),n=hn(b.get(),"node")?TN(t,h.get()):Vl(t);return e.height<=0||!N5(n,e,.01)}return!0},c=()=>{h.clear(),v.clear(),b.clear(),te.hide(r)},F=()=>{if(te.isOpen(r)){const e=r.element;B(e,"display"),_()?y(e,"display","none"):(v.set(0),te.reposition(r))}},C=e=>({dom:{tag:"div",classes:["tox-pop__dialog"]},components:[e],behaviours:i([u.config({mode:"acyclic"}),O("pop-dialog-wrap-events",[J(e=>{t.shortcuts.add("ctrl+F9","focus statusbar",()=>u.focusIn(e))}),Hn(e=>{t.shortcuts.remove("ctrl+F9")})])])}),j=hs(()=>QN(n,e=>{const t=k([e]);p(r,ug,{forwardContents:C(t)})})),T=(n,s)=>nc(t,{buttons:n,toolbar:s.items,allowToolbarGroups:!1},o.backstage,e.some(["form:"])),z=(e,t)=>AN.buildInitGroups(e,t),k=n=>{const{buttons:s}=t.ui.registry.getAll(),o=j(),i={...s,...o.formNavigators},r=Eo(t)===zt.scrolling?zt.scrolling:zt.default,c=Fe(a(n,e=>e.type==="contexttoolbar"?T(i,e):z(e,m.providers)));return mc({type:r,uid:d("context-toolbar"),initGroups:c,onEscape:e.none,cyclicKeying:!0,providers:m.providers})},D=(e,n)=>{const o=e==="node"?m.anchors.node(n):m.anchors.cursor(),i=WN(t,e,S(),{lastElement:h.get,isReposition:()=>hn(v.get(),0),getMode:()=>Ke.getMode(s)});return Q(o,i)},A=(t,n)=>{if(g.cancel(),!x())return;const a=k(t),i=t[0].position,c=D(i,n);b.set(i),v.set(1);const o=r.element;B(o,"display"),M(n)||(ae(o,Ed),Ke.reset(s,r)),te.showWithinBounds(r,C(a),{anchor:c,transition:{classes:[Ed],mode:"placement"}},()=>e.some(E())),n.fold(h.clear,h.set),_()&&y(o,"display","none")},g=R3(()=>{if(!t.hasFocus()||t.removed)return;if(mt(r.element,Ed))g.throttle();else{const n=j();XN(n,t).fold(c,t=>{A(t.toolbars,e.some(t.elem))})}},17);t.on("init",()=>{t.on("remove",c),t.on("ScrollContent ScrollWindow ObjectResized ResizeEditor longpress",F),t.on("click keyup focus SetContent",g.throttle),t.on(P7,c),t.on(vN,e=>{const n=j();f(n.lookupTable,e.toolbarKey).each(n=>{A([n],Ti(e.target!==t,e.target)),te.getContent(r).each(u.focusIn)})}),t.on("focusout",e=>{Ai.setEditorTimeout(t,()=>{rn(s.element).isNone()&&rn(r.element).isNone()&&c()},0)}),t.on("SwitchMode",()=>{t.mode.isReadOnly()&&c()}),t.on("AfterProgressState",e=>{e.state?c():t.hasFocus()&&g.throttle()}),t.on("NodeChange",e=>{rn(r.element).fold(g.throttle,l)})})},iL=e=>{const t=[{name:"alignleft",text:"Align left",cmd:"JustifyLeft",icon:"align-left"},{name:"aligncenter",text:"Align center",cmd:"JustifyCenter",icon:"align-center"},{name:"alignright",text:"Align right",cmd:"JustifyRight",icon:"align-right"},{name:"alignjustify",text:"Justify",cmd:"JustifyFull",icon:"align-justify"}];h(t,t=>{e.ui.registry.addToggleButton(t.name,{tooltip:t.text,icon:t.icon,onAction:Et(e,t.cmd),onSetup:kc(e,t.name)})}),e.ui.registry.addButton("alignnone",{tooltip:"No alignment",icon:"align-none",onAction:Et(e,"JustifyNone")})},aL={unsupportedLength:["em","ex","cap","ch","ic","rem","lh","rlh","vw","vh","vi","vb","vmin","vmax","cm","mm","Q","in","pc","pt","px"],fixed:["px","pt"],relative:["%"],empty:[""]},rL=(()=>{const e="[0-9]+",o="[+-]?"+e,n="[eE]"+o,s="\\.",t=e=>`(?:${e})?`,i=["Infinity",e+s+t(e)+t(n),s+e+t(n),e+t(n)].join("|"),a=`[+-]?(?:${i})`;return new RegExp(`^(${a})(.*)$`)})(),cL=(e,t)=>vn(t,t=>vn(aL[t],t=>e===t)),lL=(t,n)=>{const s=e.from(rL.exec(t));return s.bind(t=>{const o=Number(t[1]),s=t[2];return cL(s,n)?e.some({value:o,unit:s}):e.none()})},dL=(e,t)=>lL(e,t).map(({value:e,unit:t})=>e+t),Ip=(e,t)=>{const n=()=>{const s=t.getOptions(e),o=t.getCurrent(e).map(t.hash),n=K();return a(s,s=>({type:"togglemenuitem",text:t.display(s),onSetup:i=>{const a=e=>{e&&(n.on(e=>e.setActive(!1)),n.set(i)),i.setActive(e)};a(hn(o,t.hash(s)));const r=t.watcher(e,s,a);return()=>{n.clear(),r()}},onAction:()=>t.setCurrent(e,s)}))};e.ui.registry.addMenuButton(t.name,{tooltip:t.text,icon:t.icon,fetch:e=>e(n()),onSetup:t.onToolbarSetup}),e.ui.registry.addNestedMenuItem(t.name,{type:"nestedmenuitem",text:t.text,getSubmenuItems:n,onSetup:t.onMenuSetup})},hL={name:"lineheight",text:"Line height",icon:"line-height",getOptions:Kg,hash:e=>dL(e,["fixed","relative","empty"]).getOr(e),display:z,watcher:(e,t,n)=>e.formatter.formatChanged("lineheight",n,!1,{value:t}).unbind,getCurrent:t=>e.from(t.queryCommandValue("LineHeight")),setCurrent:(e,t)=>e.execCommand("LineHeight",!1,t)},mL=t=>{const s=e.from(bg(t));return s.map(s=>({name:"language",text:"Language",icon:"language",getOptions:n(s),hash:e=>ls(e.customCode)?e.code:`${e.code}/${e.customCode}`,display:e=>e.title,watcher:(e,t,n)=>{var s;return e.formatter.formatChanged("lang",n,!1,{value:t.code,customValue:(s=t.customCode)!==null&&s!==void 0?s:null}).unbind},getCurrent:t=>{const n=c.fromDom(t.selection.getNode());return q1(n,t=>e.some(t).filter(At).bind(e=>{const t=ut(e,"lang");return t.map(t=>{const n=ut(e,"data-mce-lang").getOrUndefined();return{code:t,customCode:n,title:""}})}))},setCurrent:(e,t)=>e.execCommand("Lang",!1,t),onToolbarSetup:e=>{const n=Qo();return e.setActive(t.formatter.match("lang",{},void 0,!0)),n.set(t.formatter.formatChanged("lang",e.setActive,!0)),n.clear}}))},fL=e=>{Ip(e,hL),mL(e).each(t=>Ip(e,t))},pL=(e,t)=>{Vz(e,t),Zz(e,t),lD(e,t),Kz(e,t),aD(e,t)},gL=e=>Ac(e,"NodeChange",t=>{t.setEnabled(e.queryCommandState("outdent"))}),vL=e=>{e.ui.registry.addButton("outdent",{tooltip:"Decrease indent",icon:"outdent",onSetup:gL(e),onAction:Et(e,"outdent")}),e.ui.registry.addButton("indent",{tooltip:"Increase indent",icon:"indent",onAction:Et(e,"indent")})},bL=e=>{vL(e)},zp=(e,t)=>n=>{n.setActive(t.get());const s=e=>{t.set(e.state),n.setActive(e.state)};return e.on("PastePlainTextToggle",s),()=>e.off("PastePlainTextToggle",s)},yL=e=>{const t=g(Ig(e)),n=()=>e.execCommand("mceTogglePlainTextPaste");e.ui.registry.addToggleButton("pastetext",{active:!1,icon:"paste-text",tooltip:"Paste as text",onAction:n,onSetup:zp(e,t)}),e.ui.registry.addToggleMenuItem("pastetext",{text:"Paste as text",icon:"paste-text",onAction:n,onSetup:zp(e,t)})},Fd=(e,t)=>()=>{e.execCommand("mceToggleFormat",!1,t)},wL=e=>{As.each([{name:"bold",text:"Bold",icon:"bold"},{name:"italic",text:"Italic",icon:"italic"},{name:"underline",text:"Underline",icon:"underline"},{name:"strikethrough",text:"Strikethrough",icon:"strike-through"},{name:"subscript",text:"Subscript",icon:"subscript"},{name:"superscript",text:"Superscript",icon:"superscript"}],(t)=>{e.ui.registry.addToggleButton(t.name,{tooltip:t.text,icon:t.icon,onSetup:kc(e,t.name),onAction:Fd(e,t.name)})});for(let t=1;t<=6;t++){const n="h"+t;e.ui.registry.addToggleButton(n,{text:n.toUpperCase(),tooltip:"Heading "+t,onSetup:kc(e,n),onAction:Fd(e,n)})}},OL=e=>{As.each([{name:"cut",text:"Cut",action:"Cut",icon:"cut"},{name:"copy",text:"Copy",action:"Copy",icon:"copy"},{name:"paste",text:"Paste",action:"Paste",icon:"paste"},{name:"help",text:"Help",action:"mceHelp",icon:"help"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all"},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document"},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting"},{name:"remove",text:"Remove",action:"Delete",icon:"remove"},{name:"print",text:"Print",action:"mcePrint",icon:"print"},{name:"hr",text:"Horizontal line",action:"InsertHorizontalRule",icon:"horizontal-rule"}],t=>{e.ui.registry.addButton(t.name,{tooltip:t.text,icon:t.icon,onAction:Et(e,t.action)})})},xL=e=>{As.each([{name:"blockquote",text:"Blockquote",action:"mceBlockQuote",icon:"quote"}],t=>{e.ui.registry.addToggleButton(t.name,{tooltip:t.text,icon:t.icon,onAction:Et(e,t.action),onSetup:kc(e,t.name)})})},CL=e=>{wL(e),OL(e),xL(e)},EL=e=>{As.each([{name:"bold",text:"Bold",action:"Bold",icon:"bold",shortcut:"Meta+B"},{name:"italic",text:"Italic",action:"Italic",icon:"italic",shortcut:"Meta+I"},{name:"underline",text:"Underline",action:"Underline",icon:"underline",shortcut:"Meta+U"},{name:"strikethrough",text:"Strikethrough",action:"Strikethrough",icon:"strike-through"},{name:"subscript",text:"Subscript",action:"Subscript",icon:"subscript"},{name:"superscript",text:"Superscript",action:"Superscript",icon:"superscript"},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting"},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document"},{name:"cut",text:"Cut",action:"Cut",icon:"cut",shortcut:"Meta+X"},{name:"copy",text:"Copy",action:"Copy",icon:"copy",shortcut:"Meta+C"},{name:"paste",text:"Paste",action:"Paste",icon:"paste",shortcut:"Meta+V"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all",shortcut:"Meta+A"},{name:"print",text:"Print...",action:"mcePrint",icon:"print",shortcut:"Meta+P"},{name:"hr",text:"Horizontal line",action:"InsertHorizontalRule",icon:"horizontal-rule"}],t=>{e.ui.registry.addMenuItem(t.name,{text:t.text,icon:t.icon,shortcut:t.shortcut,onAction:Et(e,t.action)})}),e.ui.registry.addMenuItem("codeformat",{text:"Code",icon:"sourcecode",onAction:Fd(e,"code")})},kL=e=>{CL(e),EL(e)},oc=(e,t)=>Ac(e,"Undo Redo AddUndo TypingUndo ClearUndos SwitchMode",n=>{n.setEnabled(!e.mode.isReadOnly()&&e.undoManager[t]())}),SL=e=>{e.ui.registry.addMenuItem("undo",{text:"Undo",icon:"undo",shortcut:"Meta+Z",onSetup:oc(e,"hasUndo"),onAction:Et(e,"undo")}),e.ui.registry.addMenuItem("redo",{text:"Redo",icon:"redo",shortcut:"Meta+Y",onSetup:oc(e,"hasRedo"),onAction:Et(e,"redo")})},ML=e=>{e.ui.registry.addButton("undo",{tooltip:"Undo",icon:"undo",enabled:!1,onSetup:oc(e,"hasUndo"),onAction:Et(e,"undo")}),e.ui.registry.addButton("redo",{tooltip:"Redo",icon:"redo",enabled:!1,onSetup:oc(e,"hasRedo"),onAction:Et(e,"redo")})},FL=e=>{SL(e),ML(e)},TL=e=>Ac(e,"VisualAid",t=>{t.setActive(e.hasVisual)}),zL=e=>{e.ui.registry.addToggleMenuItem("visualaid",{text:"Visual aids",onSetup:TL(e),onAction:Et(e,"mceToggleVisualAid")})},DL=e=>{e.ui.registry.addButton("visualaid",{tooltip:"Visual aids",text:"Visual aids",onAction:Et(e,"mceToggleVisualAid")})},NL=e=>{DL(e),zL(e)},LL=(e,t)=>{iL(e),kL(e),pL(e,t),FL(e),Gb(e),NL(e),bL(e),fL(e),yL(e)},RL=e=>L(e)?e.split(/[ ,]/):e,Mp=e=>t=>t.options.get(e),HL=e=>{const t=e.options.register;t("contextmenu_avoid_overlap",{processor:"string",default:""}),t("contextmenu_never_use_native",{processor:"boolean",default:!1}),t("contextmenu",{processor:e=>e===!1?{value:[],valid:!0}:L(e)||Hi(e,L)?{value:RL(e),valid:!0}:{valid:!1,message:"Must be false or a string."},default:"link linkchecker image editimage table spellchecker configurepermanentpen"})},Ep=Mp("contextmenu_never_use_native"),BL=Mp("contextmenu_avoid_overlap"),VL=e=>rp(e).length===0,rp=e=>{const n=e.ui.registry.getAll().contextMenus,t=e.options.get("contextmenu");return e.options.isSet("contextmenu")?t:q(t,e=>R(n,e))},yi=(e,t)=>({type:"makeshift",x:e,y:t}),UL=(e,t,n)=>yi(e.x+t,e.y+n),Q6=e=>e.type==="longpress"||e.type.indexOf("touch")===0,qL=e=>{if(Q6(e)){const t=e.touches[0];return yi(t.pageX,t.pageY)}return yi(e.pageX,e.pageY)},YL=e=>{if(Q6(e)){const t=e.touches[0];return yi(t.clientX,t.clientY)}return yi(e.clientX,e.clientY)},GL=(e,t)=>{const n=Do.DOM.getPos(e);return UL(t,n.x,n.y)},XL=(e,t)=>t.type==="contextmenu"||t.type==="longpress"?e.inline?qL(t):GL(e.getContentAreaContainer(),YL(t)):h6(e),h6=e=>({type:"selection",root:c.fromDom(e.selection.getNode())}),ZL=t=>({type:"node",node:e.some(c.fromDom(t.selection.getNode())),root:c.fromDom(t.getBody())}),Jf=(e,t,n)=>{switch(n){case"node":return ZL(e);case"point":return XL(e,t);case"selection":return h6(e)}},eR=(t,n,s,o,i,a)=>{const r=s(),c=Jf(t,n,a);Ro(r,Yt.CLOSE_ON_EXECUTE,o,{isHorizontalMenu:!1,search:e.none()}).map(e=>{n.preventDefault(),te.showMenuAt(i,{anchor:c},{menu:{markers:so("normal")},data:e})})},tR={onLtr:()=>[Ce,Ne,Le,Qe,tt,pt,Pn,Oi,ji,jr,gi,yr],onRtl:()=>[Ce,Le,Ne,tt,Qe,pt,Pn,Oi,gi,yr,ji,jr]},nR=12,sR={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"]},oR=(e,t)=>{const s=e.selection;if(s.isCollapsed()||t.touches.length<1)return!1;const n=t.touches[0],o=s.getRng(),i=d0(e.getWin(),la.domRange(o));return i.exists(e=>e.left<=n.clientX&&e.right>=n.clientX&&e.top<=n.clientY&&e.bottom>=n.clientY)},iR=e=>{const i=e.selection.getRng(),t=()=>{Ai.setEditorTimeout(e,()=>{e.selection.setRng(i)},10),o()};e.once("touchend",t);const n=e=>{e.preventDefault(),e.stopImmediatePropagation()};e.on("mousedown",n,!0);const s=()=>o();e.once("longpresscancel",s);const o=()=>{e.off("touchend",t),e.off("longpresscancel",s),e.off("mousedown",n)}},aR=(e,t,n)=>{const s=Jf(e,t,n),o=n==="point"?nR:0;return{bubble:To(0,o,sR),layouts:tR,overrides:{maxWidthFunction:Ru(),maxHeightFunction:Ea()},...s}},rR=(t,n,s,o,i,a,r)=>{const c=aR(t,n,a);Ro(s,Yt.CLOSE_ON_EXECUTE,o,{isHorizontalMenu:!0,search:e.none()}).map(s=>{n.preventDefault();const l=r?Ge.HighlightMenuAndItem:Ge.HighlightNone;te.showMenuWithinBounds(i,{anchor:c},{menu:{markers:so("normal"),highlightOnOpen:l},data:s,type:"horizontal"},()=>e.some(b5(t,o.shared,a==="node"?"node":"selection"))),t.dispatch(P7)})},cR=(e,t,n,s,o,i)=>{const a=ho(),r=a.os.isiOS(),c=a.os.isMacOS(),d=a.os.isAndroid(),u=a.deviceType.isTouch(),h=()=>!(d||r||c&&u),l=()=>{const a=n();rR(e,t,a,s,o,i,h())};if((c||r)&&i!=="node"){const n=()=>{iR(e),l()};oR(e,t)?n():(e.once("selectionchange",n),e.once("touchend",()=>e.off("selectionchange",n)))}else l()},Qf=e=>L(e)?e==="|":e.type==="separator",uu={type:"separator"},sf=e=>{const t=e=>({text:e.text,icon:e.icon,enabled:e.enabled,shortcut:e.shortcut});if(L(e))return e;switch(e.type){case"separator":return uu;case"submenu":return{type:"nestedmenuitem",...t(e),getSubmenuItems:()=>{const t=e.getSubmenuItems();return L(t)?t:a(t,sf)}};default:const n=e;return{type:"menuitem",...t(n),onAction:d$(n.onAction)}}},xh=(e,t)=>{if(t.length===0)return e;const n=Cl(e).filter(e=>!Qf(e)),s=n.fold(()=>[],e=>[uu]);return e.concat(s).concat(t).concat([uu])},mR=(e,t,n)=>{const s=He(t,(t,s)=>f(e,s.toLowerCase()).map(e=>{const s=e.update(n);if(L(s))return xh(t,s.split(" "));if(s.length>0){const e=a(s,sf);return xh(t,e)}return t}).getOrThunk(()=>t.concat([s])),[]);return s.length>0&&Qf(s[s.length-1])&&s.pop(),s},fR=(e,t)=>t.ctrlKey&&!Ep(e),pR=e=>e.type==="longpress"||R(e,"touches"),_h=(e,t)=>!pR(t)&&(t.button!==2||t.target===e.getBody()&&t.pointerType===""),ch=(e,t)=>_h(e,t)?e.selection.getStart(!0):t.target,bR=(e,t)=>{const n=BL(e),s=_h(e,t)?"selection":"point";if(Zl(n)){const o=ch(e,t),i=vi(c.fromDom(o),n);return i?"node":s}return s},jR=(e,t,n)=>{const r=ho(),s=r.deviceType.isTouch,a=Ye(te.sketch({dom:{tag:"div"},lazySink:t,onEscape:()=>e.focus(),onShow:()=>n.setContextMenuState(!0),onHide:()=>n.setContextMenuState(!1),fireDismissalEventInstead:{},inlineBehaviours:i([O("dismissContextMenu",[o(di(),(t)=>{k.close(t),e.focus()})])])})),c=()=>te.hide(a),l=t=>{if(Ep(e)&&t.preventDefault(),fR(e,t)||VL(e))return;const o=bR(e,t),i=()=>{const n=ch(e,t),s=e.ui.registry.getAll(),o=rp(e);return mR(s.contextMenus,o,n)},r=s()?cR:eR;r(e,t,i,n,a,o)};e.on("init",()=>{const t="ResizeEditor ScrollContent ScrollWindow longpresscancel"+(s()?"":" ResizeWindow");e.on(t,c),e.on("longpress contextmenu",l)})},w1=Lt.generate([{offset:["x","y"]},{absolute:["x","y"]},{fixed:["x","y"]}]),Ja=e=>t=>t.translate(-e.left,-e.top),Za=e=>t=>t.translate(e.left,e.top),$n=e=>(t,n)=>He(e,(e,t)=>t(e),Z(t,n)),Ka=(e,t,n)=>e.fold($n([Za(n),Ja(t)]),$n([Ja(t)]),$n([])),Lo=(e,t,n)=>e.fold($n([Za(n)]),$n([]),$n([Za(t)])),_3=(e,t,n)=>e.fold($n([]),$n([Ja(n)]),$n([Za(t),Ja(n)])),kR=(e,t,n,s,o,i)=>{const a=Lo(e,o,i),r=Lo(t,o,i);return Math.abs(a.left-r.left)<=n&&Math.abs(a.top-r.top)<=s},AR=(e,t,n,s,o,i)=>{const a=Lo(e,o,i),r=Lo(t,o,i),c=Math.abs(a.left-r.left),l=Math.abs(a.top-r.top);return Z(c,l)},b3=(t,n,s)=>{const o=t.fold((t,n)=>({position:e.some("absolute"),left:e.some(t+"px"),top:e.some(n+"px")}),(t,n)=>({position:e.some("absolute"),left:e.some(t-s.left+"px"),top:e.some(n-s.top+"px")}),(t,n)=>({position:e.some("fixed"),left:e.some(t+"px"),top:e.some(n+"px")}));return{right:e.none(),bottom:e.none(),...o}},MR=(e,t,n)=>e.fold((e,s)=>Va(e+t,s+n),(e,s)=>ws(e+t,s+n),(e,s)=>io(e+t,s+n)),W1=(e,t,n,s)=>{const o=(e,o)=>(i,a)=>{const r=e(t,n,s);return o(i.getOr(r.left),a.getOr(r.top))};return e.fold(o(_3,Va),o(Lo,ws),o(Ka,io))},Va=w1.offset,ws=w1.absolute,io=w1.fixed,P2=(e,t)=>{const n=De(e,t);return ls(n)?NaN:parseInt(n,10)},LR=(t,n)=>{const s=t.element,o=P2(s,n.leftAttr),i=P2(s,n.topAttr);return isNaN(o)||isNaN(i)?e.none():e.some(Z(o,i))},RR=(e,t,n)=>{const s=e.element;w(s,t.leftAttr,n.left+"px"),w(s,t.topAttr,n.top+"px")},PR=(e,t)=>{const n=e.element;pe(n,t.leftAttr),pe(n,t.topAttr)},HR=(e,t,n,s)=>LR(e,t).fold(()=>n,e=>io(e.left+s.left,e.top+s.top)),IR=(t,n,s,o,i,a)=>{const r=HR(t,n,s,o),l=n.mustSnap?$R(t,n,r,i,a):WR(t,n,r,i,a),c=Ka(r,i,a);return RR(t,n,c),l.fold(()=>({coord:io(c.left,c.top),extra:e.none()}),e=>({coord:e.output,extra:e.extra}))},BR=(e,t)=>{PR(e,t)},R2=(t,n,s,o)=>En(t,t=>{const i=t.sensor,a=kR(n,i,t.range.left,t.range.top,s,o);return a?e.some({output:W1(t.output,n,s,o),extra:t.extra}):e.none()}),$R=(t,n,s,o,i)=>{const a=n.getSnapPoints(t),r=R2(a,s,o,i);return r.orThunk(()=>{const t=He(a,(t,n)=>{const r=n.sensor,a=AR(s,r,n.range.left,n.range.top,o,i);return t.deltas.fold(()=>({deltas:e.some(a),snap:e.some(n)}),s=>{const o=(a.left+a.top)/2,i=(s.left+s.top)/2;return o<=i?{deltas:e.some(a),snap:e.some(n)}:t})},{deltas:e.none(),snap:e.none()});return t.snap.map(e=>({output:W1(e.output,s,o,i),extra:e.extra}))})},WR=(e,t,n,s,o)=>{const i=t.getSnapPoints(e);return R2(i,n,s,o)},UR=(e,t,n)=>({coord:W1(e.output,e.output,t,n),extra:e.extra}),KR=(e,t,n,s)=>{const o=t.getTarget(e.element);if(t.repositionTarget){const i=an(e.element),t=Cn(i),n=H4(o),a=UR(s,t,n),r=b3(a.coord,t,n);Zc(o,r)}};A2=Object.freeze({__proto__:null,snapTo:KR});const o4="data-initial-z-index",GR=e=>{Rn(e.element).filter(At).each(e=>{ut(e,o4).fold(()=>B(e,"z-index"),t=>y(e,"z-index",t)),pe(e,o4)})},XR=e=>{Rn(e.element).filter(At).each(t=>{Re(t,"z-index").each(e=>{w(t,o4,e)}),y(t,"z-index",ft(e.element,"z-index"))})},w2=(e,t)=>{e.getSystem().addToGui(t),XR(t)},ZR=e=>{GR(e),e.getSystem().removeFromGui(e)},X0=(e,t,n)=>e.getSystem().build(_n.sketch({dom:{styles:{left:"0px",top:"0px",width:"100%",height:"100%",position:"fixed","z-index":"1000000000000000"},classes:[t]},events:n}));G0=vt("snaps",[s("getSnapPoints"),E("onSensor"),s("leftAttr"),s("topAttr"),t("lazyViewport",Sn),t("mustSnap",!1)]);const C4=[t("useFixed",U),s("blockerClass"),t("getTarget",z),t("onDrag",l),t("repositionTarget",!0),t("onDrop",l),fe("getBounds",Sn),G0],nP=e=>VV(Re(e,"left"),Re(e,"top"),Re(e,"position"),(e,t,n)=>{const s=n==="fixed"?io:Va;return s(parseInt(e,10),parseInt(t,10))}).getOrThunk(()=>{const t=zs(e);return ws(t.left,t.top)}),sP=(e,t,s,o,i)=>{const a=i.bounds,c=Lo(t,s,o),l=Nt(c.left,a.x,a.x+a.width-i.width),d=Nt(c.top,a.y,a.y+a.height-i.height),r=ws(l,d);return t.fold(()=>{const e=_3(r,s,o);return Va(e.left,e.top)},n(r),()=>{const e=Ka(r,s,o);return io(e.left,e.top)})},oP=(e,t,n,s,o,i,a)=>{const r=t.fold(()=>{const t=MR(n,i.left,i.top),e=Ka(t,s,o);return io(e.left,e.top)},t=>{const a=IR(e,t,n,i,s,o);return a.extra.each(n=>{t.onSensor(e,n)}),a.coord});return sP(e,r,s,o,a)},iP=(e,t,n,s)=>{const o=t.getTarget(e.element);if(t.repositionTarget){const r=an(e.element),i=Cn(r),a=H4(o),c=nP(o),l=oP(e,t.snaps,c,i,a,s,n),d=b3(l,i,a);Zc(o,d)}t.onDrag(e,o,s)},W4=(e,t)=>({bounds:e.getBounds(),height:to(t.element),width:fa(t.element)}),_4=(e,t,n,s,o)=>{const i=n.update(s,o),a=n.getStartData().getOrThunk(()=>W4(t,e));i.each(n=>{iP(e,t,a,n)})},u0=(e,t,n,s)=>{t.each(ZR),n.snaps.each(t=>{BR(e,t)});const o=n.getTarget(e.element);s.reset(),n.onDrop(e,o)},j4=e=>(t,n)=>{const s=e=>{n.setStartData(W4(t,e))};return $([o(Xu(),e=>{n.getStartData().each(()=>s(e))}),...e(t,n,s)])},dP=e=>$([o(Kt(),e.forceDrop),o(x1(),e.drop),o(Ha(),(t,n)=>{e.move(n.event)}),o(A1(),e.delayDrop)]),uP=t=>e.from(Z(t.x,t.y)),hP=(e,t)=>Z(t.left-e.left,t.top-e.top);_0=Object.freeze({__proto__:null,getData:uP,getDelta:hP});const Q0=(t,n,s)=>[o(Kt(),(o,i)=>{const l=i.event.raw;if(l.button!==0)return;i.stop();const a=()=>u0(o,e.some(c),t,n),r=Cp(a,200),d={drop:a,delayDrop:r.schedule,forceDrop:a,move:e=>{r.cancel(),_4(o,t,n,_0,e)}},c=X0(o,t.blockerClass,dP(d)),u=()=>{s(o),w2(o,c)};u()})],pP=[...C4,W("dragger",{handlers:j4(Q0)})],gP=e=>$([o(ds(),e.forceDrop),o(Ki(),e.drop),o(w3(),e.drop),o(Na(),(t,n)=>{e.move(n.event)})]),vP=t=>{const n=t[0];return e.some(Z(n.clientX,n.clientY))},bP=t=>{const s=t.raw,n=s.touches;return n.length===1?vP(n):e.none()},jP=(e,t)=>Z(t.left-e.left,t.top-e.top);p4=Object.freeze({__proto__:null,getData:bP,getDelta:jP});const s2=(e,t,n)=>{const s=K(),i=n=>{u0(n,s.get(),e,t),s.clear()};return[o(ds(),(o,a)=>{a.stop();const r=()=>i(o),d={drop:r,delayDrop:l,forceDrop:r,move:n=>{_4(o,e,t,p4,n)}},c=X0(o,e.blockerClass,gP(d));s.set(c);const u=()=>{n(o),w2(o,c)};u()}),o(Na(),(n,s)=>{s.stop(),_4(n,e,t,p4,s.event)}),o(Ki(),(e,t)=>{t.stop(),i(e)}),o(w3(),i)]},wP=[...C4,W("dragger",{handlers:j4(s2)})],OP=(e,t,n)=>[...Q0(e,t,n),...s2(e,t,n)],xP=[...C4,W("dragger",{handlers:j4(OP)})],CP=pP,EP=wP,kP=xP;o2=Object.freeze({__proto__:null,mouse:CP,touch:EP,mouseOrTouch:kP});const SP=()=>{let t=e.none(),s=e.none();const o=()=>{t=e.none(),s=e.none()},i=(n,s)=>{const o=t.map(e=>n.getDelta(e,s));return t=e.some(s),o},a=(e,t)=>e.getData(t).bind(t=>i(e,t)),r=t=>{s=e.some(t)},c=()=>s,l=n({});return jt({readState:l,reset:o,update:a,getStartData:c,setStartData:r})};i2=Object.freeze({__proto__:null,init:SP});const $s=Em({branchKey:"mode",branches:o2,name:"dragging",active:{events:(e,t)=>{const n=e.dragger;return n.handlers(e,t)}},extra:{snap:t=>({sensor:t.sensor,range:t.range,output:t.output,extra:e.from(t.extra)})},state:i2,apis:A2}),l4=40,Or=l4/2,D2=(t,n,s,o,i,a)=>t.fold(()=>$s.snap({sensor:ws(s-Or,o-Or),range:Z(i,a),output:ws(e.some(s),e.some(o)),extra:{td:n}}),t=>{const a=s-Or,r=o-Or,c=l4,l=l4,i=t.element.dom.getBoundingClientRect();return $s.snap({sensor:ws(a,r),range:Z(c,l),output:ws(e.some(s-i.width/2),e.some(o-i.height/2)),extra:{td:n}})}),N2=(e,t,n)=>{const s=(e,t)=>e.exists(e=>Y(e,t));return{getSnapPoints:e,leftAttr:"data-drag-left",topAttr:"data-drag-top",onSensor:(e,o)=>{const i=o.td;s(t.get(),i)||(t.set(i),n(i))},mustSnap:!0}},$2=e=>V(nt.sketch({dom:{tag:"div",classes:["tox-selector"]},buttonBehaviours:i([$s.config({mode:"mouseOrTouch",blockerClass:"blocker",snaps:e}),ya.config({})]),eventOrder:{mousedown:["dragging","alloy.base.behaviour"],touchstart:["dragging","alloy.base.behaviour"]}})),RP=(e,t)=>{const f=g([]),b=g([]),o=g(!1),n=K(),s=K(),d=e=>{const n=Ps(e);return D2(p.getOpt(t),e,n.x,n.y,n.width,n.height)},C=()=>a(f.get(),e=>d(e)),u=e=>{const n=Ps(e);return D2(v.getOpt(t),e,n.right,n.bottom,n.width,n.height)},O=()=>a(b.get(),e=>u(e)),w=N2(C,n,t=>{s.get().each(n=>{e.dispatch("TableSelectorChange",{start:t,finish:n})})}),j=N2(O,s,t=>{n.get().each(n=>{e.dispatch("TableSelectorChange",{start:n,finish:t})})}),p=$2(w),v=$2(j),r=Ye(p.asSpec()),i=Ye(v.asSpec()),_=(t,n,s,o)=>{const i=n.dom.getBoundingClientRect();B(t.element,"display");const a=bi(c.fromDom(e.getBody())).dom.innerHeight,r=s(i),l=o(i,a);(r||l)&&y(t.element,"display","none")},m=(e,t,n,s)=>{const o=n(t);$s.snapTo(e,o);const i=e=>e[s]<0,a=(e,t)=>e[s]>t;_(e,t,i,a)},h=e=>m(r,e,d,"top"),x=()=>n.get().each(h),l=e=>m(i,e,u,"bottom"),E=()=>s.get().each(l);ho().deviceType.isTouch()&&(e.on("TableSelectionChange",e=>{o.get()||(Us(t,r),Us(t,i),o.set(!0)),n.set(e.start),s.set(e.finish),e.otherCells.each(t=>{f.set(t.upOrLeftCells),b.set(t.downOrRightCells),h(e.start),l(e.finish)})}),e.on("ResizeEditor ResizeWindow ScrollContent",()=>{x(),E()}),e.on("TableSelectionClear",()=>{o.get()&&(Yn(r),Yn(i),o.set(!1)),n.clear(),s.clear()}))};Z2=`<svg width="50px" height="16px" viewBox="0 0 50 16" xmlns="http://www.w3.org/2000/svg">
  <path fill-rule="evenodd" clip-rule="evenodd" d="M10.143 0c2.608.015 5.186 2.178 5.186 5.331 0 0 .077 3.812-.084 4.87-.361 2.41-2.164 4.074-4.65 4.496-1.453.284-2.523.49-3.212.623-.373.071-.634.122-.785.152-.184.038-.997.145-1.35.145-2.732 0-5.21-2.04-5.248-5.33 0 0 0-3.514.03-4.442.093-2.4 1.758-4.342 4.926-4.963 0 0 3.875-.752 4.036-.782.368-.07.775-.1 1.15-.1Zm1.826 2.8L5.83 3.989v2.393l-2.455.475v5.968l6.137-1.189V9.243l2.456-.476V2.8ZM5.83 6.382l3.682-.713v3.574l-3.682.713V6.382Zm27.173-1.64-.084-1.066h-2.226v9.132h2.456V7.743c-.008-1.151.998-2.064 2.149-2.072 1.15-.008 1.987.92 1.995 2.072v5.065h2.455V7.359c-.015-2.18-1.657-3.929-3.837-3.913a3.993 3.993 0 0 0-2.908 1.296Zm-6.3-4.266L29.16 0v2.387l-2.456.475V.476Zm0 3.2v9.132h2.456V3.676h-2.456Zm18.179 11.787L49.11 3.676H46.58l-1.612 4.527-.46 1.382-.384-1.382-1.611-4.527H39.98l3.3 9.132L42.15 16l2.732-.537ZM22.867 9.738c0 .752.568 1.075.921 1.075.353 0 .668-.047.998-.154l.537 1.765c-.23.154-.92.537-2.225.537-1.305 0-2.655-.997-2.686-2.686a136.877 136.877 0 0 1 0-4.374H18.8V3.676h1.612v-1.98l2.455-.476v2.456h2.302V5.9h-2.302v3.837Z"/>
</svg>
`;const HP=e=>e.nodeName==="BR"||!!e.getAttribute("data-mce-bogus")||e.getAttribute("data-mce-type")==="bookmark",IP=(e,t,n)=>{var s;const o=(s=t.delimiter)!==null&&s!==void 0?s:"›",a=(t,s,o)=>nt.sketch({dom:{tag:"div",classes:["tox-statusbar__path-item"],attributes:{"data-index":o,"aria-level":o+1}},components:[je(t)],action:t=>{e.focus(),e.selection.select(s),e.nodeChanged()},buttonBehaviours:i([on.button(n.isDisabled),re()])}),r=()=>({dom:{tag:"div",classes:["tox-statusbar__path-divider"],attributes:{"aria-hidden":!0}},components:[je(` ${o} `)]}),c=e=>He(e,(e,t,n)=>{const s=a(t.name,t.element,n);return n===0?e.concat([s]):e.concat([r(),s])},[]),l=t=>{const n=[];let s=t.length;for(;s-- >0;){const o=t[s];if(o.nodeType===1&&!HP(o)){const t=hb(e,o);if(t.isDefaultPrevented()||n.push({name:t.name,element:o}),t.isPropagationStopped())break}}return n};return{dom:{tag:"div",classes:["tox-statusbar__path"],attributes:{role:"navigation"}},behaviours:i([u.config({mode:"flow",selector:"div[role=button]"}),v.config({disabled:n.isDisabled}),re(),ee.config({}),j.config({}),O("elementPathEvents",[J((t)=>{e.shortcuts.add("alt+F11","focus statusbar elementpath",()=>u.focusIn(t)),e.on("NodeChange",e=>{const n=l(e.parents),s=n.length>0?c(n):[];j.set(t,s)})})])]),components:[]}};(function(e){e[e.None=0]="None",e[e.Both=1]="Both",e[e.Vertical=2]="Vertical"})(co||(co={}));const VP=(e,t,n,s,o)=>{const i={height:Gc(s+t.top,ld(e),cd(e))};return n===co.Both&&(i.width=Gc(o+t.left,dd(e),Kr(e))),i},g3=(e,t,n)=>{const s=c.fromDom(e.getContainer()),o=VP(e,t,n,Ve(s),et(s));Ie(o,(e,t)=>{gs(e)&&y(s,t,hl(e))}),rb(e)},WP=e=>{const t=Hg(e);return t===!1?co.None:t==="both"?co.Both:co.Vertical},kr=(t,n,s,o)=>{const i=20,a=Z(s*i,o*i);return g3(t,a,n),e.some(!0)},KP=(t,n)=>{const s=WP(t);return s===co.None?e.none():e.some(fn("resize-handle",{tag:"div",classes:["tox-statusbar__resize-handle"],attributes:{title:n.translate("Resize")},behaviours:[$s.config({mode:"mouse",repositionTarget:!1,onDrag:(e,n,o)=>g3(t,o,s),blockerClass:"tox-blocker"}),u.config({mode:"special",onLeft:()=>kr(t,s,-1,0),onRight:()=>kr(t,s,1,0),onUp:()=>kr(t,s,0,-1),onDown:()=>kr(t,s,0,1)}),ee.config({}),b.config({})]},n.icons))},qP=(e,t)=>{const n=(e,n,s)=>j.set(e,[je(t.translate(["{0} "+s,n[s]]))]);return nt.sketch({dom:{tag:"button",classes:["tox-statusbar__wordcount"]},components:[],buttonBehaviours:i([on.button(t.isDisabled),re(),ee.config({}),j.config({}),r.config({store:{mode:"memory",initialValue:{mode:"words",count:{words:0,characters:0}}}}),O("wordcount-events",[Jn(e=>{const t=r.getValue(e),s=t.mode==="words"?"characters":"words";r.setValue(e,{mode:s,count:t.count}),n(e,t.count,s)}),J(t=>{e.on("wordCountUpdate",e=>{const{mode:s}=r.getValue(t);r.setValue(t,{mode:s,count:e.wordCount}),n(t,e.wordCount,s)})})])]),eventOrder:{[bt()]:["disabling","alloy.base.behaviour","wordcount-events"]}})},YP=(e,t)=>{const n=()=>({dom:{tag:"span",classes:["tox-statusbar__branding"]},components:[{dom:{tag:"a",attributes:{href:"https://www.tiny.cloud/powered-by-tiny?utm_campaign=editor_referral&utm_medium=poweredby&utm_source=tinymce&utm_content=v6",rel:"noopener",target:"_blank","aria-label":Ft.translate(["Powered by {0}","Tiny"])},innerHtml:Z2.trim()},behaviours:i([b.config({})])}]}),s=()=>{const s=[];return Rg(e)&&s.push(IP(e,{},t)),e.hasPlugin("wordcount")&&s.push(qP(e,t)),Pg(e)&&s.push(n()),s.length>0?[{dom:{tag:"div",classes:["tox-statusbar__text-container"]},components:s}]:[]},o=()=>{const n=s(),o=KP(e,t);return n.concat(o.toArray())};return{dom:{tag:"div",classes:["tox-statusbar"]},components:o()}},v3=(e,t)=>t.get().getOrDie(`UI for ${e} has not been rendered`),XP=t=>{const a=t.inline,g=a?H7:Dv,h=zi(t)?U2:B4,s=gN(),w=K(),c=K(),j=ho(),b=j.deviceType.isTouch(),k="tox-platform-touch",f=b?[k]:[],r=td(t),d=Eo(t),m=V({dom:{tag:"div",classes:["tox-anchorbar"]}}),l=()=>s.mainUi.get().map(e=>e.outerContainer).bind(P.getHeader),p=()=>_.fromOption(s.dialogUi.get().map(e=>e.sink),"UI has not been rendered"),O=()=>_.fromOption(s.popupUi.get().map(e=>e.sink),"(popup) UI has not been rendered"),x=s.lazyGetInOuterOrDie("anchor bar",m.getOpt),C=s.lazyGetInOuterOrDie("toolbar",P.getToolbar),E=s.lazyGetInOuterOrDie("throbber",P.getThrobber),n=nS({popup:O,dialog:p},t,x),A=()=>{const e={attributes:{[n4]:r?rs.BottomToTop:rs.TopToBottom}},s=P.parts.menubar({dom:{tag:"div",classes:["tox-menubar"]},backstage:n.popup,onEscape:()=>{t.focus()}}),c=P.parts.toolbar({dom:{tag:"div",classes:["tox-toolbar"]},getSink:n.popup.shared.getSink,providers:n.popup.shared.providers,onEscape:()=>{t.focus()},onToolbarToggled:e=>{mb(t,e)},type:d,lazyToolbar:C,lazyHeader:()=>l().getOrDie("Could not find header element"),...e}),u=P.parts["multiple-toolbar"]({dom:{tag:"div",classes:["tox-toolbar-overlord"]},providers:n.popup.shared.providers,onEscape:()=>{t.focus()},type:d}),o=Ji(t),i=Cr(t),a=Sr(t),h=Vg(t),f=S(),p=o||i||a,g=()=>o?[u]:i?[c]:[],v=h?[f,s]:[s];return P.parts.header({dom:{tag:"div",classes:["tox-editor-header"].concat(p?[]:["tox-editor-header--empty"]),...e},components:Fe([a?v:[],g(),Bi(t)?[]:[m.asSpec()]]),sticky:zi(t),editor:t,sharedBackstage:n.popup.shared})},S=()=>P.parts.promotion({dom:{tag:"div",classes:["tox-promotion"]}}),M=()=>{const e=P.parts.socket({dom:{tag:"div",classes:["tox-edit-area"]}}),t=P.parts.sidebar({dom:{tag:"div",classes:["tox-sidebar"]}});return{dom:{tag:"div",classes:["tox-sidebar-wrap"]},components:[e,t]}},F=()=>{const e=ed(t),a=Y(Un(),e)&&ft(e,"display")==="grid",r={dom:{tag:"div",classes:["tox","tox-silver-sink","tox-tinymce-aux"].concat(f),attributes:{...Ft.isRtl()?{dir:"rtl"}:{}}},behaviours:i([Ke.config({useFixed:()=>h.isDocked(l)})])},d={dom:{styles:{width:document.body.clientWidth+"px"}},events:$([o(gr(),e=>{y(e.element,"width",document.body.clientWidth+"px")})])},n=Ye(Q(r,a?d:{})),s=cp(n);return c.set(s),{sink:n,mothership:s}},T=z,D=()=>{const s=A(),d=M(),h=P.parts.throbber({dom:{tag:"div",classes:["tox-throbber"]},backstage:n.popup}),m=P.parts.viewWrapper({backstage:n.popup}),p=Lg(t)&&!a?e.some(YP(t,n.popup.shared.providers)):e.none(),g=Fe([r?[]:[s],a?[]:[d],r?[s]:[]]),b=P.parts.editorContainer({components:Fe([g,a?[]:p.toArray()])}),o=Jl(t),j={role:"application",...Ft.isRtl()?{dir:"rtl"}:{},...o?{"aria-hidden":"true"}:{}},c=Ye(P.sketch({dom:{tag:"div",classes:["tox","tox-tinymce"].concat(a?["tox-tinymce-inline"]:[]).concat(r?["tox-tinymce--toolbar-bottom"]:[]).concat(f),styles:{visibility:"hidden",...o?{opacity:"0",border:"0"}:{}},attributes:j},components:[b,...a?[]:[m],h],behaviours:i([re(),v.config({disableClass:"tox-tinymce--disabled"}),u.config({mode:"cyclic",selector:".tox-menubar, .tox-toolbar, .tox-toolbar__primary, .tox-toolbar__overflow--open, .tox-sidebar__overflow--open, .tox-statusbar__path, .tox-statusbar__wordcount, .tox-statusbar__branding a, .tox-statusbar__resize-handle"})])})),l=cp(c);return w.set(l),{mothership:l,outerContainer:c}},N=e=>{const n=hl(iN(t)),s=hl(rN(t));return t.inline||(b6("div","width",s)&&y(e.element,"width",s),b6("div","height",n)?y(e.element,"height",n):y(e.element,"height","400px")),n},L=e=>{t.addShortcut("alt+F9","focus menubar",()=>{P.focusMenubar(e)}),t.addShortcut("alt+F10","focus toolbar",()=>{P.focusToolbar(e)}),t.addCommand("ToggleToolbarDrawer",()=>{P.toggleToolbarDrawer(e)}),t.addQueryStateHandler("ToggleToolbarDrawer",()=>P.isToolbarDrawerToggled(e))},R=e=>{const{mainUi:s,popupUi:o,uiMotherships:i}=e;_e(_g(t),(e,n)=>{t.ui.registry.addGroupToolbarButton(n,e)});const{buttons:a,menuItems:r,contextToolbars:c,sidebars:u,views:m}=t.ui.registry.getAll(),f=nd(t),p={menuItems:r,menus:n5(t),menubar:kg(t),toolbar:f.getOrThunk(()=>Mr(t)),allowToolbarGroups:d===zt.floating,buttons:a,sidebar:u,views:m};L(s.outerContainer),sS(t,s.mothership,i),h.setup(t,n.popup.shared,l),LL(t,n.popup),jR(t,n.popup.shared.getSink,n.popup),fF(t),BF(t,E,n.popup.shared),oL(t,c,o.sink,{backstage:n.popup}),RP(t,o.sink);const v=t.getElement(),b=N(s.outerContainer),j={targetNode:v,height:b};return g.render(t,e,p,n.popup,j)},H=()=>{const t=D(),e=F(),n=T(e);s.dialogUi.set(e),s.popupUi.set(n),s.mainUi.set(t);const o={popupUi:n,dialogUi:e,mainUi:t,uiMotherships:s.getUiMotherships()};return R(o)};return{popups:{backstage:n.popup,getMothership:()=>v3("popups",c)},dialogs:{backstage:n.dialog,getMothership:()=>v3("dialogs",c)},renderUI:H}},QP=(t,n)=>{const s=e.from(De(t,"id")).fold(()=>{const e=d("dialog-describe");return w(n,"id",e),e},z);w(t,"aria-describedby",s)},ZP=(e,t)=>{const n=ut(e,"id").fold(()=>{const e=d("dialog-label");return w(t,"id",e),e},z);w(e,"aria-labelledby",n)},JP=n([s("lazySink"),D("dragBlockClass"),fe("getBounds",Sn),t("useTabstopAt",ye),t("eventOrder",{}),ve("modalBehaviours",[u]),rt("onExecute"),Td("onEscape")]),V1={sketch:z},tH=n([Dt({name:"draghandle",overrides:(e,t)=>({behaviours:i([$s.config({mode:"mouse",getTarget:e=>Cc(e,'[role="dialog"]').getOr(e),blockerClass:e.dragBlockClass.getOrDie(new Error(`The drag blocker class was not specified for a dialog with a drag handle: 
`+JSON.stringify(t,null,2)).message),getBounds:e.getDragBounds})])})}),Pe({schema:[s("dom")],name:"title"}),Pe({factory:V1,schema:[s("dom")],name:"close"}),Pe({factory:V1,schema:[s("dom")],name:"body"}),Dt({factory:V1,schema:[s("dom")],name:"footer"}),Wt({factory:{sketch:(e,t)=>({...e,dom:t.dom,components:t.components})},schema:[t("dom",{tag:"div",styles:{position:"fixed",left:"0px",top:"0px",right:"0px",bottom:"0px"}}),t("components",[])],name:"blocker"})]),nH=(e,t,n,s)=>{const o=K(),r=t=>{o.set(t);const n=e.lazySink(t).getOrDie(),a=s.blocker(),r=n.getSystem().build({...a,components:a.components.concat([tn(t)]),behaviours:i([b.config({}),O("dialog-blocker-events",[So(Cs(),()=>{u.focusIn(t)})])])});Us(n,r),u.focusIn(t)},c=e=>{o.clear(),Rn(e.element).each(t=>{e.getSystem().getByDom(t).each(e=>{Yn(e)})})},l=t=>Ln(t,e,"body"),h=t=>Ln(t,e,"footer"),m=(e,t)=>{Xn.block(e,t)},f=e=>{Xn.unblock(e)},a=d("modal-events"),p={...e.eventOrder,[no()]:[a].concat(e.eventOrder["alloy.system.attached"]||[])};return{uid:e.uid,dom:e.dom,components:t,apis:{show:r,hide:c,getBody:l,getFooter:h,setIdle:f,setBusy:m},eventOrder:p,domModification:{attributes:{role:"dialog","aria-modal":"true"}},behaviours:we(e.modalBehaviours,[j.config({}),u.config({mode:"cyclic",onEnter:e.onExecute,onEscape:e.onEscape,useTabstopAt:e.useTabstopAt}),Xn.config({getRoot:o.get}),O(a,[J(t=>{ZP(t.element,Ln(t,e,"title").element),QP(t.element,Ln(t,e,"body").element)})])])}},ce=We({name:"ModalDialog",configFields:JP(),partFields:tH(),factory:nH,apis:{show:(e,t)=>{e.show(t)},hide:(e,t)=>{e.hide(t)},getBody:(e,t)=>e.getBody(t),getFooter:(e,t)=>e.getFooter(t),setBusy:(e,t,n)=>{e.setBusy(t,n)},setIdle:(e,t)=>{e.setIdle(t)}}}),oH=m([ne,Tl].concat(zo)),iH=pi,j3=[bl("button"),jn,Kn("align","end",["start","end"]),Er,Gt,J4("buttonType",["primary","secondary"])],T3=[...j3,us],L1=[Pi("type",["submit","cancel","custom"]),...T3],lH=[Pi("type",["menu"]),Io,Ba,jn,xt("items",oH),...j3],dH=yt("type",{submit:L1,cancel:L1,custom:L1,menu:lH}),uH=[ne,us,Pi("level",["info","warn","error","success"]),j7,t("url","")],hH=m(uH),mH=e=>[ne,e],fH=[ne,us,Gt,bl("button"),jn,yb,J4("buttonType",["primary","secondary","toolbar"]),Er],pH=m(fH),No=[ne,Tl],dn=No.concat([xl]),bH=No.concat([Fl,Gt]),jH=m(bH),yH=pi,_H=dn.concat([R7("auto")]),wH=m(_H),OH=d4([ea,us,j7]),xH=dn.concat([qn("storageKey","default")]),CH=m(xH),EH=Ae,kH=dn,AH=m(kH),SH=Ae,MH=No.concat([qn("tag","textarea"),he("scriptId"),he("scriptUrl"),aP("settings",void 0)]),FH=No.concat([qn("tag","textarea"),Ht("init")]),TH=wi(e=>X("customeditor.old",wt(FH),e).orThunk(()=>X("customeditor.new",wt(MH),e))),zH=Ae,DH=dn,NH=m(DH),LH=_P(),RH=e=>[ne,mP("columns"),e],PH=[ne,he("html"),Kn("presets","presentation",["presentation","document"])],HH=m(PH),IH=dn.concat([ht("sandboxed",!0),ht("transparent",!0)]),BH=m(IH),VH=Ae,$H=m(No.concat([ct("height")])),WH=m([he("url"),qi("zoom"),qi("cachedWidth"),qi("cachedHeight")]),UH=dn.concat([ct("inputMode"),ct("placeholder"),ht("maximized",!1),Gt]),KH=m(UH),qH=Ae,YH=e=>[ne,Fl,e],GH=[us,ea],XH=[us,xt("items",fP("items",()=>G3))],G3=t4([m(GH),m(XH)]),ZH=dn.concat([xt("items",G3),Gt]),JH=m(ZH),eI=Ae,tI=dn.concat([s0("items",[us,ea]),w4("size",1),Gt]),nI=m(tI),sI=Ae,oI=dn.concat([ht("constrain",!0),Gt]),iI=m(oI),X3=m([he("width"),he("height")]),rI=No.concat([Fl,w4("min",0),w4("max",0)]),cI=m(rI),lI=vr,dI=[ne,xt("header",Ae),xt("cells",Ss(Ae))],uI=m(dI),hI=dn.concat([ct("placeholder"),ht("maximized",!1),Gt]),mI=m(hI),fI=Ae,pI=dn.concat([Kn("filetype","file",["image","media","file"]),Gt]),gI=m(pI),vI=m([ea,_l]),C1=e=>Me("items","items",ln(),Ss(wi(t=>X(`Checking item of ${e}`,h1,t).fold(e=>_.error(oi(e)),e=>_.value(e))))),h1=z2(()=>fr("type",{alertbanner:hH,bar:m(mH(C1("bar"))),button:pH,checkbox:jH,colorinput:CH,colorpicker:AH,dropzone:NH,grid:m(RH(C1("grid"))),iframe:BH,input:KH,listbox:JH,selectbox:nI,sizeinput:iI,slider:cI,textarea:mI,urlinput:gI,customeditor:TH,htmlpanel:HH,imagepreview:$H,collection:wH,label:m(YH(C1("label"))),table:uI,panel:Ch})),yI=[ne,t("classes",[]),xt("items",h1)],Ch=m(yI),wI=[bl("tab"),Mb,xt("items",h1)],OI=[ne,s0("tabs",wI)],xI=m(OI),CI=T3,EI=dH,kI=m([he("title"),Ot("body",fr("type",{panel:Ch,tabpanel:xI})),qn("size","normal"),xt("buttons",EI),t("initialData",{}),fe("onAction",l),fe("onChange",l),fe("onSubmit",l),fe("onClose",l),fe("onCancel",l),fe("onTabChange",l)]),AI=e=>X("dialog",kI,e),SI=m([Pi("type",["cancel","custom"]),...CI]),MI=m([he("title"),he("url"),qi("height"),qi("width"),Q4("buttons",SI),fe("onAction",l),fe("onCancel",l),fe("onClose",l),fe("onMessage",l)]),FI=e=>X("dialog",MI,e),i1=e=>Os(e)?[e].concat(le(Nl(e),i1)):bs(e)?le(e,i1):[],zI=e=>L(e.type)&&L(e.name),DI={checkbox:yH,colorinput:EH,colorpicker:SH,dropzone:LH,input:qH,iframe:VH,imagepreview:WH,selectbox:sI,sizeinput:X3,slider:lI,listbox:eI,size:X3,textarea:fI,urlinput:vI,customeditor:zH,collection:OH,togglemenuitem:iH},NI=t=>e.from(DI[t.type]),LI=e=>q(i1(e),zI),RI=e=>{const t=LI(e),n=le(t,e=>NI(e).fold(()=>[],t=>[Ot(e.name,t)]));return m(n)},zh=e=>{var t;const n=pn(AI(e)),s=RI(e),o=(t=e.initialData)!==null&&t!==void 0?t:{};return{internalDialog:n,dataValidator:s,initialData:o}},ia={open:(e,t)=>{const n=zh(t);return e(n.internalDialog,n.initialData,n.dataValidator)},openUrl:(e,t)=>{const n=pn(FI(t));return e(n)},redial:e=>zh(e)},Rh=e=>{const t=[],n={};return Ie(e,(e,s)=>{e.fold(()=>{t.push(s)},e=>{n[s]=e})}),t.length>0?_.error(t):_.value(n)},BI=(e,t,n)=>{const s=V(li.sketch(s=>({dom:{tag:"div",classes:["tox-form"].concat(e.classes)},components:a(e.items,e=>H2(s,e,t,n))})));return{dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[s.asSpec()]}],behaviours:i([u.config({mode:"acyclic",useTabstopAt:ra(na)}),nn.memento(s),Ct.memento(s,{postprocess:e=>Rh(e).fold(e=>(console.error(e),{}),z)})])}},VI=(e)=>({uid:e.uid,dom:e.dom,components:e.components,events:Jc(e.action),behaviours:we(e.tabButtonBehaviours,[b.config({}),u.config({mode:"execution",useSpace:!0,useEnter:!0}),r.config({store:{mode:"memory",initialValue:e.value}})]),domModification:e.domModification}),$I=gt({name:"TabButton",configFields:[t("uid",void 0),s("value"),Me("dom","dom",z1(()=>({attributes:{role:"tab",id:d("aria"),"aria-selected":"false"}})),yn()),D("action"),t("domModification",{}),ve("tabButtonBehaviours",[b,u,r]),s("view")],factory:VI}),WI=n([s("tabs"),s("dom"),t("clickToDismiss",!1),ve("tabbarBehaviours",[F,u]),go(["tabClass","selectedClass"])]),UI=qr({factory:$I,name:"tabs",unit:"tab",overrides:e=>{const t=(e,t)=>{F.dehighlight(e,t),p(e,jm(),{tabbar:e,button:t})},n=(e,t)=>{F.highlight(e,t),p(e,cm(),{tabbar:e,button:t})};return{action:s=>{const o=s.getSystem().getByUid(e.uid).getOrDie(),i=F.isHighlighted(o,s),a=(()=>i&&e.clickToDismiss?t:i?l:n)();a(o,s)},domModification:{classes:[e.markers.tabClass]}}}}),KI=n([UI]),qI=(e,t)=>({uid:e.uid,dom:e.dom,components:t,"debug.sketcher":"Tabbar",domModification:{attributes:{role:"tablist"}},behaviours:we(e.tabbarBehaviours,[F.config({highlightClass:e.markers.selectedClass,itemClass:e.markers.tabClass,onHighlight:(e,t)=>{w(t.element,"aria-selected","true")},onDehighlight:(e,t)=>{w(t.element,"aria-selected","false")}}),u.config({mode:"flow",getInitial:e=>F.getHighlighted(e).map(e=>e.element),selector:"."+e.markers.tabClass,executeOnMove:!0})])}),Ih=We({name:"Tabbar",configFields:WI(),partFields:KI(),factory:qI}),GI=(e)=>({uid:e.uid,dom:e.dom,behaviours:we(e.tabviewBehaviours,[j.config({})]),domModification:{attributes:{role:"tabpanel"}}}),XI=gt({name:"Tabview",configFields:[ve("tabviewBehaviours",[j])],factory:GI}),QI=n([t("selectFirst",!0),E("onChangeTab"),E("onDismissTab"),t("tabs",[]),ve("tabSectionBehaviours",[])]),ZI=Pe({factory:Ih,schema:[s("dom"),ys("markers",[s("tabClass"),s("selectedClass")])],name:"tabbar",defaults:e=>({tabs:e.tabs})}),JI=Pe({factory:XI,name:"tabview"}),eB=n([ZI,JI]),tB=(e,t)=>{const a=t=>{const n=r.getValue(t);H(t,e,"tabview").each(s=>{const o=se(e.tabs,e=>e.value===n);o.each(n=>{const o=n.view();ut(t.element,"id").each(e=>{w(s.element,"aria-labelledby",e)}),j.set(s,o),e.onChangeTab(s,t,o)})})},i=(t,n)=>{H(t,e,"tabbar").each(e=>{n(e).each(mo)})};return{uid:e.uid,dom:e.dom,components:t,behaviours:Ar(e.tabSectionBehaviours),events:$(Fe([e.selectFirst?[J((e)=>{i(e,F.getFirst)})]:[],[o(cm(),(e,t)=>{const n=t.event.button;a(n)}),o(jm(),(t,n)=>{const s=n.event.button;e.onDismissTab(t,s)})]])),apis:{getViewItems:t=>H(t,e,"tabview").map(e=>j.contents(e)).getOr([]),showTab:(e,t)=>{const n=e=>{const n=F.getCandidates(e),s=se(n,e=>r.getValue(e)===t);return s.filter(t=>!F.isHighlighted(e,t))};i(e,n)}}}},ti=We({name:"TabSection",configFields:QI(),partFields:eB(),factory:tB,apis:{getViewItems:(e,t)=>e.getViewItems(t),showTab:(e,t,n)=>{e.showTab(t,n)}}}),sB=(e,t,n)=>a(e,(s,o)=>{j.set(n,e[o].view());const i=t.dom.getBoundingClientRect();return j.set(n,[]),i.height}),oB=e=>os(S7(e,(e,t)=>e>t?-1:e<t?+1:0)),iB=(e,t,n)=>{const s=Ld(e).dom,a=Cc(e,".tox-dialog-wrap").getOr(e),r=ft(a,"position")==="fixed";let o;r?o=Math.max(s.clientHeight,window.innerHeight):o=Math.max(s.offsetHeight,s.scrollHeight);const i=Ve(t),c=t.dom.offsetLeft>=n.dom.offsetLeft+et(n),l=c?Math.max(Ve(n),i):i,d=parseInt(ft(e,"margin-top"),10)||0,u=parseInt(ft(e,"margin-bottom"),10)||0,h=Ve(e)+d+u,m=h-l;return o-m},aB=(e,t)=>{os(e).each(e=>ti.showTab(t,e.value))},im=(e,t)=>{y(e,"height",t+"px"),y(e,"flex-basis",t+"px")},ec=(e,t,n)=>{Cc(e,'[role="dialog"]').each(e=>{be(e,'[role="tablist"]').each(s=>{n.get().map(n=>(y(t,"height","0"),y(t,"flex-basis","0"),Math.min(n,iB(e,t,s)))).each(e=>{im(t,e)})})})},Bu=e=>be(e,'[role="tabpanel"]'),dB=e=>{const t=K(),n=[J(n=>{const s=n.element;Bu(s).each(o=>{y(o,"visibility","hidden"),n.getSystem().getByDom(o).toOptional().each(n=>{const s=sB(e,o,n),i=oB(s);i.fold(t.clear,t.set)}),ec(s,o,t),B(o,"visibility"),aB(e,n),requestAnimationFrame(()=>{ec(s,o,t)})})}),o(gr(),e=>{const n=e.element;Bu(n).each(e=>{ec(n,e,t)})}),o(T6,(e)=>{const s=e.element;Bu(s).each(e=>{const i=cs(Pt(e));y(e,"visibility","hidden");const n=Re(e,"height").map(e=>parseInt(e,10));B(e,"height"),B(e,"flex-basis");const o=e.dom.getBoundingClientRect().height,a=n.forall(e=>o>e);a?(t.set(o),ec(s,e,t)):n.each(t=>{im(e,t)}),B(e,"visibility"),i.each(es)})})],s=!1;return{extraEvents:n,selectFirst:s}},ym="send-data-to-section",_m="send-data-to-view",mB=(t,n,s)=>{const o=g({}),c=e=>{const t=r.getValue(e),n=Rh(t).getOr({}),s=o.get(),i=Q(s,n);o.set(i)},l=e=>{const t=o.get();r.setValue(e,t)},d=g(null),h=a(t.tabs,e=>({value:e.name,dom:{tag:"div",classes:["tox-dialog__body-nav-item"]},components:[je(s.shared.providers.translate(e.title))],view:()=>[li.sketch(t=>({dom:{tag:"div",classes:["tox-form"]},components:a(e.items,e=>H2(t,e,n,s)),formBehaviours:i([u.config({mode:"acyclic",useTabstopAt:ra(na)}),O("TabView.form.events",[J(l),Hn(c)]),It.config({channels:Po([{key:ym,value:{onReceive:c}},{key:_m,value:{onReceive:l}}])})])}))]})),m=dB(h);return ti.sketch({dom:{tag:"div",classes:["tox-dialog__body"]},onChangeTab:(e,t)=>{const s=r.getValue(t);p(e,z6,{name:s,oldName:d.get()}),d.set(s)},tabs:h,components:[ti.parts.tabbar({dom:{tag:"div",classes:["tox-dialog__body-nav"]},components:[Ih.parts.tabs({})],markers:{tabClass:"tox-tab",selectedClass:"tox-dialog__body-nav-item--active"},tabbarBehaviours:i([ee.config({})])}),ti.parts.tabview({dom:{tag:"div",classes:["tox-dialog__body-content"]}})],selectFirst:m.selectFirst,tabSectionBehaviours:i([O("tabpanel",m.extraEvents),u.config({mode:"acyclic"}),x.config({find:e=>os(ti.getViewItems(e))}),Ct.withComp(e.none(),e=>(e.getSystem().broadcastOn([ym],{}),o.get()),(e,t)=>{o.set(t),e.getSystem().broadcastOn([_m],{})})])})},Pu=d("update-dialog"),zm=d("update-title"),Dm=d("update-body"),Lm=d("update-footer"),Rm=d("body-send-message"),Vm=(t,n,s,o,a)=>{const r=e=>{const t=e.body;switch(t.type){case"tabpanel":return[mB(t,e.initialData,o)];default:return[BI(t,e.initialData,o)]}},c=(t,n)=>e.some({isTabPanel:()=>n.body.type==="tabpanel"}),l={"aria-live":"polite"};return{dom:{tag:"div",classes:["tox-dialog__content-js"],attributes:{...s.map(e=>({id:e})).getOr({}),...a?l:{}}},components:[],behaviours:i([nn.childAt(0),it.config({channel:`${Dm}-${n}`,updateState:c,renderComponents:r,initialData:t})])}},yB=(t,n,s,o,i)=>Vm(t,n,e.some(s),o,i),_B=(t,n,s)=>{const o=Vm(t,n,e.none(),s,!1);return ce.parts.body(o)},wB=e=>{const t={dom:{tag:"div",classes:["tox-dialog__content-js"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-iframe"]},components:[em({dom:{tag:"iframe",attributes:{src:e.url}},behaviours:i([ee.config({}),b.config({})])})]}],behaviours:i([u.config({mode:"acyclic",useTabstopAt:ra(na)})])};return ce.parts.body(t)};function Rs(e){return"@babel/helpers - typeof",Rs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Rs(e)}function zu(e,t){return zu=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t},zu(e,t)}function CB(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function dc(){return CB()?dc=Reflect.construct:dc=function(t,n,s){var i,a,o=[null];return o.push.apply(o,n),a=Function.bind.apply(t,o),i=new a,s&&zu(i,s.prototype),i},dc.apply(null,arguments)}function mn(e){return AB(e)||SB(e)||MB(e)||TB()}function AB(e){if(Array.isArray(e))return ku(e)}function SB(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function MB(e,t){if(!e)return;if(typeof e=="string")return ku(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ku(e,t)}function ku(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,s=new Array(t);n<t;n++)s[n]=e[n];return s}function TB(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var P,gv,fm,St,Np,Xl,Xo,a8,i8,lm,rs,y2,g2,$4,y0,z0,D0,K0,Y0,k2,S2,M2,T2,K2,Y2,J2,o3,c3,m3,f3,J3,vh,Fh,qh,Xh,S4,gm,vm,rc,Um,Km,e8,s8,R8,G8,wf,Tf,Lf,Uf,a6,m6,g6,v6,A6,F6,L6,Ge,Ai,Ft,Jp,Do,tg,_o,zt,xa,s5,Ql,Yt,Bv,$v,Wv,Kv,xs,E5,x5,_5,Zr,ap,ip,sp,_6,y6,j6,f6,t6,C8,y8,Jm,am,As,I3,A3,k3,B4,T4,N4,P4,U4,U2,$a,H3,V3,K3,Q3,dh,gh,bh,bo,Wi,Vo,b7,w7,x7,T7,Dv,H7,A2,G0,_0,p4,o2,i2,Z2,co,zB=Object.hasOwnProperty,n8=Object.setPrototypeOf,NB=Object.isFrozen,LB=Object.getPrototypeOf,RB=Object.getOwnPropertyDescriptor,Wf,Kf,Bo,da,e6,Vn,n6,s6,Ze,Uc,Bd,Yc,qc,ep,Ic,pp,Dd,zd,Qr,Sd,Yi,Lp,Rp,sg,og,ig,ag,mg,Og,Ag,Wg,Gg,cc,Uv,ot=Object.freeze,Mn=Object.seal,IB=Object.create,M4=typeof Reflect!="undefined"&&Reflect,Rc=M4.apply,su=M4.construct;Rc||(Rc=function(t,n,s){return t.apply(n,s)}),ot||(ot=function(t){return t}),Mn||(Mn=function(t){return t}),su||(su=function(t,n){return dc(t,mn(n))}),Wf=xn(Array.prototype.forEach),Kf=xn(Array.prototype.pop),Bo=xn(Array.prototype.push),da=xn(String.prototype.toLowerCase),e6=xn(String.prototype.match),Vn=xn(String.prototype.replace),n6=xn(String.prototype.indexOf),s6=xn(String.prototype.trim),Ze=xn(RegExp.prototype.test),Uc=tV(TypeError);function xn(e){return function(t){for(var s=arguments.length,o=new Array(s>1?s-1:0),n=1;n<s;n++)o[n-1]=arguments[n];return Rc(e,t,o)}}function tV(e){return function(){for(var n=arguments.length,s=new Array(n),t=0;t<n;t++)s[t]=arguments[t];return su(e,s)}}function N(e,t){n8&&n8(e,null);for(var n,s,o=t.length;o--;)n=t[o],typeof n=="string"&&(s=da(n),s!==n&&(NB(t)||(t[o]=s),n=s)),e[n]=!0;return e}function vo(e){var t,n=IB(null);for(t in e)Rc(zB,e,[t])&&(n[t]=e[t]);return n}function Qc(e,t){for(;e!==null;){var n=RB(e,t);if(n){if(n.get)return xn(n.get);if(typeof n.value=="function")return xn(n.value)}e=LB(e)}function s(e){return console.warn("fallback value for",e),null}return s}Bd=ot(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Yc=ot(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),qc=ot(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),ep=ot(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Ic=ot(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),pp=ot(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Dd=ot(["#text"]),zd=ot(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),Qr=ot(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Sd=ot(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Yi=ot(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Lp=Mn(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Rp=Mn(/<%[\w\W]*|[\w\W]*%>/gm),sg=Mn(/^data-[-\w.\u00B7-\uFFFF]/),og=Mn(/^aria-[-\w]+$/),ig=Mn(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.-]+(?:[^a-z+.\-:]|$))/i),ag=Mn(/^(?:\w+script|data):/i),mg=Mn(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Og=Mn(/^html$/i),Ag=function(){return typeof window=="undefined"?null:window},Wg=function(t,n){if(Rs(t)!=="object"||typeof t.createPolicy!="function")return null;var o,s=null,i="data-tt-policy-suffix";n.currentScript&&n.currentScript.hasAttribute(i)&&(s=n.currentScript.getAttribute(i)),o="dompurify"+(s?"#"+s:"");try{return t.createPolicy(o,{createHTML:function(t){return t}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}};function qg(){if(t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ag(),e=function(t){return qg(t)},e.version="2.3.8",e.removed=[],!t||!t.document||t.document.nodeType!==9)return e.isSupported=!1,e;var e,t,i,a,r,h,f,j,w,E,M,z,D,L,H,V,$,B=t.document,d=t.document,fe=t.DocumentFragment,Fe=t.HTMLTemplateElement,U=t.Node,je=t.Element,K=t.NodeFilter,ye=t.NamedNodeMap,Ae=ye===void 0?t.NamedNodeMap||t.MozNamedAttrMap:ye,ze=t.HTMLFormElement,Ne=t.DOMParser,Le=t.trustedTypes,be,pe,oe,O=je.prototype,Pe=Qc(O,"cloneNode"),Be=Qc(O,"nextSibling"),Re=Qc(O,"childNodes"),ee=Qc(O,"parentNode");typeof Fe=="function"&&(E=d.createElement("template"),E.content&&E.content.ownerDocument&&(d=E.content.ownerDocument));var l=Wg(Le,B),ue=l?l.createHTML(""):"",x=d,Z=x.implementation,Oe=x.createNodeIterator,De=x.createDocumentFragment,ke=x.getElementsByTagName,Te=B.importNode,ge={};try{ge=vo(d).documentMode?d.documentMode:{}}catch{}i={},e.isSupported=typeof ee=="function"&&Z&&typeof Z.createHTMLDocument!="undefined"&&ge!==9;var I=Lp,P=Rp,xe=sg,Ie=og,He=ag,ie=mg,R=ig,s=null,he=N({},[].concat(mn(Bd),mn(Yc),mn(qc),mn(Ic),mn(Dd))),o=null,se=N({},[].concat(mn(zd),mn(Qr),mn(Sd),mn(Yi))),n=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),_=null,W=null,ve=!0,F=!0,me=!1,b=!1,u=!1,X=!1,Q=!1,p=!1,C=!1,k=!1,le=!0,T=!0,y=!1,g={},m=null,ae=N({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),re=null,ce=N({},["audio","video","img","source","image","track"]),te=null,de=N({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),J="http://www.w3.org/1998/Math/MathML",G="http://www.w3.org/2000/svg",c="http://www.w3.org/1999/xhtml",A=c,Y=!1,Me=["application/xhtml+xml","text/html"],Se="text/html",v=null,Ce=d.createElement("form"),we=function(t){return t instanceof RegExp||t instanceof Function},q=function(t){if(v&&v===t)return;(!t||Rs(t)!=="object")&&(t={}),t=vo(t),s="ALLOWED_TAGS"in t?N({},t.ALLOWED_TAGS):he,o="ALLOWED_ATTR"in t?N({},t.ALLOWED_ATTR):se,te="ADD_URI_SAFE_ATTR"in t?N(vo(de),t.ADD_URI_SAFE_ATTR):de,re="ADD_DATA_URI_TAGS"in t?N(vo(ce),t.ADD_DATA_URI_TAGS):ce,m="FORBID_CONTENTS"in t?N({},t.FORBID_CONTENTS):ae,_="FORBID_TAGS"in t?N({},t.FORBID_TAGS):{},W="FORBID_ATTR"in t?N({},t.FORBID_ATTR):{},g="USE_PROFILES"in t&&t.USE_PROFILES,ve=t.ALLOW_ARIA_ATTR!==!1,F=t.ALLOW_DATA_ATTR!==!1,me=t.ALLOW_UNKNOWN_PROTOCOLS||!1,b=t.SAFE_FOR_TEMPLATES||!1,u=t.WHOLE_DOCUMENT||!1,p=t.RETURN_DOM||!1,C=t.RETURN_DOM_FRAGMENT||!1,k=t.RETURN_TRUSTED_TYPE||!1,Q=t.FORCE_BODY||!1,le=t.SANITIZE_DOM!==!1,T=t.KEEP_CONTENT!==!1,y=t.IN_PLACE||!1,R=t.ALLOWED_URI_REGEXP||R,A=t.NAMESPACE||c,t.CUSTOM_ELEMENT_HANDLING&&we(t.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(n.tagNameCheck=t.CUSTOM_ELEMENT_HANDLING.tagNameCheck),t.CUSTOM_ELEMENT_HANDLING&&we(t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(n.attributeNameCheck=t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),t.CUSTOM_ELEMENT_HANDLING&&typeof t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(n.allowCustomizedBuiltInElements=t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),f=Me.indexOf(t.PARSER_MEDIA_TYPE)===-1?f=Se:f=t.PARSER_MEDIA_TYPE,h=f==="application/xhtml+xml"?function(e){return e}:da,b&&(F=!1),C&&(p=!0),g&&(s=N({},mn(Dd)),o=[],g.html===!0&&(N(s,Bd),N(o,zd)),g.svg===!0&&(N(s,Yc),N(o,Qr),N(o,Yi)),g.svgFilters===!0&&(N(s,qc),N(o,Qr),N(o,Yi)),g.mathMl===!0&&(N(s,Ic),N(o,Sd),N(o,Yi))),t.ADD_TAGS&&(s===he&&(s=vo(s)),N(s,t.ADD_TAGS)),t.ADD_ATTR&&(o===se&&(o=vo(o)),N(o,t.ADD_ATTR)),t.ADD_URI_SAFE_ATTR&&N(te,t.ADD_URI_SAFE_ATTR),t.FORBID_CONTENTS&&(m===ae&&(m=vo(m)),N(m,t.FORBID_CONTENTS)),T&&(s["#text"]=!0),u&&N(s,["html","head","body"]),s.table&&(N(s,["tbody"]),delete _.tbody),ot&&ot(t),v=t},ne=N({},["mi","mo","mn","ms","mtext"]),_e=N({},["foreignobject","desc","title","annotation-xml"]),Ee=N({},["title","style","font","a","script"]),S=N({},Yc);return N(S,qc),N(S,ep),M=N({},Ic),N(M,pp),be=function(t){var s,o,n=ee(t);return(!n||!n.tagName)&&(n={namespaceURI:c,tagName:"template"}),s=da(t.tagName),o=da(n.tagName),t.namespaceURI===G?n.namespaceURI===c?s==="svg":n.namespaceURI===J?s==="svg"&&(o==="annotation-xml"||ne[o]):Boolean(S[s]):t.namespaceURI===J?n.namespaceURI===c?s==="math":n.namespaceURI===G?s==="math"&&_e[o]:Boolean(M[s]):t.namespaceURI===c&&!(n.namespaceURI===G&&!_e[o])&&!(n.namespaceURI===J&&!ne[o])&&!M[s]&&(Ee[s]||!S[s])},a=function(n){Bo(e.removed,{element:n});try{n.parentNode.removeChild(n)}catch{try{n.outerHTML=ue}catch{n.remove()}}},w=function(n,s){try{Bo(e.removed,{attribute:s.getAttributeNode(n),from:s})}catch{Bo(e.removed,{attribute:null,from:s})}if(s.removeAttribute(n),n==="is"&&!o[n])if(p||C)try{a(s)}catch{}else try{s.setAttribute(n,"")}catch{}},$=function(t){if(Q)t="<remove></remove>"+t;else{var n,s,o,i,a=e6(t,/^[\r\n\t ]+/);o=a&&a[0]}if(f==="application/xhtml+xml"&&(t='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+t+"</body></html>"),i=l?l.createHTML(t):t,A===c)try{n=(new Ne).parseFromString(i,f)}catch{}if(!n||!n.documentElement){n=Z.createDocument(A,"template",null);try{n.documentElement.innerHTML=Y?"":i}catch{}}return s=n.body||n.documentElement,t&&o&&s.insertBefore(d.createTextNode(o),s.childNodes[0]||null),A===c?ke.call(n,u?"html":"body")[0]:u?n.documentElement:s},V=function(t){return Oe.call(t.ownerDocument||t,t,K.SHOW_ELEMENT|K.SHOW_COMMENT|K.SHOW_TEXT,null,!1)},pe=function(t){return t instanceof ze&&(typeof t.nodeName!="string"||typeof t.textContent!="string"||typeof t.removeChild!="function"||!(t.attributes instanceof Ae)||typeof t.removeAttribute!="function"||typeof t.setAttribute!="function"||typeof t.namespaceURI!="string"||typeof t.insertBefore!="function")},j=function(t){return Rs(U)==="object"?t instanceof U:t&&Rs(t)==="object"&&typeof t.nodeType=="number"&&typeof t.nodeName=="string"},r=function(n,s,o){if(!i[n])return;Wf(i[n],function(t){t.call(e,s,o,v)})},H=function(o){if(r("beforeSanitizeElements",o,null),pe(o))return a(o),!0;if(Ze(/[\u0080-\uFFFF]/,o.nodeName))return a(o),!0;var c,l,d,u,f,i=h(o.nodeName);if(r("uponSanitizeElement",o,{tagName:i,allowedTags:s}),o.hasChildNodes()&&!j(o.firstElementChild)&&(!j(o.content)||!j(o.content.firstElementChild))&&Ze(/<[/\w]/g,o.innerHTML)&&Ze(/<[/\w]/g,o.textContent))return a(o),!0;if(i==="select"&&Ze(/<template/i,o.innerHTML))return a(o),!0;if(!s[i]||_[i]){if(!_[i]&&D(i)){if(n.tagNameCheck instanceof RegExp&&Ze(n.tagNameCheck,i))return!1;if(n.tagNameCheck instanceof Function&&n.tagNameCheck(i))return!1}if(T&&!m[i]&&(u=ee(o)||o.parentNode,l=Re(o)||o.childNodes,l&&u)){f=l.length;for(d=f-1;d>=0;--d)u.insertBefore(Pe(l[d],!0),Be(o))}return a(o),!0}return o instanceof je&&!be(o)?(a(o),!0):(i==="noscript"||i==="noembed")&&Ze(/<\/no(script|embed)/i,o.innerHTML)?(a(o),!0):(b&&o.nodeType===3&&(c=o.textContent,c=Vn(c,I," "),c=Vn(c,P," "),o.textContent!==c&&(Bo(e.removed,{element:o.cloneNode()}),o.textContent=c)),r("afterSanitizeElements",o,null),!1)},L=function(t,s,i){if(le&&(s==="id"||s==="name")&&(i in d||i in Ce))return!1;if(F&&!W[s]&&Ze(xe,s));else if(ve&&Ze(Ie,s));else if(!o[s]||W[s])if(D(t)&&(n.tagNameCheck instanceof RegExp&&Ze(n.tagNameCheck,t)||n.tagNameCheck instanceof Function&&n.tagNameCheck(t))&&(n.attributeNameCheck instanceof RegExp&&Ze(n.attributeNameCheck,s)||n.attributeNameCheck instanceof Function&&n.attributeNameCheck(s))||s==="is"&&n.allowCustomizedBuiltInElements&&(n.tagNameCheck instanceof RegExp&&Ze(n.tagNameCheck,i)||n.tagNameCheck instanceof Function&&n.tagNameCheck(i)));else return!1;else if(te[s]);else if(Ze(R,Vn(i,ie,"")));else if((s==="src"||s==="xlink:href"||s==="href")&&t!=="script"&&n6(i,"data:")===0&&re[t]);else if(me&&!Ze(He,Vn(i,ie,"")));else if(i)return!1;return!0},D=function(t){return t.indexOf("-")>0},z=function(t){if(r("beforeSanitizeAttributes",t,null),c=t.attributes,!c)return;for(s={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:o},d=c.length;d--;){a=c[d];var n,s,a,c,l,d,f,p,u=a,i=u.name,m=u.namespaceURI;if(n=i==="value"?a.value:s6(a.value),l=h(i),f=n,s.attrName=l,s.attrValue=n,s.keepAttr=!0,s.forceKeepAttr=void 0,r("uponSanitizeAttribute",t,s),n=s.attrValue,s.forceKeepAttr)continue;if(!s.keepAttr){w(i,t);continue}if(Ze(/\/>/i,n)){w(i,t);continue}if(b&&(n=Vn(n,I," "),n=Vn(n,P," ")),p=h(t.nodeName),!L(p,l,n)){w(i,t);continue}if(n!==f)try{m?t.setAttributeNS(m,i,n):t.setAttribute(i,n)}catch{w(i,t)}}r("afterSanitizeAttributes",t,null)},oe=function e(t){var n,s=V(t);for(r("beforeSanitizeShadowDOM",t,null);n=s.nextNode();){if(r("uponSanitizeShadowNode",n,null),H(n))continue;n.content instanceof fe&&e(n.content),z(n)}r("afterSanitizeShadowDOM",t,null)},e.sanitize=function(n,i){if(Y=!n,Y&&(n="<!-->"),typeof n!="string"&&!j(n)){if(typeof n.toString!="function")throw Uc("toString is not a function");if(n=n.toString(),typeof n!="string")throw Uc("dirty is not a string, aborting")}if(!e.isSupported){if(Rs(t.toStaticHTML)==="object"||typeof t.toStaticHTML=="function"){if(typeof n=="string")return t.toStaticHTML(n);if(j(n))return t.toStaticHTML(n.outerHTML)}return n}if(X||q(i),e.removed=[],typeof n=="string"&&(y=!1),y){if(n.nodeName){var r,c,d,m,f,g,w,v=h(n.nodeName);if(!s[v]||_[v])throw Uc("root node is forbidden and cannot be sanitized in-place")}}else if(n instanceof U)r=$("<!---->"),m=r.ownerDocument.importNode(n,!0),m.nodeType===1&&m.nodeName==="BODY"?r=m:m.nodeName==="HTML"?r=m:r.appendChild(m);else{if(!p&&!b&&!u&&n.indexOf("<")===-1)return l&&k?l.createHTML(n):n;if(r=$(n),!r)return p?null:k?ue:""}for(r&&Q&&a(r.firstChild),w=V(y?n:r);d=w.nextNode();){if(d.nodeType===3&&d===g)continue;if(H(d))continue;d.content instanceof fe&&oe(d.content),z(d),g=d}if(g=null,y)return n;if(p){if(C)for(f=De.call(r.ownerDocument);r.firstChild;)f.appendChild(r.firstChild);else f=r;return o.shadowroot&&(f=Te.call(B,f,!0)),f}return c=u?r.outerHTML:r.innerHTML,u&&s["!doctype"]&&r.ownerDocument&&r.ownerDocument.doctype&&r.ownerDocument.doctype.name&&Ze(Og,r.ownerDocument.doctype.name)&&(c="<!DOCTYPE "+r.ownerDocument.doctype.name+`>
`+c),b&&(c=Vn(c,I," "),c=Vn(c,P," ")),l&&k?l.createHTML(c):c},e.setConfig=function(e){q(e),X=!0},e.clearConfig=function(){v=null,X=!1},e.isValidAttribute=function(e,t,n){v||q({});var s=h(e),o=h(t);return L(s,o,n)},e.addHook=function(e,t){if(typeof t!="function")return;i[e]=i[e]||[],Bo(i[e],t)},e.removeHook=function(e){if(i[e])return Kf(i[e])},e.removeHooks=function(e){i[e]&&(i[e]=[])},e.removeAllHooks=function(){i={}},e}Gg=qg();const AV=e=>Gg().sanitize(e),SV=_o.deviceType.isTouch(),Zg=(e,t)=>({dom:{tag:"div",styles:{display:"none"},classes:["tox-dialog__header"]},components:[e,t]}),t5=(e,t)=>ce.parts.close(nt.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":t.translate("Close")}},action:e,buttonBehaviours:i([ee.config({})])})),d5=()=>ce.parts.title({dom:{tag:"div",classes:["tox-dialog__title"],innerHtml:"",styles:{display:"none"}}}),h5=(e,t)=>ce.parts.body({dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[{dom:Ds(`<p>${AV(t.translate(e))}</p>`)}]}]}),f5=e=>ce.parts.footer({dom:{tag:"div",classes:["tox-dialog__footer"]},components:e}),j5=(e,t)=>[_n.sketch({dom:{tag:"div",classes:["tox-dialog__footer-start"]},components:e}),_n.sketch({dom:{tag:"div",classes:["tox-dialog__footer-end"]},components:t})],Wl=t=>{const n="tox-dialog",s=n+"-wrap",o=s+"__backdrop",a=n+"__disable-scroll";return ce.sketch({lazySink:t.lazySink,onEscape:n=>(t.onEscape(n),e.some(!0)),useTabstopAt:e=>!na(e),dom:{tag:"div",classes:[n].concat(t.extraClasses),styles:{position:"relative",...t.extraStyles}},components:[t.header,t.body,...t.footer.toArray()],parts:{blocker:{dom:Ds(`<div class="${s}"></div>`),components:[{dom:{tag:"div",classes:SV?[o,o+"--opaque"]:[o]}}]}},dragBlockClass:s,modalBehaviours:i([b.config({}),O("dialog-events",t.dialogEvents.concat([So(Cs(),(e)=>{u.focusIn(e)})])),O("scroll-lock",[J(()=>{me(Un(),a)}),Hn(()=>{ae(Un(),a)})]),...t.extraBehaviours]),eventOrder:{[bt()]:["dialog-events"],[no()]:["scroll-lock","dialog-events","alloy.base.behaviour"],[hi()]:["alloy.base.behaviour","dialog-events","scroll-lock"],...t.eventOrder}})},D5=e=>nt.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":e.translate("Close"),title:e.translate("Close")}},components:[fn("close",{tag:"div",classes:["tox-icon"]},e.icons)],action:e=>{T(e,yo)}}),R5=(e,t,n,s)=>{const o=e=>[je(s.translate(e.title))];return{dom:{tag:"div",classes:["tox-dialog__title"],attributes:{...n.map(e=>({id:e})).getOr({})}},components:[],behaviours:i([it.config({channel:`${zm}-${t}`,initialData:e,renderComponents:o})])}},$5=()=>({dom:Ds('<div class="tox-dialog__draghandle"></div>')}),IV=(t,n,s,o)=>_n.sketch({dom:Ds('<div class="tox-dialog__header"></div>'),components:[R5(t,n,e.some(s),o),$5(),D5(o)],containerBehaviours:i([$s.config({mode:"mouse",blockerClass:"blocker",getTarget:e=>cn(e,'[role="dialog"]').getOrDie(),snaps:{getSnapPoints:()=>[],leftAttr:"data-drag-left",topAttr:"data-drag-top"}})])}),BV=(t,n,s)=>{const o=ce.parts.title(R5(t,n,e.none(),s)),i=ce.parts.draghandle($5()),a=ce.parts.close(D5(s)),r=[o].concat(t.draggable?[i]:[]).concat([a]);return _n.sketch({dom:Ds('<div class="tox-dialog__header"></div>'),components:r})},q5=(e,t,n)=>BV({title:n.shared.providers.translate(e),draggable:n.dialog.isDraggableModal()},t,n.shared.providers),J5=(e,t,n)=>({dom:{tag:"div",classes:["tox-dialog__busy-spinner"],attributes:{"aria-label":n.translate(e)},styles:{left:"0px",right:"0px",bottom:"0px",top:"0px",position:"absolute"}},behaviours:t,components:[{dom:Ds('<div class="tox-spinner"><div></div><div></div><div></div></div>')}]}),c7=(e,t,n)=>({onClose:()=>n.closeWindow(),onBlock:n=>{ce.setBusy(e(),(e,s)=>J5(n.message,s,t))},onUnblock:()=>{ce.setIdle(e())}}),v7=(t,n,s,o)=>{const i=(t,n)=>e.some(n);return Ye(Wl({...t,lazySink:o.shared.getSink,extraBehaviours:[it.config({channel:`${Pu}-${t.id}`,updateState:i,initialData:n}),Ct.memory({}),...t.extraBehaviours],onEscape:e=>{T(e,yo)},dialogEvents:s,eventOrder:{[ao()]:[it.name(),It.name()],[no()]:["scroll-lock",it.name(),"messages","dialog-events","alloy.base.behaviour"],[hi()]:["alloy.base.behaviour","dialog-events","messages",it.name(),"scroll-lock"]}}))},C7=e=>{const t=e=>{const t=a(e.items,e=>{const t=g(!1);return{...e,storage:t}});return{...e,items:t}};return a(e,e=>e.type==="menu"?t(e):e)},k7=e=>He(e,(e,t)=>{if(t.type==="menu"){const n=t;return He(n.items,(e,t)=>(e[t.name]=t.storage,e),e)}return e},{}),z7=(e,t)=>[Xd(Cs(),nC),e(Fa,(e,n)=>{t.onClose(),n.onClose()}),e(yo,(e,t,n,s)=>{t.onCancel(e),T(s,Fa)}),o(qd,()=>t.onUnblock()),o(Kd,(e,n)=>t.onBlock(n.event))],GV=(e,t)=>{const n=(t,n)=>o(t,(t,o)=>{s(t,(s)=>{n(e(),s,o.event,t)})}),s=(e,t)=>{it.getState(e).get().each(n=>{t(n,e)})};return[...z7(n,t),n(ss,(e,t,n)=>{t.onAction(e,{name:n.name})})]},XV=(e,t,n)=>{const s=(t,n)=>o(t,(t,s)=>{i(t,(o)=>{n(e(),o,s.event,t)})}),i=(e,t)=>{it.getState(e).get().each(n=>{t(n.internalDialog,e)})};return[...z7(s,t),s(Da,(e,t)=>t.onSubmit(e)),s(lt,(e,t,n)=>{t.onChange(e,{name:n.name})}),s(ss,(e,t,s,o)=>{const i=()=>u.focusIn(o),a=e=>Y6(e,"disabled")||ut(e,"aria-disabled").exists(e=>e==="true"),r=Pt(o.element),c=cs(r);t.onAction(e,{name:s.name,value:s.value}),cs(r).fold(i,e=>{a(e)?i():c.exists(t=>tc(e,t)&&a(t))?i():n().toOptional().filter(t=>!tc(t.element,e)).each(i)})}),s(z6,(e,t,n)=>{t.onTabChange(e,{newTabName:n.name,oldTabName:n.oldName})}),Hn(t=>{const n=e();r.setValue(t,n.getData())})]},wl={initUrlDialog:GV,initDialog:XV},ZV=(e,t)=>xr(e,e.type,t),JV=(e,t,n)=>se(t,e=>e.name===n).bind(t=>t.memento.getOpt(e)),e$=(e,t)=>{const o=t.map(e=>e.footerButtons).getOr([]),n=L7(o,e=>e.align==="start"),s=(e,t)=>_n.sketch({dom:{tag:"div",classes:[`tox-dialog__footer-${e}`]},components:a(t,e=>e.memento.asSpec())}),i=s("start",n.pass),r=s("end",n.fail);return[i,r]},I7=(t,n,s)=>{const o=(t,n)=>{const o=a(n.buttons,e=>{const t=V(ZV(e,s));return{name:e.name,align:e.align,memento:t}}),i=e=>JV(t,o,e);return e.some({lookupByName:i,footerButtons:o})};return{dom:Ds('<div class="tox-dialog__footer"></div>'),components:[],behaviours:i([it.config({channel:`${Lm}-${n}`,initialData:t,updateState:o,renderComponents:e$})])}},n$=(e,t,n)=>I7(e,t,n),rv=(e,t,n)=>ce.parts.footer(I7(e,t,n)),dv=(t,n)=>{const s=t.getRoot();if(s.getSystem().isConnected()){const e=x.getCurrent(t.getFormWrapper()).getOr(t.getFormWrapper());return li.getField(e,n).orThunk(()=>{const e=t.getFooter(),s=it.getState(e).get();return s.bind(e=>e.lookupByName(n))})}return e.none()},i$=(e,t)=>{const n=e.getRoot();return it.getState(n).get().map(e=>pn(X("data",e.dataValidator,t))).getOr(t)},Fv=(e,t,n)=>{const s=t=>{const n=e.getRoot();n.getSystem().isConnected()&&t(n)},i=()=>{const t=e.getRoot(),s=t.getSystem().isConnected()?e.getFormWrapper():t,o=r.getValue(s),i=_e(n,e=>e.get());return{...o,...i}},a=t=>{s(s=>{const a=o.getData(),i=Q(a,t),c=i$(e,i),l=e.getFormWrapper();r.setValue(l,c),Ie(n,(e,t)=>{R(i,t)&&e.set(i[t])})})},c=(t,n)=>{dv(e,t).each(n?v.enable:v.disable)},l=t=>{dv(e,t).each(b.focus)},d=e=>{if(!L(e))throw new Error("The dialogInstanceAPI.block function should be passed a blocking message of type string as an argument");s(t=>{p(t,Kd,{message:e})})},u=()=>{s(e=>{T(e,qd)})},h=t=>{s(n=>{const s=e.getBody(),o=it.getState(s);o.get().exists(e=>e.isTabPanel())&&x.getCurrent(s).each(e=>{ti.showTab(e,t)})})},m=n=>{s(s=>{const a=e.getId(),i=t(n);s.getSystem().broadcastOn([`${Pu}-${a}`],i),s.getSystem().broadcastOn([`${zm}-${a}`],i.internalDialog),s.getSystem().broadcastOn([`${Dm}-${a}`],i.internalDialog),s.getSystem().broadcastOn([`${Lm}-${a}`],i.internalDialog),o.setData(i.initialData)})},f=()=>{s(e=>{T(e,Fa)})},o={getData:i,setData:a,setEnabled:c,focus:l,block:d,unblock:u,showTab:h,redial:m,close:f};return o},r$=e=>{switch(e){case"large":return["tox-dialog--width-lg"];case"medium":return["tox-dialog--width-md"];default:return[]}},c$=(t,s,o)=>{const a=d("dialog"),r=t.internalDialog,b=q5(r.title,a,o),g=_B({body:r.body,initialData:r.initialData},a,o),l=C7(r.buttons),h=k7(l),u=rv({buttons:l},a,o),m=wl.initDialog(()=>c,c7(()=>i,o.shared.providers,s),o.shared.getSink),f=r$(r.size),p={id:a,header:b,body:g,footer:e.some(u),extraClasses:f,extraBehaviours:[],extraStyles:{}},i=v7(p,t,m,o),v=(()=>{const e=()=>{const e=ce.getBody(i);return x.getCurrent(e).getOr(e)};return{getId:n(a),getRoot:n(i),getBody:()=>ce.getBody(i),getFooter:()=>ce.getFooter(i),getFormWrapper:e}})(),c=Fv(v,s.redial,h);return{dialog:i,instanceApi:c}},l$=(t,s,o,a)=>{const c=d("dialog"),g=d("dialog-label"),m=d("dialog-content"),l=t.internalDialog,y=(t,n)=>e.some(n),_=V(IV({title:l.title,draggable:!0},c,g,o.shared.providers)),h=V(yB({body:l.body,initialData:l.initialData},c,m,o,a)),f=C7(l.buttons),w=k7(f),p=V(n$({buttons:f},c,o)),C=wl.initDialog(()=>v,{onBlock:e=>{Xn.block(r,(t,n)=>J5(e.message,n,o.shared.providers))},onUnblock:()=>{Xn.unblock(r)},onClose:()=>s.closeWindow()},o.shared.getSink),r=Ye({dom:{tag:"div",classes:["tox-dialog","tox-dialog-inline"],attributes:{role:"dialog",["aria-labelledby"]:g,["aria-describedby"]:m}},eventOrder:{[ao()]:[it.name(),It.name()],[bt()]:["execute-on-form"],[no()]:["reflecting","execute-on-form"]},behaviours:i([u.config({mode:"cyclic",onEscape:t=>(T(t,Fa),e.some(!0)),useTabstopAt:e=>!na(e)&&(Wn(e)!=="button"||De(e,"disabled")!=="disabled")}),it.config({channel:`${Pu}-${c}`,updateState:y,initialData:t}),b.config({}),O("execute-on-form",C.concat([So(Cs(),(e)=>{u.focusIn(e)})])),Xn.config({getRoot:()=>e.some(r)}),j.config({}),Ct.memory({})]),components:[_.asSpec(),h.asSpec(),p.asSpec()]}),v=Fv({getId:n(c),getRoot:n(r),getFooter:()=>p.get(r),getBody:()=>h.get(r),getFormWrapper:()=>{const e=h.get(r);return x.getCurrent(e).getOr(e)}},s.redial,w);return{dialog:r,instanceApi:v}};cc=tinymce.util.Tools.resolve("tinymce.util.URI");const u$=e=>{const t=t=>{e.getSystem().isConnected()&&t(e)},n=e=>{if(!L(e))throw new Error("The urlDialogInstanceAPI.block function should be passed a blocking message of type string as an argument");t(t=>{p(t,Kd,{message:e})})},s=()=>{t(e=>{T(e,qd)})},o=()=>{t(e=>{T(e,Fa)})},i=e=>{t(t=>{t.getSystem().broadcastOn([Rm],e)})};return{block:n,unblock:s,close:o,sendMessage:i}},h$=["insertContent","setContent","execCommand","close","block","unblock"],Rv=e=>Os(e)&&h$.indexOf(e.mceAction)!==-1,f$=e=>!Rv(e)&&Os(e)&&R(e,"mceAction"),p$=(e,t,n)=>{switch(n.mceAction){case"insertContent":e.insertContent(n.content);break;case"setContent":e.setContent(n.content);break;case"execCommand":const s=!!ts(n.ui)&&n.ui;e.execCommand(n.cmd,s,n.value);break;case"close":t.close();break;case"block":t.block(n.message);break;case"unblock":t.unblock();break}},g$=(t,n,s,o)=>{const l=d("dialog"),y=q5(t.title,l,o),j=wB(t),h=t.buttons.bind(t=>t.length===0?e.none():e.some(rv({buttons:t},l,o))),g=wl.initUrlDialog(()=>a,c7(()=>r,o.shared.providers,n)),f={...t.height.fold(()=>({}),e=>({height:e+"px","max-height":e+"px"})),...t.width.fold(()=>({}),e=>({width:e+"px","max-width":e+"px"}))},m=t.width.isNone()&&t.height.isNone()?["tox-dialog--width-lg"]:[],i=new cc(t.url,{base_uri:new cc(window.location.href)}),p=`${i.protocol}://${i.host}${i.port?":"+i.port:""}`,u=Qo(),v=[O("messages",[J(()=>{const e=qe(c.fromDom(window),"message",e=>{if(i.isSameOrigin(new cc(e.raw.origin))){const n=e.raw.data;Rv(n)?p$(s,a,n):f$(n)&&t.onMessage(a,n)}});u.set(e)}),Hn(u.clear)]),It.config({channels:{[Rm]:{onReceive:(e,t)=>{be(e.element,"iframe").each(e=>{const n=e.dom.contentWindow;en(n)&&n.postMessage(t,p)})}}}})],b={id:l,header:y,body:j,footer:h,extraClasses:m,extraBehaviours:v,extraStyles:f},r=v7(b,t,g,o),a=u$(r);return{dialog:r,instanceApi:a}},v$=t=>{const n=t.shared,s=(s,i)=>{const a=()=>{ce.hide(r),i()},c=V(xr({name:"close-alert",text:"OK",primary:!0,buttonType:e.some("primary"),align:"end",enabled:!0,icon:e.none()},"cancel",t)),l=d5(),d=t5(a,n.providers),r=Ye(Wl({lazySink:()=>n.getSink(),header:Zg(l,d),body:h5(s,n.providers),footer:e.some(f5(j5([],[c.asSpec()]))),onEscape:a,extraClasses:["tox-alert-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[o(yo,a)],eventOrder:{}}));ce.show(r);const u=c.get(r);b.focus(u)};return{open:s}},b$=t=>{const n=t.shared,s=(s,i)=>{const a=e=>{ce.hide(r),i(e)},c=V(xr({name:"yes",text:"Yes",primary:!0,buttonType:e.some("primary"),align:"end",enabled:!0,icon:e.none()},"submit",t)),l=xr({name:"no",text:"No",primary:!1,buttonType:e.some("secondary"),align:"end",enabled:!0,icon:e.none()},"cancel",t),d=d5(),u=t5(()=>a(!1),n.providers),r=Ye(Wl({lazySink:()=>n.getSink(),header:Zg(d,u),body:h5(s,n.providers),footer:e.some(f5(j5([],[l,c.asSpec()]))),onEscape:()=>a(!1),extraClasses:["tox-confirm-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[o(yo,()=>a(!1)),o(Da,()=>a(!0))],eventOrder:{}}));ce.show(r);const h=c.get(r);b.focus(h)};return{open:s}},j$=(e,t)=>pn(X("data",t,e)),y$=e=>vi(e,".tox-alert-dialog")||vi(e,".tox-confirm-dialog"),_$=(t,n,s)=>n&&s?[]:[$e.config({contextual:{lazyContext:()=>e.some(at(c.fromDom(t.getContentAreaContainer()))),fadeInClass:"tox-dialog-dock-fadein",fadeOutClass:"tox-dialog-dock-fadeout",transitionClass:"tox-dialog-dock-transition"},modes:["top"]})],w$=t=>{const n=t.editor,s=zi(n),r=v$(t.backstages.dialog),c=b$(t.backstages.dialog),l=(e,n,s)=>n!==void 0&&n.inline==="toolbar"?a(e,t.backstages.popup.shared.anchors.inlineDialog(),s,n.ariaAttrs):n!==void 0&&n.inline==="cursor"?a(e,t.backstages.popup.shared.anchors.cursor(),s,n.ariaAttrs):m(e,s),d=(e,t)=>h(e,t),h=(e,s)=>{const o=e=>{const o=g$(e,{closeWindow:()=>{ce.hide(o.dialog),s(o.instanceApi)}},n,t.backstages.dialog);return ce.show(o.dialog),o.instanceApi};return ia.openUrl(o,e)},m=(e,n)=>{const s=(e,s,o)=>{const a=s,r={dataValidator:o,initialData:a,internalDialog:e},i=c$(r,{redial:ia.redial,closeWindow:()=>{ce.hide(i.dialog),n(i.instanceApi)}},t.backstages.dialog);return ce.show(i.dialog),i.instanceApi.setData(a),i.instanceApi};return ia.open(s,e)},a=(a,r,c,l=!1)=>{const d=(a,d,h)=>{const v=j$(d,h),f=K(),p=t.backstages.popup.shared.header.isPositionedAtTop(),j={dataValidator:h,initialData:v,internalDialog:a},b=()=>f.on(e=>{te.reposition(e),$e.refresh(e)}),m=l$(j,{redial:ia.redial,closeWindow:()=>{f.on(te.hide),n.off("ResizeEditor",b),f.clear(),c(m.instanceApi)}},t.backstages.popup,l),g=Ye(te.sketch({lazySink:t.backstages.popup.shared.getSink,dom:{tag:"div",classes:[]},fireDismissalEventInstead:{},...p?{}:{fireRepositionEventInstead:{}},inlineBehaviours:i([O("window-manager-inline-events",[o(di(),()=>{T(m.dialog,yo)})]),..._$(n,s,p)]),isExtraPart:(e,t)=>y$(t)}));return f.set(g),te.showWithin(g,tn(m.dialog),{anchor:r},e.some(Un())),(!s||!p)&&($e.refresh(g),n.on("ResizeEditor",b)),m.instanceApi.setData(v),u.focusIn(m.dialog),m.instanceApi};return ia.open(d,a)},f=(e,t)=>{c.open(e,t)},p=(e,t)=>{r.open(e,t)},g=e=>{e.close()};return{open:l,openUrl:d,alert:p,close:g,confirm:f}},O$=e=>{rg(e),Fb(e),HL(e)};Uv=()=>{gv.add("silver",e=>{O$(e);const{dialogs:s,popups:t,renderUI:o}=XP(e);jy.register(e,t.backstage.shared);const i=w$({editor:e,backstages:{popup:t.backstage,dialog:s.backstage}}),a=()=>Jp(e,{backstage:t.backstage},t.getMothership());return{renderUI:o,getWindowManagerImpl:n(i),getNotificationManagerImpl:a}})},Uv()})()